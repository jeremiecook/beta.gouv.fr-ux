
;
;
/*! jquery-1.8.2.min.js */ 
;
;
/*! jQuery v1.8.2 jquery.com | jquery.org/license */
(function(a,b){function G(a){var b=F[a]={};return p.each(a.split(s),function(a,c){b[c]=!0}),b}function J(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(I,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:+d+""===d?+d:H.test(d)?p.parseJSON(d):d}catch(f){}p.data(a,c,d)}else d=b}return d}function K(a){var b;for(b in a){if(b==="data"&&p.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function ba(){return!1}function bb(){return!0}function bh(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function bi(a,b){do a=a[b];while(a&&a.nodeType!==1);return a}function bj(a,b,c){b=b||0;if(p.isFunction(b))return p.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return p.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=p.grep(a,function(a){return a.nodeType===1});if(be.test(b))return p.filter(b,d,!c);b=p.filter(b,d)}return p.grep(a,function(a,d){return p.inArray(a,b)>=0===c})}function bk(a){var b=bl.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function bC(a,b){return a.getElementsByTagName(b)[0]||a.appendChild(a.ownerDocument.createElement(b))}function bD(a,b){if(b.nodeType!==1||!p.hasData(a))return;var c,d,e,f=p._data(a),g=p._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;d<e;d++)p.event.add(b,c,h[c][d])}g.data&&(g.data=p.extend({},g.data))}function bE(a,b){var c;if(b.nodeType!==1)return;b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase(),c==="object"?(b.parentNode&&(b.outerHTML=a.outerHTML),p.support.html5Clone&&a.innerHTML&&!p.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):c==="input"&&bv.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):c==="option"?b.selected=a.defaultSelected:c==="input"||c==="textarea"?b.defaultValue=a.defaultValue:c==="script"&&b.text!==a.text&&(b.text=a.text),b.removeAttribute(p.expando)}function bF(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bG(a){bv.test(a.type)&&(a.defaultChecked=a.checked)}function bY(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=bW.length;while(e--){b=bW[e]+c;if(b in a)return b}return d}function bZ(a,b){return a=b||a,p.css(a,"display")==="none"||!p.contains(a.ownerDocument,a)}function b$(a,b){var c,d,e=[],f=0,g=a.length;for(;f<g;f++){c=a[f];if(!c.style)continue;e[f]=p._data(c,"olddisplay"),b?(!e[f]&&c.style.display==="none"&&(c.style.display=""),c.style.display===""&&bZ(c)&&(e[f]=p._data(c,"olddisplay",cc(c.nodeName)))):(d=bH(c,"display"),!e[f]&&d!=="none"&&p._data(c,"olddisplay",d))}for(f=0;f<g;f++){c=a[f];if(!c.style)continue;if(!b||c.style.display==="none"||c.style.display==="")c.style.display=b?e[f]||"":"none"}return a}function b_(a,b,c){var d=bP.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function ca(a,b,c,d){var e=c===(d?"border":"content")?4:b==="width"?1:0,f=0;for(;e<4;e+=2)c==="margin"&&(f+=p.css(a,c+bV[e],!0)),d?(c==="content"&&(f-=parseFloat(bH(a,"padding"+bV[e]))||0),c!=="margin"&&(f-=parseFloat(bH(a,"border"+bV[e]+"Width"))||0)):(f+=parseFloat(bH(a,"padding"+bV[e]))||0,c!=="padding"&&(f+=parseFloat(bH(a,"border"+bV[e]+"Width"))||0));return f}function cb(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=!0,f=p.support.boxSizing&&p.css(a,"boxSizing")==="border-box";if(d<=0||d==null){d=bH(a,b);if(d<0||d==null)d=a.style[b];if(bQ.test(d))return d;e=f&&(p.support.boxSizingReliable||d===a.style[b]),d=parseFloat(d)||0}return d+ca(a,b,c||(f?"border":"content"),e)+"px"}function cc(a){if(bS[a])return bS[a];var b=p("<"+a+">").appendTo(e.body),c=b.css("display");b.remove();if(c==="none"||c===""){bI=e.body.appendChild(bI||p.extend(e.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!bJ||!bI.createElement)bJ=(bI.contentWindow||bI.contentDocument).document,bJ.write("<!doctype html><html><body>"),bJ.close();b=bJ.body.appendChild(bJ.createElement(a)),c=bH(b,"display"),e.body.removeChild(bI)}return bS[a]=c,c}function ci(a,b,c,d){var e;if(p.isArray(b))p.each(b,function(b,e){c||ce.test(a)?d(a,e):ci(a+"["+(typeof e=="object"?b:"")+"]",e,c,d)});else if(!c&&p.type(b)==="object")for(e in b)ci(a+"["+e+"]",b[e],c,d);else d(a,b)}function cz(a){return function(b,c){typeof b!="string"&&(c=b,b="*");var d,e,f,g=b.toLowerCase().split(s),h=0,i=g.length;if(p.isFunction(c))for(;h<i;h++)d=g[h],f=/^\+/.test(d),f&&(d=d.substr(1)||"*"),e=a[d]=a[d]||[],e[f?"unshift":"push"](c)}}function cA(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h,i=a[f],j=0,k=i?i.length:0,l=a===cv;for(;j<k&&(l||!h);j++)h=i[j](c,d,e),typeof h=="string"&&(!l||g[h]?h=b:(c.dataTypes.unshift(h),h=cA(a,c,d,e,h,g)));return(l||!h)&&!g["*"]&&(h=cA(a,c,d,e,"*",g)),h}function cB(a,c){var d,e,f=p.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((f[d]?a:e||(e={}))[d]=c[d]);e&&p.extend(!0,a,e)}function cC(a,c,d){var e,f,g,h,i=a.contents,j=a.dataTypes,k=a.responseFields;for(f in k)f in d&&(c[k[f]]=d[f]);while(j[0]==="*")j.shift(),e===b&&(e=a.mimeType||c.getResponseHeader("content-type"));if(e)for(f in i)if(i[f]&&i[f].test(e)){j.unshift(f);break}if(j[0]in d)g=j[0];else{for(f in d){if(!j[0]||a.converters[f+" "+j[0]]){g=f;break}h||(h=f)}g=g||h}if(g)return g!==j[0]&&j.unshift(g),d[g]}function cD(a,b){var c,d,e,f,g=a.dataTypes.slice(),h=g[0],i={},j=0;a.dataFilter&&(b=a.dataFilter(b,a.dataType));if(g[1])for(c in a.converters)i[c.toLowerCase()]=a.converters[c];for(;e=g[++j];)if(e!=="*"){if(h!=="*"&&h!==e){c=i[h+" "+e]||i["* "+e];if(!c)for(d in i){f=d.split(" ");if(f[1]===e){c=i[h+" "+f[0]]||i["* "+f[0]];if(c){c===!0?c=i[d]:i[d]!==!0&&(e=f[0],g.splice(j--,0,e));break}}}if(c!==!0)if(c&&a["throws"])b=c(b);else try{b=c(b)}catch(k){return{state:"parsererror",error:c?k:"No conversion from "+h+" to "+e}}}h=e}return{state:"success",data:b}}function cL(){try{return new a.XMLHttpRequest}catch(b){}}function cM(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function cU(){return setTimeout(function(){cN=b},0),cN=p.now()}function cV(a,b){p.each(b,function(b,c){var d=(cT[b]||[]).concat(cT["*"]),e=0,f=d.length;for(;e<f;e++)if(d[e].call(a,b,c))return})}function cW(a,b,c){var d,e=0,f=0,g=cS.length,h=p.Deferred().always(function(){delete i.elem}),i=function(){var b=cN||cU(),c=Math.max(0,j.startTime+j.duration-b),d=1-(c/j.duration||0),e=0,f=j.tweens.length;for(;e<f;e++)j.tweens[e].run(d);return h.notifyWith(a,[j,d,c]),d<1&&f?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:p.extend({},b),opts:p.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:cN||cU(),duration:c.duration,tweens:[],createTween:function(b,c,d){var e=p.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(e),e},stop:function(b){var c=0,d=b?j.tweens.length:0;for(;c<d;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;cX(k,j.opts.specialEasing);for(;e<g;e++){d=cS[e].call(j,a,k,j.opts);if(d)return d}return cV(j,k),p.isFunction(j.opts.start)&&j.opts.start.call(a,j),p.fx.timer(p.extend(i,{anim:j,queue:j.opts.queue,elem:a})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function cX(a,b){var c,d,e,f,g;for(c in a){d=p.camelCase(c),e=b[d],f=a[c],p.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=p.cssHooks[d];if(g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}}function cY(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=a.style,n={},o=[],q=a.nodeType&&bZ(a);c.queue||(j=p._queueHooks(a,"fx"),j.unqueued==null&&(j.unqueued=0,k=j.empty.fire,j.empty.fire=function(){j.unqueued||k()}),j.unqueued++,l.always(function(){l.always(function(){j.unqueued--,p.queue(a,"fx").length||j.empty.fire()})})),a.nodeType===1&&("height"in b||"width"in b)&&(c.overflow=[m.overflow,m.overflowX,m.overflowY],p.css(a,"display")==="inline"&&p.css(a,"float")==="none"&&(!p.support.inlineBlockNeedsLayout||cc(a.nodeName)==="inline"?m.display="inline-block":m.zoom=1)),c.overflow&&(m.overflow="hidden",p.support.shrinkWrapBlocks||l.done(function(){m.overflow=c.overflow[0],m.overflowX=c.overflow[1],m.overflowY=c.overflow[2]}));for(d in b){f=b[d];if(cP.exec(f)){delete b[d];if(f===(q?"hide":"show"))continue;o.push(d)}}g=o.length;if(g){h=p._data(a,"fxshow")||p._data(a,"fxshow",{}),q?p(a).show():l.done(function(){p(a).hide()}),l.done(function(){var b;p.removeData(a,"fxshow",!0);for(b in n)p.style(a,b,n[b])});for(d=0;d<g;d++)e=o[d],i=l.createTween(e,q?h[e]:0),n[e]=h[e]||p.style(a,e),e in h||(h[e]=i.start,q&&(i.end=i.start,i.start=e==="width"||e==="height"?1:0))}}function cZ(a,b,c,d,e){return new cZ.prototype.init(a,b,c,d,e)}function c$(a,b){var c,d={height:a},e=0;b=b?1:0;for(;e<4;e+=2-b)c=bV[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function da(a){return p.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}var c,d,e=a.document,f=a.location,g=a.navigator,h=a.jQuery,i=a.$,j=Array.prototype.push,k=Array.prototype.slice,l=Array.prototype.indexOf,m=Object.prototype.toString,n=Object.prototype.hasOwnProperty,o=String.prototype.trim,p=function(a,b){return new p.fn.init(a,b,c)},q=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,r=/\S/,s=/\s+/,t=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,u=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,y=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,z=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,A=/^-ms-/,B=/-([\da-z])/gi,C=function(a,b){return(b+"").toUpperCase()},D=function(){e.addEventListener?(e.removeEventListener("DOMContentLoaded",D,!1),p.ready()):e.readyState==="complete"&&(e.detachEvent("onreadystatechange",D),p.ready())},E={};p.fn=p.prototype={constructor:p,init:function(a,c,d){var f,g,h,i;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if(typeof a=="string"){a.charAt(0)==="<"&&a.charAt(a.length-1)===">"&&a.length>=3?f=[null,a,null]:f=u.exec(a);if(f&&(f[1]||!c)){if(f[1])return c=c instanceof p?c[0]:c,i=c&&c.nodeType?c.ownerDocument||c:e,a=p.parseHTML(f[1],i,!0),v.test(f[1])&&p.isPlainObject(c)&&this.attr.call(a,c,!0),p.merge(this,a);g=e.getElementById(f[2]);if(g&&g.parentNode){if(g.id!==f[2])return d.find(a);this.length=1,this[0]=g}return this.context=e,this.selector=a,this}return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a)}return p.isFunction(a)?d.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),p.makeArray(a,this))},selector:"",jquery:"1.8.2",length:0,size:function(){return this.length},toArray:function(){return k.call(this)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=p.merge(this.constructor(),a);return d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")"),d},each:function(a,b){return p.each(this,a,b)},ready:function(a){return p.ready.promise().done(a),this},eq:function(a){return a=+a,a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(k.apply(this,arguments),"slice",k.call(arguments).join(","))},map:function(a){return this.pushStack(p.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:j,sort:[].sort,splice:[].splice},p.fn.init.prototype=p.fn,p.extend=p.fn.extend=function(){var a,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;typeof h=="boolean"&&(k=h,h=arguments[1]||{},i=2),typeof h!="object"&&!p.isFunction(h)&&(h={}),j===i&&(h=this,--i);for(;i<j;i++)if((a=arguments[i])!=null)for(c in a){d=h[c],e=a[c];if(h===e)continue;k&&e&&(p.isPlainObject(e)||(f=p.isArray(e)))?(f?(f=!1,g=d&&p.isArray(d)?d:[]):g=d&&p.isPlainObject(d)?d:{},h[c]=p.extend(k,g,e)):e!==b&&(h[c]=e)}return h},p.extend({noConflict:function(b){return a.$===p&&(a.$=i),b&&a.jQuery===p&&(a.jQuery=h),p},isReady:!1,readyWait:1,holdReady:function(a){a?p.readyWait++:p.ready(!0)},ready:function(a){if(a===!0?--p.readyWait:p.isReady)return;if(!e.body)return setTimeout(p.ready,1);p.isReady=!0;if(a!==!0&&--p.readyWait>0)return;d.resolveWith(e,[p]),p.fn.trigger&&p(e).trigger("ready").off("ready")},isFunction:function(a){return p.type(a)==="function"},isArray:Array.isArray||function(a){return p.type(a)==="array"},isWindow:function(a){return a!=null&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):E[m.call(a)]||"object"},isPlainObject:function(a){if(!a||p.type(a)!=="object"||a.nodeType||p.isWindow(a))return!1;try{if(a.constructor&&!n.call(a,"constructor")&&!n.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||n.call(a,d)},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},error:function(a){throw new Error(a)},parseHTML:function(a,b,c){var d;return!a||typeof a!="string"?null:(typeof b=="boolean"&&(c=b,b=0),b=b||e,(d=v.exec(a))?[b.createElement(d[1])]:(d=p.buildFragment([a],b,c?null:[]),p.merge([],(d.cacheable?p.clone(d.fragment):d.fragment).childNodes)))},parseJSON:function(b){if(!b||typeof b!="string")return null;b=p.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(w.test(b.replace(y,"@").replace(z,"]").replace(x,"")))return(new Function("return "+b))();p.error("Invalid JSON: "+b)},parseXML:function(c){var d,e;if(!c||typeof c!="string")return null;try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}return(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&p.error("Invalid XML: "+c),d},noop:function(){},globalEval:function(b){b&&r.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(A,"ms-").replace(B,C)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,c,d){var e,f=0,g=a.length,h=g===b||p.isFunction(a);if(d){if(h){for(e in a)if(c.apply(a[e],d)===!1)break}else for(;f<g;)if(c.apply(a[f++],d)===!1)break}else if(h){for(e in a)if(c.call(a[e],e,a[e])===!1)break}else for(;f<g;)if(c.call(a[f],f,a[f++])===!1)break;return a},trim:o&&!o.call("﻿ ")?function(a){return a==null?"":o.call(a)}:function(a){return a==null?"":(a+"").replace(t,"")},makeArray:function(a,b){var c,d=b||[];return a!=null&&(c=p.type(a),a.length==null||c==="string"||c==="function"||c==="regexp"||p.isWindow(a)?j.call(d,a):p.merge(d,a)),d},inArray:function(a,b,c){var d;if(b){if(l)return l.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=c.length,e=a.length,f=0;if(typeof d=="number")for(;f<d;f++)a[e++]=c[f];else while(c[f]!==b)a[e++]=c[f++];return a.length=e,a},grep:function(a,b,c){var d,e=[],f=0,g=a.length;c=!!c;for(;f<g;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,c,d){var e,f,g=[],h=0,i=a.length,j=a instanceof p||i!==b&&typeof i=="number"&&(i>0&&a[0]&&a[i-1]||i===0||p.isArray(a));if(j)for(;h<i;h++)e=c(a[h],h,d),e!=null&&(g[g.length]=e);else for(f in a)e=c(a[f],f,d),e!=null&&(g[g.length]=e);return g.concat.apply([],g)},guid:1,proxy:function(a,c){var d,e,f;return typeof c=="string"&&(d=a[c],c=a,a=d),p.isFunction(a)?(e=k.call(arguments,2),f=function(){return a.apply(c,e.concat(k.call(arguments)))},f.guid=a.guid=a.guid||p.guid++,f):b},access:function(a,c,d,e,f,g,h){var i,j=d==null,k=0,l=a.length;if(d&&typeof d=="object"){for(k in d)p.access(a,c,k,d[k],1,g,e);f=1}else if(e!==b){i=h===b&&p.isFunction(e),j&&(i?(i=c,c=function(a,b,c){return i.call(p(a),c)}):(c.call(a,e),c=null));if(c)for(;k<l;k++)c(a[k],d,i?e.call(a[k],k,c(a[k],d)):e,h);f=1}return f?a:j?c.call(a):l?c(a[0],d):g},now:function(){return(new Date).getTime()}}),p.ready.promise=function(b){if(!d){d=p.Deferred();if(e.readyState==="complete")setTimeout(p.ready,1);else if(e.addEventListener)e.addEventListener("DOMContentLoaded",D,!1),a.addEventListener("load",p.ready,!1);else{e.attachEvent("onreadystatechange",D),a.attachEvent("onload",p.ready);var c=!1;try{c=a.frameElement==null&&e.documentElement}catch(f){}c&&c.doScroll&&function g(){if(!p.isReady){try{c.doScroll("left")}catch(a){return setTimeout(g,50)}p.ready()}}()}}return d.promise(b)},p.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){E["[object "+b+"]"]=b.toLowerCase()}),c=p(e);var F={};p.Callbacks=function(a){a=typeof a=="string"?F[a]||G(a):p.extend({},a);var c,d,e,f,g,h,i=[],j=!a.once&&[],k=function(b){c=a.memory&&b,d=!0,h=f||0,f=0,g=i.length,e=!0;for(;i&&h<g;h++)if(i[h].apply(b[0],b[1])===!1&&a.stopOnFalse){c=!1;break}e=!1,i&&(j?j.length&&k(j.shift()):c?i=[]:l.disable())},l={add:function(){if(i){var b=i.length;(function d(b){p.each(b,function(b,c){var e=p.type(c);e==="function"&&(!a.unique||!l.has(c))?i.push(c):c&&c.length&&e!=="string"&&d(c)})})(arguments),e?g=i.length:c&&(f=b,k(c))}return this},remove:function(){return i&&p.each(arguments,function(a,b){var c;while((c=p.inArray(b,i,c))>-1)i.splice(c,1),e&&(c<=g&&g--,c<=h&&h--)}),this},has:function(a){return p.inArray(a,i)>-1},empty:function(){return i=[],this},disable:function(){return i=j=c=b,this},disabled:function(){return!i},lock:function(){return j=b,c||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return b=b||[],b=[a,b.slice?b.slice():b],i&&(!d||j)&&(e?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!d}};return l},p.extend({Deferred:function(a){var b=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return p.Deferred(function(c){p.each(b,function(b,d){var f=d[0],g=a[b];e[d[1]](p.isFunction(g)?function(){var a=g.apply(this,arguments);a&&p.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f+"With"](this===e?c:this,[a])}:c[f])}),a=null}).promise()},promise:function(a){return a!=null?p.extend(a,d):d}},e={};return d.pipe=d.then,p.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[a^1][2].disable,b[2][2].lock),e[f[0]]=g.fire,e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=k.call(arguments),d=c.length,e=d!==1||a&&p.isFunction(a.promise)?d:0,f=e===1?a:p.Deferred(),g=function(a,b,c){return function(d){b[a]=this,c[a]=arguments.length>1?k.call(arguments):d,c===h?f.notifyWith(b,c):--e||f.resolveWith(b,c)}},h,i,j;if(d>1){h=new Array(d),i=new Array(d),j=new Array(d);for(;b<d;b++)c[b]&&p.isFunction(c[b].promise)?c[b].promise().done(g(b,j,c)).fail(f.reject).progress(g(b,i,h)):--e}return e||f.resolveWith(j,c),f.promise()}}),p.support=function(){var b,c,d,f,g,h,i,j,k,l,m,n=e.createElement("div");n.setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",c=n.getElementsByTagName("*"),d=n.getElementsByTagName("a")[0],d.style.cssText="top:1px;float:left;opacity:.5";if(!c||!c.length)return{};f=e.createElement("select"),g=f.appendChild(e.createElement("option")),h=n.getElementsByTagName("input")[0],b={leadingWhitespace:n.firstChild.nodeType===3,tbody:!n.getElementsByTagName("tbody").length,htmlSerialize:!!n.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:d.getAttribute("href")==="/a",opacity:/^0.5/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:h.value==="on",optSelected:g.selected,getSetAttribute:n.className!=="t",enctype:!!e.createElement("form").enctype,html5Clone:e.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:e.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},h.checked=!0,b.noCloneChecked=h.cloneNode(!0).checked,f.disabled=!0,b.optDisabled=!g.disabled;try{delete n.test}catch(o){b.deleteExpando=!1}!n.addEventListener&&n.attachEvent&&n.fireEvent&&(n.attachEvent("onclick",m=function(){b.noCloneEvent=!1}),n.cloneNode(!0).fireEvent("onclick"),n.detachEvent("onclick",m)),h=e.createElement("input"),h.value="t",h.setAttribute("type","radio"),b.radioValue=h.value==="t",h.setAttribute("checked","checked"),h.setAttribute("name","t"),n.appendChild(h),i=e.createDocumentFragment(),i.appendChild(n.lastChild),b.checkClone=i.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=h.checked,i.removeChild(h),i.appendChild(n);if(n.attachEvent)for(k in{submit:!0,change:!0,focusin:!0})j="on"+k,l=j in n,l||(n.setAttribute(j,"return;"),l=typeof n[j]=="function"),b[k+"Bubbles"]=l;return p(function(){var c,d,f,g,h="padding:0;margin:0;border:0;display:block;overflow:hidden;",i=e.getElementsByTagName("body")[0];if(!i)return;c=e.createElement("div"),c.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",i.insertBefore(c,i.firstChild),d=e.createElement("div"),c.appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",f=d.getElementsByTagName("td"),f[0].style.cssText="padding:0;margin:0;border:0;display:none",l=f[0].offsetHeight===0,f[0].style.display="",f[1].style.display="none",b.reliableHiddenOffsets=l&&f[0].offsetHeight===0,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",b.boxSizing=d.offsetWidth===4,b.doesNotIncludeMarginInBodyOffset=i.offsetTop!==1,a.getComputedStyle&&(b.pixelPosition=(a.getComputedStyle(d,null)||{}).top!=="1%",b.boxSizingReliable=(a.getComputedStyle(d,null)||{width:"4px"}).width==="4px",g=e.createElement("div"),g.style.cssText=d.style.cssText=h,g.style.marginRight=g.style.width="0",d.style.width="1px",d.appendChild(g),b.reliableMarginRight=!parseFloat((a.getComputedStyle(g,null)||{}).marginRight)),typeof d.style.zoom!="undefined"&&(d.innerHTML="",d.style.cssText=h+"width:1px;padding:1px;display:inline;zoom:1",b.inlineBlockNeedsLayout=d.offsetWidth===3,d.style.display="block",d.style.overflow="visible",d.innerHTML="<div></div>",d.firstChild.style.width="5px",b.shrinkWrapBlocks=d.offsetWidth!==3,c.style.zoom=1),i.removeChild(c),c=d=f=g=null}),i.removeChild(n),c=d=f=g=h=i=n=null,b}();var H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,I=/([A-Z])/g;p.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(p.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?p.cache[a[p.expando]]:a[p.expando],!!a&&!K(a)},data:function(a,c,d,e){if(!p.acceptData(a))return;var f,g,h=p.expando,i=typeof c=="string",j=a.nodeType,k=j?p.cache:a,l=j?a[h]:a[h]&&h;if((!l||!k[l]||!e&&!k[l].data)&&i&&d===b)return;l||(j?a[h]=l=p.deletedIds.pop()||p.guid++:l=h),k[l]||(k[l]={},j||(k[l].toJSON=p.noop));if(typeof c=="object"||typeof c=="function")e?k[l]=p.extend(k[l],c):k[l].data=p.extend(k[l].data,c);return f=k[l],e||(f.data||(f.data={}),f=f.data),d!==b&&(f[p.camelCase(c)]=d),i?(g=f[c],g==null&&(g=f[p.camelCase(c)])):g=f,g},removeData:function(a,b,c){if(!p.acceptData(a))return;var d,e,f,g=a.nodeType,h=g?p.cache:a,i=g?a[p.expando]:p.expando;if(!h[i])return;if(b){d=c?h[i]:h[i].data;if(d){p.isArray(b)||(b in d?b=[b]:(b=p.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,f=b.length;e<f;e++)delete d[b[e]];if(!(c?K:p.isEmptyObject)(d))return}}if(!c){delete h[i].data;if(!K(h[i]))return}g?p.cleanData([a],!0):p.support.deleteExpando||h!=h.window?delete h[i]:h[i]=null},_data:function(a,b,c){return p.data(a,b,c,!0)},acceptData:function(a){var b=a.nodeName&&p.noData[a.nodeName.toLowerCase()];return!b||b!==!0&&a.getAttribute("classid")===b}}),p.fn.extend({data:function(a,c){var d,e,f,g,h,i=this[0],j=0,k=null;if(a===b){if(this.length){k=p.data(i);if(i.nodeType===1&&!p._data(i,"parsedAttrs")){f=i.attributes;for(h=f.length;j<h;j++)g=f[j].name,g.indexOf("data-")||(g=p.camelCase(g.substring(5)),J(i,g,k[g]));p._data(i,"parsedAttrs",!0)}}return k}return typeof a=="object"?this.each(function(){p.data(this,a)}):(d=a.split(".",2),d[1]=d[1]?"."+d[1]:"",e=d[1]+"!",p.access(this,function(c){if(c===b)return k=this.triggerHandler("getData"+e,[d[0]]),k===b&&i&&(k=p.data(i,a),k=J(i,a,k)),k===b&&d[1]?this.data(d[0]):k;d[1]=c,this.each(function(){var b=p(this);b.triggerHandler("setData"+e,d),p.data(this,a,c),b.triggerHandler("changeData"+e,d)})},null,c,arguments.length>1,null,!1))},removeData:function(a){return this.each(function(){p.removeData(this,a)})}}),p.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=p._data(a,b),c&&(!d||p.isArray(c)?d=p._data(a,b,p.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=p.queue(a,b),d=c.length,e=c.shift(),f=p._queueHooks(a,b),g=function(){p.dequeue(a,b)};e==="inprogress"&&(e=c.shift(),d--),e&&(b==="fx"&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return p._data(a,c)||p._data(a,c,{empty:p.Callbacks("once memory").add(function(){p.removeData(a,b+"queue",!0),p.removeData(a,c,!0)})})}}),p.fn.extend({queue:function(a,c){var d=2;return typeof a!="string"&&(c=a,a="fx",d--),arguments.length<d?p.queue(this[0],a):c===b?this:this.each(function(){var b=p.queue(this,a,c);p._queueHooks(this,a),a==="fx"&&b[0]!=="inprogress"&&p.dequeue(this,a)})},dequeue:function(a){return this.each(function(){p.dequeue(this,a)})},delay:function(a,b){return a=p.fx?p.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=p.Deferred(),g=this,h=this.length,i=function(){--e||f.resolveWith(g,[g])};typeof a!="string"&&(c=a,a=b),a=a||"fx";while(h--)d=p._data(g[h],a+"queueHooks"),d&&d.empty&&(e++,d.empty.add(i));return i(),f.promise(c)}});var L,M,N,O=/[\t\r\n]/g,P=/\r/g,Q=/^(?:button|input)$/i,R=/^(?:button|input|object|select|textarea)$/i,S=/^a(?:rea|)$/i,T=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,U=p.support.getSetAttribute;p.fn.extend({attr:function(a,b){return p.access(this,p.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){p.removeAttr(this,a)})},prop:function(a,b){return p.access(this,p.prop,a,b,arguments.length>1)},removeProp:function(a){return a=p.propFix[a]||a,this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,g,h;if(p.isFunction(a))return this.each(function(b){p(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(s);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{f=" "+e.className+" ";for(g=0,h=b.length;g<h;g++)f.indexOf(" "+b[g]+" ")<0&&(f+=b[g]+" ");e.className=p.trim(f)}}}return this},removeClass:function(a){var c,d,e,f,g,h,i;if(p.isFunction(a))return this.each(function(b){p(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(s);for(h=0,i=this.length;h<i;h++){e=this[h];if(e.nodeType===1&&e.className){d=(" "+e.className+" ").replace(O," ");for(f=0,g=c.length;f<g;f++)while(d.indexOf(" "+c[f]+" ")>=0)d=d.replace(" "+c[f]+" "," ");e.className=a?p.trim(d):""}}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";return p.isFunction(a)?this.each(function(c){p(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if(c==="string"){var e,f=0,g=p(this),h=b,i=a.split(s);while(e=i[f++])h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&p._data(this,"__className__",this.className),this.className=this.className||a===!1?"":p._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(O," ").indexOf(b)>=0)return!0;return!1},val:function(a){var c,d,e,f=this[0];if(!arguments.length){if(f)return c=p.valHooks[f.type]||p.valHooks[f.nodeName.toLowerCase()],c&&"get"in c&&(d=c.get(f,"value"))!==b?d:(d=f.value,typeof d=="string"?d.replace(P,""):d==null?"":d);return}return e=p.isFunction(a),this.each(function(d){var f,g=p(this);if(this.nodeType!==1)return;e?f=a.call(this,d,g.val()):f=a,f==null?f="":typeof f=="number"?f+="":p.isArray(f)&&(f=p.map(f,function(a){return a==null?"":a+""})),c=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()];if(!c||!("set"in c)||c.set(this,f,"value")===b)this.value=f})}}),p.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,f=a.selectedIndex,g=[],h=a.options,i=a.type==="select-one";if(f<0)return null;c=i?f:0,d=i?f+1:h.length;for(;c<d;c++){e=h[c];if(e.selected&&(p.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!p.nodeName(e.parentNode,"optgroup"))){b=p(e).val();if(i)return b;g.push(b)}}return i&&!g.length&&h.length?p(h[f]).val():g},set:function(a,b){var c=p.makeArray(b);return p(a).find("option").each(function(){this.selected=p.inArray(p(this).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},attrFn:{},attr:function(a,c,d,e){var f,g,h,i=a.nodeType;if(!a||i===3||i===8||i===2)return;if(e&&p.isFunction(p.fn[c]))return p(a)[c](d);if(typeof a.getAttribute=="undefined")return p.prop(a,c,d);h=i!==1||!p.isXMLDoc(a),h&&(c=c.toLowerCase(),g=p.attrHooks[c]||(T.test(c)?M:L));if(d!==b){if(d===null){p.removeAttr(a,c);return}return g&&"set"in g&&h&&(f=g.set(a,d,c))!==b?f:(a.setAttribute(c,d+""),d)}return g&&"get"in g&&h&&(f=g.get(a,c))!==null?f:(f=a.getAttribute(c),f===null?b:f)},removeAttr:function(a,b){var c,d,e,f,g=0;if(b&&a.nodeType===1){d=b.split(s);for(;g<d.length;g++)e=d[g],e&&(c=p.propFix[e]||e,f=T.test(e),f||p.attr(a,e,""),a.removeAttribute(U?e:c),f&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(Q.test(a.nodeName)&&a.parentNode)p.error("type property can't be changed");else if(!p.support.radioValue&&b==="radio"&&p.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}},value:{get:function(a,b){return L&&p.nodeName(a,"button")?L.get(a,b):b in a?a.value:null},set:function(a,b,c){if(L&&p.nodeName(a,"button"))return L.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,f,g,h=a.nodeType;if(!a||h===3||h===8||h===2)return;return g=h!==1||!p.isXMLDoc(a),g&&(c=p.propFix[c]||c,f=p.propHooks[c]),d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&(e=f.get(a,c))!==null?e:a[c]},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):R.test(a.nodeName)||S.test(a.nodeName)&&a.href?0:b}}}}),M={get:function(a,c){var d,e=p.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;return b===!1?p.removeAttr(a,c):(d=p.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase())),c}},U||(N={name:!0,id:!0,coords:!0},L=p.valHooks.button={get:function(a,c){var d;return d=a.getAttributeNode(c),d&&(N[c]?d.value!=="":d.specified)?d.value:b},set:function(a,b,c){var d=a.getAttributeNode(c);return d||(d=e.createAttribute(c),a.setAttributeNode(d)),d.value=b+""}},p.each(["width","height"],function(a,b){p.attrHooks[b]=p.extend(p.attrHooks[b],{set:function(a,c){if(c==="")return a.setAttribute(b,"auto"),c}})}),p.attrHooks.contenteditable={get:L.get,set:function(a,b,c){b===""&&(b="false"),L.set(a,b,c)}}),p.support.hrefNormalized||p.each(["href","src","width","height"],function(a,c){p.attrHooks[c]=p.extend(p.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),p.support.style||(p.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=b+""}}),p.support.optSelected||(p.propHooks.selected=p.extend(p.propHooks.selected,{get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}})),p.support.enctype||(p.propFix.enctype="encoding"),p.support.checkOn||p.each(["radio","checkbox"],function(){p.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),p.each(["radio","checkbox"],function(){p.valHooks[this]=p.extend(p.valHooks[this],{set:function(a,b){if(p.isArray(b))return a.checked=p.inArray(p(a).val(),b)>=0}})});var V=/^(?:textarea|input|select)$/i,W=/^([^\.]*|)(?:\.(.+)|)$/,X=/(?:^|\s)hover(\.\S+|)\b/,Y=/^key/,Z=/^(?:mouse|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,_=function(a){return p.event.special.hover?a:a.replace(X,"mouseenter$1 mouseleave$1")};p.event={add:function(a,c,d,e,f){var g,h,i,j,k,l,m,n,o,q,r;if(a.nodeType===3||a.nodeType===8||!c||!d||!(g=p._data(a)))return;d.handler&&(o=d,d=o.handler,f=o.selector),d.guid||(d.guid=p.guid++),i=g.events,i||(g.events=i={}),h=g.handle,h||(g.handle=h=function(a){return typeof p!="undefined"&&(!a||p.event.triggered!==a.type)?p.event.dispatch.apply(h.elem,arguments):b},h.elem=a),c=p.trim(_(c)).split(" ");for(j=0;j<c.length;j++){k=W.exec(c[j])||[],l=k[1],m=(k[2]||"").split(".").sort(),r=p.event.special[l]||{},l=(f?r.delegateType:r.bindType)||l,r=p.event.special[l]||{},n=p.extend({type:l,origType:k[1],data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&p.expr.match.needsContext.test(f),namespace:m.join(".")},o),q=i[l];if(!q){q=i[l]=[],q.delegateCount=0;if(!r.setup||r.setup.call(a,e,m,h)===!1)a.addEventListener?a.addEventListener(l,h,!1):a.attachEvent&&a.attachEvent("on"+l,h)}r.add&&(r.add.call(a,n),n.handler.guid||(n.handler.guid=d.guid)),f?q.splice(q.delegateCount++,0,n):q.push(n),p.event.global[l]=!0}a=null},global:{},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,q,r=p.hasData(a)&&p._data(a);if(!r||!(m=r.events))return;b=p.trim(_(b||"")).split(" ");for(f=0;f<b.length;f++){g=W.exec(b[f])||[],h=i=g[1],j=g[2];if(!h){for(h in m)p.event.remove(a,h+b[f],c,d,!0);continue}n=p.event.special[h]||{},h=(d?n.delegateType:n.bindType)||h,o=m[h]||[],k=o.length,j=j?new RegExp("(^|\\.)"+j.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(l=0;l<o.length;l++)q=o[l],(e||i===q.origType)&&(!c||c.guid===q.guid)&&(!j||j.test(q.namespace))&&(!d||d===q.selector||d==="**"&&q.selector)&&(o.splice(l--,1),q.selector&&o.delegateCount--,n.remove&&n.remove.call(a,q));o.length===0&&k!==o.length&&((!n.teardown||n.teardown.call(a,j,r.handle)===!1)&&p.removeEvent(a,h,r.handle),delete m[h])}p.isEmptyObject(m)&&(delete r.handle,p.removeData(a,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,f,g){if(!f||f.nodeType!==3&&f.nodeType!==8){var h,i,j,k,l,m,n,o,q,r,s=c.type||c,t=[];if($.test(s+p.event.triggered))return;s.indexOf("!")>=0&&(s=s.slice(0,-1),i=!0),s.indexOf(".")>=0&&(t=s.split("."),s=t.shift(),t.sort());if((!f||p.event.customEvent[s])&&!p.event.global[s])return;c=typeof c=="object"?c[p.expando]?c:new p.Event(s,c):new p.Event(s),c.type=s,c.isTrigger=!0,c.exclusive=i,c.namespace=t.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+t.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,m=s.indexOf(":")<0?"on"+s:"";if(!f){h=p.cache;for(j in h)h[j].events&&h[j].events[s]&&p.event.trigger(c,d,h[j].handle.elem,!0);return}c.result=b,c.target||(c.target=f),d=d!=null?p.makeArray(d):[],d.unshift(c),n=p.event.special[s]||{};if(n.trigger&&n.trigger.apply(f,d)===!1)return;q=[[f,n.bindType||s]];if(!g&&!n.noBubble&&!p.isWindow(f)){r=n.delegateType||s,k=$.test(r+s)?f:f.parentNode;for(l=f;k;k=k.parentNode)q.push([k,r]),l=k;l===(f.ownerDocument||e)&&q.push([l.defaultView||l.parentWindow||a,r])}for(j=0;j<q.length&&!c.isPropagationStopped();j++)k=q[j][0],c.type=q[j][1],o=(p._data(k,"events")||{})[c.type]&&p._data(k,"handle"),o&&o.apply(k,d),o=m&&k[m],o&&p.acceptData(k)&&o.apply&&o.apply(k,d)===!1&&c.preventDefault();return c.type=s,!g&&!c.isDefaultPrevented()&&(!n._default||n._default.apply(f.ownerDocument,d)===!1)&&(s!=="click"||!p.nodeName(f,"a"))&&p.acceptData(f)&&m&&f[s]&&(s!=="focus"&&s!=="blur"||c.target.offsetWidth!==0)&&!p.isWindow(f)&&(l=f[m],l&&(f[m]=null),p.event.triggered=s,f[s](),p.event.triggered=b,l&&(f[m]=l)),c.result}return},dispatch:function(c){c=p.event.fix(c||a.event);var d,e,f,g,h,i,j,l,m,n,o=(p._data(this,"events")||{})[c.type]||[],q=o.delegateCount,r=k.call(arguments),s=!c.exclusive&&!c.namespace,t=p.event.special[c.type]||{},u=[];r[0]=c,c.delegateTarget=this;if(t.preDispatch&&t.preDispatch.call(this,c)===!1)return;if(q&&(!c.button||c.type!=="click"))for(f=c.target;f!=this;f=f.parentNode||this)if(f.disabled!==!0||c.type!=="click"){h={},j=[];for(d=0;d<q;d++)l=o[d],m=l.selector,h[m]===b&&(h[m]=l.needsContext?p(m,this).index(f)>=0:p.find(m,this,null,[f]).length),h[m]&&j.push(l);j.length&&u.push({elem:f,matches:j})}o.length>q&&u.push({elem:this,matches:o.slice(q)});for(d=0;d<u.length&&!c.isPropagationStopped();d++){i=u[d],c.currentTarget=i.elem;for(e=0;e<i.matches.length&&!c.isImmediatePropagationStopped();e++){l=i.matches[e];if(s||!c.namespace&&!l.namespace||c.namespace_re&&c.namespace_re.test(l.namespace))c.data=l.data,c.handleObj=l,g=((p.event.special[l.origType]||{}).handle||l.handler).apply(i.elem,r),g!==b&&(c.result=g,g===!1&&(c.preventDefault(),c.stopPropagation()))}}return t.postDispatch&&t.postDispatch.call(this,c),c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,f,g,h=c.button,i=c.fromElement;return a.pageX==null&&c.clientX!=null&&(d=a.target.ownerDocument||e,f=d.documentElement,g=d.body,a.pageX=c.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=c.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?c.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0),a}},fix:function(a){if(a[p.expando])return a;var b,c,d=a,f=p.event.fixHooks[a.type]||{},g=f.props?this.props.concat(f.props):this.props;a=p.Event(d);for(b=g.length;b;)c=g[--b],a[c]=d[c];return a.target||(a.target=d.srcElement||e),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,f.filter?f.filter(a,d):a},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){p.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=p.extend(new p.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?p.event.trigger(e,null,b):p.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},p.event.handle=p.event.dispatch,p.removeEvent=e.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]=="undefined"&&(a[d]=null),a.detachEvent(d,c))},p.Event=function(a,b){if(this instanceof p.Event)a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?bb:ba):this.type=a,b&&p.extend(this,b),this.timeStamp=a&&a.timeStamp||p.now(),this[p.expando]=!0;else return new p.Event(a,b)},p.Event.prototype={preventDefault:function(){this.isDefaultPrevented=bb;var a=this.originalEvent;if(!a)return;a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=bb;var a=this.originalEvent;if(!a)return;a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=bb,this.stopPropagation()},isDefaultPrevented:ba,isPropagationStopped:ba,isImmediatePropagationStopped:ba},p.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){p.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj,g=f.selector;if(!e||e!==d&&!p.contains(d,e))a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b;return c}}}),p.support.submitBubbles||(p.event.special.submit={setup:function(){if(p.nodeName(this,"form"))return!1;p.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=p.nodeName(c,"input")||p.nodeName(c,"button")?c.form:b;d&&!p._data(d,"_submit_attached")&&(p.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),p._data(d,"_submit_attached",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&p.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(p.nodeName(this,"form"))return!1;p.event.remove(this,"._submit")}}),p.support.changeBubbles||(p.event.special.change={setup:function(){if(V.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")p.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),p.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),p.event.simulate("change",this,a,!0)});return!1}p.event.add(this,"beforeactivate._change",function(a){var b=a.target;V.test(b.nodeName)&&!p._data(b,"_change_attached")&&(p.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&p.event.simulate("change",this.parentNode,a,!0)}),p._data(b,"_change_attached",!0))})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){return p.event.remove(this,"._change"),!V.test(this.nodeName)}}),p.support.focusinBubbles||p.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){p.event.simulate(b,a.target,p.event.fix(a),!0)};p.event.special[b]={setup:function(){c++===0&&e.addEventListener(a,d,!0)},teardown:function(){--c===0&&e.removeEventListener(a,d,!0)}}}),p.fn.extend({on:function(a,c,d,e,f){var g,h;if(typeof a=="object"){typeof c!="string"&&(d=d||c,c=b);for(h in a)this.on(h,c,d,a[h],f);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=ba;else if(!e)return this;return f===1&&(g=e,e=function(a){return p().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=p.guid++)),this.each(function(){p.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var e,f;if(a&&a.preventDefault&&a.handleObj)return e=a.handleObj,p(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if(typeof a=="object"){for(f in a)this.off(f,c,a[f]);return this}if(c===!1||typeof c=="function")d=c,c=b;return d===!1&&(d=ba),this.each(function(){p.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){return p(this.context).on(a,this.selector,b,c),this},die:function(a,b){return p(this.context).off(a,this.selector||"**",b),this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length===1?this.off(a,"**"):this.off(b,a||"**",c)},trigger:function(a,b){return this.each(function(){p.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return p.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||p.guid++,d=0,e=function(c){var e=(p._data(this,"lastToggle"+a.guid)||0)%d;return p._data(this,"lastToggle"+a.guid,e+1),c.preventDefault(),b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){p.fn[b]=function(a,c){return c==null&&(c=a,a=null),arguments.length>0?this.on(b,null,a,c):this.trigger(b)},Y.test(b)&&(p.event.fixHooks[b]=p.event.keyHooks),Z.test(b)&&(p.event.fixHooks[b]=p.event.mouseHooks)}),function(a,b){function bc(a,b,c,d){c=c||[],b=b||r;var e,f,i,j,k=b.nodeType;if(!a||typeof a!="string")return c;if(k!==1&&k!==9)return[];i=g(b);if(!i&&!d)if(e=P.exec(a))if(j=e[1]){if(k===9){f=b.getElementById(j);if(!f||!f.parentNode)return c;if(f.id===j)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(j))&&h(b,f)&&f.id===j)return c.push(f),c}else{if(e[2])return w.apply(c,x.call(b.getElementsByTagName(a),0)),c;if((j=e[3])&&_&&b.getElementsByClassName)return w.apply(c,x.call(b.getElementsByClassName(j),0)),c}return bp(a.replace(L,"$1"),b,c,d,i)}function bd(a){return function(b){var c=b.nodeName.toLowerCase();return c==="input"&&b.type===a}}function be(a){return function(b){var c=b.nodeName.toLowerCase();return(c==="input"||c==="button")&&b.type===a}}function bf(a){return z(function(b){return b=+b,z(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function bg(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}function bh(a,b){var c,d,f,g,h,i,j,k=C[o][a];if(k)return b?0:k.slice(0);h=a,i=[],j=e.preFilter;while(h){if(!c||(d=M.exec(h)))d&&(h=h.slice(d[0].length)),i.push(f=[]);c=!1;if(d=N.exec(h))f.push(c=new q(d.shift())),h=h.slice(c.length),c.type=d[0].replace(L," ");for(g in e.filter)(d=W[g].exec(h))&&(!j[g]||(d=j[g](d,r,!0)))&&(f.push(c=new q(d.shift())),h=h.slice(c.length),c.type=g,c.matches=d);if(!c)break}return b?h.length:h?bc.error(a):C(a,i).slice(0)}function bi(a,b,d){var e=b.dir,f=d&&b.dir==="parentNode",g=u++;return b.first?function(b,c,d){while(b=b[e])if(f||b.nodeType===1)return a(b,c,d)}:function(b,d,h){if(!h){var i,j=t+" "+g+" ",k=j+c;while(b=b[e])if(f||b.nodeType===1){if((i=b[o])===k)return b.sizset;if(typeof i=="string"&&i.indexOf(j)===0){if(b.sizset)return b}else{b[o]=k;if(a(b,d,h))return b.sizset=!0,b;b.sizset=!1}}}else while(b=b[e])if(f||b.nodeType===1)if(a(b,d,h))return b}}function bj(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function bk(a,b,c,d,e){var f,g=[],h=0,i=a.length,j=b!=null;for(;h<i;h++)if(f=a[h])if(!c||c(f,d,e))g.push(f),j&&b.push(h);return g}function bl(a,b,c,d,e,f){return d&&!d[o]&&(d=bl(d)),e&&!e[o]&&(e=bl(e,f)),z(function(f,g,h,i){if(f&&e)return;var j,k,l,m=[],n=[],o=g.length,p=f||bo(b||"*",h.nodeType?[h]:h,[],f),q=a&&(f||!b)?bk(p,m,a,h,i):p,r=c?e||(f?a:o||d)?[]:g:q;c&&c(q,r,h,i);if(d){l=bk(r,n),d(l,[],h,i),j=l.length;while(j--)if(k=l[j])r[n[j]]=!(q[n[j]]=k)}if(f){j=a&&r.length;while(j--)if(k=r[j])f[m[j]]=!(g[m[j]]=k)}else r=bk(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):w.apply(g,r)})}function bm(a){var b,c,d,f=a.length,g=e.relative[a[0].type],h=g||e.relative[" "],i=g?1:0,j=bi(function(a){return a===b},h,!0),k=bi(function(a){return y.call(b,a)>-1},h,!0),m=[function(a,c,d){return!g&&(d||c!==l)||((b=c).nodeType?j(a,c,d):k(a,c,d))}];for(;i<f;i++)if(c=e.relative[a[i].type])m=[bi(bj(m),c)];else{c=e.filter[a[i].type].apply(null,a[i].matches);if(c[o]){d=++i;for(;d<f;d++)if(e.relative[a[d].type])break;return bl(i>1&&bj(m),i>1&&a.slice(0,i-1).join("").replace(L,"$1"),c,i<d&&bm(a.slice(i,d)),d<f&&bm(a=a.slice(d)),d<f&&a.join(""))}m.push(c)}return bj(m)}function bn(a,b){var d=b.length>0,f=a.length>0,g=function(h,i,j,k,m){var n,o,p,q=[],s=0,u="0",x=h&&[],y=m!=null,z=l,A=h||f&&e.find.TAG("*",m&&i.parentNode||i),B=t+=z==null?1:Math.E;y&&(l=i!==r&&i,c=g.el);for(;(n=A[u])!=null;u++){if(f&&n){for(o=0;p=a[o];o++)if(p(n,i,j)){k.push(n);break}y&&(t=B,c=++g.el)}d&&((n=!p&&n)&&s--,h&&x.push(n))}s+=u;if(d&&u!==s){for(o=0;p=b[o];o++)p(x,q,i,j);if(h){if(s>0)while(u--)!x[u]&&!q[u]&&(q[u]=v.call(k));q=bk(q)}w.apply(k,q),y&&!h&&q.length>0&&s+b.length>1&&bc.uniqueSort(k)}return y&&(t=B,l=z),x};return g.el=0,d?z(g):g}function bo(a,b,c,d){var e=0,f=b.length;for(;e<f;e++)bc(a,b[e],c,d);return c}function bp(a,b,c,d,f){var g,h,j,k,l,m=bh(a),n=m.length;if(!d&&m.length===1){h=m[0]=m[0].slice(0);if(h.length>2&&(j=h[0]).type==="ID"&&b.nodeType===9&&!f&&e.relative[h[1].type]){b=e.find.ID(j.matches[0].replace(V,""),b,f)[0];if(!b)return c;a=a.slice(h.shift().length)}for(g=W.POS.test(a)?-1:h.length-1;g>=0;g--){j=h[g];if(e.relative[k=j.type])break;if(l=e.find[k])if(d=l(j.matches[0].replace(V,""),R.test(h[0].type)&&b.parentNode||b,f)){h.splice(g,1),a=d.length&&h.join("");if(!a)return w.apply(c,x.call(d,0)),c;break}}}return i(a,m)(d,b,f,c,R.test(a)),c}function bq(){}var c,d,e,f,g,h,i,j,k,l,m=!0,n="undefined",o=("sizcache"+Math.random()).replace(".",""),q=String,r=a.document,s=r.documentElement,t=0,u=0,v=[].pop,w=[].push,x=[].slice,y=[].indexOf||function(a){var b=0,c=this.length;for(;b<c;b++)if(this[b]===a)return b;return-1},z=function(a,b){return a[o]=b==null||b,a},A=function(){var a={},b=[];return z(function(c,d){return b.push(c)>e.cacheLength&&delete a[b.shift()],a[c]=d},a)},B=A(),C=A(),D=A(),E="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",G=F.replace("w","w#"),H="([*^$|!~]?=)",I="\\["+E+"*("+F+")"+E+"*(?:"+H+E+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+G+")|)|)"+E+"*\\]",J=":("+F+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+I+")|[^:]|\\\\.)*|.*))\\)|)",K=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+E+"*((?:-\\d)?\\d*)"+E+"*\\)|)(?=[^-]|$)",L=new RegExp("^"+E+"+|((?:^|[^\\\\])(?:\\\\.)*)"+E+"+$","g"),M=new RegExp("^"+E+"*,"+E+"*"),N=new RegExp("^"+E+"*([\\x20\\t\\r\\n\\f>+~])"+E+"*"),O=new RegExp(J),P=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,Q=/^:not/,R=/[\x20\t\r\n\f]*[+~]/,S=/:not\($/,T=/h\d/i,U=/input|select|textarea|button/i,V=/\\(?!\\)/g,W={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),NAME:new RegExp("^\\[name=['\"]?("+F+")['\"]?\\]"),TAG:new RegExp("^("+F.replace("w","w*")+")"),ATTR:new RegExp("^"+I),PSEUDO:new RegExp("^"+J),POS:new RegExp(K,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+E+"*(even|odd|(([+-]|)(\\d*)n|)"+E+"*(?:([+-]|)"+E+"*(\\d+)|))"+E+"*\\)|)","i"),needsContext:new RegExp("^"+E+"*[>+~]|"+K,"i")},X=function(a){var b=r.createElement("div");try{return a(b)}catch(c){return!1}finally{b=null}},Y=X(function(a){return a.appendChild(r.createComment("")),!a.getElementsByTagName("*").length}),Z=X(function(a){return a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!==n&&a.firstChild.getAttribute("href")==="#"}),$=X(function(a){a.innerHTML="<select></select>";var b=typeof a.lastChild.getAttribute("multiple");return b!=="boolean"&&b!=="string"}),_=X(function(a){return a.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!a.getElementsByClassName||!a.getElementsByClassName("e").length?!1:(a.lastChild.className="e",a.getElementsByClassName("e").length===2)}),ba=X(function(a){a.id=o+0,a.innerHTML="<a name='"+o+"'></a><div name='"+o+"'></div>",s.insertBefore(a,s.firstChild);var b=r.getElementsByName&&r.getElementsByName(o).length===2+r.getElementsByName(o+0).length;return d=!r.getElementById(o),s.removeChild(a),b});try{x.call(s.childNodes,0)[0].nodeType}catch(bb){x=function(a){var b,c=[];for(;b=this[a];a++)c.push(b);return c}}bc.matches=function(a,b){return bc(a,null,null,b)},bc.matchesSelector=function(a,b){return bc(b,null,null,[a]).length>0},f=bc.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(e===1||e===9||e===11){if(typeof a.textContent=="string")return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=f(a)}else if(e===3||e===4)return a.nodeValue}else for(;b=a[d];d++)c+=f(b);return c},g=bc.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?b.nodeName!=="HTML":!1},h=bc.contains=s.contains?function(a,b){var c=a.nodeType===9?a.documentElement:a,d=b&&b.parentNode;return a===d||!!(d&&d.nodeType===1&&c.contains&&c.contains(d))}:s.compareDocumentPosition?function(a,b){return b&&!!(a.compareDocumentPosition(b)&16)}:function(a,b){while(b=b.parentNode)if(b===a)return!0;return!1},bc.attr=function(a,b){var c,d=g(a);return d||(b=b.toLowerCase()),(c=e.attrHandle[b])?c(a):d||$?a.getAttribute(b):(c=a.getAttributeNode(b),c?typeof a[b]=="boolean"?a[b]?b:null:c.specified?c.value:null:null)},e=bc.selectors={cacheLength:50,createPseudo:z,match:W,attrHandle:Z?{}:{href:function(a){return a.getAttribute("href",2)},type:function(a){return a.getAttribute("type")}},find:{ID:d?function(a,b,c){if(typeof b.getElementById!==n&&!c){var d=b.getElementById(a);return d&&d.parentNode?[d]:[]}}:function(a,c,d){if(typeof c.getElementById!==n&&!d){var e=c.getElementById(a);return e?e.id===a||typeof e.getAttributeNode!==n&&e.getAttributeNode("id").value===a?[e]:b:[]}},TAG:Y?function(a,b){if(typeof b.getElementsByTagName!==n)return b.getElementsByTagName(a)}:function(a,b){var c=b.getElementsByTagName(a);if(a==="*"){var d,e=[],f=0;for(;d=c[f];f++)d.nodeType===1&&e.push(d);return e}return c},NAME:ba&&function(a,b){if(typeof b.getElementsByName!==n)return b.getElementsByName(name)},CLASS:_&&function(a,b,c){if(typeof b.getElementsByClassName!==n&&!c)return b.getElementsByClassName(a)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(V,""),a[3]=(a[4]||a[5]||"").replace(V,""),a[2]==="~="&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),a[1]==="nth"?(a[2]||bc.error(a[0]),a[3]=+(a[3]?a[4]+(a[5]||1):2*(a[2]==="even"||a[2]==="odd")),a[4]=+(a[6]+a[7]||a[2]==="odd")):a[2]&&bc.error(a[0]),a},PSEUDO:function(a){var b,c;if(W.CHILD.test(a[0]))return null;if(a[3])a[2]=a[3];else if(b=a[4])O.test(b)&&(c=bh(b,!0))&&(c=b.indexOf(")",b.length-c)-b.length)&&(b=b.slice(0,c),a[0]=a[0].slice(0,c)),a[2]=b;return a.slice(0,3)}},filter:{ID:d?function(a){return a=a.replace(V,""),function(b){return b.getAttribute("id")===a}}:function(a){return a=a.replace(V,""),function(b){var c=typeof b.getAttributeNode!==n&&b.getAttributeNode("id");return c&&c.value===a}},TAG:function(a){return a==="*"?function(){return!0}:(a=a.replace(V,"").toLowerCase(),function(b){return b.nodeName&&b.nodeName.toLowerCase()===a})},CLASS:function(a){var b=B[o][a];return b||(b=B(a,new RegExp("(^|"+E+")"+a+"("+E+"|$)"))),function(a){return b.test(a.className||typeof a.getAttribute!==n&&a.getAttribute("class")||"")}},ATTR:function(a,b,c){return function(d,e){var f=bc.attr(d,a);return f==null?b==="!=":b?(f+="",b==="="?f===c:b==="!="?f!==c:b==="^="?c&&f.indexOf(c)===0:b==="*="?c&&f.indexOf(c)>-1:b==="$="?c&&f.substr(f.length-c.length)===c:b==="~="?(" "+f+" ").indexOf(c)>-1:b==="|="?f===c||f.substr(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d){return a==="nth"?function(a){var b,e,f=a.parentNode;if(c===1&&d===0)return!0;if(f){e=0;for(b=f.firstChild;b;b=b.nextSibling)if(b.nodeType===1){e++;if(a===b)break}}return e-=d,e===c||e%c===0&&e/c>=0}:function(b){var c=b;switch(a){case"only":case"first":while(c=c.previousSibling)if(c.nodeType===1)return!1;if(a==="first")return!0;c=b;case"last":while(c=c.nextSibling)if(c.nodeType===1)return!1;return!0}}},PSEUDO:function(a,b){var c,d=e.pseudos[a]||e.setFilters[a.toLowerCase()]||bc.error("unsupported pseudo: "+a);return d[o]?d(b):d.length>1?(c=[a,a,"",b],e.setFilters.hasOwnProperty(a.toLowerCase())?z(function(a,c){var e,f=d(a,b),g=f.length;while(g--)e=y.call(a,f[g]),a[e]=!(c[e]=f[g])}):function(a){return d(a,0,c)}):d}},pseudos:{not:z(function(a){var b=[],c=[],d=i(a.replace(L,"$1"));return d[o]?z(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)if(f=g[h])a[h]=!(b[h]=f)}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:z(function(a){return function(b){return bc(a,b).length>0}}),contains:z(function(a){return function(b){return(b.textContent||b.innerText||f(b)).indexOf(a)>-1}}),enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&!!a.checked||b==="option"&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return!e.pseudos.empty(a)},empty:function(a){var b;a=a.firstChild;while(a){if(a.nodeName>"@"||(b=a.nodeType)===3||b===4)return!1;a=a.nextSibling}return!0},header:function(a){return T.test(a.nodeName)},text:function(a){var b,c;return a.nodeName.toLowerCase()==="input"&&(b=a.type)==="text"&&((c=a.getAttribute("type"))==null||c.toLowerCase()===b)},radio:bd("radio"),checkbox:bd("checkbox"),file:bd("file"),password:bd("password"),image:bd("image"),submit:be("submit"),reset:be("reset"),button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&a.type==="button"||b==="button"},input:function(a){return U.test(a.nodeName)},focus:function(a){var b=a.ownerDocument;return a===b.activeElement&&(!b.hasFocus||b.hasFocus())&&(!!a.type||!!a.href)},active:function(a){return a===a.ownerDocument.activeElement},first:bf(function(a,b,c){return[0]}),last:bf(function(a,b,c){return[b-1]}),eq:bf(function(a,b,c){return[c<0?c+b:c]}),even:bf(function(a,b,c){for(var d=0;d<b;d+=2)a.push(d);return a}),odd:bf(function(a,b,c){for(var d=1;d<b;d+=2)a.push(d);return a}),lt:bf(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:bf(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},j=s.compareDocumentPosition?function(a,b){return a===b?(k=!0,0):(!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition:a.compareDocumentPosition(b)&4)?-1:1}:function(a,b){if(a===b)return k=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,h=b.parentNode,i=g;if(g===h)return bg(a,b);if(!g)return-1;if(!h)return 1;while(i)e.unshift(i),i=i.parentNode;i=h;while(i)f.unshift(i),i=i.parentNode;c=e.length,d=f.length;for(var j=0;j<c&&j<d;j++)if(e[j]!==f[j])return bg(e[j],f[j]);return j===c?bg(a,f[j],-1):bg(e[j],b,1)},[0,0].sort(j),m=!k,bc.uniqueSort=function(a){var b,c=1;k=m,a.sort(j);if(k)for(;b=a[c];c++)b===a[c-1]&&a.splice(c--,1);return a},bc.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},i=bc.compile=function(a,b){var c,d=[],e=[],f=D[o][a];if(!f){b||(b=bh(a)),c=b.length;while(c--)f=bm(b[c]),f[o]?d.push(f):e.push(f);f=D(a,bn(e,d))}return f},r.querySelectorAll&&function(){var a,b=bp,c=/'|\\/g,d=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,e=[":focus"],f=[":active",":focus"],h=s.matchesSelector||s.mozMatchesSelector||s.webkitMatchesSelector||s.oMatchesSelector||s.msMatchesSelector;X(function(a){a.innerHTML="<select><option selected=''></option></select>",a.querySelectorAll("[selected]").length||e.push("\\["+E+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),a.querySelectorAll(":checked").length||e.push(":checked")}),X(function(a){a.innerHTML="<p test=''></p>",a.querySelectorAll("[test^='']").length&&e.push("[*^$]="+E+"*(?:\"\"|'')"),a.innerHTML="<input type='hidden'/>",a.querySelectorAll(":enabled").length||e.push(":enabled",":disabled")}),e=new RegExp(e.join("|")),bp=function(a,d,f,g,h){if(!g&&!h&&(!e||!e.test(a))){var i,j,k=!0,l=o,m=d,n=d.nodeType===9&&a;if(d.nodeType===1&&d.nodeName.toLowerCase()!=="object"){i=bh(a),(k=d.getAttribute("id"))?l=k.replace(c,"\\$&"):d.setAttribute("id",l),l="[id='"+l+"'] ",j=i.length;while(j--)i[j]=l+i[j].join("");m=R.test(a)&&d.parentNode||d,n=i.join(",")}if(n)try{return w.apply(f,x.call(m.querySelectorAll(n),0)),f}catch(p){}finally{k||d.removeAttribute("id")}}return b(a,d,f,g,h)},h&&(X(function(b){a=h.call(b,"div");try{h.call(b,"[test!='']:sizzle"),f.push("!=",J)}catch(c){}}),f=new RegExp(f.join("|")),bc.matchesSelector=function(b,c){c=c.replace(d,"='$1']");if(!g(b)&&!f.test(c)&&(!e||!e.test(c)))try{var i=h.call(b,c);if(i||a||b.document&&b.document.nodeType!==11)return i}catch(j){}return bc(c,null,null,[b]).length>0})}(),e.pseudos.nth=e.pseudos.eq,e.filters=bq.prototype=e.pseudos,e.setFilters=new bq,bc.attr=p.attr,p.find=bc,p.expr=bc.selectors,p.expr[":"]=p.expr.pseudos,p.unique=bc.uniqueSort,p.text=bc.getText,p.isXMLDoc=bc.isXML,p.contains=bc.contains}(a);var bc=/Until$/,bd=/^(?:parents|prev(?:Until|All))/,be=/^.[^:#\[\.,]*$/,bf=p.expr.match.needsContext,bg={children:!0,contents:!0,next:!0,prev:!0};p.fn.extend({find:function(a){var b,c,d,e,f,g,h=this;if(typeof a!="string")return p(a).filter(function(){for(b=0,c=h.length;b<c;b++)if(p.contains(h[b],this))return!0});g=this.pushStack("","find",a);for(b=0,c=this.length;b<c;b++){d=g.length,p.find(a,this[b],g);if(b>0)for(e=d;e<g.length;e++)for(f=0;f<d;f++)if(g[f]===g[e]){g.splice(e--,1);break}}return g},has:function(a){var b,c=p(a,this),d=c.length;return this.filter(function(){for(b=0;b<d;b++)if(p.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(bj(this,a,!1),"not",a)},filter:function(a){return this.pushStack(bj(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?bf.test(a)?p(a,this.context).index(this[0])>=0:p.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c,d=0,e=this.length,f=[],g=bf.test(a)||typeof a!="string"?p(a,b||this.context):0;for(;d<e;d++){c=this[d];while(c&&c.ownerDocument&&c!==b&&c.nodeType!==11){if(g?g.index(c)>-1:p.find.matchesSelector(c,a)){f.push(c);break}c=c.parentNode}}return f=f.length>1?p.unique(f):f,this.pushStack(f,"closest",a)},index:function(a){return a?typeof a=="string"?p.inArray(this[0],p(a)):p.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,b){var c=typeof a=="string"?p(a,b):p.makeArray(a&&a.nodeType?[a]:a),d=p.merge(this.get(),c);return this.pushStack(bh(c[0])||bh(d[0])?d:p.unique(d))},addBack:function(a){return this.add(a==null?this.prevObject:this.prevObject.filter(a))}}),p.fn.andSelf=p.fn.addBack,p.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return p.dir(a,"parentNode")},parentsUntil:function(a,b,c){return p.dir(a,"parentNode",c)},next:function(a){return bi(a,"nextSibling")},prev:function(a){return bi(a,"previousSibling")},nextAll:function(a){return p.dir(a,"nextSibling")},prevAll:function(a){return p.dir(a,"previousSibling")},nextUntil:function(a,b,c){return p.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return p.dir(a,"previousSibling",c)},siblings:function(a){return p.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return p.sibling(a.firstChild)},contents:function(a){return p.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:p.merge([],a.childNodes)}},function(a,b){p.fn[a]=function(c,d){var e=p.map(this,b,c);return bc.test(a)||(d=c),d&&typeof d=="string"&&(e=p.filter(d,e)),e=this.length>1&&!bg[a]?p.unique(e):e,this.length>1&&bd.test(a)&&(e=e.reverse()),this.pushStack(e,a,k.call(arguments).join(","))}}),p.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),b.length===1?p.find.matchesSelector(b[0],a)?[b[0]]:[]:p.find.matches(a,b)},dir:function(a,c,d){var e=[],f=a[c];while(f&&f.nodeType!==9&&(d===b||f.nodeType!==1||!p(f).is(d)))f.nodeType===1&&e.push(f),f=f[c];return e},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var bl="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",bm=/ jQuery\d+="(?:null|\d+)"/g,bn=/^\s+/,bo=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bp=/<([\w:]+)/,bq=/<tbody/i,br=/<|&#?\w+;/,bs=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,bu=new RegExp("<(?:"+bl+")[\\s/>]","i"),bv=/^(?:checkbox|radio)$/,bw=/checked\s*(?:[^=]|=\s*.checked.)/i,bx=/\/(java|ecma)script/i,by=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,bz={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bA=bk(e),bB=bA.appendChild(e.createElement("div"));bz.optgroup=bz.option,bz.tbody=bz.tfoot=bz.colgroup=bz.caption=bz.thead,bz.th=bz.td,p.support.htmlSerialize||(bz._default=[1,"X<div>","</div>"]),p.fn.extend({text:function(a){return p.access(this,function(a){return a===b?p.text(this):this.empty().append((this[0]&&this[0].ownerDocument||e).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(p.isFunction(a))return this.each(function(b){p(this).wrapAll(a.call(this,b))});if(this[0]){var b=p(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return p.isFunction(a)?this.each(function(b){p(this).wrapInner(a.call(this,b))}):this.each(function(){var b=p(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=p.isFunction(a);return this.each(function(c){p(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){(this.nodeType===1||this.nodeType===11)&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(a,this.firstChild)})},before:function(){if(!bh(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=p.clean(arguments);return this.pushStack(p.merge(a,this),"before",this.selector)}},after:function(){if(!bh(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=p.clean(arguments);return this.pushStack(p.merge(this,a),"after",this.selector)}},remove:function(a,b){var c,d=0;for(;(c=this[d])!=null;d++)if(!a||p.filter(a,[c]).length)!b&&c.nodeType===1&&(p.cleanData(c.getElementsByTagName("*")),p.cleanData([c])),c.parentNode&&c.parentNode.removeChild(c);return this},empty:function(){var a,b=0;for(;(a=this[b])!=null;b++){a.nodeType===1&&p.cleanData(a.getElementsByTagName("*"));while(a.firstChild)a.removeChild(a.firstChild)}return this},clone:function(a,b){return a=a==null?!1:a,b=b==null?a:b,this.map(function(){return p.clone(this,a,b)})},html:function(a){return p.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return c.nodeType===1?c.innerHTML.replace(bm,""):b;if(typeof a=="string"&&!bs.test(a)&&(p.support.htmlSerialize||!bu.test(a))&&(p.support.leadingWhitespace||!bn.test(a))&&!bz[(bp.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(bo,"<$1></$2>");try{for(;d<e;d++)c=this[d]||{},c.nodeType===1&&(p.cleanData(c.getElementsByTagName("*")),c.innerHTML=a);c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){return bh(this[0])?this.length?this.pushStack(p(p.isFunction(a)?a():a),"replaceWith",a):this:p.isFunction(a)?this.each(function(b){var c=p(this),d=c.html();c.replaceWith(a.call(this,b,d))}):(typeof a!="string"&&(a=p(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;p(this).remove(),b?p(b).before(a):p(c).append(a)}))},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){a=[].concat.apply([],a);var e,f,g,h,i=0,j=a[0],k=[],l=this.length;if(!p.support.checkClone&&l>1&&typeof j=="string"&&bw.test(j))return this.each(function(){p(this).domManip(a,c,d)});if(p.isFunction(j))return this.each(function(e){var f=p(this);a[0]=j.call(this,e,c?f.html():b),f.domManip(a,c,d)});if(this[0]){e=p.buildFragment(a,this,k),g=e.fragment,f=g.firstChild,g.childNodes.length===1&&(g=f);if(f){c=c&&p.nodeName(f,"tr");for(h=e.cacheable||l-1;i<l;i++)d.call(c&&p.nodeName(this[i],"table")?bC(this[i],"tbody"):this[i],i===h?g:p.clone(g,!0,!0))}g=f=null,k.length&&p.each(k,function(a,b){b.src?p.ajax?p.ajax({url:b.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):p.error("no ajax"):p.globalEval((b.text||b.textContent||b.innerHTML||"").replace(by,"")),b.parentNode&&b.parentNode.removeChild(b)})}return this}}),p.buildFragment=function(a,c,d){var f,g,h,i=a[0];return c=c||e,c=!c.nodeType&&c[0]||c,c=c.ownerDocument||c,a.length===1&&typeof i=="string"&&i.length<512&&c===e&&i.charAt(0)==="<"&&!bt.test(i)&&(p.support.checkClone||!bw.test(i))&&(p.support.html5Clone||!bu.test(i))&&(g=!0,f=p.fragments[i],h=f!==b),f||(f=c.createDocumentFragment(),p.clean(a,c,f,d),g&&(p.fragments[i]=h&&f)),{fragment:f,cacheable:g}},p.fragments={},p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){p.fn[a]=function(c){var d,e=0,f=[],g=p(c),h=g.length,i=this.length===1&&this[0].parentNode;if((i==null||i&&i.nodeType===11&&i.childNodes.length===1)&&h===1)return g[b](this[0]),this;for(;e<h;e++)d=(e>0?this.clone(!0):this).get(),p(g[e])[b](d),f=f.concat(d);return this.pushStack(f,a,g.selector)}}),p.extend({clone:function(a,b,c){var d,e,f,g;p.support.html5Clone||p.isXMLDoc(a)||!bu.test("<"+a.nodeName+">")?g=a.cloneNode(!0):(bB.innerHTML=a.outerHTML,bB.removeChild(g=bB.firstChild));if((!p.support.noCloneEvent||!p.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!p.isXMLDoc(a)){bE(a,g),d=bF(a),e=bF(g);for(f=0;d[f];++f)e[f]&&bE(d[f],e[f])}if(b){bD(a,g);if(c){d=bF(a),e=bF(g);for(f=0;d[f];++f)bD(d[f],e[f])}}return d=e=null,g},clean:function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,q,r,s=b===e&&bA,t=[];if(!b||typeof b.createDocumentFragment=="undefined")b=e;for(f=0;(h=a[f])!=null;f++){typeof h=="number"&&(h+="");if(!h)continue;if(typeof h=="string")if(!br.test(h))h=b.createTextNode(h);else{s=s||bk(b),l=b.createElement("div"),s.appendChild(l),h=h.replace(bo,"<$1></$2>"),i=(bp.exec(h)||["",""])[1].toLowerCase(),j=bz[i]||bz._default,k=j[0],l.innerHTML=j[1]+h+j[2];while(k--)l=l.lastChild;if(!p.support.tbody){m=bq.test(h),n=i==="table"&&!m?l.firstChild&&l.firstChild.childNodes:j[1]==="<table>"&&!m?l.childNodes:[];for(g=n.length-1;g>=0;--g)p.nodeName(n[g],"tbody")&&!n[g].childNodes.length&&n[g].parentNode.removeChild(n[g])}!p.support.leadingWhitespace&&bn.test(h)&&l.insertBefore(b.createTextNode(bn.exec(h)[0]),l.firstChild),h=l.childNodes,l.parentNode.removeChild(l)}h.nodeType?t.push(h):p.merge(t,h)}l&&(h=l=s=null);if(!p.support.appendChecked)for(f=0;(h=t[f])!=null;f++)p.nodeName(h,"input")?bG(h):typeof h.getElementsByTagName!="undefined"&&p.grep(h.getElementsByTagName("input"),bG);if(c){q=function(a){if(!a.type||bx.test(a.type))return d?d.push(a.parentNode?a.parentNode.removeChild(a):a):c.appendChild(a)};for(f=0;(h=t[f])!=null;f++)if(!p.nodeName(h,"script")||!q(h))c.appendChild(h),typeof h.getElementsByTagName!="undefined"&&(r=p.grep(p.merge([],h.getElementsByTagName("script")),q),t.splice.apply(t,[f+1,0].concat(r)),f+=r.length)}return t},cleanData:function(a,b){var c,d,e,f,g=0,h=p.expando,i=p.cache,j=p.support.deleteExpando,k=p.event.special;for(;(e=a[g])!=null;g++)if(b||p.acceptData(e)){d=e[h],c=d&&i[d];if(c){if(c.events)for(f in c.events)k[f]?p.event.remove(e,f):p.removeEvent(e,f,c.handle);i[d]&&(delete i[d],j?delete e[h]:e.removeAttribute?e.removeAttribute(h):e[h]=null,p.deletedIds.push(d))}}}}),function(){var a,b;p.uaMatch=function(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},a=p.uaMatch(g.userAgent),b={},a.browser&&(b[a.browser]=!0,b.version=a.version),b.chrome?b.webkit=!0:b.webkit&&(b.safari=!0),p.browser=b,p.sub=function(){function a(b,c){return new a.fn.init(b,c)}p.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function c(c,d){return d&&d instanceof p&&!(d instanceof a)&&(d=a(d)),p.fn.init.call(this,c,d,b)},a.fn.init.prototype=a.fn;var b=a(e);return a}}();var bH,bI,bJ,bK=/alpha\([^)]*\)/i,bL=/opacity=([^)]*)/,bM=/^(top|right|bottom|left)$/,bN=/^(none|table(?!-c[ea]).+)/,bO=/^margin/,bP=new RegExp("^("+q+")(.*)$","i"),bQ=new RegExp("^("+q+")(?!px)[a-z%]+$","i"),bR=new RegExp("^([-+])=("+q+")","i"),bS={},bT={position:"absolute",visibility:"hidden",display:"block"},bU={letterSpacing:0,fontWeight:400},bV=["Top","Right","Bottom","Left"],bW=["Webkit","O","Moz","ms"],bX=p.fn.toggle;p.fn.extend({css:function(a,c){return p.access(this,function(a,c,d){return d!==b?p.style(a,c,d):p.css(a,c)},a,c,arguments.length>1)},show:function(){return b$(this,!0)},hide:function(){return b$(this)},toggle:function(a,b){var c=typeof a=="boolean";return p.isFunction(a)&&p.isFunction(b)?bX.apply(this,arguments):this.each(function(){(c?a:bZ(this))?p(this).show():p(this).hide()})}}),p.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bH(a,"opacity");return c===""?"1":c}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":p.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!a||a.nodeType===3||a.nodeType===8||!a.style)return;var f,g,h,i=p.camelCase(c),j=a.style;c=p.cssProps[i]||(p.cssProps[i]=bY(j,i)),h=p.cssHooks[c]||p.cssHooks[i];if(d===b)return h&&"get"in h&&(f=h.get(a,!1,e))!==b?f:j[c];g=typeof d,g==="string"&&(f=bR.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(p.css(a,c)),g="number");if(d==null||g==="number"&&isNaN(d))return;g==="number"&&!p.cssNumber[i]&&(d+="px");if(!h||!("set"in h)||(d=h.set(a,d,e))!==b)try{j[c]=d}catch(k){}},css:function(a,c,d,e){var f,g,h,i=p.camelCase(c);return c=p.cssProps[i]||(p.cssProps[i]=bY(a.style,i)),h=p.cssHooks[c]||p.cssHooks[i],h&&"get"in h&&(f=h.get(a,!0,e)),f===b&&(f=bH(a,c)),f==="normal"&&c in bU&&(f=bU[c]),d||e!==b?(g=parseFloat(f),d||p.isNumeric(g)?g||0:f):f},swap:function(a,b,c){var d,e,f={};for(e in b)f[e]=a.style[e],a.style[e]=b[e];d=c.call(a);for(e in b)a.style[e]=f[e];return d}}),a.getComputedStyle?bH=function(b,c){var d,e,f,g,h=a.getComputedStyle(b,null),i=b.style;return h&&(d=h[c],d===""&&!p.contains(b.ownerDocument,b)&&(d=p.style(b,c)),bQ.test(d)&&bO.test(c)&&(e=i.width,f=i.minWidth,g=i.maxWidth,i.minWidth=i.maxWidth=i.width=d,d=h.width,i.width=e,i.minWidth=f,i.maxWidth=g)),d}:e.documentElement.currentStyle&&(bH=function(a,b){var c,d,e=a.currentStyle&&a.currentStyle[b],f=a.style;return e==null&&f&&f[b]&&(e=f[b]),bQ.test(e)&&!bM.test(b)&&(c=f.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),f.left=b==="fontSize"?"1em":e,e=f.pixelLeft+"px",f.left=c,d&&(a.runtimeStyle.left=d)),e===""?"auto":e}),p.each(["height","width"],function(a,b){p.cssHooks[b]={get:function(a,c,d){if(c)return a.offsetWidth===0&&bN.test(bH(a,"display"))?p.swap(a,bT,function(){return cb(a,b,d)}):cb(a,b,d)},set:function(a,c,d){return b_(a,c,d?ca(a,b,d,p.support.boxSizing&&p.css(a,"boxSizing")==="border-box"):0)}}}),p.support.opacity||(p.cssHooks.opacity={get:function(a,b){return bL.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=p.isNumeric(b)?"alpha(opacity="+b*100+")":"",f=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&p.trim(f.replace(bK,""))===""&&c.removeAttribute){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bK.test(f)?f.replace(bK,e):f+" "+e}}),p(function(){p.support.reliableMarginRight||(p.cssHooks.marginRight={get:function(a,b){return p.swap(a,{display:"inline-block"},function(){if(b)return bH(a,"marginRight")})}}),!p.support.pixelPosition&&p.fn.position&&p.each(["top","left"],function(a,b){p.cssHooks[b]={get:function(a,c){if(c){var d=bH(a,b);return bQ.test(d)?p(a).position()[b]+"px":d}}}})}),p.expr&&p.expr.filters&&(p.expr.filters.hidden=function(a){return a.offsetWidth===0&&a.offsetHeight===0||!p.support.reliableHiddenOffsets&&(a.style&&a.style.display||bH(a,"display"))==="none"},p.expr.filters.visible=function(a){return!p.expr.filters.hidden(a)}),p.each({margin:"",padding:"",border:"Width"},function(a,b){p.cssHooks[a+b]={expand:function(c){var d,e=typeof c=="string"?c.split(" "):[c],f={};for(d=0;d<4;d++)f[a+bV[d]+b]=e[d]||e[d-2]||e[0];return f}},bO.test(a)||(p.cssHooks[a+b].set=b_)});var cd=/%20/g,ce=/\[\]$/,cf=/\r?\n/g,cg=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,ch=/^(?:select|textarea)/i;p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?p.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ch.test(this.nodeName)||cg.test(this.type))}).map(function(a,b){var c=p(this).val();return c==null?null:p.isArray(c)?p.map(c,function(a,c){return{name:b.name,value:a.replace(cf,"\r\n")}}):{name:b.name,value:c.replace(cf,"\r\n")}}).get()}}),p.param=function(a,c){var d,e=[],f=function(a,b){b=p.isFunction(b)?b():b==null?"":b,e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=p.ajaxSettings&&p.ajaxSettings.traditional);if(p.isArray(a)||a.jquery&&!p.isPlainObject(a))p.each(a,function(){f(this.name,this.value)});else for(d in a)ci(d,a[d],c,f);return e.join("&").replace(cd,"+")};var cj,ck,cl=/#.*$/,cm=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,cn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,co=/^(?:GET|HEAD)$/,cp=/^\/\//,cq=/\?/,cr=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,cs=/([?&])_=[^&]*/,ct=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,cu=p.fn.load,cv={},cw={},cx=["*/"]+["*"];try{ck=f.href}catch(cy){ck=e.createElement("a"),ck.href="",ck=ck.href}cj=ct.exec(ck.toLowerCase())||[],p.fn.load=function(a,c,d){if(typeof a!="string"&&cu)return cu.apply(this,arguments);if(!this.length)return this;var e,f,g,h=this,i=a.indexOf(" ");return i>=0&&(e=a.slice(i,a.length),a=a.slice(0,i)),p.isFunction(c)?(d=c,c=b):c&&typeof c=="object"&&(f="POST"),p.ajax({url:a,type:f,dataType:"html",data:c,complete:function(a,b){d&&h.each(d,g||[a.responseText,b,a])}}).done(function(a){g=arguments,h.html(e?p("<div>").append(a.replace(cr,"")).find(e):a)}),this},p.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){p.fn[b]=function(a){return this.on(b,a)}}),p.each(["get","post"],function(a,c){p[c]=function(a,d,e,f){return p.isFunction(d)&&(f=f||e,e=d,d=b),p.ajax({type:c,url:a,data:d,success:e,dataType:f})}}),p.extend({getScript:function(a,c){return p.get(a,b,c,"script")},getJSON:function(a,b,c){return p.get(a,b,c,"json")},ajaxSetup:function(a,b){return b?cB(a,p.ajaxSettings):(b=a,a=p.ajaxSettings),cB(a,b),a},ajaxSettings:{url:ck,isLocal:cn.test(cj[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":cx},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:cz(cv),ajaxTransport:cz(cw),ajax:function(a,c){function y(a,c,f,i){var k,s,t,u,w,y=c;if(v===2)return;v=2,h&&clearTimeout(h),g=b,e=i||"",x.readyState=a>0?4:0,f&&(u=cC(l,x,f));if(a>=200&&a<300||a===304)l.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(p.lastModified[d]=w),w=x.getResponseHeader("Etag"),w&&(p.etag[d]=w)),a===304?(y="notmodified",k=!0):(k=cD(l,u),y=k.state,s=k.data,t=k.error,k=!t);else{t=y;if(!y||a)y="error",a<0&&(a=0)}x.status=a,x.statusText=(c||y)+"",k?o.resolveWith(m,[s,y,x]):o.rejectWith(m,[x,y,t]),x.statusCode(r),r=b,j&&n.trigger("ajax"+(k?"Success":"Error"),[x,l,k?s:t]),q.fireWith(m,[x,y]),j&&(n.trigger("ajaxComplete",[x,l]),--p.active||p.event.trigger("ajaxStop"))}typeof a=="object"&&(c=a,a=b),c=c||{};var d,e,f,g,h,i,j,k,l=p.ajaxSetup({},c),m=l.context||l,n=m!==l&&(m.nodeType||m instanceof p)?p(m):p.event,o=p.Deferred(),q=p.Callbacks("once memory"),r=l.statusCode||{},t={},u={},v=0,w="canceled",x={readyState:0,setRequestHeader:function(a,b){if(!v){var c=a.toLowerCase();a=u[c]=u[c]||a,t[a]=b}return this},getAllResponseHeaders:function(){return v===2?e:null},getResponseHeader:function(a){var c;if(v===2){if(!f){f={};while(c=cm.exec(e))f[c[1].toLowerCase()]=c[2]}c=f[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){return v||(l.mimeType=a),this},abort:function(a){return a=a||w,g&&g.abort(a),y(0,a),this}};o.promise(x),x.success=x.done,x.error=x.fail,x.complete=q.add,x.statusCode=function(a){if(a){var b;if(v<2)for(b in a)r[b]=[r[b],a[b]];else b=a[x.status],x.always(b)}return this},l.url=((a||l.url)+"").replace(cl,"").replace(cp,cj[1]+"//"),l.dataTypes=p.trim(l.dataType||"*").toLowerCase().split(s),l.crossDomain==null&&(i=ct.exec(l.url.toLowerCase())||!1,l.crossDomain=i&&i.join(":")+(i[3]?"":i[1]==="http:"?80:443)!==cj.join(":")+(cj[3]?"":cj[1]==="http:"?80:443)),l.data&&l.processData&&typeof l.data!="string"&&(l.data=p.param(l.data,l.traditional)),cA(cv,l,c,x);if(v===2)return x;j=l.global,l.type=l.type.toUpperCase(),l.hasContent=!co.test(l.type),j&&p.active++===0&&p.event.trigger("ajaxStart");if(!l.hasContent){l.data&&(l.url+=(cq.test(l.url)?"&":"?")+l.data,delete l.data),d=l.url;if(l.cache===!1){var z=p.now(),A=l.url.replace(cs,"$1_="+z);l.url=A+(A===l.url?(cq.test(l.url)?"&":"?")+"_="+z:"")}}(l.data&&l.hasContent&&l.contentType!==!1||c.contentType)&&x.setRequestHeader("Content-Type",l.contentType),l.ifModified&&(d=d||l.url,p.lastModified[d]&&x.setRequestHeader("If-Modified-Since",p.lastModified[d]),p.etag[d]&&x.setRequestHeader("If-None-Match",p.etag[d])),x.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+(l.dataTypes[0]!=="*"?", "+cx+"; q=0.01":""):l.accepts["*"]);for(k in l.headers)x.setRequestHeader(k,l.headers[k]);if(!l.beforeSend||l.beforeSend.call(m,x,l)!==!1&&v!==2){w="abort";for(k in{success:1,error:1,complete:1})x[k](l[k]);g=cA(cw,l,c,x);if(!g)y(-1,"No Transport");else{x.readyState=1,j&&n.trigger("ajaxSend",[x,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){x.abort("timeout")},l.timeout));try{v=1,g.send(t,y)}catch(B){if(v<2)y(-1,B);else throw B}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var cE=[],cF=/\?/,cG=/(=)\?(?=&|$)|\?\?/,cH=p.now();p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=cE.pop()||p.expando+"_"+cH++;return this[a]=!0,a}}),p.ajaxPrefilter("json jsonp",function(c,d,e){var f,g,h,i=c.data,j=c.url,k=c.jsonp!==!1,l=k&&cG.test(j),m=k&&!l&&typeof i=="string"&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&cG.test(i);if(c.dataTypes[0]==="jsonp"||l||m)return f=c.jsonpCallback=p.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,g=a[f],l?c.url=j.replace(cG,"$1"+f):m?c.data=i.replace(cG,"$1"+f):k&&(c.url+=(cF.test(j)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return h||p.error(f+" was not called"),h[0]},c.dataTypes[0]="json",a[f]=function(){h=arguments},e.always(function(){a[f]=g,c[f]&&(c.jsonpCallback=d.jsonpCallback,cE.push(f)),h&&p.isFunction(g)&&g(h[0]),h=g=b}),"script"}),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return p.globalEval(a),a}}}),p.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),p.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=e.head||e.getElementsByTagName("head")[0]||e.documentElement;return{send:function(f,g){c=e.createElement("script"),c.async="async",a.scriptCharset&&(c.charset=a.scriptCharset),c.src=a.url,c.onload=c.onreadystatechange=function(a,e){if(e||!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||g(200,"success")},d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(0,1)}}}});var cI,cJ=a.ActiveXObject?function(){for(var a in cI)cI[a](0,1)}:!1,cK=0;p.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&cL()||cM()}:cL,function(a){p.extend(p.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(p.ajaxSettings.xhr()),p.support.ajax&&p.ajaxTransport(function(c){if(!c.crossDomain||p.support.cors){var d;return{send:function(e,f){var g,h,i=c.xhr();c.username?i.open(c.type,c.url,c.async,c.username,c.password):i.open(c.type,c.url,c.async);if(c.xhrFields)for(h in c.xhrFields)i[h]=c.xhrFields[h];c.mimeType&&i.overrideMimeType&&i.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e)i.setRequestHeader(h,e[h])}catch(j){}i.send(c.hasContent&&c.data||null),d=function(a,e){var h,j,k,l,m;try{if(d&&(e||i.readyState===4)){d=b,g&&(i.onreadystatechange=p.noop,cJ&&delete cI[g]);if(e)i.readyState!==4&&i.abort();else{h=i.status,k=i.getAllResponseHeaders(),l={},m=i.responseXML,m&&m.documentElement&&(l.xml=m);try{l.text=i.responseText}catch(a){}try{j=i.statusText}catch(n){j=""}!h&&c.isLocal&&!c.crossDomain?h=l.text?200:404:h===1223&&(h=204)}}}catch(o){e||f(-1,o)}l&&f(h,j,l,k)},c.async?i.readyState===4?setTimeout(d,0):(g=++cK,cJ&&(cI||(cI={},p(a).unload(cJ)),cI[g]=d),i.onreadystatechange=d):d()},abort:function(){d&&d(0,1)}}}});var cN,cO,cP=/^(?:toggle|show|hide)$/,cQ=new RegExp("^(?:([-+])=|)("+q+")([a-z%]*)$","i"),cR=/queueHooks$/,cS=[cY],cT={"*":[function(a,b){var c,d,e=this.createTween(a,b),f=cQ.exec(b),g=e.cur(),h=+g||0,i=1,j=20;if(f){c=+f[2],d=f[3]||(p.cssNumber[a]?"":"px");if(d!=="px"&&h){h=p.css(e.elem,a,!0)||c||1;do i=i||".5",h=h/i,p.style(e.elem,a,h+d);while(i!==(i=e.cur()/g)&&i!==1&&--j)}e.unit=d,e.start=h,e.end=f[1]?h+(f[1]+1)*c:c}return e}]};p.Animation=p.extend(cW,{tweener:function(a,b){p.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");var c,d=0,e=a.length;for(;d<e;d++)c=a[d],cT[c]=cT[c]||[],cT[c].unshift(b)},prefilter:function(a,b){b?cS.unshift(a):cS.push(a)}}),p.Tween=cZ,cZ.prototype={constructor:cZ,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(p.cssNumber[c]?"":"px")},cur:function(){var a=cZ.propHooks[this.prop];return a&&a.get?a.get(this):cZ.propHooks._default.get(this)},run:function(a){var b,c=cZ.propHooks[this.prop];return this.options.duration?this.pos=b=p.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):cZ.propHooks._default.set(this),this}},cZ.prototype.init.prototype=cZ.prototype,cZ.propHooks={_default:{get:function(a){var b;return a.elem[a.prop]==null||!!a.elem.style&&a.elem.style[a.prop]!=null?(b=p.css(a.elem,a.prop,!1,""),!b||b==="auto"?0:b):a.elem[a.prop]},set:function(a){p.fx.step[a.prop]?p.fx.step[a.prop](a):a.elem.style&&(a.elem.style[p.cssProps[a.prop]]!=null||p.cssHooks[a.prop])?p.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},cZ.propHooks.scrollTop=cZ.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},p.each(["toggle","show","hide"],function(a,b){var c=p.fn[b];p.fn[b]=function(d,e,f){return d==null||typeof d=="boolean"||!a&&p.isFunction(d)&&p.isFunction(e)?c.apply(this,arguments):this.animate(c$(b,!0),d,e,f)}}),p.fn.extend({fadeTo:function(a,b,c,d){return this.filter(bZ).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=p.isEmptyObject(a),f=p.speed(b,c,d),g=function(){var b=cW(this,p.extend({},a),f);e&&b.stop(!0)};return e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop,b(d)};return typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=a!=null&&a+"queueHooks",f=p.timers,g=p._data(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&g[c].stop&&cR.test(c)&&e(g[c]);for(c=f.length;c--;)f[c].elem===this&&(a==null||f[c].queue===a)&&(f[c].anim.stop(d),b=!1,f.splice(c,1));(b||!d)&&p.dequeue(this,a)})}}),p.each({slideDown:c$("show"),slideUp:c$("hide"),slideToggle:c$("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){p.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),p.speed=function(a,b,c){var d=a&&typeof a=="object"?p.extend({},a):{complete:c||!c&&b||p.isFunction(a)&&a,duration:a,easing:c&&b||b&&!p.isFunction(b)&&b};d.duration=p.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in p.fx.speeds?p.fx.speeds[d.duration]:p.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";return d.old=d.complete,d.complete=function(){p.isFunction(d.old)&&d.old.call(this),d.queue&&p.dequeue(this,d.queue)},d},p.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},p.timers=[],p.fx=cZ.prototype.init,p.fx.tick=function(){var a,b=p.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||p.fx.stop()},p.fx.timer=function(a){a()&&p.timers.push(a)&&!cO&&(cO=setInterval(p.fx.tick,p.fx.interval))},p.fx.interval=13,p.fx.stop=function(){clearInterval(cO),cO=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fx.step={},p.expr&&p.expr.filters&&(p.expr.filters.animated=function(a){return p.grep(p.timers,function(b){return a===b.elem}).length});var c_=/^(?:body|html)$/i;p.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){p.offset.setOffset(this,a,b)});var c,d,e,f,g,h,i,j={top:0,left:0},k=this[0],l=k&&k.ownerDocument;if(!l)return;return(d=l.body)===k?p.offset.bodyOffset(k):(c=l.documentElement,p.contains(c,k)?(typeof k.getBoundingClientRect!="undefined"&&(j=k.getBoundingClientRect()),e=da(l),f=c.clientTop||d.clientTop||0,g=c.clientLeft||d.clientLeft||0,h=e.pageYOffset||c.scrollTop,i=e.pageXOffset||c.scrollLeft,{top:j.top+h-f,left:j.left+i-g}):j)},p.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return p.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(p.css(a,"marginTop"))||0,c+=parseFloat(p.css(a,"marginLeft"))||0),{top:b,left:c}},setOffset:function(a,b,c){var d=p.css(a,"position");d==="static"&&(a.style.position="relative");var e=p(a),f=e.offset(),g=p.css(a,"top"),h=p.css(a,"left"),i=(d==="absolute"||d==="fixed")&&p.inArray("auto",[g,h])>-1,j={},k={},l,m;i?(k=e.position(),l=k.top,m=k.left):(l=parseFloat(g)||0,m=parseFloat(h)||0),p.isFunction(b)&&(b=b.call(a,c,f)),b.top!=null&&(j.top=b.top-f.top+l),b.left!=null&&(j.left=b.left-f.left+m),"using"in b?b.using.call(a,j):e.css(j)}},p.fn.extend({position:function(){if(!this[0])return;var a=this[0],b=this.offsetParent(),c=this.offset(),d=c_.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(p.css(a,"marginTop"))||0,c.left-=parseFloat(p.css(a,"marginLeft"))||0,d.top+=parseFloat(p.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(p.css(b[0],"borderLeftWidth"))||0,{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||e.body;while(a&&!c_.test(a.nodeName)&&p.css(a,"position")==="static")a=a.offsetParent;return a||e.body})}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);p.fn[a]=function(e){return p.access(this,function(a,e,f){var g=da(a);if(f===b)return g?c in g?g[c]:g.document.documentElement[e]:a[e];g?g.scrollTo(d?p(g).scrollLeft():f,d?f:p(g).scrollTop()):a[e]=f},a,e,arguments.length,null)}}),p.each({Height:"height",Width:"width"},function(a,c){p.each({padding:"inner"+a,content:c,"":"outer"+a},function(d,e){p.fn[e]=function(e,f){var g=arguments.length&&(d||typeof e!="boolean"),h=d||(e===!0||f===!0?"margin":"border");return p.access(this,function(c,d,e){var f;return p.isWindow(c)?c.document.documentElement["client"+a]:c.nodeType===9?(f=c.documentElement,Math.max(c.body["scroll"+a],f["scroll"+a],c.body["offset"+a],f["offset"+a],f["client"+a])):e===b?p.css(c,d,e,h):p.style(c,d,e,h)},c,g?e:b,g,null)}})}),a.jQuery=a.$=p,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return p})})(window);
;
;
/*! jquery-ui-1.9.1.custom.min.js */ 
;
;
/*! jQuery UI - v1.9.1 - 2012-11-05
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.position.js, jquery.ui.draggable.js, jquery.ui.resizable.js, jquery.ui.sortable.js
* Copyright (c) 2012 jQuery Foundation and other contributors Licensed MIT */
(function(e,t){function i(t,n){var r,i,o,u=t.nodeName.toLowerCase();return"area"===u?(r=t.parentNode,i=r.name,!t.href||!i||r.nodeName.toLowerCase()!=="map"?!1:(o=e("img[usemap=#"+i+"]")[0],!!o&&s(o))):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&s(t)}function s(t){return e.expr.filters.visible(t)&&!e(t).parents().andSelf().filter(function(){return e.css(this,"visibility")==="hidden"}).length}var n=0,r=/^ui-id-\d+$/;e.ui=e.ui||{};if(e.ui.version)return;e.extend(e.ui,{version:"1.9.1",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return typeof t=="number"?this.each(function(){var r=this;setTimeout(function(){e(r).focus(),n&&n.call(r)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):t=this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length){var r=e(this[0]),i,s;while(r.length&&r[0]!==document){i=r.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){s=parseInt(r.css("zIndex"),10);if(!isNaN(s)&&s!==0)return s}r=r.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function u(t,n,r,s){return e.each(i,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var i=r==="Width"?["Left","Right"]:["Top","Bottom"],s=r.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?o["inner"+r].call(this):this.each(function(){e(this).css(s,u(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return typeof t!="number"?o["outer"+r].call(this,t):this.each(function(){e(this).css(s,u(this,t,!0,n)+"px")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),r=isNaN(n);return(r||n>=0)&&i(t,!r)}}),e(function(){var t=document.body,n=t.appendChild(n=document.createElement("div"));n.offsetHeight,e.extend(n.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),e.support.minHeight=n.offsetHeight===100,e.support.selectstart="onselectstart"in n,t.removeChild(n).style.display="none"}),function(){var t=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];e.ui.ie=t.length?!0:!1,e.ui.ie6=parseFloat(t[1],10)===6}(),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(!i||!e.element[0].parentNode||e.element[0].parentNode.nodeType===11)return;for(r=0;r<i.length;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},contains:e.contains,hasScroll:function(t,n){if(e(t).css("overflow")==="hidden")return!1;var r=n&&n==="left"?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)},isOverAxis:function(e,t,n){return e>t&&e<t+n},isOver:function(t,n,r,i,s,o){return e.ui.isOverAxis(t,r,s)&&e.ui.isOverAxis(n,i,o)}})})(jQuery);(function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n=0,r;(r=t[n])!=null;n++)try{e(r).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(t,n,r){var i,s,o,u,a=t.split(".")[0];t=t.split(".")[1],i=a+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[a]=e[a]||{},s=e[a][t],o=e[a][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,i){e.isFunction(i)&&(r[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t=this._super,n=this._superApply,s;return this._super=e,this._superApply=r,s=i.apply(this,arguments),this._super=t,this._superApply=n,s}}())}),o.prototype=e.widget.extend(u,{widgetEventPrefix:u.widgetEventPrefix||t},r,{constructor:o,namespace:a,widgetName:t,widgetBaseClass:i,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){var i=r.call(arguments,1),s=0,o=i.length,u,a;for(;s<o;s++)for(u in i[s])a=i[s][u],i[s].hasOwnProperty(u)&&a!==t&&(e.isPlainObject(a)?n[u]=e.isPlainObject(n[u])?e.widget.extend({},n[u],a):e.widget.extend({},a):n[u]=a);return n},e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName;e.fn[n]=function(o){var u=typeof o=="string",a=r.call(arguments,1),f=this;return o=!u&&a.length?e.widget.extend.apply(null,[o].concat(a)):o,u?this.each(function(){var r,i=e.data(this,s);if(!i)return e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'");if(!e.isFunction(i[o])||o.charAt(0)==="_")return e.error("no such method '"+o+"' for "+n+" widget instance");r=i[o].apply(i,a);if(r!==i&&r!==t)return f=r&&r.jquery?f.pushStack(r.get()):r,!1}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():new i(o,this)}),f}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetName,this),e.data(r,this.widgetFullName,this),this._on(this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i=n,s,o,u;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof n=="string"){i={},s=n.split("."),n=s.shift();if(s.length){o=i[n]=e.widget.extend({},this.options[n]);for(u=0;u<s.length-1;u++)o[s[u]]=o[s[u]]||{},o=o[s[u]];n=s.pop();if(r===t)return o[n]===t?null:o[n];o[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];i[n]=r}}return this._setOptions(i),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,e==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n){var r,i=this;n?(t=r=e(t),this.bindings=this.bindings.add(t)):(n=t,t=this.element,r=this.widget()),e.each(n,function(n,s){function o(){if(i.options.disabled===!0||e(this).hasClass("ui-state-disabled"))return;return(typeof s=="string"?i[s]:s).apply(i,arguments)}typeof s!="string"&&(o.guid=s.guid=s.guid||o.guid||e.guid++);var u=n.match(/^(\w+)\s*(.*)$/),a=u[1]+i.eventNamespace,f=u[2];f?r.delegate(f,a,o):t.bind(a,o)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return(typeof e=="string"?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent;if(s)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){typeof i=="string"&&(i={effect:i});var o,u=i?i===!0||typeof i=="number"?n:i.effect||n:t;i=i||{},typeof i=="number"&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&(e.effects.effect[u]||e.uiBackCompat!==!1&&e.effects[u])?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}}),e.uiBackCompat!==!1&&(e.Widget.prototype._getCreateOptions=function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]})})(jQuery);(function(e,t){var n=!1;e(document).mouseup(function(e){n=!1}),e.widget("ui.mouse",{version:"1.9.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(n)return;this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var r=this,i=t.which===1,s=typeof this.options.cancel=="string"&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;if(!i||s||!this._mouseCapture(t))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(t)!==!1;if(!this._mouseStarted)return t.preventDefault(),!0}return!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0},_mouseMove:function(t){return!e.ui.ie||document.documentMode>=9||!!t.button?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(e){return this.mouseDelayMet},_mouseStart:function(e){},_mouseDrag:function(e){},_mouseStop:function(e){},_mouseCapture:function(e){return!0}})})(jQuery);(function(e,t){function h(e,t,n){return[parseInt(e[0],10)*(l.test(e[0])?t/100:1),parseInt(e[1],10)*(l.test(e[1])?n/100:1)]}function p(t,n){return parseInt(e.css(t,n),10)||0}e.ui=e.ui||{};var n,r=Math.max,i=Math.abs,s=Math.round,o=/left|center|right/,u=/top|center|bottom/,a=/[\+\-]\d+%?/,f=/^\w+/,l=/%$/,c=e.fn.position;e.position={scrollbarWidth:function(){if(n!==t)return n;var r,i,s=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return e("body").append(s),r=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,r===i&&(i=s[0].clientWidth),s.remove(),n=r-i},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),i=n==="scroll"||n==="auto"&&t.width<t.element[0].scrollWidth,s=r==="scroll"||r==="auto"&&t.height<t.element[0].scrollHeight;return{width:i?e.position.scrollbarWidth():0,height:s?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),r=e.isWindow(n[0]);return{element:n,isWindow:r,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:r?n.width():n.outerWidth(),height:r?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return c.apply(this,arguments);t=e.extend({},t);var n,l,d,v,m,g=e(t.of),y=e.position.getWithinInfo(t.within),b=e.position.getScrollInfo(y),w=g[0],E=(t.collision||"flip").split(" "),S={};return w.nodeType===9?(l=g.width(),d=g.height(),v={top:0,left:0}):e.isWindow(w)?(l=g.width(),d=g.height(),v={top:g.scrollTop(),left:g.scrollLeft()}):w.preventDefault?(t.at="left top",l=d=0,v={top:w.pageY,left:w.pageX}):(l=g.outerWidth(),d=g.outerHeight(),v=g.offset()),m=e.extend({},v),e.each(["my","at"],function(){var e=(t[this]||"").split(" "),n,r;e.length===1&&(e=o.test(e[0])?e.concat(["center"]):u.test(e[0])?["center"].concat(e):["center","center"]),e[0]=o.test(e[0])?e[0]:"center",e[1]=u.test(e[1])?e[1]:"center",n=a.exec(e[0]),r=a.exec(e[1]),S[this]=[n?n[0]:0,r?r[0]:0],t[this]=[f.exec(e[0])[0],f.exec(e[1])[0]]}),E.length===1&&(E[1]=E[0]),t.at[0]==="right"?m.left+=l:t.at[0]==="center"&&(m.left+=l/2),t.at[1]==="bottom"?m.top+=d:t.at[1]==="center"&&(m.top+=d/2),n=h(S.at,l,d),m.left+=n[0],m.top+=n[1],this.each(function(){var o,u,a=e(this),f=a.outerWidth(),c=a.outerHeight(),w=p(this,"marginLeft"),x=p(this,"marginTop"),T=f+w+p(this,"marginRight")+b.width,N=c+x+p(this,"marginBottom")+b.height,C=e.extend({},m),k=h(S.my,a.outerWidth(),a.outerHeight());t.my[0]==="right"?C.left-=f:t.my[0]==="center"&&(C.left-=f/2),t.my[1]==="bottom"?C.top-=c:t.my[1]==="center"&&(C.top-=c/2),C.left+=k[0],C.top+=k[1],e.support.offsetFractions||(C.left=s(C.left),C.top=s(C.top)),o={marginLeft:w,marginTop:x},e.each(["left","top"],function(r,i){e.ui.position[E[r]]&&e.ui.position[E[r]][i](C,{targetWidth:l,targetHeight:d,elemWidth:f,elemHeight:c,collisionPosition:o,collisionWidth:T,collisionHeight:N,offset:[n[0]+k[0],n[1]+k[1]],my:t.my,at:t.at,within:y,elem:a})}),e.fn.bgiframe&&a.bgiframe(),t.using&&(u=function(e){var n=v.left-C.left,s=n+l-f,o=v.top-C.top,u=o+d-c,h={target:{element:g,left:v.left,top:v.top,width:l,height:d},element:{element:a,left:C.left,top:C.top,width:f,height:c},horizontal:s<0?"left":n>0?"right":"center",vertical:u<0?"top":o>0?"bottom":"middle"};l<f&&i(n+s)<l&&(h.horizontal="center"),d<c&&i(o+u)<d&&(h.vertical="middle"),r(i(n),i(s))>r(i(o),i(u))?h.important="horizontal":h.important="vertical",t.using.call(this,e,h)}),a.offset(e.extend(C,{using:u}))})},e.ui.position={fit:{left:function(e,t){var n=t.within,i=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,o=e.left-t.collisionPosition.marginLeft,u=i-o,a=o+t.collisionWidth-s-i,f;t.collisionWidth>s?u>0&&a<=0?(f=e.left+u+t.collisionWidth-s-i,e.left+=u-f):a>0&&u<=0?e.left=i:u>a?e.left=i+s-t.collisionWidth:e.left=i:u>0?e.left+=u:a>0?e.left-=a:e.left=r(e.left-o,e.left)},top:function(e,t){var n=t.within,i=n.isWindow?n.scrollTop:n.offset.top,s=t.within.height,o=e.top-t.collisionPosition.marginTop,u=i-o,a=o+t.collisionHeight-s-i,f;t.collisionHeight>s?u>0&&a<=0?(f=e.top+u+t.collisionHeight-s-i,e.top+=u-f):a>0&&u<=0?e.top=i:u>a?e.top=i+s-t.collisionHeight:e.top=i:u>0?e.top+=u:a>0?e.top-=a:e.top=r(e.top-o,e.top)}},flip:{left:function(e,t){var n=t.within,r=n.offset.left+n.scrollLeft,s=n.width,o=n.isWindow?n.scrollLeft:n.offset.left,u=e.left-t.collisionPosition.marginLeft,a=u-o,f=u+t.collisionWidth-s-o,l=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,c=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,h=-2*t.offset[0],p,d;if(a<0){p=e.left+l+c+h+t.collisionWidth-s-r;if(p<0||p<i(a))e.left+=l+c+h}else if(f>0){d=e.left-t.collisionPosition.marginLeft+l+c+h-o;if(d>0||i(d)<f)e.left+=l+c+h}},top:function(e,t){var n=t.within,r=n.offset.top+n.scrollTop,s=n.height,o=n.isWindow?n.scrollTop:n.offset.top,u=e.top-t.collisionPosition.marginTop,a=u-o,f=u+t.collisionHeight-s-o,l=t.my[1]==="top",c=l?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,h=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,p=-2*t.offset[1],d,v;a<0?(v=e.top+c+h+p+t.collisionHeight-s-r,e.top+c+h+p>a&&(v<0||v<i(a))&&(e.top+=c+h+p)):f>0&&(d=e.top-t.collisionPosition.marginTop+c+h+p-o,e.top+c+h+p>f&&(d>0||i(d)<f)&&(e.top+=c+h+p))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,r,i,s,o=document.getElementsByTagName("body")[0],u=document.createElement("div");t=document.createElement(o?"div":"body"),r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in r)t.style[s]=r[s];t.appendChild(u),n=o||document.documentElement,n.insertBefore(t,n.firstChild),u.style.cssText="position: absolute; left: 10.7432222px;",i=e(u).offset().left,e.support.offsetFractions=i>10&&i<11,t.innerHTML="",n.removeChild(t)}(),e.uiBackCompat!==!1&&function(e){var n=e.fn.position;e.fn.position=function(r){if(!r||!r.offset)return n.call(this,r);var i=r.offset.split(" "),s=r.at.split(" ");return i.length===1&&(i[1]=i[0]),/^\d/.test(i[0])&&(i[0]="+"+i[0]),/^\d/.test(i[1])&&(i[1]="+"+i[1]),s.length===1&&(/left|center|right/.test(s[0])?s[1]="center":(s[1]=s[0],s[0]="center")),n.call(this,e.extend(r,{at:s[0]+i[0]+" "+s[1]+i[1],offset:t}))}}(jQuery)})(jQuery);(function(e,t){e.widget("ui.draggable",e.ui.mouse,{version:"1.9.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),n.containment&&this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute");if(!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";return e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=!1;e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1);var r=this.element[0],i=!1;while(r&&(r=r.parentNode))r==document&&(i=!0);if(!i&&this.options.helper==="original")return!1;if(this.options.revert=="invalid"&&!n||this.options.revert=="valid"&&n||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)){var s=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){s._trigger("stop",t)!==!1&&s._clear()})}else this._trigger("stop",t)!==!1&&this._clear();return!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){var n=!this.options.handle||!e(this.options.handle,this.element).length?!0:!1;return e(this.options.handle,this.element).find("*").andSelf().each(function(){this==t.target&&(n=!0)}),n},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):n.helper=="clone"?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo(n.appendTo=="parent"?this.element[0].parentNode:n.appendTo),r[0]!=this.element[0]&&!/(fixed|absolute)/.test(r.css("position"))&&r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.ui.ie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;t.containment=="parent"&&(t.containment=this.helper[0].parentNode);if(t.containment=="document"||t.containment=="window")this.containment=[t.containment=="document"?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t.containment=="document"?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(t.containment=="document"?0:e(window).scrollLeft())+e(t.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(t.containment=="document"?0:e(window).scrollTop())+(e(t.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(t.containment)&&t.containment.constructor!=Array){var n=e(t.containment),r=n[0];if(!r)return;var i=n.offset(),s=e(r).css("overflow")!="hidden";this.containment=[(parseInt(e(r).css("borderLeftWidth"),10)||0)+(parseInt(e(r).css("paddingLeft"),10)||0),(parseInt(e(r).css("borderTopWidth"),10)||0)+(parseInt(e(r).css("paddingTop"),10)||0),(s?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(e(r).css("borderLeftWidth"),10)||0)-(parseInt(e(r).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(s?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(e(r).css("borderTopWidth"),10)||0)-(parseInt(e(r).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n}else t.containment.constructor==Array&&(this.containment=t.containment)},_convertPositionTo:function(t,n){n||(n=this.position);var r=t=="absolute"?1:-1,i=this.options,s=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(s[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():o?0:s.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():o?0:s.scrollLeft())*r}},_generatePosition:function(t){var n=this.options,r=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(r[0].tagName),s=t.pageX,o=t.pageY;if(this.originalPosition){var u;if(this.containment){if(this.relative_container){var a=this.relative_container.offset();u=[this.containment[0]+a.left,this.containment[1]+a.top,this.containment[2]+a.left,this.containment[3]+a.top]}else u=this.containment;t.pageX-this.offset.click.left<u[0]&&(s=u[0]+this.offset.click.left),t.pageY-this.offset.click.top<u[1]&&(o=u[1]+this.offset.click.top),t.pageX-this.offset.click.left>u[2]&&(s=u[2]+this.offset.click.left),t.pageY-this.offset.click.top>u[3]&&(o=u[3]+this.offset.click.top)}if(n.grid){var f=n.grid[1]?this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1]:this.originalPageY;o=u?f-this.offset.click.top<u[1]||f-this.offset.click.top>u[3]?f-this.offset.click.top<u[1]?f+n.grid[1]:f-n.grid[1]:f:f;var l=n.grid[0]?this.originalPageX+Math.round((s-this.originalPageX)/n.grid[0])*n.grid[0]:this.originalPageX;s=u?l-this.offset.click.left<u[0]||l-this.offset.click.left>u[2]?l-this.offset.click.left<u[0]?l+n.grid[0]:l-n.grid[0]:l:l}}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():i?0:r.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():i?0:r.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r]),t=="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(e){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var r=e(this).data("draggable"),i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[],e(i.connectToSortable).each(function(){var n=e.data(this,"sortable");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n){var r=e(this).data("draggable"),i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,r.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n){var r=e(this).data("draggable"),i=this,s=function(t){var n=this.offset.click.top,r=this.offset.click.left,i=this.positionAbs.top,s=this.positionAbs.left,o=t.height,u=t.width,a=t.top,f=t.left;return e.ui.isOver(i+n,s+r,a,f,o,u)};e.each(r.sortables,function(s){var o=!1,u=this;this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,e.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!=u&&this.instance._intersectsWith(this.instance.containerCache)&&e.ui.contains(u.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n){var r=e("body"),i=e(this).data("draggable").options;r.css("cursor")&&(i._cursor=r.css("cursor")),r.css("cursor",i.cursor)},stop:function(t,n){var r=e(this).data("draggable").options;r._cursor&&e("body").css("cursor",r._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var r=e(n.helper),i=e(this).data("draggable").options;r.css("opacity")&&(i._opacity=r.css("opacity")),r.css("opacity",i.opacity)},stop:function(t,n){var r=e(this).data("draggable").options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(t,n){var r=e(this).data("draggable");r.scrollParent[0]!=document&&r.scrollParent[0].tagName!="HTML"&&(r.overflowOffset=r.scrollParent.offset())},drag:function(t,n){var r=e(this).data("draggable"),i=r.options,s=!1;if(r.scrollParent[0]!=document&&r.scrollParent[0].tagName!="HTML"){if(!i.axis||i.axis!="x")r.overflowOffset.top+r.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-r.overflowOffset.top<i.scrollSensitivity&&(r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop-i.scrollSpeed);if(!i.axis||i.axis!="y")r.overflowOffset.left+r.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-r.overflowOffset.left<i.scrollSensitivity&&(r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft-i.scrollSpeed)}else{if(!i.axis||i.axis!="x")t.pageY-e(document).scrollTop()<i.scrollSensitivity?s=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity&&(s=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed));if(!i.axis||i.axis!="y")t.pageX-e(document).scrollLeft()<i.scrollSensitivity?s=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity&&(s=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed))}s!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(r,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n){var r=e(this).data("draggable"),i=r.options;r.snapElements=[],e(i.snap.constructor!=String?i.snap.items||":data(draggable)":i.snap).each(function(){var t=e(this),n=t.offset();this!=r.element[0]&&r.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})})},drag:function(t,n){var r=e(this).data("draggable"),i=r.options,s=i.snapTolerance,o=n.offset.left,u=o+r.helperProportions.width,a=n.offset.top,f=a+r.helperProportions.height;for(var l=r.snapElements.length-1;l>=0;l--){var c=r.snapElements[l].left,h=c+r.snapElements[l].width,p=r.snapElements[l].top,d=p+r.snapElements[l].height;if(!(c-s<o&&o<h+s&&p-s<a&&a<d+s||c-s<o&&o<h+s&&p-s<f&&f<d+s||c-s<u&&u<h+s&&p-s<a&&a<d+s||c-s<u&&u<h+s&&p-s<f&&f<d+s)){r.snapElements[l].snapping&&r.options.snap.release&&r.options.snap.release.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[l].item})),r.snapElements[l].snapping=!1;continue}if(i.snapMode!="inner"){var v=Math.abs(p-f)<=s,m=Math.abs(d-a)<=s,g=Math.abs(c-u)<=s,y=Math.abs(h-o)<=s;v&&(n.position.top=r._convertPositionTo("relative",{top:p-r.helperProportions.height,left:0}).top-r.margins.top),m&&(n.position.top=r._convertPositionTo("relative",{top:d,left:0}).top-r.margins.top),g&&(n.position.left=r._convertPositionTo("relative",{top:0,left:c-r.helperProportions.width}).left-r.margins.left),y&&(n.position.left=r._convertPositionTo("relative",{top:0,left:h}).left-r.margins.left)}var b=v||m||g||y;if(i.snapMode!="outer"){var v=Math.abs(p-a)<=s,m=Math.abs(d-f)<=s,g=Math.abs(c-o)<=s,y=Math.abs(h-u)<=s;v&&(n.position.top=r._convertPositionTo("relative",{top:p,left:0}).top-r.margins.top),m&&(n.position.top=r._convertPositionTo("relative",{top:d-r.helperProportions.height,left:0}).top-r.margins.top),g&&(n.position.left=r._convertPositionTo("relative",{top:0,left:c}).left-r.margins.left),y&&(n.position.left=r._convertPositionTo("relative",{top:0,left:h-r.helperProportions.width}).left-r.margins.left)}!r.snapElements[l].snapping&&(v||m||g||y||b)&&r.options.snap.snap&&r.options.snap.snap.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[l].item})),r.snapElements[l].snapping=v||m||g||y||b}}}),e.ui.plugin.add("draggable","stack",{start:function(t,n){var r=e(this).data("draggable").options,i=e.makeArray(e(r.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});if(!i.length)return;var s=parseInt(i[0].style.zIndex)||0;e(i).each(function(e){this.style.zIndex=s+e}),this[0].style.zIndex=s+i.length}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var r=e(n.helper),i=e(this).data("draggable").options;r.css("zIndex")&&(i._zIndex=r.css("zIndex")),r.css("zIndex",i.zIndex)},stop:function(t,n){var r=e(this).data("draggable").options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}})})(jQuery);(function(e,t){e.widget("ui.resizable",e.ui.mouse,{version:"1.9.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var t=this,n=this.options;this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!n.aspectRatio,aspectRatio:n.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:n.helper||n.ghost||n.animate?n.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=n.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){this.handles=="all"&&(this.handles="n,e,s,w,se,sw,ne,nw");var r=this.handles.split(",");this.handles={};for(var i=0;i<r.length;i++){var s=e.trim(r[i]),o="ui-resizable-"+s,u=e('<div class="ui-resizable-handle '+o+'"></div>');u.css({zIndex:n.zIndex}),"se"==s&&u.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(u)}}this._renderAxis=function(t){t=t||this.element;for(var n in this.handles){this.handles[n].constructor==String&&(this.handles[n]=e(this.handles[n],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var r=e(this.handles[n],this.element),i=0;i=/sw|ne|nw|se|n|s/.test(n)?r.outerHeight():r.outerWidth();var s=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join("");t.css(s,i),this._proportionallyResize()}if(!e(this.handles[n]).length)continue}},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!t.resizing){if(this.className)var e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);t.axis=e&&e[1]?e[1]:"se"}}),n.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(n.disabled)return;e(this).removeClass("ui-resizable-autohide"),t._handles.show()}).mouseleave(function(){if(n.disabled)return;t.resizing||(e(this).addClass("ui-resizable-autohide"),t._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){t(this.element);var n=this.element;this.originalElement.css({position:n.css("position"),width:n.outerWidth(),height:n.outerHeight(),top:n.css("top"),left:n.css("left")}).insertAfter(n),n.remove()}return this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_mouseCapture:function(t){var n=!1;for(var r in this.handles)e(this.handles[r])[0]==t.target&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var r=this.options,i=this.element.position(),s=this.element;this.resizing=!0,this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()},(s.is(".ui-draggable")||/absolute/.test(s.css("position")))&&s.css({position:"absolute",top:i.top,left:i.left}),this._renderProxy();var o=n(this.helper.css("left")),u=n(this.helper.css("top"));r.containment&&(o+=e(r.containment).scrollLeft()||0,u+=e(r.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:o,top:u},this.size=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalPosition={left:o,top:u},this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio=typeof r.aspectRatio=="number"?r.aspectRatio:this.originalSize.width/this.originalSize.height||1;var a=e(".ui-resizable-"+this.axis).css("cursor");return e("body").css("cursor",a=="auto"?this.axis+"-resize":a),s.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(e){var t=this.helper,n=this.options,r={},i=this,s=this.originalMousePosition,o=this.axis,u=e.pageX-s.left||0,a=e.pageY-s.top||0,f=this._change[o];if(!f)return!1;var l=f.apply(this,[e,u,a]);this._updateVirtualBoundaries(e.shiftKey);if(this._aspectRatio||e.shiftKey)l=this._updateRatio(l,e);return l=this._respectSize(l,e),this._propagate("resize",e),t.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(l),this._trigger("resize",e,this.ui()),!1},_mouseStop:function(t){this.resizing=!1;var n=this.options,r=this;if(this._helper){var i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),o=s&&e.ui.hasScroll(i[0],"left")?0:r.sizeDiff.height,u=s?0:r.sizeDiff.width,a={width:r.helper.width()-u,height:r.helper.height()-o},f=parseInt(r.element.css("left"),10)+(r.position.left-r.originalPosition.left)||null,l=parseInt(r.element.css("top"),10)+(r.position.top-r.originalPosition.top)||null;n.animate||this.element.css(e.extend(a,{top:l,left:f})),r.helper.height(r.size.height),r.helper.width(r.size.width),this._helper&&!n.animate&&this._proportionallyResize()}return e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t=this.options,n,i,s,o,u;u={minWidth:r(t.minWidth)?t.minWidth:0,maxWidth:r(t.maxWidth)?t.maxWidth:Infinity,minHeight:r(t.minHeight)?t.minHeight:0,maxHeight:r(t.maxHeight)?t.maxHeight:Infinity};if(this._aspectRatio||e)n=u.minHeight*this.aspectRatio,s=u.minWidth/this.aspectRatio,i=u.maxHeight*this.aspectRatio,o=u.maxWidth/this.aspectRatio,n>u.minWidth&&(u.minWidth=n),s>u.minHeight&&(u.minHeight=s),i<u.maxWidth&&(u.maxWidth=i),o<u.maxHeight&&(u.maxHeight=o);this._vBoundaries=u},_updateCache:function(e){var t=this.options;this.offset=this.helper.offset(),r(e.left)&&(this.position.left=e.left),r(e.top)&&(this.position.top=e.top),r(e.height)&&(this.size.height=e.height),r(e.width)&&(this.size.width=e.width)},_updateRatio:function(e,t){var n=this.options,i=this.position,s=this.size,o=this.axis;return r(e.height)?e.width=e.height*this.aspectRatio:r(e.width)&&(e.height=e.width/this.aspectRatio),o=="sw"&&(e.left=i.left+(s.width-e.width),e.top=null),o=="nw"&&(e.top=i.top+(s.height-e.height),e.left=i.left+(s.width-e.width)),e},_respectSize:function(e,t){var n=this.helper,i=this._vBoundaries,s=this._aspectRatio||t.shiftKey,o=this.axis,u=r(e.width)&&i.maxWidth&&i.maxWidth<e.width,a=r(e.height)&&i.maxHeight&&i.maxHeight<e.height,f=r(e.width)&&i.minWidth&&i.minWidth>e.width,l=r(e.height)&&i.minHeight&&i.minHeight>e.height;f&&(e.width=i.minWidth),l&&(e.height=i.minHeight),u&&(e.width=i.maxWidth),a&&(e.height=i.maxHeight);var c=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,p=/sw|nw|w/.test(o),d=/nw|ne|n/.test(o);f&&p&&(e.left=c-i.minWidth),u&&p&&(e.left=c-i.maxWidth),l&&d&&(e.top=h-i.minHeight),a&&d&&(e.top=h-i.maxHeight);var v=!e.width&&!e.height;return v&&!e.left&&e.top?e.top=null:v&&!e.top&&e.left&&(e.left=null),e},_proportionallyResize:function(){var t=this.options;if(!this._proportionallyResizeElements.length)return;var n=this.helper||this.element;for(var r=0;r<this._proportionallyResizeElements.length;r++){var i=this._proportionallyResizeElements[r];if(!this.borderDif){var s=[i.css("borderTopWidth"),i.css("borderRightWidth"),i.css("borderBottomWidth"),i.css("borderLeftWidth")],o=[i.css("paddingTop"),i.css("paddingRight"),i.css("paddingBottom"),i.css("paddingLeft")];this.borderDif=e.map(s,function(e,t){var n=parseInt(e,10)||0,r=parseInt(o[t],10)||0;return n+r})}i.css({height:n.height()-this.borderDif[0]-this.borderDif[2]||0,width:n.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset();if(this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var r=e.ui.ie6?1:0,i=e.ui.ie6?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+i,height:this.element.outerHeight()+i,position:"absolute",left:this.elementOffset.left-r+"px",top:this.elementOffset.top-r+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(e,t,n){return{width:this.originalSize.width+t}},w:function(e,t,n){var r=this.options,i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,n){var r=this.options,i=this.originalSize,s=this.originalPosition;return{top:s.top+n,height:i.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},sw:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,r]))},ne:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},nw:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,r]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),t!="resize"&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","alsoResize",{start:function(t,n){var r=e(this).data("resizable"),i=r.options,s=function(t){e(t).each(function(){var t=e(this);t.data("resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};typeof i.alsoResize=="object"&&!i.alsoResize.parentNode?i.alsoResize.length?(i.alsoResize=i.alsoResize[0],s(i.alsoResize)):e.each(i.alsoResize,function(e){s(e)}):s(i.alsoResize)},resize:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.originalSize,o=r.originalPosition,u={height:r.size.height-s.height||0,width:r.size.width-s.width||0,top:r.position.top-o.top||0,left:r.position.left-o.left||0},a=function(t,r){e(t).each(function(){var t=e(this),i=e(this).data("resizable-alsoresize"),s={},o=r&&r.length?r:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var n=(i[t]||0)+(u[t]||0);n&&n>=0&&(s[t]=n||null)}),t.css(s)})};typeof i.alsoResize=="object"&&!i.alsoResize.nodeType?e.each(i.alsoResize,function(e,t){a(e,t)}):a(i.alsoResize)},stop:function(t,n){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","animate",{stop:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r._proportionallyResizeElements,o=s.length&&/textarea/i.test(s[0].nodeName),u=o&&e.ui.hasScroll(s[0],"left")?0:r.sizeDiff.height,a=o?0:r.sizeDiff.width,f={width:r.size.width-a,height:r.size.height-u},l=parseInt(r.element.css("left"),10)+(r.position.left-r.originalPosition.left)||null,c=parseInt(r.element.css("top"),10)+(r.position.top-r.originalPosition.top)||null;r.element.animate(e.extend(f,c&&l?{top:c,left:l}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var n={width:parseInt(r.element.css("width"),10),height:parseInt(r.element.css("height"),10),top:parseInt(r.element.css("top"),10),left:parseInt(r.element.css("left"),10)};s&&s.length&&e(s[0]).css({width:n.width,height:n.height}),r._updateCache(n),r._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(t,r){var i=e(this).data("resizable"),s=i.options,o=i.element,u=s.containment,a=u instanceof e?u.get(0):/parent/.test(u)?o.parent().get(0):u;if(!a)return;i.containerElement=e(a);if(/document/.test(u)||u==document)i.containerOffset={left:0,top:0},i.containerPosition={left:0,top:0},i.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight};else{var f=e(a),l=[];e(["Top","Right","Left","Bottom"]).each(function(e,t){l[e]=n(f.css("padding"+t))}),i.containerOffset=f.offset(),i.containerPosition=f.position(),i.containerSize={height:f.innerHeight()-l[3],width:f.innerWidth()-l[1]};var c=i.containerOffset,h=i.containerSize.height,p=i.containerSize.width,d=e.ui.hasScroll(a,"left")?a.scrollWidth:p,v=e.ui.hasScroll(a)?a.scrollHeight:h;i.parentData={element:a,left:c.left,top:c.top,width:d,height:v}}},resize:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.containerSize,o=r.containerOffset,u=r.size,a=r.position,f=r._aspectRatio||t.shiftKey,l={top:0,left:0},c=r.containerElement;c[0]!=document&&/static/.test(c.css("position"))&&(l=o),a.left<(r._helper?o.left:0)&&(r.size.width=r.size.width+(r._helper?r.position.left-o.left:r.position.left-l.left),f&&(r.size.height=r.size.width/r.aspectRatio),r.position.left=i.helper?o.left:0),a.top<(r._helper?o.top:0)&&(r.size.height=r.size.height+(r._helper?r.position.top-o.top:r.position.top),f&&(r.size.width=r.size.height*r.aspectRatio),r.position.top=r._helper?o.top:0),r.offset.left=r.parentData.left+r.position.left,r.offset.top=r.parentData.top+r.position.top;var h=Math.abs((r._helper?r.offset.left-l.left:r.offset.left-l.left)+r.sizeDiff.width),p=Math.abs((r._helper?r.offset.top-l.top:r.offset.top-o.top)+r.sizeDiff.height),d=r.containerElement.get(0)==r.element.parent().get(0),v=/relative|absolute/.test(r.containerElement.css("position"));d&&v&&(h-=r.parentData.left),h+r.size.width>=r.parentData.width&&(r.size.width=r.parentData.width-h,f&&(r.size.height=r.size.width/r.aspectRatio)),p+r.size.height>=r.parentData.height&&(r.size.height=r.parentData.height-p,f&&(r.size.width=r.size.height*r.aspectRatio))},stop:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.position,o=r.containerOffset,u=r.containerPosition,a=r.containerElement,f=e(r.helper),l=f.offset(),c=f.outerWidth()-r.sizeDiff.width,h=f.outerHeight()-r.sizeDiff.height;r._helper&&!i.animate&&/relative/.test(a.css("position"))&&e(this).css({left:l.left-u.left-o.left,width:c,height:h}),r._helper&&!i.animate&&/static/.test(a.css("position"))&&e(this).css({left:l.left-u.left-o.left,width:c,height:h})}}),e.ui.plugin.add("resizable","ghost",{start:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.size;r.ghost=r.originalElement.clone(),r.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof i.ghost=="string"?i.ghost:""),r.ghost.appendTo(r.helper)},resize:function(t,n){var r=e(this).data("resizable"),i=r.options;r.ghost&&r.ghost.css({position:"relative",height:r.size.height,width:r.size.width})},stop:function(t,n){var r=e(this).data("resizable"),i=r.options;r.ghost&&r.helper&&r.helper.get(0).removeChild(r.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.size,o=r.originalSize,u=r.originalPosition,a=r.axis,f=i._aspectRatio||t.shiftKey;i.grid=typeof i.grid=="number"?[i.grid,i.grid]:i.grid;var l=Math.round((s.width-o.width)/(i.grid[0]||1))*(i.grid[0]||1),c=Math.round((s.height-o.height)/(i.grid[1]||1))*(i.grid[1]||1);/^(se|s|e)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c):/^(ne)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c,r.position.top=u.top-c):/^(sw)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c,r.position.left=u.left-l):(r.size.width=o.width+l,r.size.height=o.height+c,r.position.top=u.top-c,r.position.left=u.left-l)}});var n=function(e){return parseInt(e,10)||0},r=function(e){return!isNaN(parseInt(e,10))}})(jQuery);(function(e,t){e.widget("ui.sortable",e.ui.mouse,{version:"1.9.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?e.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){t==="disabled"?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var r=this;if(this.reverting)return!1;if(this.options.disabled||this.options.type=="static")return!1;this._refreshItems(t);var i=null,s=e(t.target).parents().each(function(){if(e.data(this,r.widgetName+"-item")==r)return i=e(this),!1});e.data(t.target,r.widgetName+"-item")==r&&(i=e(t.target));if(!i)return!1;if(this.options.handle&&!n){var o=!1;e(this.options.handle,i).find("*").andSelf().each(function(){this==t.target&&(o=!0)});if(!o)return!1}return this.currentItem=i,this._removeCurrentsFromItems(),!0},_mouseStart:function(t,n,r){var i=this.options;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),i.containment&&this._setContainment(),i.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",i.cursor)),i.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",i.opacity)),i.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",i.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!r)for(var s=this.containers.length-1;s>=0;s--)this.containers[s]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var n=this.options,r=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<n.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+n.scrollSpeed:t.pageY-this.overflowOffset.top<n.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-n.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<n.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+n.scrollSpeed:t.pageX-this.overflowOffset.left<n.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-n.scrollSpeed)):(t.pageY-e(document).scrollTop()<n.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<n.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+n.scrollSpeed)),t.pageX-e(document).scrollLeft()<n.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<n.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+n.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(var i=this.items.length-1;i>=0;i--){var s=this.items[i],o=s.item[0],u=this._intersectsWithPointer(s);if(!u)continue;if(s.instance!==this.currentContainer)continue;if(o!=this.currentItem[0]&&this.placeholder[u==1?"next":"prev"]()[0]!=o&&!e.contains(this.placeholder[0],o)&&(this.options.type=="semi-dynamic"?!e.contains(this.element[0],o):!0)){this.direction=u==1?"down":"up";if(this.options.tolerance!="pointer"&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(!t)return;e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t);if(this.options.revert){var r=this,i=this.placeholder.offset();this.reverting=!0,e(this.helper).animate({left:i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,n);return!1},cancel:function(){if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[-=_](.+)/);n&&r.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},n.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,s=e.left,o=s+e.width,u=e.top,a=u+e.height,f=this.offset.click.top,l=this.offset.click.left,c=r+f>u&&r+f<a&&t+l>s&&t+l<o;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?c:s<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&u<r+this.helperProportions.height/2&&i-this.helperProportions.height/2<a},_intersectsWithPointer:function(t){var n=this.options.axis==="x"||e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),r=this.options.axis==="y"||e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),i=n&&r,s=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return i?this.floating?o&&o=="right"||s=="down"?2:1:s&&(s=="down"?2:1):!1},_intersectsWithSides:function(t){var n=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),r=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),i=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?s=="right"&&r||s=="left"&&!r:i&&(i=="down"&&n||i=="up"&&!n)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return e!=0&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return e!=0&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor==String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n=[],r=[],i=this._connectWith();if(i&&t)for(var s=i.length-1;s>=0;s--){var o=e(i[s]);for(var u=o.length-1;u>=0;u--){var a=e.data(o[u],this.widgetName);a&&a!=this&&!a.options.disabled&&r.push([e.isFunction(a.options.items)?a.options.items.call(a.element):e(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a])}}r.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var s=r.length-1;s>=0;s--)r[s][0].each(function(){n.push(this)});return e(n)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]==e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n=this.items,r=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],i=this._connectWith();if(i&&this.ready)for(var s=i.length-1;s>=0;s--){var o=e(i[s]);for(var u=o.length-1;u>=0;u--){var a=e.data(o[u],this.widgetName);a&&a!=this&&!a.options.disabled&&(r.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a))}}for(var s=r.length-1;s>=0;s--){var f=r[s][1],l=r[s][0];for(var u=0,c=l.length;u<c;u++){var h=e(l[u]);h.data(this.widgetName+"-item",f),n.push({item:h,instance:f,width:0,height:0,left:0,top:0})}}},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var n=this.items.length-1;n>=0;n--){var r=this.items[n];if(r.instance!=this.currentContainer&&this.currentContainer&&r.item[0]!=this.currentItem[0])continue;var i=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item;t||(r.width=i.outerWidth(),r.height=i.outerHeight());var s=i.offset();r.left=s.left,r.top=s.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var n=this.containers.length-1;n>=0;n--){var s=this.containers[n].element.offset();this.containers[n].containerCache.left=s.left,this.containers[n].containerCache.top=s.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight()}return this},_createPlaceholder:function(t){t=t||this;var n=t.options;if(!n.placeholder||n.placeholder.constructor==String){var r=n.placeholder;n.placeholder={element:function(){var n=e(document.createElement(t.currentItem[0].nodeName)).addClass(r||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return r||(n.style.visibility="hidden"),n},update:function(e,i){if(r&&!n.forcePlaceholderSize)return;i.height()||i.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10))}}}t.placeholder=e(n.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),n.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var n=null,r=null;for(var i=this.containers.length-1;i>=0;i--){if(e.contains(this.currentItem[0],this.containers[i].element[0]))continue;if(this._intersectsWith(this.containers[i].containerCache)){if(n&&e.contains(this.containers[i].element[0],n.element[0]))continue;n=this.containers[i],r=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0)}if(!n)return;if(this.containers.length===1)this.containers[r]._trigger("over",t,this._uiHash(this)),this.containers[r].containerCache.over=1;else{var s=1e4,o=null,u=this.containers[r].floating?"left":"top",a=this.containers[r].floating?"width":"height",f=this.positionAbs[u]+this.offset.click[u];for(var l=this.items.length-1;l>=0;l--){if(!e.contains(this.containers[r].element[0],this.items[l].item[0]))continue;if(this.items[l].item[0]==this.currentItem[0])continue;var c=this.items[l].item.offset()[u],h=!1;Math.abs(c-f)>Math.abs(c+this.items[l][a]-f)&&(h=!0,c+=this.items[l][a]),Math.abs(c-f)<s&&(s=Math.abs(c-f),o=this.items[l],this.direction=h?"up":"down")}if(!o&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[r],o?this._rearrange(t,o,null,!0):this._rearrange(t,null,this.containers[r].element,!0),this._trigger("change",t,this._uiHash()),this.containers[r]._trigger("change",t,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[r]._trigger("over",t,this._uiHash(this)),this.containers[r].containerCache.over=1}},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):n.helper=="clone"?this.currentItem.clone():this.currentItem;return r.parents("body").length||e(n.appendTo!="parent"?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(r[0].style.width==""||n.forceHelperSize)&&r.width(this.currentItem.width()),(r[0].style.height==""||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.ui.ie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;t.containment=="parent"&&(t.containment=this.helper[0].parentNode);if(t.containment=="document"||t.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e(t.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(e(t.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(t.containment)){var n=e(t.containment)[0],r=e(t.containment).offset(),i=e(n).css("overflow")!="hidden";this.containment=[r.left+(parseInt(e(n).css("borderLeftWidth"),10)||0)+(parseInt(e(n).css("paddingLeft"),10)||0)-this.margins.left,r.top+(parseInt(e(n).css("borderTopWidth"),10)||0)+(parseInt(e(n).css("paddingTop"),10)||0)-this.margins.top,r.left+(i?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(e(n).css("borderLeftWidth"),10)||0)-(parseInt(e(n).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,r.top+(i?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(e(n).css("borderTopWidth"),10)||0)-(parseInt(e(n).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(t,n){n||(n=this.position);var r=t=="absolute"?1:-1,i=this.options,s=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(s[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():o?0:s.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():o?0:s.scrollLeft())*r}},_generatePosition:function(t){var n=this.options,r=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(r[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var s=t.pageX,o=t.pageY;if(this.originalPosition){this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top));if(n.grid){var u=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1];o=this.containment?u-this.offset.click.top<this.containment[1]||u-this.offset.click.top>this.containment[3]?u-this.offset.click.top<this.containment[1]?u+n.grid[1]:u-n.grid[1]:u:u;var a=this.originalPageX+Math.round((s-this.originalPageX)/n.grid[0])*n.grid[0];s=this.containment?a-this.offset.click.left<this.containment[0]||a-this.offset.click.left>this.containment[2]?a-this.offset.click.left<this.containment[0]?a+n.grid[0]:a-n.grid[0]:a:a}}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():i?0:r.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():i?0:r.scrollLeft())}},_rearrange:function(e,t,n,r){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i==this.counter&&this.refreshPositions(!r)})},_clear:function(t,n){this.reverting=!1;var r=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var i in this._storedCSS)if(this._storedCSS[i]=="auto"||this._storedCSS[i]=="static")this._storedCSS[i]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!n&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!n&&r.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(n||(r.push(function(e){this._trigger("remove",e,this._uiHash())}),r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer))));for(var i=this.containers.length-1;i>=0;i--)n||r.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(r.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);this._storedCursor&&e("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!n){this._trigger("beforeStop",t,this._uiHash());for(var i=0;i<r.length;i++)r[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}n||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!n){for(var i=0;i<r.length;i++)r[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})})(jQuery);
;
;
/*! lodash.min.js */ 
;
;
/**
* @license
* lodash 3.9.3 (Custom Build) lodash.com/license | Underscore.js 1.8.3 underscorejs.org/LICENSE
* Build: `lodash modern -o ./lodash.js`
*
*/
;(function(){function n(n,t){if(n!==t){var r=null===n,e=n===m,u=n===n,i=null===t,o=t===m,f=t===t;if(n>t&&!i||!u||r&&!o&&f||e&&f)return 1;if(n<t&&!r||!f||i&&!e&&u||o&&u)return-1}return 0}function t(n,t,r){for(var e=n.length,u=r?e:-1;r?u--:++u<e;)if(t(n[u],u,n))return u;return-1}function r(n,t,r){if(t!==t)return s(n,r);r-=1;for(var e=n.length;++r<e;)if(n[r]===t)return r;return-1}function e(n){return typeof n=="function"||false}function u(n){return typeof n=="string"?n:null==n?"":n+""}function i(n,t){for(var r=-1,e=n.length;++r<e&&-1<t.indexOf(n.charAt(r)););
return r}function o(n,t){for(var r=n.length;r--&&-1<t.indexOf(n.charAt(r)););return r}function f(t,r){return n(t.a,r.a)||t.b-r.b}function l(n){return Nn[n]}function a(n){return Ln[n]}function c(n){return"\\"+Mn[n]}function s(n,t,r){var e=n.length;for(t+=r?0:-1;r?t--:++t<e;){var u=n[t];if(u!==u)return t}return-1}function p(n){return!!n&&typeof n=="object"}function h(n){return 160>=n&&9<=n&&13>=n||32==n||160==n||5760==n||6158==n||8192<=n&&(8202>=n||8232==n||8233==n||8239==n||8287==n||12288==n||65279==n);
}function _(n,t){for(var r=-1,e=n.length,u=-1,i=[];++r<e;)n[r]===t&&(n[r]=L,i[++u]=r);return i}function v(n){for(var t=-1,r=n.length;++t<r&&h(n.charCodeAt(t)););return t}function g(n){for(var t=n.length;t--&&h(n.charCodeAt(t)););return t}function y(n){return zn[n]}function d(h){function Nn(n){if(p(n)&&!(Ti(n)||n instanceof Bn)){if(n instanceof zn)return n;if(ru.call(n,"__chain__")&&ru.call(n,"__wrapped__"))return Mr(n)}return new zn(n)}function Ln(){}function zn(n,t,r){this.__wrapped__=n,this.__actions__=r||[],
this.__chain__=!!t}function Bn(n){this.__wrapped__=n,this.__actions__=null,this.__dir__=1,this.__filtered__=false,this.__iteratees__=null,this.__takeCount__=Su,this.__views__=null}function Mn(){this.__data__={}}function Pn(n){var t=n?n.length:0;for(this.data={hash:bu(null),set:new vu};t--;)this.push(n[t])}function qn(n,t){var r=n.data;return(typeof t=="string"||ve(t)?r.set.has(t):r.hash[t])?0:-1}function Dn(n,t){var r=-1,e=n.length;for(t||(t=Me(e));++r<e;)t[r]=n[r];return t}function Kn(n,t){for(var r=-1,e=n.length;++r<e&&false!==t(n[r],r,n););
return n}function Vn(n,t){for(var r=-1,e=n.length;++r<e;)if(!t(n[r],r,n))return false;return true}function Gn(n,t){for(var r=-1,e=n.length,u=-1,i=[];++r<e;){var o=n[r];t(o,r,n)&&(i[++u]=o)}return i}function Jn(n,t){for(var r=-1,e=n.length,u=Me(e);++r<e;)u[r]=t(n[r],r,n);return u}function Xn(n,t,r,e){var u=-1,i=n.length;for(e&&i&&(r=n[++u]);++u<i;)r=t(r,n[u],u,n);return r}function Hn(n,t){for(var r=-1,e=n.length;++r<e;)if(t(n[r],r,n))return true;return false}function Qn(n,t){return n===m?t:n}function nt(n,t,r,e){
return n!==m&&ru.call(e,r)?n:t}function tt(n,t,r){for(var e=-1,u=Ki(t),i=u.length;++e<i;){var o=u[e],f=n[o],l=r(f,t[o],o,n,t);(l===l?l===f:f!==f)&&(f!==m||o in n)||(n[o]=l)}return n}function rt(n,t){return null==t?n:ut(t,Ki(t),n)}function et(n,t){for(var r=-1,e=null==n,u=!e&&Ir(n),i=u?n.length:0,o=t.length,f=Me(o);++r<o;){var l=t[r];f[r]=u?Er(l,i)?n[l]:m:e?m:n[l]}return f}function ut(n,t,r){r||(r={});for(var e=-1,u=t.length;++e<u;){var i=t[e];r[i]=n[i]}return r}function it(n,t,r){var e=typeof n;return"function"==e?t===m?n:Mt(n,t,r):null==n?Fe:"object"==e?xt(n):t===m?Be(n):At(n,t);
}function ot(n,t,r,e,u,i,o){var f;if(r&&(f=u?r(n,e,u):r(n)),f!==m)return f;if(!ve(n))return n;if(e=Ti(n)){if(f=jr(n),!t)return Dn(n,f)}else{var l=uu.call(n),a=l==D;if(l!=V&&l!=z&&(!a||u))return $n[l]?Or(n,l,t):u?n:{};if(f=kr(a?{}:n),!t)return rt(f,n)}for(i||(i=[]),o||(o=[]),u=i.length;u--;)if(i[u]==n)return o[u];return i.push(n),o.push(f),(e?Kn:vt)(n,function(e,u){f[u]=ot(e,t,r,u,n,i,o)}),f}function ft(n,t,r){if(typeof n!="function")throw new Je(N);return gu(function(){n.apply(m,r)},t)}function lt(n,t){
var e=n?n.length:0,u=[];if(!e)return u;var i=-1,o=br(),f=o==r,l=f&&200<=t.length?Vu(t):null,a=t.length;l&&(o=qn,f=false,t=l);n:for(;++i<e;)if(l=n[i],f&&l===l){for(var c=a;c--;)if(t[c]===l)continue n;u.push(l)}else 0>o(t,l,0)&&u.push(l);return u}function at(n,t){var r=true;return Mu(n,function(n,e,u){return r=!!t(n,e,u)}),r}function ct(n,t,r,e){var u=e,i=u;return Mu(n,function(n,o,f){o=+t(n,o,f),(r(o,u)||o===e&&o===i)&&(u=o,i=n)}),i}function st(n,t){var r=[];return Mu(n,function(n,e,u){t(n,e,u)&&r.push(n);
}),r}function pt(n,t,r,e){var u;return r(n,function(n,r,i){return t(n,r,i)?(u=e?r:n,false):void 0}),u}function ht(n,t,r){for(var e=-1,u=n.length,i=-1,o=[];++e<u;){var f=n[e];if(p(f)&&Ir(f)&&(r||Ti(f)||se(f))){t&&(f=ht(f,t,r));for(var l=-1,a=f.length;++l<a;)o[++i]=f[l]}else r||(o[++i]=f)}return o}function _t(n,t){qu(n,t,ke)}function vt(n,t){return qu(n,t,Ki)}function gt(n,t){return Du(n,t,Ki)}function yt(n,t){for(var r=-1,e=t.length,u=-1,i=[];++r<e;){var o=t[r];$i(n[o])&&(i[++u]=o)}return i}function dt(n,t,r){
if(null!=n){r!==m&&r in zr(n)&&(t=[r]),r=0;for(var e=t.length;null!=n&&r<e;)n=n[t[r++]];return r&&r==e?n:m}}function mt(n,t,r,e,u,i){if(n===t)n=true;else if(null==n||null==t||!ve(n)&&!p(t))n=n!==n&&t!==t;else n:{var o=mt,f=Ti(n),l=Ti(t),a=B,c=B;f||(a=uu.call(n),a==z?a=V:a!=V&&(f=we(n))),l||(c=uu.call(t),c==z?c=V:c!=V&&we(t));var s=a==V,l=c==V,c=a==c;if(!c||f||s){if(!e&&(a=s&&ru.call(n,"__wrapped__"),l=l&&ru.call(t,"__wrapped__"),a||l)){n=o(a?n.value():n,l?t.value():t,r,e,u,i);break n}if(c){for(u||(u=[]),
i||(i=[]),a=u.length;a--;)if(u[a]==n){n=i[a]==t;break n}u.push(n),i.push(t),n=(f?gr:dr)(n,t,o,r,e,u,i),u.pop(),i.pop()}else n=false}else n=yr(n,t,a)}return n}function wt(n,t,r){var e=t.length,u=e,i=!r;if(null==n)return!u;for(n=zr(n);e--;){var o=t[e];if(i&&o[2]?o[1]!==n[o[0]]:!(o[0]in n))return false}for(;++e<u;){var o=t[e],f=o[0],l=n[f],a=o[1];if(i&&o[2]){if(l===m&&!(f in n))return false}else if(o=r?r(l,a,f):m,o===m?!mt(a,l,r,true):!o)return false}return true}function bt(n,t){var r=-1,e=Ir(n)?Me(n.length):[];return Mu(n,function(n,u,i){
e[++r]=t(n,u,i)}),e}function xt(n){var t=xr(n);if(1==t.length&&t[0][2]){var r=t[0][0],e=t[0][1];return function(n){return null==n?false:n[r]===e&&(e!==m||r in zr(n))}}return function(n){return wt(n,t)}}function At(n,t){var r=Ti(n),e=Wr(n)&&t===t&&!ve(t),u=n+"";return n=Br(n),function(i){if(null==i)return false;var o=u;if(i=zr(i),!(!r&&e||o in i)){if(i=1==n.length?i:dt(i,Ct(n,0,-1)),null==i)return false;o=Vr(n),i=zr(i)}return i[o]===t?t!==m||o in i:mt(t,i[o],m,true)}}function jt(n,t,r,e,u){if(!ve(n))return n;var i=Ir(t)&&(Ti(t)||we(t)),o=i?null:Ki(t);
return Kn(o||t,function(f,l){if(o&&(l=f,f=t[l]),p(f)){e||(e=[]),u||(u=[]);n:{for(var a=l,c=e,s=u,h=c.length,_=t[a];h--;)if(c[h]==_){n[a]=s[h];break n}var h=n[a],v=r?r(h,_,a,n,t):m,g=v===m;g&&(v=_,Ir(_)&&(Ti(_)||we(_))?v=Ti(h)?h:Ir(h)?Dn(h):[]:Fi(_)||se(_)?v=se(h)?Ae(h):Fi(h)?h:{}:g=false),c.push(_),s.push(v),g?n[a]=jt(v,_,r,c,s):(v===v?v!==h:h===h)&&(n[a]=v)}}else a=n[l],c=r?r(a,f,l,n,t):m,(s=c===m)&&(c=f),c===m&&(!i||l in n)||!s&&(c===c?c===a:a!==a)||(n[l]=c)}),n}function kt(n){return function(t){return null==t?m:t[n];
}}function Ot(n){var t=n+"";return n=Br(n),function(r){return dt(r,n,t)}}function Rt(n,t){for(var r=n?t.length:0;r--;){var e=t[r];if(e!=u&&Er(e)){var u=e;yu.call(n,e,1)}}}function It(n,t){return n+su(Cu()*(t-n+1))}function Et(n,t,r,e,u){return u(n,function(n,u,i){r=e?(e=false,n):t(r,n,u,i)}),r}function Ct(n,t,r){var e=-1,u=n.length;for(t=null==t?0:+t||0,0>t&&(t=-t>u?0:u+t),r=r===m||r>u?u:+r||0,0>r&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0,r=Me(u);++e<u;)r[e]=n[e+t];return r}function Wt(n,t){var r;return Mu(n,function(n,e,u){
return r=t(n,e,u),!r}),!!r}function St(n,t){var r=n.length;for(n.sort(t);r--;)n[r]=n[r].c;return n}function Tt(t,r,e){var u=mr(),i=-1;return r=Jn(r,function(n){return u(n)}),t=bt(t,function(n){return{a:Jn(r,function(t){return t(n)}),b:++i,c:n}}),St(t,function(t,r){var u;n:{u=-1;for(var i=t.a,o=r.a,f=i.length,l=e.length;++u<f;){var a=n(i[u],o[u]);if(a){u=u<l?a*(e[u]?1:-1):a;break n}}u=t.b-r.b}return u})}function Ut(n,t){var r=0;return Mu(n,function(n,e,u){r+=+t(n,e,u)||0}),r}function $t(n,t){var e=-1,u=br(),i=n.length,o=u==r,f=o&&200<=i,l=f?Vu():null,a=[];
l?(u=qn,o=false):(f=false,l=t?[]:a);n:for(;++e<i;){var c=n[e],s=t?t(c,e,n):c;if(o&&c===c){for(var p=l.length;p--;)if(l[p]===s)continue n;t&&l.push(s),a.push(c)}else 0>u(l,s,0)&&((t||f)&&l.push(s),a.push(c))}return a}function Ft(n,t){for(var r=-1,e=t.length,u=Me(e);++r<e;)u[r]=n[t[r]];return u}function Nt(n,t,r,e){for(var u=n.length,i=e?u:-1;(e?i--:++i<u)&&t(n[i],i,n););return r?Ct(n,e?0:i,e?i+1:u):Ct(n,e?i+1:0,e?u:i)}function Lt(n,t){var r=n;r instanceof Bn&&(r=r.value());for(var e=-1,u=t.length;++e<u;){
var r=[r],i=t[e];_u.apply(r,i.args),r=i.func.apply(i.thisArg,r)}return r}function zt(n,t,r){var e=0,u=n?n.length:e;if(typeof t=="number"&&t===t&&u<=Uu){for(;e<u;){var i=e+u>>>1,o=n[i];(r?o<=t:o<t)&&null!==o?e=i+1:u=i}return u}return Bt(n,t,Fe,r)}function Bt(n,t,r,e){t=r(t);for(var u=0,i=n?n.length:0,o=t!==t,f=null===t,l=t===m;u<i;){var a=su((u+i)/2),c=r(n[a]),s=c!==m,p=c===c;(o?p||e:f?p&&s&&(e||null!=c):l?p&&(e||s):null==c?0:e?c<=t:c<t)?u=a+1:i=a}return Ou(i,Tu)}function Mt(n,t,r){if(typeof n!="function")return Fe;
if(t===m)return n;switch(r){case 1:return function(r){return n.call(t,r)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)};case 5:return function(r,e,u,i,o){return n.call(t,r,e,u,i,o)}}return function(){return n.apply(t,arguments)}}function Pt(n){return lu.call(n,0)}function qt(n,t,r){for(var e=r.length,u=-1,i=ku(n.length-e,0),o=-1,f=t.length,l=Me(i+f);++o<f;)l[o]=t[o];for(;++u<e;)l[r[u]]=n[u];for(;i--;)l[o++]=n[u++];return l}function Dt(n,t,r){
for(var e=-1,u=r.length,i=-1,o=ku(n.length-u,0),f=-1,l=t.length,a=Me(o+l);++i<o;)a[i]=n[i];for(o=i;++f<l;)a[o+f]=t[f];for(;++e<u;)a[o+r[e]]=n[i++];return a}function Kt(n,t){return function(r,e,u){var i=t?t():{};if(e=mr(e,u,3),Ti(r)){u=-1;for(var o=r.length;++u<o;){var f=r[u];n(i,f,e(f,u,r),r)}}else Mu(r,function(t,r,u){n(i,t,e(t,r,u),u)});return i}}function Vt(n){return ae(function(t,r){var e=-1,u=null==t?0:r.length,i=2<u?r[u-2]:m,o=2<u?r[2]:m,f=1<u?r[u-1]:m;for(typeof i=="function"?(i=Mt(i,f,5),
u-=2):(i=typeof f=="function"?f:m,u-=i?1:0),o&&Cr(r[0],r[1],o)&&(i=3>u?m:i,u=1);++e<u;)(o=r[e])&&n(t,o,i);return t})}function Yt(n,t){return function(r,e){var u=r?Zu(r):0;if(!Tr(u))return n(r,e);for(var i=t?u:-1,o=zr(r);(t?i--:++i<u)&&false!==e(o[i],i,o););return r}}function Zt(n){return function(t,r,e){var u=zr(t);e=e(t);for(var i=e.length,o=n?i:-1;n?o--:++o<i;){var f=e[o];if(false===r(u[f],f,u))break}return t}}function Gt(n,t){function r(){return(this&&this!==Yn&&this instanceof r?e:n).apply(t,arguments);
}var e=Xt(n);return r}function Jt(n){return function(t){var r=-1;t=Te(Ie(t));for(var e=t.length,u="";++r<e;)u=n(u,t[r],r);return u}}function Xt(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4])}var r=Bu(n.prototype),t=n.apply(r,t);return ve(t)?t:r}}function Ht(n){function t(r,e,u){return u&&Cr(r,e,u)&&(e=null),
r=vr(r,n,null,null,null,null,null,e),r.placeholder=t.placeholder,r}return t}function Qt(n,t){return function(r,e,u){if(u&&Cr(r,e,u)&&(e=null),e=mr(e,u,3),1==e.length){u=r=Lr(r);for(var i=e,o=-1,f=u.length,l=t,a=l;++o<f;){var c=u[o],s=+i(c);n(s,l)&&(l=s,a=c)}if(u=a,!r.length||u!==t)return u}return ct(r,e,n,t)}}function nr(n,r){return function(e,u,i){return u=mr(u,i,3),Ti(e)?(u=t(e,u,r),-1<u?e[u]:m):pt(e,u,n)}}function tr(n){return function(r,e,u){return r&&r.length?(e=mr(e,u,3),t(r,e,n)):-1}}function rr(n){
return function(t,r,e){return r=mr(r,e,3),pt(t,r,n,true)}}function er(n){return function(){for(var t,r=arguments.length,e=n?r:-1,u=0,i=Me(r);n?e--:++e<r;){var o=i[u++]=arguments[e];if(typeof o!="function")throw new Je(N);!t&&zn.prototype.thru&&"wrapper"==wr(o)&&(t=new zn([]))}for(e=t?-1:r;++e<r;){var o=i[e],u=wr(o),f="wrapper"==u?Yu(o):null;t=f&&Sr(f[0])&&f[1]==(I|j|O|E)&&!f[4].length&&1==f[9]?t[wr(f[0])].apply(t,f[3]):1==o.length&&Sr(o)?t[u]():t.thru(o)}return function(){var n=arguments;if(t&&1==n.length&&Ti(n[0]))return t.plant(n[0]).value();
for(var e=0,n=r?i[e].apply(this,n):n[0];++e<r;)n=i[e].call(this,n);return n}}}function ur(n,t){return function(r,e,u){return typeof e=="function"&&u===m&&Ti(r)?n(r,e):t(r,Mt(e,u,3))}}function ir(n){return function(t,r,e){return(typeof r!="function"||e!==m)&&(r=Mt(r,e,3)),n(t,r,ke)}}function or(n){return function(t,r,e){return(typeof r!="function"||e!==m)&&(r=Mt(r,e,3)),n(t,r)}}function fr(n){return function(t,r,e){var u={};return r=mr(r,e,3),vt(t,function(t,e,i){i=r(t,e,i),e=n?i:e,t=n?t:i,u[e]=t}),
u}}function lr(n){return function(t,r,e){return t=u(t),(n?t:"")+pr(t,r,e)+(n?"":t)}}function ar(n){var t=ae(function(r,e){var u=_(e,t.placeholder);return vr(r,n,null,e,u)});return t}function cr(n,t){return function(r,e,u,i){var o=3>arguments.length;return typeof e=="function"&&i===m&&Ti(r)?n(r,e,u,o):Et(r,mr(e,i,4),u,o,t)}}function sr(n,t,r,e,u,i,o,f,l,a){function c(){for(var w=arguments.length,A=w,j=Me(w);A--;)j[A]=arguments[A];if(e&&(j=qt(j,e,u)),i&&(j=Dt(j,i,o)),v||y){var A=c.placeholder,k=_(j,A),w=w-k.length;
if(w<a){var I=f?Dn(f):null,w=ku(a-w,0),E=v?k:null,k=v?null:k,C=v?j:null,j=v?null:j;return t|=v?O:R,t&=~(v?R:O),g||(t&=~(b|x)),j=[n,t,r,C,E,j,k,I,l,w],I=sr.apply(m,j),Sr(n)&&Gu(I,j),I.placeholder=A,I}}if(A=p?r:this,I=h?A[n]:n,f)for(w=j.length,E=Ou(f.length,w),k=Dn(j);E--;)C=f[E],j[E]=Er(C,w)?k[C]:m;return s&&l<j.length&&(j.length=l),this&&this!==Yn&&this instanceof c&&(I=d||Xt(n)),I.apply(A,j)}var s=t&I,p=t&b,h=t&x,v=t&j,g=t&A,y=t&k,d=h?null:Xt(n);return c}function pr(n,t,r){return n=n.length,t=+t,
n<t&&Au(t)?(t-=n,r=null==r?" ":r+"",We(r,au(t/r.length)).slice(0,t)):""}function hr(n,t,r,e){function u(){for(var t=-1,f=arguments.length,l=-1,a=e.length,c=Me(f+a);++l<a;)c[l]=e[l];for(;f--;)c[l++]=arguments[++t];return(this&&this!==Yn&&this instanceof u?o:n).apply(i?r:this,c)}var i=t&b,o=Xt(n);return u}function _r(n){return function(t,r,e,u){var i=mr(e);return null==e&&i===it?zt(t,r,n):Bt(t,r,i(e,u,1),n)}}function vr(n,t,r,e,u,i,o,f){var l=t&x;if(!l&&typeof n!="function")throw new Je(N);var a=e?e.length:0;
if(a||(t&=~(O|R),e=u=null),a-=u?u.length:0,t&R){var c=e,s=u;e=u=null}var p=l?null:Yu(n);return r=[n,t,r,e,u,c,s,i,o,f],p&&(e=r[1],t=p[1],f=e|t,u=t==I&&e==j||t==I&&e==E&&r[7].length<=p[8]||t==(I|E)&&e==j,(f<I||u)&&(t&b&&(r[2]=p[2],f|=e&b?0:A),(e=p[3])&&(u=r[3],r[3]=u?qt(u,e,p[4]):Dn(e),r[4]=u?_(r[3],L):Dn(p[4])),(e=p[5])&&(u=r[5],r[5]=u?Dt(u,e,p[6]):Dn(e),r[6]=u?_(r[5],L):Dn(p[6])),(e=p[7])&&(r[7]=Dn(e)),t&I&&(r[8]=null==r[8]?p[8]:Ou(r[8],p[8])),null==r[9]&&(r[9]=p[9]),r[0]=p[0],r[1]=f),t=r[1],f=r[9]),
r[9]=null==f?l?0:n.length:ku(f-a,0)||0,(p?Ku:Gu)(t==b?Gt(r[0],r[2]):t!=O&&t!=(b|O)||r[4].length?sr.apply(m,r):hr.apply(m,r),r)}function gr(n,t,r,e,u,i,o){var f=-1,l=n.length,a=t.length;if(l!=a&&(!u||a<=l))return false;for(;++f<l;){var c=n[f],a=t[f],s=e?e(u?a:c,u?c:a,f):m;if(s!==m){if(s)continue;return false}if(u){if(!Hn(t,function(n){return c===n||r(c,n,e,u,i,o)}))return false}else if(c!==a&&!r(c,a,e,u,i,o))return false}return true}function yr(n,t,r){switch(r){case M:case P:return+n==+t;case q:return n.name==t.name&&n.message==t.message;
case K:return n!=+n?t!=+t:n==+t;case Y:case Z:return n==t+""}return false}function dr(n,t,r,e,u,i,o){var f=Ki(n),l=f.length,a=Ki(t).length;if(l!=a&&!u)return false;for(a=l;a--;){var c=f[a];if(!(u?c in t:ru.call(t,c)))return false}for(var s=u;++a<l;){var c=f[a],p=n[c],h=t[c],_=e?e(u?h:p,u?p:h,c):m;if(_===m?!r(p,h,e,u,i,o):!_)return false;s||(s="constructor"==c)}return s||(r=n.constructor,e=t.constructor,!(r!=e&&"constructor"in n&&"constructor"in t)||typeof r=="function"&&r instanceof r&&typeof e=="function"&&e instanceof e)?true:false;
}function mr(n,t,r){var e=Nn.callback||Ue,e=e===Ue?it:e;return r?e(n,t,r):e}function wr(n){for(var t=n.name,r=Lu[t],e=r?r.length:0;e--;){var u=r[e],i=u.func;if(null==i||i==n)return u.name}return t}function br(n,t,e){var u=Nn.indexOf||Kr,u=u===Kr?r:u;return n?u(n,t,e):u}function xr(n){n=Oe(n);for(var t=n.length;t--;){var r=n[t][1];n[t][2]=r===r&&!ve(r)}return n}function Ar(n,t){var r=null==n?m:n[t];return ge(r)?r:m}function jr(n){var t=n.length,r=new n.constructor(t);return t&&"string"==typeof n[0]&&ru.call(n,"index")&&(r.index=n.index,
r.input=n.input),r}function kr(n){return n=n.constructor,typeof n=="function"&&n instanceof n||(n=Ye),new n}function Or(n,t,r){var e=n.constructor;switch(t){case G:return Pt(n);case M:case P:return new e(+n);case J:case X:case H:case Q:case nn:case tn:case rn:case en:case un:return t=n.buffer,new e(r?Pt(t):t,n.byteOffset,n.length);case K:case Z:return new e(n);case Y:var u=new e(n.source,jn.exec(n));u.lastIndex=n.lastIndex}return u}function Rr(n,t,r){return null==n||Wr(t,n)||(t=Br(t),n=1==t.length?n:dt(n,Ct(t,0,-1)),
t=Vr(t)),t=null==n?n:n[t],null==t?m:t.apply(n,r)}function Ir(n){return null!=n&&Tr(Zu(n))}function Er(n,t){return n=typeof n=="number"||Rn.test(n)?+n:-1,t=null==t?Fu:t,-1<n&&0==n%1&&n<t}function Cr(n,t,r){if(!ve(r))return false;var e=typeof t;return("number"==e?Ir(r)&&Er(t,r.length):"string"==e&&t in r)?(t=r[t],n===n?n===t:t!==t):false}function Wr(n,t){var r=typeof n;return"string"==r&&yn.test(n)||"number"==r?true:Ti(n)?false:!gn.test(n)||null!=t&&n in zr(t)}function Sr(n){var t=wr(n);return t in Bn.prototype?(t=Nn[t],
n===t?true:(t=Yu(t),!!t&&n===t[0])):false}function Tr(n){return typeof n=="number"&&-1<n&&0==n%1&&n<=Fu}function Ur(n,t){n=zr(n);for(var r=-1,e=t.length,u={};++r<e;){var i=t[r];i in n&&(u[i]=n[i])}return u}function $r(n,t){var r={};return _t(n,function(n,e,u){t(n,e,u)&&(r[e]=n)}),r}function Fr(n){var t;if(!p(n)||uu.call(n)!=V||!(ru.call(n,"constructor")||(t=n.constructor,typeof t!="function"||t instanceof t)))return false;var r;return _t(n,function(n,t){r=t}),r===m||ru.call(n,r)}function Nr(n){for(var t=ke(n),r=t.length,e=r&&n.length,u=!!e&&Tr(e)&&(Ti(n)||se(n)),i=-1,o=[];++i<r;){
var f=t[i];(u&&Er(f,e)||ru.call(n,f))&&o.push(f)}return o}function Lr(n){return null==n?[]:Ir(n)?ve(n)?n:Ye(n):Re(n)}function zr(n){return ve(n)?n:Ye(n)}function Br(n){if(Ti(n))return n;var t=[];return u(n).replace(dn,function(n,r,e,u){t.push(e?u.replace(xn,"$1"):r||n)}),t}function Mr(n){return n instanceof Bn?n.clone():new zn(n.__wrapped__,n.__chain__,Dn(n.__actions__))}function Pr(n,t,r){return n&&n.length?((r?Cr(n,t,r):null==t)&&(t=1),Ct(n,0>t?0:t)):[]}function qr(n,t,r){var e=n?n.length:0;return e?((r?Cr(n,t,r):null==t)&&(t=1),
t=e-(+t||0),Ct(n,0,0>t?0:t)):[]}function Dr(n){return n?n[0]:m}function Kr(n,t,e){var u=n?n.length:0;if(!u)return-1;if(typeof e=="number")e=0>e?ku(u+e,0):e;else if(e)return e=zt(n,t),n=n[e],(t===t?t===n:n!==n)?e:-1;return r(n,t,e||0)}function Vr(n){var t=n?n.length:0;return t?n[t-1]:m}function Yr(n){return Pr(n,1)}function Zr(n,t,e,u){if(!n||!n.length)return[];null!=t&&typeof t!="boolean"&&(u=e,e=Cr(n,t,u)?null:t,t=false);var i=mr();if((null!=e||i!==it)&&(e=i(e,u,3)),t&&br()==r){t=e;var o;e=-1,u=n.length;
for(var i=-1,f=[];++e<u;){var l=n[e],a=t?t(l,e,n):l;e&&o===a||(o=a,f[++i]=l)}n=f}else n=$t(n,e);return n}function Gr(n){if(!n||!n.length)return[];var t=-1,r=0;n=Gn(n,function(n){return Ir(n)?(r=ku(n.length,r),true):void 0});for(var e=Me(r);++t<r;)e[t]=Jn(n,kt(t));return e}function Jr(n,t,r){return n&&n.length?(n=Gr(n),null==t?n:(t=Mt(t,r,4),Jn(n,function(n){return Xn(n,t,m,true)}))):[]}function Xr(n,t){var r=-1,e=n?n.length:0,u={};for(!e||t||Ti(n[0])||(t=[]);++r<e;){var i=n[r];t?u[i]=t[r]:i&&(u[i[0]]=i[1]);
}return u}function Hr(n){return n=Nn(n),n.__chain__=true,n}function Qr(n,t,r){return t.call(r,n)}function ne(n,t,r){var e=Ti(n)?Vn:at;return r&&Cr(n,t,r)&&(t=null),(typeof t!="function"||r!==m)&&(t=mr(t,r,3)),e(n,t)}function te(n,t,r){var e=Ti(n)?Gn:st;return t=mr(t,r,3),e(n,t)}function re(n,t,r,e){var u=n?Zu(n):0;return Tr(u)||(n=Re(n),u=n.length),u?(r=typeof r!="number"||e&&Cr(t,r,e)?0:0>r?ku(u+r,0):r||0,typeof n=="string"||!Ti(n)&&me(n)?r<u&&-1<n.indexOf(t,r):-1<br(n,t,r)):false}function ee(n,t,r){
var e=Ti(n)?Jn:bt;return t=mr(t,r,3),e(n,t)}function ue(n,t,r){if(r?Cr(n,t,r):null==t){n=Lr(n);var e=n.length;return 0<e?n[It(0,e-1)]:m}r=-1,n=xe(n);var e=n.length,u=e-1;for(t=Ou(0>t?0:+t||0,e);++r<t;){var e=It(r,u),i=n[e];n[e]=n[r],n[r]=i}return n.length=t,n}function ie(n,t,r){var e=Ti(n)?Hn:Wt;return r&&Cr(n,t,r)&&(t=null),(typeof t!="function"||r!==m)&&(t=mr(t,r,3)),e(n,t)}function oe(n,t){var r;if(typeof t!="function"){if(typeof n!="function")throw new Je(N);var e=n;n=t,t=e}return function(){
return 0<--n&&(r=t.apply(this,arguments)),1>=n&&(t=null),r}}function fe(n,t,r){function e(){var r=t-(wi()-a);0>=r||r>t?(f&&cu(f),r=p,f=s=p=m,r&&(h=wi(),l=n.apply(c,o),s||f||(o=c=null))):s=gu(e,r)}function u(){s&&cu(s),f=s=p=m,(v||_!==t)&&(h=wi(),l=n.apply(c,o),s||f||(o=c=null))}function i(){if(o=arguments,a=wi(),c=this,p=v&&(s||!g),false===_)var r=g&&!s;else{f||g||(h=a);var i=_-(a-h),y=0>=i||i>_;y?(f&&(f=cu(f)),h=a,l=n.apply(c,o)):f||(f=gu(u,i))}return y&&s?s=cu(s):s||t===_||(s=gu(e,t)),r&&(y=true,l=n.apply(c,o)),
!y||s||f||(o=c=null),l}var o,f,l,a,c,s,p,h=0,_=false,v=true;if(typeof n!="function")throw new Je(N);if(t=0>t?0:+t||0,true===r)var g=true,v=false;else ve(r)&&(g=r.leading,_="maxWait"in r&&ku(+r.maxWait||0,t),v="trailing"in r?r.trailing:v);return i.cancel=function(){s&&cu(s),f&&cu(f),f=s=p=m},i}function le(n,t){function r(){var e=arguments,u=t?t.apply(this,e):e[0],i=r.cache;return i.has(u)?i.get(u):(e=n.apply(this,e),r.cache=i.set(u,e),e)}if(typeof n!="function"||t&&typeof t!="function")throw new Je(N);return r.cache=new le.Cache,
r}function ae(n,t){if(typeof n!="function")throw new Je(N);return t=ku(t===m?n.length-1:+t||0,0),function(){for(var r=arguments,e=-1,u=ku(r.length-t,0),i=Me(u);++e<u;)i[e]=r[t+e];switch(t){case 0:return n.call(this,i);case 1:return n.call(this,r[0],i);case 2:return n.call(this,r[0],r[1],i)}for(u=Me(t+1),e=-1;++e<t;)u[e]=r[e];return u[t]=i,n.apply(this,u)}}function ce(n,t){return n>t}function se(n){return p(n)&&Ir(n)&&uu.call(n)==z}function pe(n){return!!n&&1===n.nodeType&&p(n)&&-1<uu.call(n).indexOf("Element");
}function he(n,t,r,e){return e=(r=typeof r=="function"?Mt(r,e,3):m)?r(n,t):m,e===m?mt(n,t,r):!!e}function _e(n){return p(n)&&typeof n.message=="string"&&uu.call(n)==q}function ve(n){var t=typeof n;return!!n&&("object"==t||"function"==t)}function ge(n){return null==n?false:uu.call(n)==D?ou.test(tu.call(n)):p(n)&&On.test(n)}function ye(n){return typeof n=="number"||p(n)&&uu.call(n)==K}function de(n){return p(n)&&uu.call(n)==Y}function me(n){return typeof n=="string"||p(n)&&uu.call(n)==Z}function we(n){return p(n)&&Tr(n.length)&&!!Un[uu.call(n)];
}function be(n,t){return n<t}function xe(n){var t=n?Zu(n):0;return Tr(t)?t?Dn(n):[]:Re(n)}function Ae(n){return ut(n,ke(n))}function je(n){return yt(n,ke(n))}function ke(n){if(null==n)return[];ve(n)||(n=Ye(n));for(var t=n.length,t=t&&Tr(t)&&(Ti(n)||se(n))&&t||0,r=n.constructor,e=-1,r=typeof r=="function"&&r.prototype===n,u=Me(t),i=0<t;++e<t;)u[e]=e+"";for(var o in n)i&&Er(o,t)||"constructor"==o&&(r||!ru.call(n,o))||u.push(o);return u}function Oe(n){n=zr(n);for(var t=-1,r=Ki(n),e=r.length,u=Me(e);++t<e;){
var i=r[t];u[t]=[i,n[i]]}return u}function Re(n){return Ft(n,Ki(n))}function Ie(n){return(n=u(n))&&n.replace(In,l).replace(bn,"")}function Ee(n){return(n=u(n))&&wn.test(n)?n.replace(mn,"\\$&"):n}function Ce(n,t,r){return r&&Cr(n,t,r)&&(t=0),Eu(n,t)}function We(n,t){var r="";if(n=u(n),t=+t,1>t||!n||!Au(t))return r;do t%2&&(r+=n),t=su(t/2),n+=n;while(t);return r}function Se(n,t,r){var e=n;return(n=u(n))?(r?Cr(e,t,r):null==t)?n.slice(v(n),g(n)+1):(t+="",n.slice(i(n,t),o(n,t)+1)):n}function Te(n,t,r){
return r&&Cr(n,t,r)&&(t=null),n=u(n),n.match(t||Wn)||[]}function Ue(n,t,r){return r&&Cr(n,t,r)&&(t=null),p(n)?Ne(n):it(n,t)}function $e(n){return function(){return n}}function Fe(n){return n}function Ne(n){return xt(ot(n,true))}function Le(n,t,r){if(null==r){var e=ve(t),u=e?Ki(t):null;((u=u&&u.length?yt(t,u):null)?u.length:e)||(u=false,r=t,t=n,n=this)}u||(u=yt(t,Ki(t)));var i=true,e=-1,o=$i(n),f=u.length;false===r?i=false:ve(r)&&"chain"in r&&(i=r.chain);for(;++e<f;){r=u[e];var l=t[r];n[r]=l,o&&(n.prototype[r]=function(t){
return function(){var r=this.__chain__;if(i||r){var e=n(this.__wrapped__);return(e.__actions__=Dn(this.__actions__)).push({func:t,args:arguments,thisArg:n}),e.__chain__=r,e}return r=[this.value()],_u.apply(r,arguments),t.apply(n,r)}}(l))}return n}function ze(){}function Be(n){return Wr(n)?kt(n):Ot(n)}h=h?Zn.defaults(Yn.Object(),h,Zn.pick(Yn,Tn)):Yn;var Me=h.Array,Pe=h.Date,qe=h.Error,De=h.Function,Ke=h.Math,Ve=h.Number,Ye=h.Object,Ze=h.RegExp,Ge=h.String,Je=h.TypeError,Xe=Me.prototype,He=Ye.prototype,Qe=Ge.prototype,nu=(nu=h.window)?nu.document:null,tu=De.prototype.toString,ru=He.hasOwnProperty,eu=0,uu=He.toString,iu=h._,ou=Ze("^"+Ee(tu.call(ru)).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),fu=Ar(h,"ArrayBuffer"),lu=Ar(fu&&new fu(0),"slice"),au=Ke.ceil,cu=h.clearTimeout,su=Ke.floor,pu=Ar(Ye,"getPrototypeOf"),hu=h.parseFloat,_u=Xe.push,vu=Ar(h,"Set"),gu=h.setTimeout,yu=Xe.splice,du=Ar(h,"Uint8Array"),mu=Ar(h,"WeakMap"),wu=function(){
try{var n=Ar(h,"Float64Array"),t=new n(new fu(10),0,1)&&n}catch(r){}return t||null}(),bu=Ar(Ye,"create"),xu=Ar(Me,"isArray"),Au=h.isFinite,ju=Ar(Ye,"keys"),ku=Ke.max,Ou=Ke.min,Ru=Ar(Pe,"now"),Iu=Ar(Ve,"isFinite"),Eu=h.parseInt,Cu=Ke.random,Wu=Ve.NEGATIVE_INFINITY,Su=Ve.POSITIVE_INFINITY,Tu=4294967294,Uu=2147483647,$u=wu?wu.BYTES_PER_ELEMENT:0,Fu=9007199254740991,Nu=mu&&new mu,Lu={},zu=Nn.support={};!function(n){function t(){this.x=n}var r=[];t.prototype={valueOf:n,y:n};for(var e in new t)r.push(e);
try{zu.dom=11===nu.createDocumentFragment().nodeType}catch(u){zu.dom=false}}(1,0),Nn.templateSettings={escape:hn,evaluate:_n,interpolate:vn,variable:"",imports:{_:Nn}};var Bu=function(){function n(){}return function(t){if(ve(t)){n.prototype=t;var r=new n;n.prototype=null}return r||{}}}(),Mu=Yt(vt),Pu=Yt(gt,true),qu=Zt(),Du=Zt(true),Ku=Nu?function(n,t){return Nu.set(n,t),n}:Fe;lu||(Pt=fu&&du?function(n){var t=n.byteLength,r=wu?su(t/$u):0,e=r*$u,u=new fu(t);if(r){var i=new wu(u,0,r);i.set(new wu(n,0,r))}return t!=e&&(i=new du(u,e),
i.set(new du(n,e))),u}:$e(null));var Vu=bu&&vu?function(n){return new Pn(n)}:$e(null),Yu=Nu?function(n){return Nu.get(n)}:ze,Zu=kt("length"),Gu=function(){var n=0,t=0;return function(r,e){var u=wi(),i=T-(u-t);if(t=u,0<i){if(++n>=S)return r}else n=0;return Ku(r,e)}}(),Ju=ae(function(n,t){return Ir(n)?lt(n,ht(t,false,true)):[]}),Xu=tr(),Hu=tr(true),Qu=ae(function(n){for(var t=n.length,e=t,u=Me(c),i=br(),o=i==r,f=[];e--;){var l=n[e]=Ir(l=n[e])?l:[];u[e]=o&&120<=l.length?Vu(e&&l):null}var o=n[0],a=-1,c=o?o.length:0,s=u[0];
n:for(;++a<c;)if(l=o[a],0>(s?qn(s,l):i(f,l,0))){for(e=t;--e;){var p=u[e];if(0>(p?qn(p,l):i(n[e],l,0)))continue n}s&&s.push(l),f.push(l)}return f}),ni=ae(function(t,r){r=ht(r);var e=et(t,r);return Rt(t,r.sort(n)),e}),ti=_r(),ri=_r(true),ei=ae(function(n){return $t(ht(n,false,true))}),ui=ae(function(n,t){return Ir(n)?lt(n,t):[]}),ii=ae(Gr),oi=ae(function(n){var t=n.length,r=2<t?n[t-2]:m,e=1<t?n[t-1]:m;return 2<t&&typeof r=="function"?t-=2:(r=1<t&&typeof e=="function"?(--t,e):m,e=m),n.length=t,Jr(n,r,e)}),fi=ae(function(n,t){
return et(n,ht(t))}),li=Kt(function(n,t,r){ru.call(n,r)?++n[r]:n[r]=1}),ai=nr(Mu),ci=nr(Pu,true),si=ur(Kn,Mu),pi=ur(function(n,t){for(var r=n.length;r--&&false!==t(n[r],r,n););return n},Pu),hi=Kt(function(n,t,r){ru.call(n,r)?n[r].push(t):n[r]=[t]}),_i=Kt(function(n,t,r){n[r]=t}),vi=ae(function(n,t,r){var e=-1,u=typeof t=="function",i=Wr(t),o=Ir(n)?Me(n.length):[];return Mu(n,function(n){var f=u?t:i&&null!=n?n[t]:null;o[++e]=f?f.apply(n,r):Rr(n,t,r)}),o}),gi=Kt(function(n,t,r){n[r?0:1].push(t)},function(){
return[[],[]]}),yi=cr(Xn,Mu),di=cr(function(n,t,r,e){var u=n.length;for(e&&u&&(r=n[--u]);u--;)r=t(r,n[u],u,n);return r},Pu),mi=ae(function(n,t){if(null==n)return[];var r=t[2];return r&&Cr(t[0],t[1],r)&&(t.length=1),Tt(n,ht(t),[])}),wi=Ru||function(){return(new Pe).getTime()},bi=ae(function(n,t,r){var e=b;if(r.length)var u=_(r,bi.placeholder),e=e|O;return vr(n,e,t,r,u)}),xi=ae(function(n,t){t=t.length?ht(t):je(n);for(var r=-1,e=t.length;++r<e;){var u=t[r];n[u]=vr(n[u],b,n)}return n}),Ai=ae(function(n,t,r){
var e=b|x;if(r.length)var u=_(r,Ai.placeholder),e=e|O;return vr(t,e,n,r,u)}),ji=Ht(j),ki=Ht(k),Oi=ae(function(n,t){return ft(n,1,t)}),Ri=ae(function(n,t,r){return ft(n,t,r)}),Ii=er(),Ei=er(true),Ci=ar(O),Wi=ar(R),Si=ae(function(n,t){return vr(n,E,null,null,null,ht(t))}),Ti=xu||function(n){return p(n)&&Tr(n.length)&&uu.call(n)==B};zu.dom||(pe=function(n){return!!n&&1===n.nodeType&&p(n)&&!Fi(n)});var Ui=Iu||function(n){return typeof n=="number"&&Au(n)},$i=e(/x/)||du&&!e(du)?function(n){return uu.call(n)==D;
}:e,Fi=pu?function(n){if(!n||uu.call(n)!=V)return false;var t=Ar(n,"valueOf"),r=t&&(r=pu(t))&&pu(r);return r?n==r||pu(n)==r:Fr(n)}:Fr,Ni=Vt(function(n,t,r){return r?tt(n,t,r):rt(n,t)}),Li=ae(function(n){var t=n[0];return null==t?t:(n.push(Qn),Ni.apply(m,n))}),zi=rr(vt),Bi=rr(gt),Mi=ir(qu),Pi=ir(Du),qi=or(vt),Di=or(gt),Ki=ju?function(n){var t=null==n?null:n.constructor;return typeof t=="function"&&t.prototype===n||typeof n!="function"&&Ir(n)?Nr(n):ve(n)?ju(n):[]}:Nr,Vi=fr(true),Yi=fr(),Zi=Vt(jt),Gi=ae(function(n,t){
if(null==n)return{};if("function"!=typeof t[0])return t=Jn(ht(t),Ge),Ur(n,lt(ke(n),t));var r=Mt(t[0],t[1],3);return $r(n,function(n,t,e){return!r(n,t,e)})}),Ji=ae(function(n,t){return null==n?{}:"function"==typeof t[0]?$r(n,Mt(t[0],t[1],3)):Ur(n,ht(t))}),Xi=Jt(function(n,t,r){return t=t.toLowerCase(),n+(r?t.charAt(0).toUpperCase()+t.slice(1):t)}),Hi=Jt(function(n,t,r){return n+(r?"-":"")+t.toLowerCase()}),Qi=lr(),no=lr(true);8!=Eu(Sn+"08")&&(Ce=function(n,t,r){return(r?Cr(n,t,r):null==t)?t=0:t&&(t=+t),
n=Se(n),Eu(n,t||(kn.test(n)?16:10))});var to=Jt(function(n,t,r){return n+(r?"_":"")+t.toLowerCase()}),ro=Jt(function(n,t,r){return n+(r?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))}),eo=ae(function(n,t){try{return n.apply(m,t)}catch(r){return _e(r)?r:new qe(r)}}),uo=ae(function(n,t){return function(r){return Rr(r,n,t)}}),io=ae(function(n,t){return function(r){return Rr(n,r,t)}}),oo=Qt(ce,Wu),fo=Qt(be,Su);return Nn.prototype=Ln.prototype,zn.prototype=Bu(Ln.prototype),zn.prototype.constructor=zn,
Bn.prototype=Bu(Ln.prototype),Bn.prototype.constructor=Bn,Mn.prototype["delete"]=function(n){return this.has(n)&&delete this.__data__[n]},Mn.prototype.get=function(n){return"__proto__"==n?m:this.__data__[n]},Mn.prototype.has=function(n){return"__proto__"!=n&&ru.call(this.__data__,n)},Mn.prototype.set=function(n,t){return"__proto__"!=n&&(this.__data__[n]=t),this},Pn.prototype.push=function(n){var t=this.data;typeof n=="string"||ve(n)?t.set.add(n):t.hash[n]=true},le.Cache=Mn,Nn.after=function(n,t){if(typeof t!="function"){
if(typeof n!="function")throw new Je(N);var r=n;n=t,t=r}return n=Au(n=+n)?n:0,function(){return 1>--n?t.apply(this,arguments):void 0}},Nn.ary=function(n,t,r){return r&&Cr(n,t,r)&&(t=null),t=n&&null==t?n.length:ku(+t||0,0),vr(n,I,null,null,null,null,t)},Nn.assign=Ni,Nn.at=fi,Nn.before=oe,Nn.bind=bi,Nn.bindAll=xi,Nn.bindKey=Ai,Nn.callback=Ue,Nn.chain=Hr,Nn.chunk=function(n,t,r){t=(r?Cr(n,t,r):null==t)?1:ku(+t||1,1),r=0;for(var e=n?n.length:0,u=-1,i=Me(au(e/t));r<e;)i[++u]=Ct(n,r,r+=t);return i},Nn.compact=function(n){
for(var t=-1,r=n?n.length:0,e=-1,u=[];++t<r;){var i=n[t];i&&(u[++e]=i)}return u},Nn.constant=$e,Nn.countBy=li,Nn.create=function(n,t,r){var e=Bu(n);return r&&Cr(n,t,r)&&(t=null),t?rt(e,t):e},Nn.curry=ji,Nn.curryRight=ki,Nn.debounce=fe,Nn.defaults=Li,Nn.defer=Oi,Nn.delay=Ri,Nn.difference=Ju,Nn.drop=Pr,Nn.dropRight=qr,Nn.dropRightWhile=function(n,t,r){return n&&n.length?Nt(n,mr(t,r,3),true,true):[]},Nn.dropWhile=function(n,t,r){return n&&n.length?Nt(n,mr(t,r,3),true):[]},Nn.fill=function(n,t,r,e){var u=n?n.length:0;
if(!u)return[];for(r&&typeof r!="number"&&Cr(n,t,r)&&(r=0,e=u),u=n.length,r=null==r?0:+r||0,0>r&&(r=-r>u?0:u+r),e=e===m||e>u?u:+e||0,0>e&&(e+=u),u=r>e?0:e>>>0,r>>>=0;r<u;)n[r++]=t;return n},Nn.filter=te,Nn.flatten=function(n,t,r){var e=n?n.length:0;return r&&Cr(n,t,r)&&(t=false),e?ht(n,t):[]},Nn.flattenDeep=function(n){return n&&n.length?ht(n,true):[]},Nn.flow=Ii,Nn.flowRight=Ei,Nn.forEach=si,Nn.forEachRight=pi,Nn.forIn=Mi,Nn.forInRight=Pi,Nn.forOwn=qi,Nn.forOwnRight=Di,Nn.functions=je,Nn.groupBy=hi,Nn.indexBy=_i,
Nn.initial=function(n){return qr(n,1)},Nn.intersection=Qu,Nn.invert=function(n,t,r){r&&Cr(n,t,r)&&(t=null),r=-1;for(var e=Ki(n),u=e.length,i={};++r<u;){var o=e[r],f=n[o];t?ru.call(i,f)?i[f].push(o):i[f]=[o]:i[f]=o}return i},Nn.invoke=vi,Nn.keys=Ki,Nn.keysIn=ke,Nn.map=ee,Nn.mapKeys=Vi,Nn.mapValues=Yi,Nn.matches=Ne,Nn.matchesProperty=function(n,t){return At(n,ot(t,true))},Nn.memoize=le,Nn.merge=Zi,Nn.method=uo,Nn.methodOf=io,Nn.mixin=Le,Nn.negate=function(n){if(typeof n!="function")throw new Je(N);return function(){
return!n.apply(this,arguments)}},Nn.omit=Gi,Nn.once=function(n){return oe(2,n)},Nn.pairs=Oe,Nn.partial=Ci,Nn.partialRight=Wi,Nn.partition=gi,Nn.pick=Ji,Nn.pluck=function(n,t){return ee(n,Be(t))},Nn.property=Be,Nn.propertyOf=function(n){return function(t){return dt(n,Br(t),t+"")}},Nn.pull=function(){var n=arguments,t=n[0];if(!t||!t.length)return t;for(var r=0,e=br(),u=n.length;++r<u;)for(var i=0,o=n[r];-1<(i=e(t,o,i));)yu.call(t,i,1);return t},Nn.pullAt=ni,Nn.range=function(n,t,r){r&&Cr(n,t,r)&&(t=r=null),
n=+n||0,r=null==r?1:+r||0,null==t?(t=n,n=0):t=+t||0;var e=-1;t=ku(au((t-n)/(r||1)),0);for(var u=Me(t);++e<t;)u[e]=n,n+=r;return u},Nn.rearg=Si,Nn.reject=function(n,t,r){var e=Ti(n)?Gn:st;return t=mr(t,r,3),e(n,function(n,r,e){return!t(n,r,e)})},Nn.remove=function(n,t,r){var e=[];if(!n||!n.length)return e;var u=-1,i=[],o=n.length;for(t=mr(t,r,3);++u<o;)r=n[u],t(r,u,n)&&(e.push(r),i.push(u));return Rt(n,i),e},Nn.rest=Yr,Nn.restParam=ae,Nn.set=function(n,t,r){if(null==n)return n;var e=t+"";t=null!=n[e]||Wr(t,n)?[e]:Br(t);
for(var e=-1,u=t.length,i=u-1,o=n;null!=o&&++e<u;){var f=t[e];ve(o)&&(e==i?o[f]=r:null==o[f]&&(o[f]=Er(t[e+1])?[]:{})),o=o[f]}return n},Nn.shuffle=function(n){return ue(n,Su)},Nn.slice=function(n,t,r){var e=n?n.length:0;return e?(r&&typeof r!="number"&&Cr(n,t,r)&&(t=0,r=e),Ct(n,t,r)):[]},Nn.sortBy=function(n,t,r){if(null==n)return[];r&&Cr(n,t,r)&&(t=null);var e=-1;return t=mr(t,r,3),n=bt(n,function(n,r,u){return{a:t(n,r,u),b:++e,c:n}}),St(n,f)},Nn.sortByAll=mi,Nn.sortByOrder=function(n,t,r,e){return null==n?[]:(e&&Cr(t,r,e)&&(r=null),
Ti(t)||(t=null==t?[]:[t]),Ti(r)||(r=null==r?[]:[r]),Tt(n,t,r))},Nn.spread=function(n){if(typeof n!="function")throw new Je(N);return function(t){return n.apply(this,t)}},Nn.take=function(n,t,r){return n&&n.length?((r?Cr(n,t,r):null==t)&&(t=1),Ct(n,0,0>t?0:t)):[]},Nn.takeRight=function(n,t,r){var e=n?n.length:0;return e?((r?Cr(n,t,r):null==t)&&(t=1),t=e-(+t||0),Ct(n,0>t?0:t)):[]},Nn.takeRightWhile=function(n,t,r){return n&&n.length?Nt(n,mr(t,r,3),false,true):[]},Nn.takeWhile=function(n,t,r){return n&&n.length?Nt(n,mr(t,r,3)):[];
},Nn.tap=function(n,t,r){return t.call(r,n),n},Nn.throttle=function(n,t,r){var e=true,u=true;if(typeof n!="function")throw new Je(N);return false===r?e=false:ve(r)&&(e="leading"in r?!!r.leading:e,u="trailing"in r?!!r.trailing:u),Fn.leading=e,Fn.maxWait=+t,Fn.trailing=u,fe(n,t,Fn)},Nn.thru=Qr,Nn.times=function(n,t,r){if(n=su(n),1>n||!Au(n))return[];var e=-1,u=Me(Ou(n,4294967295));for(t=Mt(t,r,1);++e<n;)4294967295>e?u[e]=t(e):t(e);return u},Nn.toArray=xe,Nn.toPlainObject=Ae,Nn.transform=function(n,t,r,e){var u=Ti(n)||we(n);
return t=mr(t,e,4),null==r&&(u||ve(n)?(e=n.constructor,r=u?Ti(n)?new e:[]:Bu($i(e)?e.prototype:null)):r={}),(u?Kn:vt)(n,function(n,e,u){return t(r,n,e,u)}),r},Nn.union=ei,Nn.uniq=Zr,Nn.unzip=Gr,Nn.unzipWith=Jr,Nn.values=Re,Nn.valuesIn=function(n){return Ft(n,ke(n))},Nn.where=function(n,t){return te(n,xt(t))},Nn.without=ui,Nn.wrap=function(n,t){return t=null==t?Fe:t,vr(t,O,null,[n],[])},Nn.xor=function(){for(var n=-1,t=arguments.length;++n<t;){var r=arguments[n];if(Ir(r))var e=e?lt(e,r).concat(lt(r,e)):r;
}return e?$t(e):[]},Nn.zip=ii,Nn.zipObject=Xr,Nn.zipWith=oi,Nn.backflow=Ei,Nn.collect=ee,Nn.compose=Ei,Nn.each=si,Nn.eachRight=pi,Nn.extend=Ni,Nn.iteratee=Ue,Nn.methods=je,Nn.object=Xr,Nn.select=te,Nn.tail=Yr,Nn.unique=Zr,Le(Nn,Nn),Nn.add=function(n,t){return(+n||0)+(+t||0)},Nn.attempt=eo,Nn.camelCase=Xi,Nn.capitalize=function(n){return(n=u(n))&&n.charAt(0).toUpperCase()+n.slice(1)},Nn.clone=function(n,t,r,e){return t&&typeof t!="boolean"&&Cr(n,t,r)?t=false:typeof t=="function"&&(e=r,r=t,t=false),typeof r=="function"?ot(n,t,Mt(r,e,1)):ot(n,t);
},Nn.cloneDeep=function(n,t,r){return typeof t=="function"?ot(n,true,Mt(t,r,1)):ot(n,true)},Nn.deburr=Ie,Nn.endsWith=function(n,t,r){n=u(n),t+="";var e=n.length;return r=r===m?e:Ou(0>r?0:+r||0,e),r-=t.length,0<=r&&n.indexOf(t,r)==r},Nn.escape=function(n){return(n=u(n))&&pn.test(n)?n.replace(cn,a):n},Nn.escapeRegExp=Ee,Nn.every=ne,Nn.find=ai,Nn.findIndex=Xu,Nn.findKey=zi,Nn.findLast=ci,Nn.findLastIndex=Hu,Nn.findLastKey=Bi,Nn.findWhere=function(n,t){return ai(n,xt(t))},Nn.first=Dr,Nn.get=function(n,t,r){
return n=null==n?m:dt(n,Br(t),t+""),n===m?r:n},Nn.gt=ce,Nn.gte=function(n,t){return n>=t},Nn.has=function(n,t){if(null==n)return false;var r=ru.call(n,t);if(!r&&!Wr(t)){if(t=Br(t),n=1==t.length?n:dt(n,Ct(t,0,-1)),null==n)return false;t=Vr(t),r=ru.call(n,t)}return r||Tr(n.length)&&Er(t,n.length)&&(Ti(n)||se(n))},Nn.identity=Fe,Nn.includes=re,Nn.indexOf=Kr,Nn.inRange=function(n,t,r){return t=+t||0,"undefined"===typeof r?(r=t,t=0):r=+r||0,n>=Ou(t,r)&&n<ku(t,r)},Nn.isArguments=se,Nn.isArray=Ti,Nn.isBoolean=function(n){
return true===n||false===n||p(n)&&uu.call(n)==M},Nn.isDate=function(n){return p(n)&&uu.call(n)==P},Nn.isElement=pe,Nn.isEmpty=function(n){return null==n?true:Ir(n)&&(Ti(n)||me(n)||se(n)||p(n)&&$i(n.splice))?!n.length:!Ki(n).length},Nn.isEqual=he,Nn.isError=_e,Nn.isFinite=Ui,Nn.isFunction=$i,Nn.isMatch=function(n,t,r,e){return r=typeof r=="function"?Mt(r,e,3):m,wt(n,xr(t),r)},Nn.isNaN=function(n){return ye(n)&&n!=+n},Nn.isNative=ge,Nn.isNull=function(n){return null===n},Nn.isNumber=ye,Nn.isObject=ve,Nn.isPlainObject=Fi,
Nn.isRegExp=de,Nn.isString=me,Nn.isTypedArray=we,Nn.isUndefined=function(n){return n===m},Nn.kebabCase=Hi,Nn.last=Vr,Nn.lastIndexOf=function(n,t,r){var e=n?n.length:0;if(!e)return-1;var u=e;if(typeof r=="number")u=(0>r?ku(e+r,0):Ou(r||0,e-1))+1;else if(r)return u=zt(n,t,true)-1,n=n[u],(t===t?t===n:n!==n)?u:-1;if(t!==t)return s(n,u,true);for(;u--;)if(n[u]===t)return u;return-1},Nn.lt=be,Nn.lte=function(n,t){return n<=t},Nn.max=oo,Nn.min=fo,Nn.noConflict=function(){return h._=iu,this},Nn.noop=ze,Nn.now=wi,
Nn.pad=function(n,t,r){n=u(n),t=+t;var e=n.length;return e<t&&Au(t)?(e=(t-e)/2,t=su(e),e=au(e),r=pr("",e,r),r.slice(0,t)+n+r):n},Nn.padLeft=Qi,Nn.padRight=no,Nn.parseInt=Ce,Nn.random=function(n,t,r){r&&Cr(n,t,r)&&(t=r=null);var e=null==n,u=null==t;return null==r&&(u&&typeof n=="boolean"?(r=n,n=1):typeof t=="boolean"&&(r=t,u=true)),e&&u&&(t=1,u=false),n=+n||0,u?(t=n,n=0):t=+t||0,r||n%1||t%1?(r=Cu(),Ou(n+r*(t-n+hu("1e-"+((r+"").length-1))),t)):It(n,t)},Nn.reduce=yi,Nn.reduceRight=di,Nn.repeat=We,Nn.result=function(n,t,r){
var e=null==n?m:n[t];return e===m&&(null==n||Wr(t,n)||(t=Br(t),n=1==t.length?n:dt(n,Ct(t,0,-1)),e=null==n?m:n[Vr(t)]),e=e===m?r:e),$i(e)?e.call(n):e},Nn.runInContext=d,Nn.size=function(n){var t=n?Zu(n):0;return Tr(t)?t:Ki(n).length},Nn.snakeCase=to,Nn.some=ie,Nn.sortedIndex=ti,Nn.sortedLastIndex=ri,Nn.startCase=ro,Nn.startsWith=function(n,t,r){return n=u(n),r=null==r?0:Ou(0>r?0:+r||0,n.length),n.lastIndexOf(t,r)==r},Nn.sum=function(n,t,r){r&&Cr(n,t,r)&&(t=null);var e=mr(),u=null==t;if(u&&e===it||(u=false,
t=e(t,r,3)),u){for(n=Ti(n)?n:Lr(n),t=n.length,r=0;t--;)r+=+n[t]||0;n=r}else n=Ut(n,t);return n},Nn.template=function(n,t,r){var e=Nn.templateSettings;r&&Cr(n,t,r)&&(t=r=null),n=u(n),t=tt(rt({},r||t),e,nt),r=tt(rt({},t.imports),e.imports,nt);var i,o,f=Ki(r),l=Ft(r,f),a=0;r=t.interpolate||En;var s="__p+='";r=Ze((t.escape||En).source+"|"+r.source+"|"+(r===vn?An:En).source+"|"+(t.evaluate||En).source+"|$","g");var p="sourceURL"in t?"//# sourceURL="+t.sourceURL+"\n":"";if(n.replace(r,function(t,r,e,u,f,l){
return e||(e=u),s+=n.slice(a,l).replace(Cn,c),r&&(i=true,s+="'+__e("+r+")+'"),f&&(o=true,s+="';"+f+";\n__p+='"),e&&(s+="'+((__t=("+e+"))==null?'':__t)+'"),a=l+t.length,t}),s+="';",(t=t.variable)||(s="with(obj){"+s+"}"),s=(o?s.replace(on,""):s).replace(fn,"$1").replace(ln,"$1;"),s="function("+(t||"obj")+"){"+(t?"":"obj||(obj={});")+"var __t,__p=''"+(i?",__e=_.escape":"")+(o?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+s+"return __p}",t=eo(function(){return De(f,p+"return "+s).apply(m,l);
}),t.source=s,_e(t))throw t;return t},Nn.trim=Se,Nn.trimLeft=function(n,t,r){var e=n;return(n=u(n))?n.slice((r?Cr(e,t,r):null==t)?v(n):i(n,t+"")):n},Nn.trimRight=function(n,t,r){var e=n;return(n=u(n))?(r?Cr(e,t,r):null==t)?n.slice(0,g(n)+1):n.slice(0,o(n,t+"")+1):n},Nn.trunc=function(n,t,r){r&&Cr(n,t,r)&&(t=null);var e=C;if(r=W,null!=t)if(ve(t)){var i="separator"in t?t.separator:i,e="length"in t?+t.length||0:e;r="omission"in t?u(t.omission):r}else e=+t||0;if(n=u(n),e>=n.length)return n;if(e-=r.length,
1>e)return r;if(t=n.slice(0,e),null==i)return t+r;if(de(i)){if(n.slice(e).search(i)){var o,f=n.slice(0,e);for(i.global||(i=Ze(i.source,(jn.exec(i)||"")+"g")),i.lastIndex=0;n=i.exec(f);)o=n.index;t=t.slice(0,null==o?e:o)}}else n.indexOf(i,e)!=e&&(i=t.lastIndexOf(i),-1<i&&(t=t.slice(0,i)));return t+r},Nn.unescape=function(n){return(n=u(n))&&sn.test(n)?n.replace(an,y):n},Nn.uniqueId=function(n){var t=++eu;return u(n)+t},Nn.words=Te,Nn.all=ne,Nn.any=ie,Nn.contains=re,Nn.eq=he,Nn.detect=ai,Nn.foldl=yi,
Nn.foldr=di,Nn.head=Dr,Nn.include=re,Nn.inject=yi,Le(Nn,function(){var n={};return vt(Nn,function(t,r){Nn.prototype[r]||(n[r]=t)}),n}(),false),Nn.sample=ue,Nn.prototype.sample=function(n){return this.__chain__||null!=n?this.thru(function(t){return ue(t,n)}):ue(this.value())},Nn.VERSION=w,Kn("bind bindKey curry curryRight partial partialRight".split(" "),function(n){Nn[n].placeholder=Nn}),Kn(["dropWhile","filter","map","takeWhile"],function(n,t){var r=t!=F,e=t==U;Bn.prototype[n]=function(n,u){var i=this.__filtered__,o=i&&e?new Bn(this):this.clone();
return(o.__iteratees__||(o.__iteratees__=[])).push({done:false,count:0,index:0,iteratee:mr(n,u,1),limit:-1,type:t}),o.__filtered__=i||r,o}}),Kn(["drop","take"],function(n,t){var r=n+"While";Bn.prototype[n]=function(r){var e=this.__filtered__,u=e&&!t?this.dropWhile():this.clone();return r=null==r?1:ku(su(r)||0,0),e?t?u.__takeCount__=Ou(u.__takeCount__,r):Vr(u.__iteratees__).limit=r:(u.__views__||(u.__views__=[])).push({size:r,type:n+(0>u.__dir__?"Right":"")}),u},Bn.prototype[n+"Right"]=function(t){return this.reverse()[n](t).reverse();
},Bn.prototype[n+"RightWhile"]=function(n,t){return this.reverse()[r](n,t).reverse()}}),Kn(["first","last"],function(n,t){var r="take"+(t?"Right":"");Bn.prototype[n]=function(){return this[r](1).value()[0]}}),Kn(["initial","rest"],function(n,t){var r="drop"+(t?"":"Right");Bn.prototype[n]=function(){return this[r](1)}}),Kn(["pluck","where"],function(n,t){var r=t?"filter":"map",e=t?xt:Be;Bn.prototype[n]=function(n){return this[r](e(n))}}),Bn.prototype.compact=function(){return this.filter(Fe)},Bn.prototype.reject=function(n,t){
return n=mr(n,t,1),this.filter(function(t){return!n(t)})},Bn.prototype.slice=function(n,t){n=null==n?0:+n||0;var r=this;return 0>n?r=this.takeRight(-n):n&&(r=this.drop(n)),t!==m&&(t=+t||0,r=0>t?r.dropRight(-t):r.take(t-n)),r},Bn.prototype.toArray=function(){return this.drop(0)},vt(Bn.prototype,function(n,t){var r=Nn[t];if(r){var e=/^(?:filter|map|reject)|While$/.test(t),u=/^(?:first|last)$/.test(t);Nn.prototype[t]=function(){function t(n){return n=[n],_u.apply(n,i),r.apply(Nn,n)}var i=arguments,o=this.__chain__,f=this.__wrapped__,l=!!this.__actions__.length,a=f instanceof Bn,c=i[0],s=a||Ti(f);
return s&&e&&typeof c=="function"&&1!=c.length&&(a=s=false),a=a&&!l,u&&!o?a?n.call(f):r.call(Nn,this.value()):s?(f=n.apply(a?f:new Bn(this),i),u||!l&&!f.__actions__||(f.__actions__||(f.__actions__=[])).push({func:Qr,args:[t],thisArg:Nn}),new zn(f,o)):this.thru(t)}}}),Kn("concat join pop push replace shift sort splice split unshift".split(" "),function(n){var t=(/^(?:replace|split)$/.test(n)?Qe:Xe)[n],r=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",e=/^(?:join|pop|replace|shift)$/.test(n);Nn.prototype[n]=function(){
var n=arguments;return e&&!this.__chain__?t.apply(this.value(),n):this[r](function(r){return t.apply(r,n)})}}),vt(Bn.prototype,function(n,t){var r=Nn[t];if(r){var e=r.name;(Lu[e]||(Lu[e]=[])).push({name:t,func:r})}}),Lu[sr(null,x).name]=[{name:"wrapper",func:null}],Bn.prototype.clone=function(){var n=this.__actions__,t=this.__iteratees__,r=this.__views__,e=new Bn(this.__wrapped__);return e.__actions__=n?Dn(n):null,e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=t?Dn(t):null,
e.__takeCount__=this.__takeCount__,e.__views__=r?Dn(r):null,e},Bn.prototype.reverse=function(){if(this.__filtered__){var n=new Bn(this);n.__dir__=-1,n.__filtered__=true}else n=this.clone(),n.__dir__*=-1;return n},Bn.prototype.value=function(){var n=this.__wrapped__.value();if(!Ti(n))return Lt(n,this.__actions__);var t,r=this.__dir__,e=0>r;t=n.length;for(var u=this.__views__,i=0,o=-1,f=u?u.length:0;++o<f;){var l=u[o],a=l.size;switch(l.type){case"drop":i+=a;break;case"dropRight":t-=a;break;case"take":
t=Ou(t,i+a);break;case"takeRight":i=ku(i,t-a)}}t={start:i,end:t},u=t.start,i=t.end,t=i-u,u=e?i:u-1,i=Ou(t,this.__takeCount__),f=(o=this.__iteratees__)?o.length:0,l=0,a=[];n:for(;t--&&l<i;){for(var u=u+r,c=-1,s=n[u];++c<f;){var p=o[c],h=p.iteratee,_=p.type;if(_==U){if(p.done&&(e?u>p.index:u<p.index)&&(p.count=0,p.done=false),p.index=u,!(p.done||(_=p.limit,p.done=-1<_?p.count++>=_:!h(s))))continue n}else if(p=h(s),_==F)s=p;else if(!p){if(_==$)continue n;break n}}a[l++]=s}return a},Nn.prototype.chain=function(){
return Hr(this)},Nn.prototype.commit=function(){return new zn(this.value(),this.__chain__)},Nn.prototype.plant=function(n){for(var t,r=this;r instanceof Ln;){var e=Mr(r);t?u.__wrapped__=e:t=e;var u=e,r=r.__wrapped__}return u.__wrapped__=n,t},Nn.prototype.reverse=function(){var n=this.__wrapped__;return n instanceof Bn?(this.__actions__.length&&(n=new Bn(this)),new zn(n.reverse(),this.__chain__)):this.thru(function(n){return n.reverse()})},Nn.prototype.toString=function(){return this.value()+""},Nn.prototype.run=Nn.prototype.toJSON=Nn.prototype.valueOf=Nn.prototype.value=function(){
return Lt(this.__wrapped__,this.__actions__)},Nn.prototype.collect=Nn.prototype.map,Nn.prototype.head=Nn.prototype.first,Nn.prototype.select=Nn.prototype.filter,Nn.prototype.tail=Nn.prototype.rest,Nn}var m,w="3.9.3",b=1,x=2,A=4,j=8,k=16,O=32,R=64,I=128,E=256,C=30,W="...",S=150,T=16,U=0,$=1,F=2,N="Expected a function",L="__lodash_placeholder__",z="[object Arguments]",B="[object Array]",M="[object Boolean]",P="[object Date]",q="[object Error]",D="[object Function]",K="[object Number]",V="[object Object]",Y="[object RegExp]",Z="[object String]",G="[object ArrayBuffer]",J="[object Float32Array]",X="[object Float64Array]",H="[object Int8Array]",Q="[object Int16Array]",nn="[object Int32Array]",tn="[object Uint8Array]",rn="[object Uint8ClampedArray]",en="[object Uint16Array]",un="[object Uint32Array]",on=/\b__p\+='';/g,fn=/\b(__p\+=)''\+/g,ln=/(__e\(.*?\)|\b__t\))\+'';/g,an=/&(?:amp|lt|gt|quot|#39|#96);/g,cn=/[&<>"'`]/g,sn=RegExp(an.source),pn=RegExp(cn.source),hn=/<%-([\s\S]+?)%>/g,_n=/<%([\s\S]+?)%>/g,vn=/<%=([\s\S]+?)%>/g,gn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,yn=/^\w*$/,dn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,mn=/[.*+?^${}()|[\]\/\\]/g,wn=RegExp(mn.source),bn=/[\u0300-\u036f\ufe20-\ufe23]/g,xn=/\\(\\)?/g,An=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,jn=/\w*$/,kn=/^0[xX]/,On=/^\[object .+?Constructor\]$/,Rn=/^\d+$/,In=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,En=/($^)/,Cn=/['\n\r\u2028\u2029\\]/g,Wn=RegExp("[A-Z\\xc0-\\xd6\\xd8-\\xde]+(?=[A-Z\\xc0-\\xd6\\xd8-\\xde][a-z\\xdf-\\xf6\\xf8-\\xff]+)|[A-Z\\xc0-\\xd6\\xd8-\\xde]?[a-z\\xdf-\\xf6\\xf8-\\xff]+|[A-Z\\xc0-\\xd6\\xd8-\\xde]+|[0-9]+","g"),Sn=" \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000",Tn="Array ArrayBuffer Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Math Number Object RegExp Set String _ clearTimeout document isFinite parseFloat parseInt setTimeout TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap window".split(" "),Un={};
Un[J]=Un[X]=Un[H]=Un[Q]=Un[nn]=Un[tn]=Un[rn]=Un[en]=Un[un]=true,Un[z]=Un[B]=Un[G]=Un[M]=Un[P]=Un[q]=Un[D]=Un["[object Map]"]=Un[K]=Un[V]=Un[Y]=Un["[object Set]"]=Un[Z]=Un["[object WeakMap]"]=false;var $n={};$n[z]=$n[B]=$n[G]=$n[M]=$n[P]=$n[J]=$n[X]=$n[H]=$n[Q]=$n[nn]=$n[K]=$n[V]=$n[Y]=$n[Z]=$n[tn]=$n[rn]=$n[en]=$n[un]=true,$n[q]=$n[D]=$n["[object Map]"]=$n["[object Set]"]=$n["[object WeakMap]"]=false;var Fn={leading:false,maxWait:0,trailing:false},Nn={"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A",
"\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u",
"\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss"},Ln={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},zn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Bn={"function":true,object:true},Mn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Pn=Bn[typeof exports]&&exports&&!exports.nodeType&&exports,qn=Bn[typeof module]&&module&&!module.nodeType&&module,Dn=Bn[typeof self]&&self&&self.Object&&self,Kn=Bn[typeof window]&&window&&window.Object&&window,Vn=qn&&qn.exports===Pn&&Pn,Yn=Pn&&qn&&typeof global=="object"&&global&&global.Object&&global||Kn!==(this&&this.window)&&Kn||Dn||this,Zn=d();
typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Yn._=Zn, define(function(){return Zn})):Pn&&qn?Vn?(qn.exports=Zn)._=Zn:Pn._=Zn:Yn._=Zn}).call(this);
;
;
/*! moment.min.js */ 
;
;
(function(e){function O(e,t){return function(n){return j(e.call(this,n),t)}}function M(e){return function(t){return this.lang().ordinal(e.call(this,t))}}function _(){}function D(e){H(this,e)}function P(e){var t=this._data={},n=e.years||e.year||e.y||0,r=e.months||e.month||e.M||0,i=e.weeks||e.week||e.w||0,s=e.days||e.day||e.d||0,o=e.hours||e.hour||e.h||0,u=e.minutes||e.minute||e.m||0,a=e.seconds||e.second||e.s||0,f=e.milliseconds||e.millisecond||e.ms||0;this._milliseconds=f+a*1e3+u*6e4+o*36e5,this._days=s+i*7,this._months=r+n*12,t.milliseconds=f%1e3,a+=B(f/1e3),t.seconds=a%60,u+=B(a/60),t.minutes=u%60,o+=B(u/60),t.hours=o%24,s+=B(o/24),s+=i*7,t.days=s%30,r+=B(s/30),t.months=r%12,n+=B(r/12),t.years=n}function H(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function B(e){return e<0?Math.ceil(e):Math.floor(e)}function j(e,t){var n=e+"";while(n.length<t)n="0"+n;return n}function F(e,t,n){var r=t._milliseconds,i=t._days,s=t._months,o;r&&e._d.setTime(+e+r*n),i&&e.date(e.date()+i*n),s&&(o=e.date(),e.date(1).month(e.month()+s*n).date(Math.min(o,e.daysInMonth())))}function I(e){return Object.prototype.toString.call(e)==="[object Array]"}function q(e,t){var n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),i=0,s;for(s=0;s<n;s++)~~e[s]!==~~t[s]&&i++;return i+r}function R(e,t){return t.abbr=e,s[e]||(s[e]=new _),s[e].set(t),s[e]}function U(e){return e?(!s[e]&&o&&require("./lang/"+e),s[e]):t.fn._lang}function z(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function W(e){var t=e.match(a),n,r;for(n=0,r=t.length;n<r;n++)A[t[n]]?t[n]=A[t[n]]:t[n]=z(t[n]);return function(i){var s="";for(n=0;n<r;n++)s+=typeof t[n].call=="function"?t[n].call(i,e):t[n];return s}}function X(e,t){function r(t){return e.lang().longDateFormat(t)||t}var n=5;while(n--&&f.test(t))t=t.replace(f,r);return C[t]||(C[t]=W(t)),C[t](e)}function V(e){switch(e){case"DDDD":return p;case"YYYY":return d;case"YYYYY":return v;case"S":case"SS":case"SSS":case"DDD":return h;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return m;case"X":return b;case"Z":case"ZZ":return g;case"T":return y;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return c;default:return new RegExp(e.replace("\\",""))}}function $(e,t,n){var r,i,s=n._a;switch(e){case"M":case"MM":s[1]=t==null?0:~~t-1;break;case"MMM":case"MMMM":r=U(n._l).monthsParse(t),r!=null?s[1]=r:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":t!=null&&(s[2]=~~t);break;case"YY":s[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":s[0]=~~t;break;case"a":case"A":n._isPm=(t+"").toLowerCase()==="pm";break;case"H":case"HH":case"h":case"hh":s[3]=~~t;break;case"m":case"mm":s[4]=~~t;break;case"s":case"ss":s[5]=~~t;break;case"S":case"SS":case"SSS":s[6]=~~(("0."+t)*1e3);break;case"X":n._d=new Date(parseFloat(t)*1e3);break;case"Z":case"ZZ":n._useUTC=!0,r=(t+"").match(x),r&&r[1]&&(n._tzh=~~r[1]),r&&r[2]&&(n._tzm=~~r[2]),r&&r[0]==="+"&&(n._tzh=-n._tzh,n._tzm=-n._tzm)}t==null&&(n._isValid=!1)}function J(e){var t,n,r=[];if(e._d)return;for(t=0;t<7;t++)e._a[t]=r[t]=e._a[t]==null?t===2?1:0:e._a[t];r[3]+=e._tzh||0,r[4]+=e._tzm||0,n=new Date(0),e._useUTC?(n.setUTCFullYear(r[0],r[1],r[2]),n.setUTCHours(r[3],r[4],r[5],r[6])):(n.setFullYear(r[0],r[1],r[2]),n.setHours(r[3],r[4],r[5],r[6])),e._d=n}function K(e){var t=e._f.match(a),n=e._i,r,i;e._a=[];for(r=0;r<t.length;r++)i=(V(t[r]).exec(n)||[])[0],i&&(n=n.slice(n.indexOf(i)+i.length)),A[t[r]]&&$(t[r],i,e);e._isPm&&e._a[3]<12&&(e._a[3]+=12),e._isPm===!1&&e._a[3]===12&&(e._a[3]=0),J(e)}function Q(e){var t,n,r,i=99,s,o,u;while(e._f.length){t=H({},e),t._f=e._f.pop(),K(t),n=new D(t);if(n.isValid()){r=n;break}u=q(t._a,n.toArray()),u<i&&(i=u,r=n)}H(e,r)}function G(e){var t,n=e._i;if(w.exec(n)){e._f="YYYY-MM-DDT";for(t=0;t<4;t++)if(S[t][1].exec(n)){e._f+=S[t][0];break}g.exec(n)&&(e._f+=" Z"),K(e)}else e._d=new Date(n)}function Y(t){var n=t._i,r=u.exec(n);n===e?t._d=new Date:r?t._d=new Date(+r[1]):typeof n=="string"?G(t):I(n)?(t._a=n.slice(0),J(t)):t._d=n instanceof Date?new Date(+n):new Date(n)}function Z(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function et(e,t,n){var i=r(Math.abs(e)/1e3),s=r(i/60),o=r(s/60),u=r(o/24),a=r(u/365),f=i<45&&["s",i]||s===1&&["m"]||s<45&&["mm",s]||o===1&&["h"]||o<22&&["hh",o]||u===1&&["d"]||u<=25&&["dd",u]||u<=45&&["M"]||u<345&&["MM",r(u/30)]||a===1&&["y"]||["yy",a];return f[2]=t,f[3]=e>0,f[4]=n,Z.apply({},f)}function tt(e,n,r){var i=r-n,s=r-e.day();return s>i&&(s-=7),s<i-7&&(s+=7),Math.ceil(t(e).add("d",s).dayOfYear()/7)}function nt(e){var n=e._i,r=e._f;return n===null||n===""?null:(typeof n=="string"&&(e._i=n=U().preparse(n)),t.isMoment(n)?(e=H({},n),e._d=new Date(+n._d)):r?I(r)?Q(e):K(e):Y(e),new D(e))}function rt(e,n){t.fn[e]=t.fn[e+"s"]=function(e){var t=this._isUTC?"UTC":"";return e!=null?(this._d["set"+t+n](e),this):this._d["get"+t+n]()}}function it(e){t.duration.fn[e]=function(){return this._data[e]}}function st(e,n){t.duration.fn["as"+e]=function(){return+this/n}}var t,n="2.0.0",r=Math.round,i,s={},o=typeof module!="undefined"&&module.exports,u=/^\/?Date\((\-?\d+)/i,a=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,f=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,l=/([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,c=/\d\d?/,h=/\d{1,3}/,p=/\d{3}/,d=/\d{1,4}/,v=/[+\-]?\d{1,6}/,m=/[0-9]*[a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF]+\s*?[\u0600-\u06FF]+/i,g=/Z|[\+\-]\d\d:?\d\d/i,y=/T/i,b=/[\+\-]?\d+(\.\d{1,3})?/,w=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,E="YYYY-MM-DDTHH:mm:ssZ",S=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],x=/([\+\-]|\d\d)/gi,T="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),N={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},C={},k="DDD w W M D d".split(" "),L="M D H h m s w W".split(" "),A={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return j(this.year()%100,2)},YYYY:function(){return j(this.year(),4)},YYYYY:function(){return j(this.year(),5)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return j(~~(this.milliseconds()/10),2)},SSS:function(){return j(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+j(~~(e/60),2)+":"+j(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+j(~~(10*e/6),4)},X:function(){return this.unix()}};while(k.length)i=k.pop(),A[i+"o"]=M(A[i]);while(L.length)i=L.pop(),A[i+i]=O(A[i],2);A.DDDD=O(A.DDD,3),_.prototype={set:function(e){var t,n;for(n in e)t=e[n],typeof t=="function"?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var n,r,i,s;this._monthsParse||(this._monthsParse=[]);for(n=0;n<12;n++){this._monthsParse[n]||(r=t([2e3,n]),i="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i"));if(this._monthsParse[n].test(e))return n}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return typeof n=="function"?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var i=this._relativeTime[n];return typeof i=="function"?i(e,t,n,r):i.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return typeof n=="function"?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return tt(e,this._week.dow,this._week.doy)},_week:{dow:0,doy:6}},t=function(e,t,n){return nt({_i:e,_f:t,_l:n,_isUTC:!1})},t.utc=function(e,t,n){return nt({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t})},t.unix=function(e){return t(e*1e3)},t.duration=function(e,n){var r=t.isDuration(e),i=typeof e=="number",s=r?e._data:i?{}:e,o;return i&&(n?s[n]=e:s.milliseconds=e),o=new P(s),r&&e.hasOwnProperty("_lang")&&(o._lang=e._lang),o},t.version=n,t.defaultFormat=E,t.lang=function(e,n){var r;if(!e)return t.fn._lang._abbr;n?R(e,n):s[e]||U(e),t.duration.fn._lang=t.fn._lang=U(e)},t.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),U(e)},t.isMoment=function(e){return e instanceof D},t.isDuration=function(e){return e instanceof P},t.fn=D.prototype={clone:function(){return t(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._d},toJSON:function(){return t.utc(this).format("YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return this._isValid==null&&(this._a?this._isValid=!q(this._a,(this._isUTC?t.utc(this._a):t(this._a)).toArray()):this._isValid=!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){var n=X(this,e||t.defaultFormat);return this.lang().postformat(n)},add:function(e,n){var r;return typeof e=="string"?r=t.duration(+n,e):r=t.duration(e,n),F(this,r,1),this},subtract:function(e,n){var r;return typeof e=="string"?r=t.duration(+n,e):r=t.duration(e,n),F(this,r,-1),this},diff:function(e,n,r){var i=this._isUTC?t(e).utc():t(e).local(),s=(this.zone()-i.zone())*6e4,o,u;return n&&(n=n.replace(/s$/,"")),n==="year"||n==="month"?(o=(this.daysInMonth()+i.daysInMonth())*432e5,u=(this.year()-i.year())*12+(this.month()-i.month()),u+=(this-t(this).startOf("month")-(i-t(i).startOf("month")))/o,n==="year"&&(u/=12)):(o=this-i-s,u=n==="second"?o/1e3:n==="minute"?o/6e4:n==="hour"?o/36e5:n==="day"?o/864e5:n==="week"?o/6048e5:o),r?u:B(u)},from:function(e,n){return t.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!n)},fromNow:function(e){return this.from(t(),e)},calendar:function(){var e=this.diff(t().startOf("day"),"days",!0),n=e<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(n,this))},isLeapYear:function(){var e=this.year();return e%4===0&&e%100!==0||e%400===0},isDST:function(){return this.zone()<t([this.year()]).zone()||this.zone()<t([this.year(),5]).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e==null?t:this.add({d:e-t})},startOf:function(e){e=e.replace(/s$/,"");switch(e){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return e==="week"&&this.day(0),this},endOf:function(e){return this.startOf(e).add(e.replace(/s?$/,"s"),1).subtract("ms",1)},isAfter:function(e,n){return n=typeof n!="undefined"?n:"millisecond",+this.clone().startOf(n)>+t(e).startOf(n)},isBefore:function(e,n){return n=typeof n!="undefined"?n:"millisecond",+this.clone().startOf(n)<+t(e).startOf(n)},isSame:function(e,n){return n=typeof n!="undefined"?n:"millisecond",+this.clone().startOf(n)===+t(e).startOf(n)},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return t.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var n=r((t(this).startOf("day")-t(this).startOf("year"))/864e5)+1;return e==null?n:this.add("d",e-n)},isoWeek:function(e){var t=tt(this,1,4);return e==null?t:this.add("d",(e-t)*7)},week:function(e){var t=this.lang().week(this);return e==null?t:this.add("d",(e-t)*7)},lang:function(t){return t===e?this._lang:(this._lang=U(t),this)}};for(i=0;i<T.length;i++)rt(T[i].toLowerCase().replace(/s$/,""),T[i]);rt("year","FullYear"),t.fn.days=t.fn.day,t.fn.weeks=t.fn.week,t.fn.isoWeeks=t.fn.isoWeek,t.duration.fn=P.prototype={weeks:function(){return B(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months*2592e6},humanize:function(e){var t=+this,n=et(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},lang:t.fn.lang};for(i in N)N.hasOwnProperty(i)&&(st(i,N[i]),it(i.toLowerCase()));st("Weeks",6048e5),t.lang("en",{ordinal:function(e){var t=e%10,n=~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+n}}),o&&(module.exports=t),typeof ender=="undefined"&&(this.moment=t),typeof define=="function"&&define.amd&&define("moment",[],function(){return t})}).call(this);
;
;
/*! bootstrap.min.js */ 
;
;
/*!
* Bootstrap.js by @fat & @mdo
* Copyright 2012 Twitter, Inc.
* http://www.apache.org/licenses/LICENSE-2.0.txt
*/
!function(e){e(function(){"use strict";e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t){if(e.style[n]!==undefined){return t[n]}}}();return e&&{end:e}}()})}(window.jQuery);!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;if(!r){r=n.attr("href");r=r&&r.replace(/.*(?=#[^\s]*$)/,"")}i=e(r);t&&t.preventDefault();i.length||(i=n.hasClass("alert")?n:n.parent());i.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;i.removeClass("in");e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()};e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");if(!i)r.data("alert",i=new n(this));if(typeof t=="string")i[t].call(r)})};e.fn.alert.Constructor=n;e(function(){e("body").on("click.alert.data-api",t,n.prototype.close)})}(window.jQuery);!function(e){"use strict";var t=function(t,n){this.$element=e(t);this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e=e+"Text";r.resetText||n.data("resetText",n[i]());n[i](r[e]||this.options[e]);setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)};t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active");this.$element.toggleClass("active")};e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;if(!i)r.data("button",i=new t(this,s));if(n=="toggle")i.toggle();else if(n)i.setState(n)})};e.fn.button.defaults={loadingText:"loading..."};e.fn.button.Constructor=t;e(function(){e("body").on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);if(!n.hasClass("btn"))n=n.closest(".btn");n.button("toggle")})})}(window.jQuery);!function(e){"use strict";var t=function(t,n){this.$element=e(t);this.options=n;this.options.slide&&this.slide(this.options.slide);this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){if(!t)this.paused=false;this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval));return this},to:function(t){var n=this.$element.find(".item.active"),r=n.parent().children(),i=r.index(n),s=this;if(t>r.length-1||t<0)return;if(this.sliding){return this.$element.one("slid",function(){s.to(t)})}if(i==t){return this.pause().cycle()}return this.slide(t>i?"next":"prev",e(r[t]))},pause:function(t){if(!t)this.paused=true;if(this.$element.find(".next, .prev").length&&e.support.transition.end){this.$element.trigger(e.support.transition.end);this.cycle()}clearInterval(this.interval);this.interval=null;return this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".item.active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this,f=e.Event("slide",{relatedTarget:i[0]});this.sliding=true;s&&this.pause();i=i.length?i:this.$element.find(".item")[u]();if(i.hasClass("active"))return;if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t);i[0].offsetWidth;r.addClass(o);i.addClass(o);this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active");r.removeClass(["active",o].join(" "));a.sliding=false;setTimeout(function(){a.$element.trigger("slid")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("active");i.addClass("active");this.sliding=false;this.$element.trigger("slid")}s&&this.cycle();return this}};e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;if(!i)r.data("carousel",i=new t(this,s));if(typeof n=="number")i.to(n);else if(o)i[o]();else if(s.interval)i.cycle()})};e.fn.carousel.defaults={interval:5e3,pause:"hover"};e.fn.carousel.Constructor=t;e(function(){e("body").on("click.carousel.data-api","[data-slide]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=!i.data("modal")&&e.extend({},i.data(),n.data());i.carousel(s);t.preventDefault()})})}(window.jQuery);!function(e){"use strict";var t=function(t,n){this.$element=e(t);this.options=e.extend({},e.fn.collapse.defaults,n);if(this.options.parent){this.$parent=e(this.options.parent)}this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning)return;t=this.dimension();n=e.camelCase(["scroll",t].join("-"));r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide");i||r.data("collapse",null)}this.$element[t](0);this.transition("addClass",e.Event("show"),"shown");e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning)return;t=this.dimension();this.reset(this.$element[t]());this.transition("removeClass",e.Event("hide"),"hidden");this.$element[t](0)},reset:function(e){var t=this.dimension();this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth;this.$element[e!==null?"addClass":"removeClass"]("collapse");return this},transition:function(t,n,r){var i=this,s=function(){if(n.type=="show")i.reset();i.transitioning=0;i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1;this.$element[t]("in");e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=typeof n=="object"&&n;if(!i)r.data("collapse",i=new t(this,s));if(typeof n=="string")i[n]()})};e.fn.collapse.defaults={toggle:true};e.fn.collapse.Constructor=t;e(function(){e("body").on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();n[e(i).hasClass("in")?"addClass":"removeClass"]("collapsed");e(i).collapse(s)})})}(window.jQuery);!function(e){"use strict";function r(){i(e(t)).removeClass("open")}function i(t){var n=t.attr("data-target"),r;if(!n){n=t.attr("href");n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")}r=e(n);r.length||(r=t.parent());return r}var t="[data-toggle=dropdown]",n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),s,o;if(n.is(".disabled, :disabled"))return;s=i(n);o=s.hasClass("open");r();if(!o){s.toggleClass("open");n.focus()}return false},keydown:function(t){var n,r,s,o,u,a;if(!/(38|40|27)/.test(t.keyCode))return;n=e(this);t.preventDefault();t.stopPropagation();if(n.is(".disabled, :disabled"))return;o=i(n);u=o.hasClass("open");if(!u||u&&t.keyCode==27)return n.click();r=e("[role=menu] li:not(.divider) a",o);if(!r.length)return;a=r.index(r.filter(":focus"));if(t.keyCode==38&&a>0)a--;if(t.keyCode==40&&a<r.length-1)a++;if(!~a)a=0;r.eq(a).focus()}};e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");if(!i)r.data("dropdown",i=new n(this));if(typeof t=="string")i[t].call(r)})};e.fn.dropdown.Constructor=n;e(function(){e("html").on("click.dropdown.data-api touchstart.dropdown.data-api",r);e("body").on("click.dropdown touchstart.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api touchstart.dropdown.data-api",t,n.prototype.toggle).on("keydown.dropdown.data-api touchstart.dropdown.data-api",t+", [role=menu]",n.prototype.keydown)})}(window.jQuery);!function(e){"use strict";var t=function(t,n){this.options=n;this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this));this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[!this.isShown?"show":"hide"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;e("body").addClass("modal-open");this.isShown=true;this.escape();this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");if(!t.$element.parent().length){t.$element.appendTo(document.body)}t.$element.show();if(n){t.$element[0].offsetWidth}t.$element.addClass("in").attr("aria-hidden",false);t.enforceFocus();n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide");this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=false;e("body").removeClass("modal-open");this.escape();e(document).off("focusin.modal");this.$element.removeClass("in").attr("aria-hidden",true);e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){},escape:function(){var e=this;if(this.isShown&&this.options.keyboard){this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()})}else if(!this.isShown){this.$element.off("keyup.dismiss.modal")}},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end);t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n);t.hideModal()})},hideModal:function(e){this.$element.hide().trigger("hidden");this.backdrop()},removeBackdrop:function(){this.$backdrop.remove();this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body);if(this.options.backdrop!="static"){this.$backdrop.click(e.proxy(this.hide,this))}if(i)this.$backdrop[0].offsetWidth;this.$backdrop.addClass("in");i?this.$backdrop.one(e.support.transition.end,t):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(this.removeBackdrop,this)):this.removeBackdrop()}else if(t){t()}}};e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);if(!i)r.data("modal",i=new t(this,s));if(typeof n=="string")i[n]();else if(s.show)i.show()})};e.fn.modal.defaults={backdrop:true,keyboard:true,show:true};e.fn.modal.Constructor=t;e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault();i.modal(s).one("hide",function(){n.focus()})})})}(window.jQuery);!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s;this.type=t;this.$element=e(n);this.options=this.getOptions(r);this.enabled=true;if(this.options.trigger=="click"){this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this))}else if(this.options.trigger!="manual"){i=this.options.trigger=="hover"?"mouseenter":"focus";s=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this));this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this))}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){t=e.extend({},e.fn[this.type].defaults,t,this.$element.data());if(t.delay&&typeof t.delay=="number"){t.delay={show:t.delay,hide:t.delay}}return t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(!n.options.delay||!n.options.delay.show)return n.show();clearTimeout(this.timeout);n.hoverState="in";this.timeout=setTimeout(function(){if(n.hoverState=="in")n.show()},n.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(this.timeout)clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out";this.timeout=setTimeout(function(){if(n.hoverState=="out")n.hide()},n.options.delay.hide)},show:function(){var e,t,n,r,i,s,o;if(this.hasContent()&&this.enabled){e=this.tip();this.setContent();if(this.options.animation){e.addClass("fade")}s=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement;t=/in/.test(s);e.remove().css({top:0,left:0,display:"block"}).appendTo(t?this.$element:document.body);n=this.getPosition(t);r=e[0].offsetWidth;i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width};break}e.css(o).addClass(s).addClass("in")}},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t);e.removeClass("fade in top bottom left right")},hide:function(){function r(){var t=setTimeout(function(){n.off(e.support.transition.end).remove()},500);n.one(e.support.transition.end,function(){clearTimeout(t);n.remove()})}var t=this,n=this.tip();n.removeClass("in");e.support.transition&&this.$tip.hasClass("fade")?r():n.remove();return this},fixTitle:function(){var e=this.$element;if(e.attr("title")||typeof e.attr("data-original-title")!="string"){e.attr("data-original-title",e.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title);return e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;if(!i)r.data("tooltip",i=new t(this,s));if(typeof n=="string")i[n]()})};e.fn.tooltip.Constructor=t;e.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:true}}(window.jQuery);!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t);e.find(".popover-content > *")[this.options.html?"html":"text"](n);e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;e=t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content);return e},tip:function(){if(!this.$tip){this.$tip=e(this.options.template)}return this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;if(!i)r.data("popover",i=new t(this,s));if(typeof n=="string")i[n]()})};e.fn.popover.Constructor=t;e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery);!function(e){"use strict";function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n);this.$scrollElement=i.on("scroll.scroll-spy.data-api",r);this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a";this.$body=e("body");this.refresh();this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]);this.targets=e([]);n=this.$body.find(this.selector).map(function(){var t=e(this),n=t.data("target")||t.attr("href"),r=/^#\w/.test(n)&&e(n);return r&&r.length&&[[r.position().top,n]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]);t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n){return s!=(o=i.last()[0])&&this.activate(o)}for(o=r.length;o--;){s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])}},activate:function(t){var n,r;this.activeTarget=t;e(this.selector).parent(".active").removeClass("active");r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]';n=e(r).parent("li").addClass("active");if(n.parent(".dropdown-menu").length){n=n.closest("li.dropdown").addClass("active")}n.trigger("activate")}};e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;if(!i)r.data("scrollspy",i=new t(this,s));if(typeof n=="string")i[n]()})};e.fn.scrollspy.Constructor=t;e.fn.scrollspy.defaults={offset:10};e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery);!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;if(!r){r=t.attr("href");r=r&&r.replace(/.*(?=#[^\s]*$)/,"")}if(t.parent("li").hasClass("active"))return;i=n.find(".active a").last()[0];o=e.Event("show",{relatedTarget:i});t.trigger(o);if(o.isDefaultPrevented())return;s=e(r);this.activate(t.parent("li"),n);this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");t.addClass("active");if(s){t[0].offsetWidth;t.addClass("in")}else{t.removeClass("fade")}if(t.parent(".dropdown-menu")){t.closest("li.dropdown").addClass("active")}r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o();i.removeClass("in")}};e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");if(!i)r.data("tab",i=new t(this));if(typeof n=="string")i[n]()})};e.fn.tab.Constructor=t;e(function(){e("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault();e(this).tab("show")})})}(window.jQuery);!function(e){"use strict";var t=function(t,n){this.$element=e(t);this.options=e.extend({},e.fn.typeahead.defaults,n);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.updater=this.options.updater||this.updater;this.$menu=e(this.options.menu).appendTo("body");this.source=this.options.source;this.shown=false;this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");this.$element.val(this.updater(e)).change();return this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.$menu.css({top:t.top+t.height,left:t.left});this.$menu.show();this.shown=true;return this},hide:function(){this.$menu.hide();this.shown=false;return this},lookup:function(t){var n;this.query=this.$element.val();if(!this.query||this.query.length<this.options.minLength){return this.shown?this.hide():this}n=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source;return n?this.process(n):this},process:function(t){var n=this;t=e.grep(t,function(e){return n.matcher(e)});t=this.sorter(t);if(!t.length){return this.shown?this.hide():this}return this.render(t.slice(0,this.options.items)).show()},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift()){if(!i.toLowerCase().indexOf(this.query.toLowerCase()))t.push(i);else if(~i.indexOf(this.query))n.push(i);else r.push(i)}return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;t=e(t).map(function(t,r){t=e(n.options.item).attr("data-value",r);t.find("a").html(n.highlighter(r));return t[0]});t.first().addClass("active");this.$menu.html(t);return this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();if(!r.length){r=e(this.$menu.find("li")[0])}r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();if(!n.length){n=this.$menu.find("li").last()}n.addClass("active")},listen:function(){this.$element.on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this));if(e.browser.chrome||e.browser.webkit||e.browser.msie){this.$element.on("keydown",e.proxy(this.keydown,this))}this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this))},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault();this.prev();break;case 40:e.preventDefault();this.next();break}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=!~e.inArray(t.keyCode,[40,38,9,13,27]);this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation();e.preventDefault()},blur:function(e){var t=this;setTimeout(function(){t.hide()},150)},click:function(e){e.stopPropagation();e.preventDefault();this.select()},mouseenter:function(t){this.$menu.find(".active").removeClass("active");e(t.currentTarget).addClass("active")}};e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;if(!i)r.data("typeahead",i=new t(this,s));if(typeof n=="string")i[n]()})};e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1};e.fn.typeahead.Constructor=t;e(function(){e("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;t.preventDefault();n.typeahead(n.data())})})}(window.jQuery);!function(e){"use strict";var t=function(t,n){this.options=e.extend({},e.fn.affix.defaults,n);this.$window=e(window).on("scroll.affix.data-api",e.proxy(this.checkPosition,this));this.$element=e(t);this.checkPosition()};t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var t=e(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top,u="affix affix-top affix-bottom",a;if(typeof i!="object")s=o=i;if(typeof o=="function")o=i.top();if(typeof s=="function")s=i.bottom();a=this.unpin!=null&&n+this.unpin<=r.top?false:s!=null&&r.top+this.$element.height()>=t-s?"bottom":o!=null&&n<=o?"top":false;if(this.affixed===a)return;this.affixed=a;this.unpin=a=="bottom"?r.top-n:null;this.$element.removeClass(u).addClass("affix"+(a?"-"+a:""))};e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("affix"),s=typeof n=="object"&&n;if(!i)r.data("affix",i=new t(this,s));if(typeof n=="string")i[n]()})};e.fn.affix.Constructor=t;e.fn.affix.defaults={offset:0};e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{};n.offsetBottom&&(n.offset.bottom=n.offsetBottom);n.offsetTop&&(n.offset.top=n.offsetTop);t.affix(n)})})}(window.jQuery);
;
;
/*! bootstrap-select-1.6.3.js */ 
;
;
(function ($) {
'use strict';
$.expr[':'].icontains = function (obj, index, meta) {
return icontains($(obj).text(), meta[3]);
};
$.expr[':'].aicontains = function (obj, index, meta) {
return icontains($(obj).data('normalizedText') || $(obj).text(), meta[3]);
};
/**
* Actual implementation of the case insensitive search.
* @access private
* @param {String} haystack
* @param {String} needle
* @returns {boolean}
*/
function icontains(haystack, needle) {
return haystack.toUpperCase().indexOf(needle.toUpperCase()) > -1;
}
/**
* Remove all diatrics from the given text.
* @access private
* @param {String} text
* @returns {String}
*/
function normalizeToBase(text) {
var rExps = [
{re: /[\xC0-\xC6]/g, ch: "A"},
{re: /[\xE0-\xE6]/g, ch: "a"},
{re: /[\xC8-\xCB]/g, ch: "E"},
{re: /[\xE8-\xEB]/g, ch: "e"},
{re: /[\xCC-\xCF]/g, ch: "I"},
{re: /[\xEC-\xEF]/g, ch: "i"},
{re: /[\xD2-\xD6]/g, ch: "O"},
{re: /[\xF2-\xF6]/g, ch: "o"},
{re: /[\xD9-\xDC]/g, ch: "U"},
{re: /[\xF9-\xFC]/g, ch: "u"},
{re: /[\xC7-\xE7]/g, ch: "c"},
{re: /[\xD1]/g, ch: "N"},
{re: /[\xF1]/g, ch: "n"}
];
$.each(rExps, function () {
text = text.replace(this.re, this.ch);
});
return text;
}
function htmlEscape(html) {
var escapeMap = {
'&': '&amp;',
'<': '&lt;',
'>': '&gt;',
'"': '&quot;',
"'": '&#x27;',
'`': '&#x60;'
};
var source = '(?:' + Object.keys(escapeMap).join('|') + ')',
testRegexp = new RegExp(source),
replaceRegexp = new RegExp(source, 'g'),
string = html == null ? '' : '' + html;
return testRegexp.test(string) ? string.replace(replaceRegexp, function (match) {
return escapeMap[match];
}) : string;
}
var Selectpicker = function (element, options, e) {
if (e) {
e.stopPropagation();
e.preventDefault();
}
this.$element = $(element);
this.$newElement = null;
this.$button = null;
this.$menu = null;
this.$lis = null;
this.options = options;
if (this.options.title === null) {
this.options.title = this.$element.attr('title');
}
this.val = Selectpicker.prototype.val;
this.render = Selectpicker.prototype.render;
this.refresh = Selectpicker.prototype.refresh;
this.setStyle = Selectpicker.prototype.setStyle;
this.selectAll = Selectpicker.prototype.selectAll;
this.deselectAll = Selectpicker.prototype.deselectAll;
this.destroy = Selectpicker.prototype.remove;
this.remove = Selectpicker.prototype.remove;
this.show = Selectpicker.prototype.show;
this.hide = Selectpicker.prototype.hide;
this.init();
};
Selectpicker.VERSION = '1.6.3';
Selectpicker.DEFAULTS = {
noneSelectedText: 'Nothing selected',
noneResultsText: 'No results match',
countSelectedText: function (numSelected, numTotal) {
return (numSelected == 1) ? "{0} item selected" : "{0} items selected";
},
maxOptionsText: function (numAll, numGroup) {
var arr = [];
arr[0] = (numAll == 1) ? 'Limit reached ({n} item max)' : 'Limit reached ({n} items max)';
arr[1] = (numGroup == 1) ? 'Group limit reached ({n} item max)' : 'Group limit reached ({n} items max)';
return arr;
},
selectAllText: 'Select All',
deselectAllText: 'Deselect All',
multipleSeparator: ', ',
style: 'btn-default',
size: 'auto',
title: null,
selectedTextFormat: 'values',
width: false,
container: false,
hideDisabled: false,
showSubtext: false,
showIcon: true,
showContent: true,
dropupAuto: true,
header: false,
liveSearch: false,
actionsBox: false,
iconBase: 'glyphicon',
tickIcon: 'glyphicon-ok',
maxOptions: false,
mobile: false,
selectOnTab: false,
dropdownAlignRight: false,
searchAccentInsensitive: false
};
Selectpicker.prototype = {
constructor: Selectpicker,
init: function () {
var that = this,
id = this.$element.attr('id');
this.$element.hide();
this.multiple = this.$element.prop('multiple');
this.autofocus = this.$element.prop('autofocus');
this.$newElement = this.createView();
this.$element.after(this.$newElement);
this.$menu = this.$newElement.find('> .dropdown-menu');
this.$button = this.$newElement.find('> button');
this.$searchbox = this.$newElement.find('input');
if (this.options.dropdownAlignRight)
this.$menu.addClass('dropdown-menu-right');
if (typeof id !== 'undefined') {
this.$button.attr('data-id', id);
$('label[for="' + id + '"]').click(function (e) {
e.preventDefault();
that.$button.focus();
});
}
this.checkDisabled();
this.clickListener();
if (this.options.liveSearch) this.liveSearchListener();
this.render();
this.liHeight();
this.setStyle();
this.setWidth();
if (this.options.container) this.selectPosition();
this.$menu.data('this', this);
this.$newElement.data('this', this);
if (this.options.mobile) this.mobile();
},
createDropdown: function () {
var multiple = this.multiple ? ' show-tick' : '',
inputGroup = this.$element.parent().hasClass('input-group') ? ' input-group-btn' : '',
autofocus = this.autofocus ? ' autofocus' : '',
btnSize = this.$element.parents().hasClass('form-group-lg') ? ' btn-lg' : (this.$element.parents().hasClass('form-group-sm') ? ' btn-sm' : '');
var header = this.options.header ? '<div class="popover-title"><button type="button" class="close" aria-hidden="true">&times;</button>' + this.options.header + '</div>' : '';
var searchbox = this.options.liveSearch ? '<div class="bs-searchbox"><input type="text" class="input-block-level form-control" autocomplete="off" /></div>' : '';
var actionsbox = this.options.actionsBox ? '<div class="bs-actionsbox">' +
'<div class="btn-group btn-block">' +
'<button class="actions-btn bs-select-all btn btn-sm btn-default">' +
this.options.selectAllText +
'</button>' +
'<button class="actions-btn bs-deselect-all btn btn-sm btn-default">' +
this.options.deselectAllText +
'</button>' +
'</div>' +
'</div>' : '';
var drop =
'<div class="btn-group bootstrap-select' + multiple + inputGroup + '">' +
'<button type="button" class="btn dropdown-toggle selectpicker' + btnSize + '" data-toggle="dropdown"' + autofocus + '>' +
'<span class="filter-option pull-left"></span>&nbsp;' +
'<span class="caret"></span>' +
'</button>' +
'<div class="dropdown-menu open">' +
header +
searchbox +
actionsbox +
'<ul class="dropdown-menu inner selectpicker" role="menu">' +
'</ul>' +
'</div>' +
'</div>';
return $(drop);
},
createView: function () {
var $drop = this.createDropdown();
var $li = this.createLi();
$drop.find('ul').append($li);
return $drop;
},
reloadLi: function () {
this.destroyLi();
var $li = this.createLi();
this.$menu.find('ul').append($li);
},
destroyLi: function () {
this.$menu.find('li').remove();
},
createLi: function () {
var that = this,
_li = [],
optID = 0;
/**
* @param content
* @param [index]
* @param [classes]
* @returns {string}
*/
var generateLI = function (content, index, classes) {
return '<li' +
(typeof classes !== 'undefined' ? ' class="' + classes + '"' : '') +
(typeof index !== 'undefined' | null === index ? ' data-original-index="' + index + '"' : '') +
'>' + content + '</li>';
};
/**
* @param text
* @param [classes]
* @param [inline]
* @param [optgroup]
* @returns {string}
*/
var generateA = function (text, classes, inline, optgroup) {
var normText = normalizeToBase(htmlEscape(text));
return '<a tabindex="0"' +
(typeof classes !== 'undefined' ? ' class="' + classes + '"' : '') +
(typeof inline !== 'undefined' ? ' style="' + inline + '"' : '') +
(typeof optgroup !== 'undefined' ? 'data-optgroup="' + optgroup + '"' : '') +
' data-normalized-text="' + normText + '"' +
'>' + text +
'<span class="' + that.options.iconBase + ' ' + that.options.tickIcon + ' check-mark"></span>' +
'</a>';
};
this.$element.find('option').each(function () {
var $this = $(this);
var optionClass = $this.attr('class') || '',
inline = $this.attr('style'),
text = $this.data('content') ? $this.data('content') : $this.html(),
subtext = typeof $this.data('subtext') !== 'undefined' ? '<small class="muted text-muted">' + $this.data('subtext') + '</small>' : '',
icon = typeof $this.data('icon') !== 'undefined' ? '<span class="' + that.options.iconBase + ' ' + $this.data('icon') + '"></span> ' : '',
isDisabled = $this.is(':disabled') || $this.parent().is(':disabled'),
index = $this[0].index;
if (icon !== '' && isDisabled) {
icon = '<span>' + icon + '</span>';
}
if (!$this.data('content')) {
text = icon + '<span class="text">' + text + subtext + '</span>';
}
if (that.options.hideDisabled && isDisabled) {
return;
}
if ($this.parent().is('optgroup') && $this.data('divider') !== true) {
if ($this.index() === 0) { // Is it the first option of the optgroup?
optID += 1;
var label = $this.parent().attr('label');
var labelSubtext = typeof $this.parent().data('subtext') !== 'undefined' ? '<small class="muted text-muted">' + $this.parent().data('subtext') + '</small>' : '';
var labelIcon = $this.parent().data('icon') ? '<span class="' + that.options.iconBase + ' ' + $this.parent().data('icon') + '"></span> ' : '';
label = labelIcon + '<span class="text">' + label + labelSubtext + '</span>';
if (index !== 0 && _li.length > 0) { // Is it NOT the first option of the select && are there elements in the dropdown?
_li.push(generateLI('', null, 'divider'));
}
_li.push(generateLI(label, null, 'dropdown-header'));
}
_li.push(generateLI(generateA(text, 'opt ' + optionClass, inline, optID), index));
} else if ($this.data('divider') === true) {
_li.push(generateLI('', index, 'divider'));
} else if ($this.data('hidden') === true) {
_li.push(generateLI(generateA(text, optionClass, inline), index, 'hide is-hidden'));
} else {
_li.push(generateLI(generateA(text, optionClass, inline), index));
}
});
if (!this.multiple && this.$element.find('option:selected').length === 0 && !this.options.title) {
this.$element.find('option').eq(0).prop('selected', true).attr('selected', 'selected');
}
return $(_li.join(''));
},
findLis: function () {
if (this.$lis == null) this.$lis = this.$menu.find('li');
return this.$lis;
},
/**
* @param [updateLi] defaults to true
*/
render: function (updateLi) {
var that = this;
if (updateLi !== false) {
this.$element.find('option').each(function (index) {
that.setDisabled(index, $(this).is(':disabled') || $(this).parent().is(':disabled'));
that.setSelected(index, $(this).is(':selected'));
});
}
this.tabIndex();
var notDisabled = this.options.hideDisabled ? ':not([disabled])' : '';
var selectedItems = this.$element.find('option:selected' + notDisabled).map(function () {
var $this = $(this);
var icon = $this.data('icon') && that.options.showIcon ? '<i class="' + that.options.iconBase + ' ' + $this.data('icon') + '"></i> ' : '';
var subtext;
if (that.options.showSubtext && $this.attr('data-subtext') && !that.multiple) {
subtext = ' <small class="muted text-muted">' + $this.data('subtext') + '</small>';
} else {
subtext = '';
}
if ($this.data('content') && that.options.showContent) {
return $this.data('content');
} else if (typeof $this.attr('title') !== 'undefined') {
return $this.attr('title');
} else {
return icon + $this.html() + subtext;
}
}).toArray();
var title = !this.multiple ? selectedItems[0] : selectedItems.join(this.options.multipleSeparator);
if (this.multiple && this.options.selectedTextFormat.indexOf('count') > -1) {
var max = this.options.selectedTextFormat.split('>');
if ((max.length > 1 && selectedItems.length > max[1]) || (max.length == 1 && selectedItems.length >= 2)) {
notDisabled = this.options.hideDisabled ? ', [disabled]' : '';
var totalCount = this.$element.find('option').not('[data-divider="true"], [data-hidden="true"]' + notDisabled).length,
tr8nText = (typeof this.options.countSelectedText === 'function') ? this.options.countSelectedText(selectedItems.length, totalCount) : this.options.countSelectedText;
title = tr8nText.replace('{0}', selectedItems.length.toString()).replace('{1}', totalCount.toString());
}
}
this.options.title = this.$element.attr('title');
if (this.options.selectedTextFormat == 'static') {
title = this.options.title;
}
if (!title) {
title = typeof this.options.title !== 'undefined' ? this.options.title : this.options.noneSelectedText;
}
this.$button.attr('title', htmlEscape(title));
this.$newElement.find('.filter-option').html(title);
},
/**
* @param [style]
* @param [status]
*/
setStyle: function (style, status) {
if (this.$element.attr('class')) {
this.$newElement.addClass(this.$element.attr('class').replace(/selectpicker|mobile-device|validate\[.*\]/gi, ''));
}
var buttonClass = style ? style : this.options.style;
if (status == 'add') {
this.$button.addClass(buttonClass);
} else if (status == 'remove') {
this.$button.removeClass(buttonClass);
} else {
this.$button.removeClass(this.options.style);
this.$button.addClass(buttonClass);
}
},
liHeight: function () {
if (this.options.size === false) return;
var $selectClone = this.$menu.parent().clone().find('> .dropdown-toggle').prop('autofocus', false).end().appendTo('body'),
$menuClone = $selectClone.addClass('open').find('> .dropdown-menu'),
liHeight = $menuClone.find('li').not('.divider').not('.dropdown-header').filter(':visible').children('a').outerHeight(),
headerHeight = this.options.header ? $menuClone.find('.popover-title').outerHeight() : 0,
searchHeight = this.options.liveSearch ? $menuClone.find('.bs-searchbox').outerHeight() : 0,
actionsHeight = this.options.actionsBox ? $menuClone.find('.bs-actionsbox').outerHeight() : 0;
$selectClone.remove();
this.$newElement
.data('liHeight', liHeight)
.data('headerHeight', headerHeight)
.data('searchHeight', searchHeight)
.data('actionsHeight', actionsHeight);
},
setSize: function () {
this.findLis();
var that = this,
menu = this.$menu,
menuInner = menu.find('.inner'),
selectHeight = this.$newElement.outerHeight(),
liHeight = this.$newElement.data('liHeight'),
headerHeight = this.$newElement.data('headerHeight'),
searchHeight = this.$newElement.data('searchHeight'),
actionsHeight = this.$newElement.data('actionsHeight'),
divHeight = this.$lis.filter('.divider').outerHeight(true),
menuPadding = parseInt(menu.css('padding-top')) +
parseInt(menu.css('padding-bottom')) +
parseInt(menu.css('border-top-width')) +
parseInt(menu.css('border-bottom-width')),
notDisabled = this.options.hideDisabled ? ', .disabled' : '',
$window = $(window),
menuExtras = menuPadding + parseInt(menu.css('margin-top')) + parseInt(menu.css('margin-bottom')) + 2,
menuHeight,
selectOffsetTop,
selectOffsetBot,
posVert = function () {
selectOffsetTop = that.$newElement.offset().top - $window.scrollTop();
selectOffsetBot = $window.height() - selectOffsetTop - selectHeight;
};
posVert();
if (this.options.header) menu.css('padding-top', 0);
if (this.options.size == 'auto') {
var getSize = function () {
var minHeight,
lisVis = that.$lis.not('.hide');
posVert();
menuHeight = selectOffsetBot - menuExtras;
if (that.options.dropupAuto) {
that.$newElement.toggleClass('dropup', (selectOffsetTop > selectOffsetBot) && ((menuHeight - menuExtras) < menu.height()));
}
if (that.$newElement.hasClass('dropup')) {
menuHeight = selectOffsetTop - menuExtras;
}
if ((lisVis.length + lisVis.filter('.dropdown-header').length) > 3) {
minHeight = liHeight * 3 + menuExtras - 2;
} else {
minHeight = 0;
}
menu.css({
'max-height': menuHeight + 'px',
'overflow': 'hidden',
'min-height': minHeight + headerHeight + searchHeight + actionsHeight + 'px'
});
menuInner.css({
'max-height': menuHeight - headerHeight - searchHeight - actionsHeight - menuPadding + 'px',
'overflow-y': 'auto',
'min-height': Math.max(minHeight - menuPadding, 0) + 'px'
});
};
getSize();
this.$searchbox.off('input.getSize propertychange.getSize').on('input.getSize propertychange.getSize', getSize);
$(window).off('resize.getSize').on('resize.getSize', getSize);
$(window).off('scroll.getSize').on('scroll.getSize', getSize);
} else if (this.options.size && this.options.size != 'auto' && menu.find('li' + notDisabled).length > this.options.size) {
var optIndex = this.$lis.not('.divider' + notDisabled).find(' > *').slice(0, this.options.size).last().parent().index();
var divLength = this.$lis.slice(0, optIndex + 1).filter('.divider').length;
menuHeight = liHeight * this.options.size + divLength * divHeight + menuPadding;
if (that.options.dropupAuto) {
this.$newElement.toggleClass('dropup', (selectOffsetTop > selectOffsetBot) && (menuHeight < menu.height()));
}
menu.css({'max-height': menuHeight + headerHeight + searchHeight + actionsHeight + 'px', 'overflow': 'hidden'});
menuInner.css({'max-height': menuHeight - menuPadding + 'px', 'overflow-y': 'auto'});
}
},
setWidth: function () {
if (this.options.width == 'auto') {
this.$menu.css('min-width', '0');
var selectClone = this.$newElement.clone().appendTo('body');
var ulWidth = selectClone.find('> .dropdown-menu').css('width');
var btnWidth = selectClone.css('width', 'auto').find('> button').css('width');
selectClone.remove();
this.$newElement.css('width', Math.max(parseInt(ulWidth), parseInt(btnWidth)) + 'px');
} else if (this.options.width == 'fit') {
this.$menu.css('min-width', '');
this.$newElement.css('width', '').addClass('fit-width');
} else if (this.options.width) {
this.$menu.css('min-width', '');
this.$newElement.css('width', this.options.width);
} else {
this.$menu.css('min-width', '');
this.$newElement.css('width', '');
}
if (this.$newElement.hasClass('fit-width') && this.options.width !== 'fit') {
this.$newElement.removeClass('fit-width');
}
},
selectPosition: function () {
var that = this,
drop = '<div />',
$drop = $(drop),
pos,
actualHeight,
getPlacement = function ($element) {
$drop.addClass($element.attr('class').replace(/form-control/gi, '')).toggleClass('dropup', $element.hasClass('dropup'));
pos = $element.offset();
actualHeight = $element.hasClass('dropup') ? 0 : $element[0].offsetHeight;
$drop.css({
'top': pos.top + actualHeight,
'left': pos.left,
'width': $element[0].offsetWidth,
'position': 'absolute'
});
};
this.$newElement.on('click', function () {
if (that.isDisabled()) {
return;
}
getPlacement($(this));
$drop.appendTo(that.options.container);
$drop.toggleClass('open', !$(this).hasClass('open'));
$drop.append(that.$menu);
});
$(window).resize(function () {
getPlacement(that.$newElement);
});
$(window).on('scroll', function () {
getPlacement(that.$newElement);
});
$('html').on('click', function (e) {
if ($(e.target).closest(that.$newElement).length < 1) {
$drop.removeClass('open');
}
});
},
setSelected: function (index, selected) {
this.findLis();
this.$lis.filter('[data-original-index="' + index + '"]').toggleClass('selected', selected);
},
setDisabled: function (index, disabled) {
this.findLis();
if (disabled) {
this.$lis.filter('[data-original-index="' + index + '"]').addClass('disabled').find('a').attr('href', '#').attr('tabindex', -1);
} else {
this.$lis.filter('[data-original-index="' + index + '"]').removeClass('disabled').find('a').removeAttr('href').attr('tabindex', 0);
}
},
isDisabled: function () {
return this.$element.is(':disabled');
},
checkDisabled: function () {
var that = this;
if (this.isDisabled()) {
this.$button.addClass('disabled').attr('tabindex', -1);
} else {
if (this.$button.hasClass('disabled')) {
this.$button.removeClass('disabled');
}
if (this.$button.attr('tabindex') == -1) {
if (!this.$element.data('tabindex')) this.$button.removeAttr('tabindex');
}
}
this.$button.click(function () {
return !that.isDisabled();
});
},
tabIndex: function () {
if (this.$element.is('[tabindex]')) {
this.$element.data('tabindex', this.$element.attr('tabindex'));
this.$button.attr('tabindex', this.$element.data('tabindex'));
}
},
clickListener: function () {
var that = this;
this.$newElement.on('touchstart.dropdown', '.dropdown-menu', function (e) {
e.stopPropagation();
});
this.$newElement.on('click', function () {
that.setSize();
if (!that.options.liveSearch && !that.multiple) {
setTimeout(function () {
that.$menu.find('.selected a').focus();
}, 10);
}
});
this.$menu.on('click', 'li a', function (e) {
var $this = $(this),
clickedIndex = $this.parent().data('originalIndex'),
prevValue = that.$element.val(),
prevIndex = that.$element.prop('selectedIndex');
if (that.multiple) {
e.stopPropagation();
}
e.preventDefault();
if (!that.isDisabled() && !$this.parent().hasClass('disabled')) {
var $options = that.$element.find('option'),
$option = $options.eq(clickedIndex),
state = $option.prop('selected'),
$optgroup = $option.parent('optgroup'),
maxOptions = that.options.maxOptions,
maxOptionsGrp = $optgroup.data('maxOptions') || false;
if (!that.multiple) { // Deselect all others if not multi select box
$options.prop('selected', false);
$option.prop('selected', true);
that.$menu.find('.selected').removeClass('selected');
that.setSelected(clickedIndex, true);
} else { // Toggle the one we have chosen if we are multi select.
$option.prop('selected', !state);
that.setSelected(clickedIndex, !state);
$this.blur();
if ((maxOptions !== false) || (maxOptionsGrp !== false)) {
var maxReached = maxOptions < $options.filter(':selected').length,
maxReachedGrp = maxOptionsGrp < $optgroup.find('option:selected').length;
if ((maxOptions && maxReached) || (maxOptionsGrp && maxReachedGrp)) {
if (maxOptions && maxOptions == 1) {
$options.prop('selected', false);
$option.prop('selected', true);
that.$menu.find('.selected').removeClass('selected');
that.setSelected(clickedIndex, true);
} else if (maxOptionsGrp && maxOptionsGrp == 1) {
$optgroup.find('option:selected').prop('selected', false);
$option.prop('selected', true);
var optgroupID = $this.data('optgroup');
that.$menu.find('.selected').has('a[data-optgroup="' + optgroupID + '"]').removeClass('selected');
that.setSelected(clickedIndex, true);
} else {
var maxOptionsArr = (typeof that.options.maxOptionsText === 'function') ?
that.options.maxOptionsText(maxOptions, maxOptionsGrp) : that.options.maxOptionsText,
maxTxt = maxOptionsArr[0].replace('{n}', maxOptions),
maxTxtGrp = maxOptionsArr[1].replace('{n}', maxOptionsGrp),
$notify = $('<div class="notify"></div>');
/** @deprecated */
if (maxOptionsArr[2]) {
maxTxt = maxTxt.replace('{var}', maxOptionsArr[2][maxOptions > 1 ? 0 : 1]);
maxTxtGrp = maxTxtGrp.replace('{var}', maxOptionsArr[2][maxOptionsGrp > 1 ? 0 : 1]);
}
$option.prop('selected', false);
that.$menu.append($notify);
if (maxOptions && maxReached) {
$notify.append($('<div>' + maxTxt + '</div>'));
that.$element.trigger('maxReached.bs.select');
}
if (maxOptionsGrp && maxReachedGrp) {
$notify.append($('<div>' + maxTxtGrp + '</div>'));
that.$element.trigger('maxReachedGrp.bs.select');
}
setTimeout(function () {
that.setSelected(clickedIndex, false);
}, 10);
$notify.delay(750).fadeOut(300, function () {
$(this).remove();
});
}
}
}
}
if (!that.multiple) {
that.$button.focus();
} else if (that.options.liveSearch) {
that.$searchbox.focus();
}
if ((prevValue != that.$element.val() && that.multiple) || (prevIndex != that.$element.prop('selectedIndex') && !that.multiple)) {
that.$element.change();
}
}
});
this.$menu.on('click', 'li.disabled a, .popover-title, .popover-title :not(.close)', function (e) {
if (e.target == this) {
e.preventDefault();
e.stopPropagation();
if (!that.options.liveSearch) {
that.$button.focus();
} else {
that.$searchbox.focus();
}
}
});
this.$menu.on('click', 'li.divider, li.dropdown-header', function (e) {
e.preventDefault();
e.stopPropagation();
if (!that.options.liveSearch) {
that.$button.focus();
} else {
that.$searchbox.focus();
}
});
this.$menu.on('click', '.popover-title .close', function () {
that.$button.focus();
});
this.$searchbox.on('click', function (e) {
e.stopPropagation();
});
this.$menu.on('click', '.actions-btn', function (e) {
if (that.options.liveSearch) {
that.$searchbox.focus();
} else {
that.$button.focus();
}
e.preventDefault();
e.stopPropagation();
if ($(this).is('.bs-select-all')) {
that.selectAll();
} else {
that.deselectAll();
}
that.$element.change();
});
this.$element.change(function () {
that.render(false);
});
},
liveSearchListener: function () {
var that = this,
no_results = $('<li class="no-results"></li>');
this.$newElement.on('click.dropdown.data-api touchstart.dropdown.data-api', function () {
that.$menu.find('.active').removeClass('active');
if (!!that.$searchbox.val()) {
that.$searchbox.val('');
that.$lis.not('.is-hidden').removeClass('hide');
if (!!no_results.parent().length) no_results.remove();
}
if (!that.multiple) that.$menu.find('.selected').addClass('active');
setTimeout(function () {
that.$searchbox.focus();
}, 10);
});
this.$searchbox.on('click.dropdown.data-api focus.dropdown.data-api touchend.dropdown.data-api', function (e) {
e.stopPropagation();
});
this.$searchbox.on('input propertychange', function () {
if (that.$searchbox.val()) {
if (that.options.searchAccentInsensitive) {
that.$lis.not('.is-hidden').removeClass('hide').find('a').not(':aicontains(' + normalizeToBase(that.$searchbox.val()) + ')').parent().addClass('hide');
} else {
that.$lis.not('.is-hidden').removeClass('hide').find('a').not(':icontains(' + that.$searchbox.val() + ')').parent().addClass('hide');
}
if (!that.$menu.find('li').filter(':visible:not(.no-results)').length) {
if (!!no_results.parent().length) no_results.remove();
no_results.html(that.options.noneResultsText + ' "' + htmlEscape(that.$searchbox.val()) + '"').show();
that.$menu.find('li').last().after(no_results);
} else if (!!no_results.parent().length) {
no_results.remove();
}
} else {
that.$lis.not('.is-hidden').removeClass('hide');
if (!!no_results.parent().length) no_results.remove();
}
that.$menu.find('li.active').removeClass('active');
that.$menu.find('li').filter(':visible:not(.divider)').eq(0).addClass('active').find('a').focus();
$(this).focus();
});
},
val: function (value) {
if (typeof value !== 'undefined') {
this.$element.val(value);
this.render();
return this.$element;
} else {
return this.$element.val();
}
},
selectAll: function () {
this.findLis();
this.$lis.not('.divider').not('.disabled').not('.selected').filter(':visible').find('a').click();
},
deselectAll: function () {
this.findLis();
this.$lis.not('.divider').not('.disabled').filter('.selected').filter(':visible').find('a').click();
},
keydown: function (e) {
var $this = $(this),
$parent = ($this.is('input')) ? $this.parent().parent() : $this.parent(),
$items,
that = $parent.data('this'),
index,
next,
first,
last,
prev,
nextPrev,
prevIndex,
isActive,
keyCodeMap = {
32: ' ',
48: '0',
49: '1',
50: '2',
51: '3',
52: '4',
53: '5',
54: '6',
55: '7',
56: '8',
57: '9',
59: ';',
65: 'a',
66: 'b',
67: 'c',
68: 'd',
69: 'e',
70: 'f',
71: 'g',
72: 'h',
73: 'i',
74: 'j',
75: 'k',
76: 'l',
77: 'm',
78: 'n',
79: 'o',
80: 'p',
81: 'q',
82: 'r',
83: 's',
84: 't',
85: 'u',
86: 'v',
87: 'w',
88: 'x',
89: 'y',
90: 'z',
96: '0',
97: '1',
98: '2',
99: '3',
100: '4',
101: '5',
102: '6',
103: '7',
104: '8',
105: '9'
};
if (that.options.liveSearch) $parent = $this.parent().parent();
if (that.options.container) $parent = that.$menu;
$items = $('[role=menu] li a', $parent);
isActive = that.$menu.parent().hasClass('open');
if (!isActive && /([0-9]|[A-z])/.test(String.fromCharCode(e.keyCode))) {
if (!that.options.container) {
that.setSize();
that.$menu.parent().addClass('open');
isActive = true;
} else {
that.$newElement.trigger('click');
}
that.$searchbox.focus();
}
if (that.options.liveSearch) {
if (/(^9$|27)/.test(e.keyCode.toString(10)) && isActive && that.$menu.find('.active').length === 0) {
e.preventDefault();
that.$menu.parent().removeClass('open');
that.$button.focus();
}
$items = $('[role=menu] li:not(.divider):not(.dropdown-header):visible', $parent);
if (!$this.val() && !/(38|40)/.test(e.keyCode.toString(10))) {
if ($items.filter('.active').length === 0) {
if (that.options.searchAccentInsensitive) {
$items = that.$newElement.find('li').filter(':aicontains(' + normalizeToBase(keyCodeMap[e.keyCode]) + ')');
} else {
$items = that.$newElement.find('li').filter(':icontains(' + keyCodeMap[e.keyCode] + ')');
}
}
}
}
if (!$items.length) return;
if (/(38|40)/.test(e.keyCode.toString(10))) {
index = $items.index($items.filter(':focus'));
first = $items.parent(':not(.disabled):visible').first().index();
last = $items.parent(':not(.disabled):visible').last().index();
next = $items.eq(index).parent().nextAll(':not(.disabled):visible').eq(0).index();
prev = $items.eq(index).parent().prevAll(':not(.disabled):visible').eq(0).index();
nextPrev = $items.eq(next).parent().prevAll(':not(.disabled):visible').eq(0).index();
if (that.options.liveSearch) {
$items.each(function (i) {
if ($(this).is(':not(.disabled)')) {
$(this).data('index', i);
}
});
index = $items.index($items.filter('.active'));
first = $items.filter(':not(.disabled):visible').first().data('index');
last = $items.filter(':not(.disabled):visible').last().data('index');
next = $items.eq(index).nextAll(':not(.disabled):visible').eq(0).data('index');
prev = $items.eq(index).prevAll(':not(.disabled):visible').eq(0).data('index');
nextPrev = $items.eq(next).prevAll(':not(.disabled):visible').eq(0).data('index');
}
prevIndex = $this.data('prevIndex');
if (e.keyCode == 38) {
if (that.options.liveSearch) index -= 1;
if (index != nextPrev && index > prev) index = prev;
if (index < first) index = first;
if (index == prevIndex) index = last;
}
if (e.keyCode == 40) {
if (that.options.liveSearch) index += 1;
if (index == -1) index = 0;
if (index != nextPrev && index < next) index = next;
if (index > last) index = last;
if (index == prevIndex) index = first;
}
$this.data('prevIndex', index);
if (!that.options.liveSearch) {
$items.eq(index).focus();
} else {
e.preventDefault();
if (!$this.is('.dropdown-toggle')) {
$items.removeClass('active');
$items.eq(index).addClass('active').find('a').focus();
$this.focus();
}
}
} else if (!$this.is('input')) {
var keyIndex = [],
count,
prevKey;
$items.each(function () {
if ($(this).parent().is(':not(.disabled)')) {
if ($.trim($(this).text().toLowerCase()).substring(0, 1) == keyCodeMap[e.keyCode]) {
keyIndex.push($(this).parent().index());
}
}
});
count = $(document).data('keycount');
count++;
$(document).data('keycount', count);
prevKey = $.trim($(':focus').text().toLowerCase()).substring(0, 1);
if (prevKey != keyCodeMap[e.keyCode]) {
count = 1;
$(document).data('keycount', count);
} else if (count >= keyIndex.length) {
$(document).data('keycount', 0);
if (count > keyIndex.length) count = 1;
}
$items.eq(keyIndex[count - 1]).focus();
}
if ((/(13|32)/.test(e.keyCode.toString(10)) || (/(^9$)/.test(e.keyCode.toString(10)) && that.options.selectOnTab)) && isActive) {
if (!/(32)/.test(e.keyCode.toString(10))) e.preventDefault();
if (!that.options.liveSearch) {
$(':focus').click();
} else if (!/(32)/.test(e.keyCode.toString(10))) {
that.$menu.find('.active a').click();
$this.focus();
}
$(document).data('keycount', 0);
}
if ((/(^9$|27)/.test(e.keyCode.toString(10)) && isActive && (that.multiple || that.options.liveSearch)) || (/(27)/.test(e.keyCode.toString(10)) && !isActive)) {
that.$menu.parent().removeClass('open');
that.$button.focus();
}
},
mobile: function () {
this.$element.addClass('mobile-device').appendTo(this.$newElement);
if (this.options.container) this.$menu.hide();
},
refresh: function () {
this.$lis = null;
this.reloadLi();
this.render();
this.setWidth();
this.setStyle();
this.checkDisabled();
this.liHeight();
},
update: function () {
this.reloadLi();
this.setWidth();
this.setStyle();
this.checkDisabled();
this.liHeight();
},
hide: function () {
this.$newElement.hide();
},
show: function () {
this.$newElement.show();
},
remove: function () {
this.$newElement.remove();
this.$element.remove();
}
};
function Plugin(option, event) {
var args = arguments;
var _option = option,
option = args[0],
event = args[1];
[].shift.apply(args);
if (typeof option == 'undefined') {
option = _option;
}
var value;
var chain = this.each(function () {
var $this = $(this);
if ($this.is('select')) {
var data = $this.data('selectpicker'),
options = typeof option == 'object' && option;
if (!data) {
var config = $.extend({}, Selectpicker.DEFAULTS, $.fn.selectpicker.defaults || {}, $this.data(), options);
$this.data('selectpicker', (data = new Selectpicker(this, config, event)));
} else if (options) {
for (var i in options) {
if (options.hasOwnProperty(i)) {
data.options[i] = options[i];
}
}
}
if (typeof option == 'string') {
if (data[option] instanceof Function) {
value = data[option].apply(data, args);
} else {
value = data.options[option];
}
}
}
});
if (typeof value !== 'undefined') {
return value;
} else {
return chain;
}
}
var old = $.fn.selectpicker;
$.fn.selectpicker = Plugin;
$.fn.selectpicker.Constructor = Selectpicker;
$.fn.selectpicker.noConflict = function () {
$.fn.selectpicker = old;
return this;
};
$(document)
.data('keycount', 0)
.on('keydown', '.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=menu], .bs-searchbox input', Selectpicker.prototype.keydown)
.on('focusin.modal', '.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=menu], .bs-searchbox input', function (e) {
e.stopPropagation();
});
$(window).on('load.bs.select.data-api', function () {
$('.selectpicker').each(function () {
var $selectpicker = $(this);
Plugin.call($selectpicker, $selectpicker.data());
})
});
})(jQuery);
;
;
/*! angular.min.js */ 
;
;
/*
AngularJS v1.2.22
(c) 2010-2014 Google, Inc. http://angularjs.org
License: MIT
*/
(function(P,X,s){'use strict';function w(b){return function(){var a=arguments[0],c,a="["+(b?b+":":"")+a+"] http://errors.angularjs.org/1.2.22/"+(b?b+"/":"")+a;for(c=1;c<arguments.length;c++)a=a+(1==c?"?":"&")+"p"+(c-1)+"="+encodeURIComponent("function"==typeof arguments[c]?arguments[c].toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof arguments[c]?"undefined":"string"!=typeof arguments[c]?JSON.stringify(arguments[c]):arguments[c]);return Error(a)}}function fb(b){if(null==b||Fa(b))return!1;
var a=b.length;return 1===b.nodeType&&a?!0:C(b)||L(b)||0===a||"number"===typeof a&&0<a&&a-1 in b}function r(b,a,c){var d;if(b)if(J(b))for(d in b)"prototype"==d||("length"==d||"name"==d||b.hasOwnProperty&&!b.hasOwnProperty(d))||a.call(c,b[d],d);else if(L(b)||fb(b))for(d=0;d<b.length;d++)a.call(c,b[d],d);else if(b.forEach&&b.forEach!==r)b.forEach(a,c);else for(d in b)b.hasOwnProperty(d)&&a.call(c,b[d],d);return b}function Zb(b){var a=[],c;for(c in b)b.hasOwnProperty(c)&&a.push(c);return a.sort()}function Tc(b,
a,c){for(var d=Zb(b),e=0;e<d.length;e++)a.call(c,b[d[e]],d[e]);return d}function $b(b){return function(a,c){b(c,a)}}function gb(){for(var b=la.length,a;b;){b--;a=la[b].charCodeAt(0);if(57==a)return la[b]="A",la.join("");if(90==a)la[b]="0";else return la[b]=String.fromCharCode(a+1),la.join("")}la.unshift("0");return la.join("")}function ac(b,a){a?b.$$hashKey=a:delete b.$$hashKey}function E(b){var a=b.$$hashKey;r(arguments,function(a){a!==b&&r(a,function(a,c){b[c]=a})});ac(b,a);return b}function Z(b){return parseInt(b,
10)}function bc(b,a){return E(new (E(function(){},{prototype:b})),a)}function z(){}function Ga(b){return b}function $(b){return function(){return b}}function F(b){return"undefined"===typeof b}function D(b){return"undefined"!==typeof b}function T(b){return null!=b&&"object"===typeof b}function C(b){return"string"===typeof b}function Ab(b){return"number"===typeof b}function sa(b){return"[object Date]"===ya.call(b)}function J(b){return"function"===typeof b}function hb(b){return"[object RegExp]"===ya.call(b)}
function Fa(b){return b&&b.document&&b.location&&b.alert&&b.setInterval}function Uc(b){return!(!b||!(b.nodeName||b.prop&&b.attr&&b.find))}function Vc(b,a,c){var d=[];r(b,function(b,f,g){d.push(a.call(c,b,f,g))});return d}function Qa(b,a){if(b.indexOf)return b.indexOf(a);for(var c=0;c<b.length;c++)if(a===b[c])return c;return-1}function Ra(b,a){var c=Qa(b,a);0<=c&&b.splice(c,1);return a}function Ha(b,a,c,d){if(Fa(b)||b&&b.$evalAsync&&b.$watch)throw Sa("cpws");if(a){if(b===a)throw Sa("cpi");c=c||[];
d=d||[];if(T(b)){var e=Qa(c,b);if(-1!==e)return d[e];c.push(b);d.push(a)}if(L(b))for(var f=a.length=0;f<b.length;f++)e=Ha(b[f],null,c,d),T(b[f])&&(c.push(b[f]),d.push(e)),a.push(e);else{var g=a.$$hashKey;r(a,function(b,c){delete a[c]});for(f in b)e=Ha(b[f],null,c,d),T(b[f])&&(c.push(b[f]),d.push(e)),a[f]=e;ac(a,g)}}else if(a=b)L(b)?a=Ha(b,[],c,d):sa(b)?a=new Date(b.getTime()):hb(b)?(a=RegExp(b.source,b.toString().match(/[^\/]*$/)[0]),a.lastIndex=b.lastIndex):T(b)&&(a=Ha(b,{},c,d));return a}function ga(b,
a){if(L(b)){a=a||[];for(var c=0;c<b.length;c++)a[c]=b[c]}else if(T(b))for(c in a=a||{},b)!ib.call(b,c)||"$"===c.charAt(0)&&"$"===c.charAt(1)||(a[c]=b[c]);return a||b}function za(b,a){if(b===a)return!0;if(null===b||null===a)return!1;if(b!==b&&a!==a)return!0;var c=typeof b,d;if(c==typeof a&&"object"==c)if(L(b)){if(!L(a))return!1;if((c=b.length)==a.length){for(d=0;d<c;d++)if(!za(b[d],a[d]))return!1;return!0}}else{if(sa(b))return sa(a)&&b.getTime()==a.getTime();if(hb(b)&&hb(a))return b.toString()==a.toString();
if(b&&b.$evalAsync&&b.$watch||a&&a.$evalAsync&&a.$watch||Fa(b)||Fa(a)||L(a))return!1;c={};for(d in b)if("$"!==d.charAt(0)&&!J(b[d])){if(!za(b[d],a[d]))return!1;c[d]=!0}for(d in a)if(!c.hasOwnProperty(d)&&"$"!==d.charAt(0)&&a[d]!==s&&!J(a[d]))return!1;return!0}return!1}function Bb(b,a){var c=2<arguments.length?Aa.call(arguments,2):[];return!J(a)||a instanceof RegExp?a:c.length?function(){return arguments.length?a.apply(b,c.concat(Aa.call(arguments,0))):a.apply(b,c)}:function(){return arguments.length?
a.apply(b,arguments):a.call(b)}}function Wc(b,a){var c=a;"string"===typeof b&&"$"===b.charAt(0)?c=s:Fa(a)?c="$WINDOW":a&&X===a?c="$DOCUMENT":a&&(a.$evalAsync&&a.$watch)&&(c="$SCOPE");return c}function ta(b,a){return"undefined"===typeof b?s:JSON.stringify(b,Wc,a?"  ":null)}function cc(b){return C(b)?JSON.parse(b):b}function Ta(b){"function"===typeof b?b=!0:b&&0!==b.length?(b=M(""+b),b=!("f"==b||"0"==b||"false"==b||"no"==b||"n"==b||"[]"==b)):b=!1;return b}function ha(b){b=y(b).clone();try{b.empty()}catch(a){}var c=
y("<div>").append(b).html();try{return 3===b[0].nodeType?M(c):c.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(a,b){return"<"+M(b)})}catch(d){return M(c)}}function dc(b){try{return decodeURIComponent(b)}catch(a){}}function ec(b){var a={},c,d;r((b||"").split("&"),function(b){b&&(c=b.replace(/\+/g,"%20").split("="),d=dc(c[0]),D(d)&&(b=D(c[1])?dc(c[1]):!0,ib.call(a,d)?L(a[d])?a[d].push(b):a[d]=[a[d],b]:a[d]=b))});return a}function Cb(b){var a=[];r(b,function(b,d){L(b)?r(b,function(b){a.push(Ba(d,
!0)+(!0===b?"":"="+Ba(b,!0)))}):a.push(Ba(d,!0)+(!0===b?"":"="+Ba(b,!0)))});return a.length?a.join("&"):""}function jb(b){return Ba(b,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function Ba(b,a){return encodeURIComponent(b).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,a?"%20":"+")}function Xc(b,a){function c(a){a&&d.push(a)}var d=[b],e,f,g=["ng:app","ng-app","x-ng-app","data-ng-app"],k=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;
r(g,function(a){g[a]=!0;c(X.getElementById(a));a=a.replace(":","\\:");b.querySelectorAll&&(r(b.querySelectorAll("."+a),c),r(b.querySelectorAll("."+a+"\\:"),c),r(b.querySelectorAll("["+a+"]"),c))});r(d,function(a){if(!e){var b=k.exec(" "+a.className+" ");b?(e=a,f=(b[2]||"").replace(/\s+/g,",")):r(a.attributes,function(b){!e&&g[b.name]&&(e=a,f=b.value)})}});e&&a(e,f?[f]:[])}function fc(b,a){var c=function(){b=y(b);if(b.injector()){var c=b[0]===X?"document":ha(b);throw Sa("btstrpd",c);}a=a||[];a.unshift(["$provide",
function(a){a.value("$rootElement",b)}]);a.unshift("ng");c=gc(a);c.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(a,b,c,d,e){a.$apply(function(){b.data("$injector",d);c(b)(a)})}]);return c},d=/^NG_DEFER_BOOTSTRAP!/;if(P&&!d.test(P.name))return c();P.name=P.name.replace(d,"");Ua.resumeBootstrap=function(b){r(b,function(b){a.push(b)});c()}}function kb(b,a){a=a||"_";return b.replace(Yc,function(b,d){return(d?a:"")+b.toLowerCase()})}function Db(b,a,c){if(!b)throw Sa("areq",
a||"?",c||"required");return b}function Va(b,a,c){c&&L(b)&&(b=b[b.length-1]);Db(J(b),a,"not a function, got "+(b&&"object"===typeof b?b.constructor.name||"Object":typeof b));return b}function Ca(b,a){if("hasOwnProperty"===b)throw Sa("badname",a);}function hc(b,a,c){if(!a)return b;a=a.split(".");for(var d,e=b,f=a.length,g=0;g<f;g++)d=a[g],b&&(b=(e=b)[d]);return!c&&J(b)?Bb(e,b):b}function Eb(b){var a=b[0];b=b[b.length-1];if(a===b)return y(a);var c=[a];do{a=a.nextSibling;if(!a)break;c.push(a)}while(a!==
b);return y(c)}function Zc(b){var a=w("$injector"),c=w("ng");b=b.angular||(b.angular={});b.$$minErr=b.$$minErr||w;return b.module||(b.module=function(){var b={};return function(e,f,g){if("hasOwnProperty"===e)throw c("badname","module");f&&b.hasOwnProperty(e)&&(b[e]=null);return b[e]||(b[e]=function(){function b(a,d,e){return function(){c[e||"push"]([a,d,arguments]);return n}}if(!f)throw a("nomod",e);var c=[],d=[],l=b("$injector","invoke"),n={_invokeQueue:c,_runBlocks:d,requires:f,name:e,provider:b("$provide",
"provider"),factory:b("$provide","factory"),service:b("$provide","service"),value:b("$provide","value"),constant:b("$provide","constant","unshift"),animation:b("$animateProvider","register"),filter:b("$filterProvider","register"),controller:b("$controllerProvider","register"),directive:b("$compileProvider","directive"),config:l,run:function(a){d.push(a);return this}};g&&l(g);return n}())}}())}function $c(b){E(b,{bootstrap:fc,copy:Ha,extend:E,equals:za,element:y,forEach:r,injector:gc,noop:z,bind:Bb,
toJson:ta,fromJson:cc,identity:Ga,isUndefined:F,isDefined:D,isString:C,isFunction:J,isObject:T,isNumber:Ab,isElement:Uc,isArray:L,version:ad,isDate:sa,lowercase:M,uppercase:Ia,callbacks:{counter:0},$$minErr:w,$$csp:Wa});Xa=Zc(P);try{Xa("ngLocale")}catch(a){Xa("ngLocale",[]).provider("$locale",bd)}Xa("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:cd});a.provider("$compile",ic).directive({a:dd,input:jc,textarea:jc,form:ed,script:fd,select:gd,style:hd,option:id,ngBind:jd,ngBindHtml:kd,
ngBindTemplate:ld,ngClass:md,ngClassEven:nd,ngClassOdd:od,ngCloak:pd,ngController:qd,ngForm:rd,ngHide:sd,ngIf:td,ngInclude:ud,ngInit:vd,ngNonBindable:wd,ngPluralize:xd,ngRepeat:yd,ngShow:zd,ngStyle:Ad,ngSwitch:Bd,ngSwitchWhen:Cd,ngSwitchDefault:Dd,ngOptions:Ed,ngTransclude:Fd,ngModel:Gd,ngList:Hd,ngChange:Id,required:kc,ngRequired:kc,ngValue:Jd}).directive({ngInclude:Kd}).directive(Fb).directive(lc);a.provider({$anchorScroll:Ld,$animate:Md,$browser:Nd,$cacheFactory:Od,$controller:Pd,$document:Qd,
$exceptionHandler:Rd,$filter:mc,$interpolate:Sd,$interval:Td,$http:Ud,$httpBackend:Vd,$location:Wd,$log:Xd,$parse:Yd,$rootScope:Zd,$q:$d,$sce:ae,$sceDelegate:be,$sniffer:ce,$templateCache:de,$timeout:ee,$window:fe,$$rAF:ge,$$asyncCallback:he})}])}function Ya(b){return b.replace(ie,function(a,b,d,e){return e?d.toUpperCase():d}).replace(je,"Moz$1")}function Gb(b,a,c,d){function e(b){var e=c&&b?[this.filter(b)]:[this],m=a,h,l,n,p,q,t;if(!d||null!=b)for(;e.length;)for(h=e.shift(),l=0,n=h.length;l<n;l++)for(p=
y(h[l]),m?p.triggerHandler("$destroy"):m=!m,q=0,p=(t=p.children()).length;q<p;q++)e.push(Da(t[q]));return f.apply(this,arguments)}var f=Da.fn[b],f=f.$original||f;e.$original=f;Da.fn[b]=e}function S(b){if(b instanceof S)return b;C(b)&&(b=aa(b));if(!(this instanceof S)){if(C(b)&&"<"!=b.charAt(0))throw Hb("nosel");return new S(b)}if(C(b)){var a=b;b=X;var c;if(c=ke.exec(a))b=[b.createElement(c[1])];else{var d=b,e;b=d.createDocumentFragment();c=[];if(Ib.test(a)){d=b.appendChild(d.createElement("div"));
e=(le.exec(a)||["",""])[1].toLowerCase();e=ba[e]||ba._default;d.innerHTML="<div>&#160;</div>"+e[1]+a.replace(me,"<$1></$2>")+e[2];d.removeChild(d.firstChild);for(a=e[0];a--;)d=d.lastChild;a=0;for(e=d.childNodes.length;a<e;++a)c.push(d.childNodes[a]);d=b.firstChild;d.textContent=""}else c.push(d.createTextNode(a));b.textContent="";b.innerHTML="";b=c}Jb(this,b);y(X.createDocumentFragment()).append(this)}else Jb(this,b)}function Kb(b){return b.cloneNode(!0)}function Ja(b){Lb(b);var a=0;for(b=b.childNodes||
[];a<b.length;a++)Ja(b[a])}function nc(b,a,c,d){if(D(d))throw Hb("offargs");var e=ma(b,"events");ma(b,"handle")&&(F(a)?r(e,function(a,c){Za(b,c,a);delete e[c]}):r(a.split(" "),function(a){F(c)?(Za(b,a,e[a]),delete e[a]):Ra(e[a]||[],c)}))}function Lb(b,a){var c=b.ng339,d=$a[c];d&&(a?delete $a[c].data[a]:(d.handle&&(d.events.$destroy&&d.handle({},"$destroy"),nc(b)),delete $a[c],b.ng339=s))}function ma(b,a,c){var d=b.ng339,d=$a[d||-1];if(D(c))d||(b.ng339=d=++ne,d=$a[d]={}),d[a]=c;else return d&&d[a]}
function Mb(b,a,c){var d=ma(b,"data"),e=D(c),f=!e&&D(a),g=f&&!T(a);d||g||ma(b,"data",d={});if(e)d[a]=c;else if(f){if(g)return d&&d[a];E(d,a)}else return d}function Nb(b,a){return b.getAttribute?-1<(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+a+" "):!1}function lb(b,a){a&&b.setAttribute&&r(a.split(" "),function(a){b.setAttribute("class",aa((" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+aa(a)+" "," ")))})}function mb(b,a){if(a&&b.setAttribute){var c=
(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");r(a.split(" "),function(a){a=aa(a);-1===c.indexOf(" "+a+" ")&&(c+=a+" ")});b.setAttribute("class",aa(c))}}function Jb(b,a){if(a){a=a.nodeName||!D(a.length)||Fa(a)?[a]:a;for(var c=0;c<a.length;c++)b.push(a[c])}}function oc(b,a){return nb(b,"$"+(a||"ngController")+"Controller")}function nb(b,a,c){9==b.nodeType&&(b=b.documentElement);for(a=L(a)?a:[a];b;){for(var d=0,e=a.length;d<e;d++)if((c=y.data(b,a[d]))!==s)return c;b=b.parentNode||11===
b.nodeType&&b.host}}function pc(b){for(var a=0,c=b.childNodes;a<c.length;a++)Ja(c[a]);for(;b.firstChild;)b.removeChild(b.firstChild)}function qc(b,a){var c=ob[a.toLowerCase()];return c&&rc[b.nodeName]&&c}function oe(b,a){var c=function(c,e){c.preventDefault||(c.preventDefault=function(){c.returnValue=!1});c.stopPropagation||(c.stopPropagation=function(){c.cancelBubble=!0});c.target||(c.target=c.srcElement||X);if(F(c.defaultPrevented)){var f=c.preventDefault;c.preventDefault=function(){c.defaultPrevented=
!0;f.call(c)};c.defaultPrevented=!1}c.isDefaultPrevented=function(){return c.defaultPrevented||!1===c.returnValue};var g=ga(a[e||c.type]||[]);r(g,function(a){a.call(b,c)});8>=Q?(c.preventDefault=null,c.stopPropagation=null,c.isDefaultPrevented=null):(delete c.preventDefault,delete c.stopPropagation,delete c.isDefaultPrevented)};c.elem=b;return c}function Ka(b,a){var c=typeof b,d;"function"==c||"object"==c&&null!==b?"function"==typeof(d=b.$$hashKey)?d=b.$$hashKey():d===s&&(d=b.$$hashKey=(a||gb)()):
d=b;return c+":"+d}function ab(b,a){if(a){var c=0;this.nextUid=function(){return++c}}r(b,this.put,this)}function sc(b){var a,c;"function"===typeof b?(a=b.$inject)||(a=[],b.length&&(c=b.toString().replace(pe,""),c=c.match(qe),r(c[1].split(re),function(b){b.replace(se,function(b,c,d){a.push(d)})})),b.$inject=a):L(b)?(c=b.length-1,Va(b[c],"fn"),a=b.slice(0,c)):Va(b,"fn",!0);return a}function gc(b){function a(a){return function(b,c){if(T(b))r(b,$b(a));else return a(b,c)}}function c(a,b){Ca(a,"service");
if(J(b)||L(b))b=n.instantiate(b);if(!b.$get)throw bb("pget",a);return l[a+k]=b}function d(a,b){return c(a,{$get:b})}function e(a){var b=[],c,d,f,k;r(a,function(a){if(!h.get(a)){h.put(a,!0);try{if(C(a))for(c=Xa(a),b=b.concat(e(c.requires)).concat(c._runBlocks),d=c._invokeQueue,f=0,k=d.length;f<k;f++){var g=d[f],m=n.get(g[0]);m[g[1]].apply(m,g[2])}else J(a)?b.push(n.invoke(a)):L(a)?b.push(n.invoke(a)):Va(a,"module")}catch(l){throw L(a)&&(a=a[a.length-1]),l.message&&(l.stack&&-1==l.stack.indexOf(l.message))&&
(l=l.message+"\n"+l.stack),bb("modulerr",a,l.stack||l.message||l);}}});return b}function f(a,b){function c(d){if(a.hasOwnProperty(d)){if(a[d]===g)throw bb("cdep",d+" <- "+m.join(" <- "));return a[d]}try{return m.unshift(d),a[d]=g,a[d]=b(d)}catch(e){throw a[d]===g&&delete a[d],e;}finally{m.shift()}}function d(a,b,e){var f=[],k=sc(a),g,m,h;m=0;for(g=k.length;m<g;m++){h=k[m];if("string"!==typeof h)throw bb("itkn",h);f.push(e&&e.hasOwnProperty(h)?e[h]:c(h))}L(a)&&(a=a[g]);return a.apply(b,f)}return{invoke:d,
instantiate:function(a,b){var c=function(){},e;c.prototype=(L(a)?a[a.length-1]:a).prototype;c=new c;e=d(a,c,b);return T(e)||J(e)?e:c},get:c,annotate:sc,has:function(b){return l.hasOwnProperty(b+k)||a.hasOwnProperty(b)}}}var g={},k="Provider",m=[],h=new ab([],!0),l={$provide:{provider:a(c),factory:a(d),service:a(function(a,b){return d(a,["$injector",function(a){return a.instantiate(b)}])}),value:a(function(a,b){return d(a,$(b))}),constant:a(function(a,b){Ca(a,"constant");l[a]=b;p[a]=b}),decorator:function(a,
b){var c=n.get(a+k),d=c.$get;c.$get=function(){var a=q.invoke(d,c);return q.invoke(b,null,{$delegate:a})}}}},n=l.$injector=f(l,function(){throw bb("unpr",m.join(" <- "));}),p={},q=p.$injector=f(p,function(a){a=n.get(a+k);return q.invoke(a.$get,a)});r(e(b),function(a){q.invoke(a||z)});return q}function Ld(){var b=!0;this.disableAutoScrolling=function(){b=!1};this.$get=["$window","$location","$rootScope",function(a,c,d){function e(a){var b=null;r(a,function(a){b||"a"!==M(a.nodeName)||(b=a)});return b}
function f(){var b=c.hash(),d;b?(d=g.getElementById(b))?d.scrollIntoView():(d=e(g.getElementsByName(b)))?d.scrollIntoView():"top"===b&&a.scrollTo(0,0):a.scrollTo(0,0)}var g=a.document;b&&d.$watch(function(){return c.hash()},function(){d.$evalAsync(f)});return f}]}function he(){this.$get=["$$rAF","$timeout",function(b,a){return b.supported?function(a){return b(a)}:function(b){return a(b,0,!1)}}]}function te(b,a,c,d){function e(a){try{a.apply(null,Aa.call(arguments,1))}finally{if(t--,0===t)for(;K.length;)try{K.pop()()}catch(b){c.error(b)}}}
function f(a,b){(function ca(){r(x,function(a){a()});v=b(ca,a)})()}function g(){u=null;A!=k.url()&&(A=k.url(),r(da,function(a){a(k.url())}))}var k=this,m=a[0],h=b.location,l=b.history,n=b.setTimeout,p=b.clearTimeout,q={};k.isMock=!1;var t=0,K=[];k.$$completeOutstandingRequest=e;k.$$incOutstandingRequestCount=function(){t++};k.notifyWhenNoOutstandingRequests=function(a){r(x,function(a){a()});0===t?a():K.push(a)};var x=[],v;k.addPollFn=function(a){F(v)&&f(100,n);x.push(a);return a};var A=h.href,R=a.find("base"),
u=null;k.url=function(a,c){h!==b.location&&(h=b.location);l!==b.history&&(l=b.history);if(a){if(A!=a)return A=a,d.history?c?l.replaceState(null,"",a):(l.pushState(null,"",a),R.attr("href",R.attr("href"))):(u=a,c?h.replace(a):h.href=a),k}else return u||h.href.replace(/%27/g,"'")};var da=[],I=!1;k.onUrlChange=function(a){if(!I){if(d.history)y(b).on("popstate",g);if(d.hashchange)y(b).on("hashchange",g);else k.addPollFn(g);I=!0}da.push(a);return a};k.baseHref=function(){var a=R.attr("href");return a?
a.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var W={},ea="",N=k.baseHref();k.cookies=function(a,b){var d,e,f,k;if(a)b===s?m.cookie=escape(a)+"=;path="+N+";expires=Thu, 01 Jan 1970 00:00:00 GMT":C(b)&&(d=(m.cookie=escape(a)+"="+escape(b)+";path="+N).length+1,4096<d&&c.warn("Cookie '"+a+"' possibly not set or overflowed because it was too large ("+d+" > 4096 bytes)!"));else{if(m.cookie!==ea)for(ea=m.cookie,d=ea.split("; "),W={},f=0;f<d.length;f++)e=d[f],k=e.indexOf("="),0<k&&(a=unescape(e.substring(0,
k)),W[a]===s&&(W[a]=unescape(e.substring(k+1))));return W}};k.defer=function(a,b){var c;t++;c=n(function(){delete q[c];e(a)},b||0);q[c]=!0;return c};k.defer.cancel=function(a){return q[a]?(delete q[a],p(a),e(z),!0):!1}}function Nd(){this.$get=["$window","$log","$sniffer","$document",function(b,a,c,d){return new te(b,d,a,c)}]}function Od(){this.$get=function(){function b(b,d){function e(a){a!=n&&(p?p==a&&(p=a.n):p=a,f(a.n,a.p),f(a,n),n=a,n.n=null)}function f(a,b){a!=b&&(a&&(a.p=b),b&&(b.n=a))}if(b in
a)throw w("$cacheFactory")("iid",b);var g=0,k=E({},d,{id:b}),m={},h=d&&d.capacity||Number.MAX_VALUE,l={},n=null,p=null;return a[b]={put:function(a,b){if(h<Number.MAX_VALUE){var c=l[a]||(l[a]={key:a});e(c)}if(!F(b))return a in m||g++,m[a]=b,g>h&&this.remove(p.key),b},get:function(a){if(h<Number.MAX_VALUE){var b=l[a];if(!b)return;e(b)}return m[a]},remove:function(a){if(h<Number.MAX_VALUE){var b=l[a];if(!b)return;b==n&&(n=b.p);b==p&&(p=b.n);f(b.n,b.p);delete l[a]}delete m[a];g--},removeAll:function(){m=
{};g=0;l={};n=p=null},destroy:function(){l=k=m=null;delete a[b]},info:function(){return E({},k,{size:g})}}}var a={};b.info=function(){var b={};r(a,function(a,e){b[e]=a.info()});return b};b.get=function(b){return a[b]};return b}}function de(){this.$get=["$cacheFactory",function(b){return b("templates")}]}function ic(b,a){var c={},d="Directive",e=/^\s*directive\:\s*([\d\w_\-]+)\s+(.*)$/,f=/(([\d\w_\-]+)(?:\:([^;]+))?;?)/,g=/^(on[a-z]+|formaction)$/;this.directive=function m(a,e){Ca(a,"directive");C(a)?
(Db(e,"directiveFactory"),c.hasOwnProperty(a)||(c[a]=[],b.factory(a+d,["$injector","$exceptionHandler",function(b,d){var e=[];r(c[a],function(c,f){try{var g=b.invoke(c);J(g)?g={compile:$(g)}:!g.compile&&g.link&&(g.compile=$(g.link));g.priority=g.priority||0;g.index=f;g.name=g.name||a;g.require=g.require||g.controller&&g.name;g.restrict=g.restrict||"A";e.push(g)}catch(m){d(m)}});return e}])),c[a].push(e)):r(a,$b(m));return this};this.aHrefSanitizationWhitelist=function(b){return D(b)?(a.aHrefSanitizationWhitelist(b),
this):a.aHrefSanitizationWhitelist()};this.imgSrcSanitizationWhitelist=function(b){return D(b)?(a.imgSrcSanitizationWhitelist(b),this):a.imgSrcSanitizationWhitelist()};this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(a,b,l,n,p,q,t,K,x,v,A,R){function u(a,b,c,d,e){a instanceof y||(a=y(a));r(a,function(b,c){3==b.nodeType&&b.nodeValue.match(/\S+/)&&(a[c]=y(b).wrap("<span></span>").parent()[0])});
var f=I(a,b,a,c,d,e);da(a,"ng-scope");return function(b,c,d,e){Db(b,"scope");var g=c?La.clone.call(a):a;r(d,function(a,b){g.data("$"+b+"Controller",a)});d=0;for(var m=g.length;d<m;d++){var h=g[d].nodeType;1!==h&&9!==h||g.eq(d).data("$scope",b)}c&&c(g,b);f&&f(b,g,g,e);return g}}function da(a,b){try{a.addClass(b)}catch(c){}}function I(a,b,c,d,e,f){function g(a,c,d,e){var f,h,l,q,n,p,t;f=c.length;var x=Array(f);for(q=0;q<f;q++)x[q]=c[q];p=q=0;for(n=m.length;q<n;p++)h=x[p],c=m[q++],f=m[q++],c?(c.scope?
(l=a.$new(),y.data(h,"$scope",l)):l=a,t=c.transcludeOnThisElement?W(a,c.transclude,e):!c.templateOnThisElement&&e?e:!e&&b?W(a,b):null,c(f,l,h,d,t)):f&&f(a,h.childNodes,s,e)}for(var m=[],h,l,q,n,p=0;p<a.length;p++)h=new Ob,l=ea(a[p],[],h,0===p?d:s,e),(f=l.length?G(l,a[p],h,b,c,null,[],[],f):null)&&f.scope&&da(h.$$element,"ng-scope"),h=f&&f.terminal||!(q=a[p].childNodes)||!q.length?null:I(q,f?(f.transcludeOnThisElement||!f.templateOnThisElement)&&f.transclude:b),m.push(f,h),n=n||f||h,f=null;return n?
g:null}function W(a,b,c){return function(d,e,f){var g=!1;d||(d=a.$new(),g=d.$$transcluded=!0);e=b(d,e,f,c);if(g)e.on("$destroy",function(){d.$destroy()});return e}}function ea(a,b,c,d,g){var h=c.$attr,m;switch(a.nodeType){case 1:ca(b,na(Ma(a).toLowerCase()),"E",d,g);for(var l,q,n,p=a.attributes,t=0,x=p&&p.length;t<x;t++){var K=!1,v=!1;l=p[t];if(!Q||8<=Q||l.specified){m=l.name;q=aa(l.value);l=na(m);if(n=V.test(l))m=kb(l.substr(6),"-");var A=l.replace(/(Start|End)$/,"");l===A+"Start"&&(K=m,v=m.substr(0,
m.length-5)+"end",m=m.substr(0,m.length-6));l=na(m.toLowerCase());h[l]=m;if(n||!c.hasOwnProperty(l))c[l]=q,qc(a,l)&&(c[l]=!0);P(a,b,q,l);ca(b,l,"A",d,g,K,v)}}a=a.className;if(C(a)&&""!==a)for(;m=f.exec(a);)l=na(m[2]),ca(b,l,"C",d,g)&&(c[l]=aa(m[3])),a=a.substr(m.index+m[0].length);break;case 3:w(b,a.nodeValue);break;case 8:try{if(m=e.exec(a.nodeValue))l=na(m[1]),ca(b,l,"M",d,g)&&(c[l]=aa(m[2]))}catch(u){}}b.sort(F);return b}function N(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw ia("uterdir",
b,c);1==a.nodeType&&(a.hasAttribute(b)&&e++,a.hasAttribute(c)&&e--);d.push(a);a=a.nextSibling}while(0<e)}else d.push(a);return y(d)}function B(a,b,c){return function(d,e,f,g,m){e=N(e[0],b,c);return a(d,e,f,g,m)}}function G(a,c,d,e,f,g,m,n,p){function x(a,b,c,d){if(a){c&&(a=B(a,c,d));a.require=H.require;a.directiveName=oa;if(I===H||H.$$isolateScope)a=tc(a,{isolateScope:!0});m.push(a)}if(b){c&&(b=B(b,c,d));b.require=H.require;b.directiveName=oa;if(I===H||H.$$isolateScope)b=tc(b,{isolateScope:!0});n.push(b)}}
function K(a,b,c,d){var e,f="data",g=!1;if(C(b)){for(;"^"==(e=b.charAt(0))||"?"==e;)b=b.substr(1),"^"==e&&(f="inheritedData"),g=g||"?"==e;e=null;d&&"data"===f&&(e=d[b]);e=e||c[f]("$"+b+"Controller");if(!e&&!g)throw ia("ctreq",b,a);}else L(b)&&(e=[],r(b,function(b){e.push(K(a,b,c,d))}));return e}function v(a,e,f,g,p){function x(a,b){var c;2>arguments.length&&(b=a,a=s);Ea&&(c=ea);return p(a,b,c)}var A,O,u,R,B,N,ea={},qb;A=c===f?d:ga(d,new Ob(y(f),d.$attr));O=A.$$element;if(I){var Na=/^\s*([@=&])(\??)\s*(\w*)\s*$/;
N=e.$new(!0);!G||G!==I&&G!==I.$$originalDirective?O.data("$isolateScopeNoTemplate",N):O.data("$isolateScope",N);da(O,"ng-isolate-scope");r(I.scope,function(a,c){var d=a.match(Na)||[],f=d[3]||c,g="?"==d[2],d=d[1],m,l,n,p;N.$$isolateBindings[c]=d+f;switch(d){case "@":A.$observe(f,function(a){N[c]=a});A.$$observers[f].$$scope=e;A[f]&&(N[c]=b(A[f])(e));break;case "=":if(g&&!A[f])break;l=q(A[f]);p=l.literal?za:function(a,b){return a===b||a!==a&&b!==b};n=l.assign||function(){m=N[c]=l(e);throw ia("nonassign",
A[f],I.name);};m=N[c]=l(e);N.$watch(function(){var a=l(e);p(a,N[c])||(p(a,m)?n(e,a=N[c]):N[c]=a);return m=a},null,l.literal);break;case "&":l=q(A[f]);N[c]=function(a){return l(e,a)};break;default:throw ia("iscp",I.name,c,a);}})}qb=p&&x;W&&r(W,function(a){var b={$scope:a===I||a.$$isolateScope?N:e,$element:O,$attrs:A,$transclude:qb},c;B=a.controller;"@"==B&&(B=A[a.name]);c=t(B,b);ea[a.name]=c;Ea||O.data("$"+a.name+"Controller",c);a.controllerAs&&(b.$scope[a.controllerAs]=c)});g=0;for(u=m.length;g<u;g++)try{R=
m[g],R(R.isolateScope?N:e,O,A,R.require&&K(R.directiveName,R.require,O,ea),qb)}catch(ca){l(ca,ha(O))}g=e;I&&(I.template||null===I.templateUrl)&&(g=N);a&&a(g,f.childNodes,s,p);for(g=n.length-1;0<=g;g--)try{R=n[g],R(R.isolateScope?N:e,O,A,R.require&&K(R.directiveName,R.require,O,ea),qb)}catch(pb){l(pb,ha(O))}}p=p||{};for(var A=-Number.MAX_VALUE,R,W=p.controllerDirectives,I=p.newIsolateScopeDirective,G=p.templateDirective,ca=p.nonTlbTranscludeDirective,F=!1,E=!1,Ea=p.hasElementTranscludeDirective,w=
d.$$element=y(c),H,oa,U,S=e,Q,P=0,pa=a.length;P<pa;P++){H=a[P];var V=H.$$start,Y=H.$$end;V&&(w=N(c,V,Y));U=s;if(A>H.priority)break;if(U=H.scope)R=R||H,H.templateUrl||(M("new/isolated scope",I,H,w),T(U)&&(I=H));oa=H.name;!H.templateUrl&&H.controller&&(U=H.controller,W=W||{},M("'"+oa+"' controller",W[oa],H,w),W[oa]=H);if(U=H.transclude)F=!0,H.$$tlb||(M("transclusion",ca,H,w),ca=H),"element"==U?(Ea=!0,A=H.priority,U=w,w=d.$$element=y(X.createComment(" "+oa+": "+d[oa]+" ")),c=w[0],Na(f,Aa.call(U,0),c),
S=u(U,e,A,g&&g.name,{nonTlbTranscludeDirective:ca})):(U=y(Kb(c)).contents(),w.empty(),S=u(U,e));if(H.template)if(E=!0,M("template",G,H,w),G=H,U=J(H.template)?H.template(w,d):H.template,U=Z(U),H.replace){g=H;U=Ib.test(U)?y(aa(U)):[];c=U[0];if(1!=U.length||1!==c.nodeType)throw ia("tplrt",oa,"");Na(f,w,c);pa={$attr:{}};U=ea(c,[],pa);var $=a.splice(P+1,a.length-(P+1));I&&pb(U);a=a.concat(U).concat($);D(d,pa);pa=a.length}else w.html(U);if(H.templateUrl)E=!0,M("template",G,H,w),G=H,H.replace&&(g=H),v=z(a.splice(P,
a.length-P),w,d,f,F&&S,m,n,{controllerDirectives:W,newIsolateScopeDirective:I,templateDirective:G,nonTlbTranscludeDirective:ca}),pa=a.length;else if(H.compile)try{Q=H.compile(w,d,S),J(Q)?x(null,Q,V,Y):Q&&x(Q.pre,Q.post,V,Y)}catch(ba){l(ba,ha(w))}H.terminal&&(v.terminal=!0,A=Math.max(A,H.priority))}v.scope=R&&!0===R.scope;v.transcludeOnThisElement=F;v.templateOnThisElement=E;v.transclude=S;p.hasElementTranscludeDirective=Ea;return v}function pb(a){for(var b=0,c=a.length;b<c;b++)a[b]=bc(a[b],{$$isolateScope:!0})}
function ca(b,e,f,g,h,q,n){if(e===h)return null;h=null;if(c.hasOwnProperty(e)){var p;e=a.get(e+d);for(var t=0,x=e.length;t<x;t++)try{p=e[t],(g===s||g>p.priority)&&-1!=p.restrict.indexOf(f)&&(q&&(p=bc(p,{$$start:q,$$end:n})),b.push(p),h=p)}catch(K){l(K)}}return h}function D(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;r(a,function(d,e){"$"!=e.charAt(0)&&(b[e]&&b[e]!==d&&(d+=("style"===e?";":" ")+b[e]),a.$set(e,d,!0,c[e]))});r(b,function(b,f){"class"==f?(da(e,b),a["class"]=(a["class"]?a["class"]+" ":
"")+b):"style"==f?(e.attr("style",e.attr("style")+";"+b),a.style=(a.style?a.style+";":"")+b):"$"==f.charAt(0)||a.hasOwnProperty(f)||(a[f]=b,d[f]=c[f])})}function z(a,b,c,d,e,f,g,m){var h=[],l,q,t=b[0],x=a.shift(),K=E({},x,{templateUrl:null,transclude:null,replace:null,$$originalDirective:x}),A=J(x.templateUrl)?x.templateUrl(b,c):x.templateUrl;b.empty();n.get(v.getTrustedResourceUrl(A),{cache:p}).success(function(n){var p,v;n=Z(n);if(x.replace){n=Ib.test(n)?y(aa(n)):[];p=n[0];if(1!=n.length||1!==p.nodeType)throw ia("tplrt",
x.name,A);n={$attr:{}};Na(d,b,p);var u=ea(p,[],n);T(x.scope)&&pb(u);a=u.concat(a);D(c,n)}else p=t,b.html(n);a.unshift(K);l=G(a,p,c,e,b,x,f,g,m);r(d,function(a,c){a==p&&(d[c]=b[0])});for(q=I(b[0].childNodes,e);h.length;){n=h.shift();v=h.shift();var R=h.shift(),B=h.shift(),u=b[0];if(v!==t){var N=v.className;m.hasElementTranscludeDirective&&x.replace||(u=Kb(p));Na(R,y(v),u);da(y(u),N)}v=l.transcludeOnThisElement?W(n,l.transclude,B):B;l(q,n,u,d,v)}h=null}).error(function(a,b,c,d){throw ia("tpload",d.url);
});return function(a,b,c,d,e){a=e;h?(h.push(b),h.push(c),h.push(d),h.push(a)):(l.transcludeOnThisElement&&(a=W(b,l.transclude,e)),l(q,b,c,d,a))}}function F(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function M(a,b,c,d){if(b)throw ia("multidir",b.name,c.name,a,ha(d));}function w(a,c){var d=b(c,!0);d&&a.push({priority:0,compile:function(a){var b=a.parent().length;b&&da(a.parent(),"ng-binding");return function(a,c){var e=c.parent(),f=e.data("$binding")||
[];f.push(d);e.data("$binding",f);b||da(e,"ng-binding");a.$watch(d,function(a){c[0].nodeValue=a})}}})}function S(a,b){if("srcdoc"==b)return v.HTML;var c=Ma(a);if("xlinkHref"==b||"FORM"==c&&"action"==b||"IMG"!=c&&("src"==b||"ngSrc"==b))return v.RESOURCE_URL}function P(a,c,d,e){var f=b(d,!0);if(f){if("multiple"===e&&"SELECT"===Ma(a))throw ia("selmulti",ha(a));c.push({priority:100,compile:function(){return{pre:function(c,d,m){d=m.$$observers||(m.$$observers={});if(g.test(e))throw ia("nodomevents");if(f=
b(m[e],!0,S(a,e)))m[e]=f(c),(d[e]||(d[e]=[])).$$inter=!0,(m.$$observers&&m.$$observers[e].$$scope||c).$watch(f,function(a,b){"class"===e&&a!=b?m.$updateClass(a,b):m.$set(e,a)})}}}})}}function Na(a,b,c){var d=b[0],e=b.length,f=d.parentNode,g,m;if(a)for(g=0,m=a.length;g<m;g++)if(a[g]==d){a[g++]=c;m=g+e-1;for(var h=a.length;g<h;g++,m++)m<h?a[g]=a[m]:delete a[g];a.length-=e-1;break}f&&f.replaceChild(c,d);a=X.createDocumentFragment();a.appendChild(d);c[y.expando]=d[y.expando];d=1;for(e=b.length;d<e;d++)f=
b[d],y(f).remove(),a.appendChild(f),delete b[d];b[0]=c;b.length=1}function tc(a,b){return E(function(){return a.apply(null,arguments)},a,b)}var Ob=function(a,b){this.$$element=a;this.$attr=b||{}};Ob.prototype={$normalize:na,$addClass:function(a){a&&0<a.length&&A.addClass(this.$$element,a)},$removeClass:function(a){a&&0<a.length&&A.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=uc(a,b),d=uc(b,a);0===c.length?A.removeClass(this.$$element,d):0===d.length?A.addClass(this.$$element,c):
A.setClass(this.$$element,c,d)},$set:function(a,b,c,d){var e=qc(this.$$element[0],a);e&&(this.$$element.prop(a,b),d=e);this[a]=b;d?this.$attr[a]=d:(d=this.$attr[a])||(this.$attr[a]=d=kb(a,"-"));e=Ma(this.$$element);if("A"===e&&"href"===a||"IMG"===e&&"src"===a)this[a]=b=R(b,"src"===a);!1!==c&&(null===b||b===s?this.$$element.removeAttr(d):this.$$element.attr(d,b));(c=this.$$observers)&&r(c[a],function(a){try{a(b)}catch(c){l(c)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers={}),
e=d[a]||(d[a]=[]);e.push(b);K.$evalAsync(function(){e.$$inter||b(c[a])});return b}};var pa=b.startSymbol(),Ea=b.endSymbol(),Z="{{"==pa||"}}"==Ea?Ga:function(a){return a.replace(/\{\{/g,pa).replace(/}}/g,Ea)},V=/^ngAttr[A-Z]/;return u}]}function na(b){return Ya(b.replace(ue,""))}function uc(b,a){var c="",d=b.split(/\s+/),e=a.split(/\s+/),f=0;a:for(;f<d.length;f++){for(var g=d[f],k=0;k<e.length;k++)if(g==e[k])continue a;c+=(0<c.length?" ":"")+g}return c}function Pd(){var b={},a=/^(\S+)(\s+as\s+(\w+))?$/;
this.register=function(a,d){Ca(a,"controller");T(a)?E(b,a):b[a]=d};this.$get=["$injector","$window",function(c,d){return function(e,f){var g,k,m;C(e)&&(g=e.match(a),k=g[1],m=g[3],e=b.hasOwnProperty(k)?b[k]:hc(f.$scope,k,!0)||hc(d,k,!0),Va(e,k,!0));g=c.instantiate(e,f);if(m){if(!f||"object"!==typeof f.$scope)throw w("$controller")("noscp",k||e.name,m);f.$scope[m]=g}return g}}]}function Qd(){this.$get=["$window",function(b){return y(b.document)}]}function Rd(){this.$get=["$log",function(b){return function(a,
c){b.error.apply(b,arguments)}}]}function vc(b){var a={},c,d,e;if(!b)return a;r(b.split("\n"),function(b){e=b.indexOf(":");c=M(aa(b.substr(0,e)));d=aa(b.substr(e+1));c&&(a[c]=a[c]?a[c]+", "+d:d)});return a}function wc(b){var a=T(b)?b:s;return function(c){a||(a=vc(b));return c?a[M(c)]||null:a}}function xc(b,a,c){if(J(c))return c(b,a);r(c,function(c){b=c(b,a)});return b}function Ud(){var b=/^\s*(\[|\{[^\{])/,a=/[\}\]]\s*$/,c=/^\)\]\}',?\n/,d={"Content-Type":"application/json;charset=utf-8"},e=this.defaults=
{transformResponse:[function(d){C(d)&&(d=d.replace(c,""),b.test(d)&&a.test(d)&&(d=cc(d)));return d}],transformRequest:[function(a){return T(a)&&"[object File]"!==ya.call(a)&&"[object Blob]"!==ya.call(a)?ta(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:ga(d),put:ga(d),patch:ga(d)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},f=this.interceptors=[],g=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",
function(a,b,c,d,n,p){function q(a){function b(a){var d=E({},a,{data:xc(a.data,a.headers,c.transformResponse)});return 200<=a.status&&300>a.status?d:n.reject(d)}var c={method:"get",transformRequest:e.transformRequest,transformResponse:e.transformResponse},d=function(a){var b=e.headers,c=E({},a.headers),d,f,b=E({},b.common,b[M(a.method)]);a:for(d in b){a=M(d);for(f in c)if(M(f)===a)continue a;c[d]=b[d]}(function(a){var b;r(a,function(c,d){J(c)&&(b=c(),null!=b?a[d]=b:delete a[d])})})(c);return c}(a);
E(c,a);c.headers=d;c.method=Ia(c.method);var f=[function(a){d=a.headers;var c=xc(a.data,wc(d),a.transformRequest);F(c)&&r(d,function(a,b){"content-type"===M(b)&&delete d[b]});F(a.withCredentials)&&!F(e.withCredentials)&&(a.withCredentials=e.withCredentials);return t(a,c,d).then(b,b)},s],g=n.when(c);for(r(v,function(a){(a.request||a.requestError)&&f.unshift(a.request,a.requestError);(a.response||a.responseError)&&f.push(a.response,a.responseError)});f.length;){a=f.shift();var m=f.shift(),g=g.then(a,
m)}g.success=function(a){g.then(function(b){a(b.data,b.status,b.headers,c)});return g};g.error=function(a){g.then(null,function(b){a(b.data,b.status,b.headers,c)});return g};return g}function t(c,f,g){function h(a,b,c,e){B&&(200<=a&&300>a?B.put(y,[a,b,vc(c),e]):B.remove(y));p(b,a,c,e);d.$$phase||d.$apply()}function p(a,b,d,e){b=Math.max(b,0);(200<=b&&300>b?v.resolve:v.reject)({data:a,status:b,headers:wc(d),config:c,statusText:e})}function t(){var a=Qa(q.pendingRequests,c);-1!==a&&q.pendingRequests.splice(a,
1)}var v=n.defer(),r=v.promise,B,G,y=K(c.url,c.params);q.pendingRequests.push(c);r.then(t,t);!c.cache&&!e.cache||(!1===c.cache||"GET"!==c.method&&"JSONP"!==c.method)||(B=T(c.cache)?c.cache:T(e.cache)?e.cache:x);if(B)if(G=B.get(y),D(G)){if(G&&J(G.then))return G.then(t,t),G;L(G)?p(G[1],G[0],ga(G[2]),G[3]):p(G,200,{},"OK")}else B.put(y,r);F(G)&&((G=Pb(c.url)?b.cookies()[c.xsrfCookieName||e.xsrfCookieName]:s)&&(g[c.xsrfHeaderName||e.xsrfHeaderName]=G),a(c.method,y,f,h,g,c.timeout,c.withCredentials,c.responseType));
return r}function K(a,b){if(!b)return a;var c=[];Tc(b,function(a,b){null===a||F(a)||(L(a)||(a=[a]),r(a,function(a){T(a)&&(sa(a)?a=a.toISOString():T(a)&&(a=ta(a)));c.push(Ba(b)+"="+Ba(a))}))});0<c.length&&(a+=(-1==a.indexOf("?")?"?":"&")+c.join("&"));return a}var x=c("$http"),v=[];r(f,function(a){v.unshift(C(a)?p.get(a):p.invoke(a))});r(g,function(a,b){var c=C(a)?p.get(a):p.invoke(a);v.splice(b,0,{response:function(a){return c(n.when(a))},responseError:function(a){return c(n.reject(a))}})});q.pendingRequests=
[];(function(a){r(arguments,function(a){q[a]=function(b,c){return q(E(c||{},{method:a,url:b}))}})})("get","delete","head","jsonp");(function(a){r(arguments,function(a){q[a]=function(b,c,d){return q(E(d||{},{method:a,url:b,data:c}))}})})("post","put");q.defaults=e;return q}]}function ve(b){if(8>=Q&&(!b.match(/^(get|post|head|put|delete|options)$/i)||!P.XMLHttpRequest))return new P.ActiveXObject("Microsoft.XMLHTTP");if(P.XMLHttpRequest)return new P.XMLHttpRequest;throw w("$httpBackend")("noxhr");}function Vd(){this.$get=
["$browser","$window","$document",function(b,a,c){return we(b,ve,b.defer,a.angular.callbacks,c[0])}]}function we(b,a,c,d,e){function f(a,b,c){var f=e.createElement("script"),g=null;f.type="text/javascript";f.src=a;f.async=!0;g=function(a){Za(f,"load",g);Za(f,"error",g);e.body.removeChild(f);f=null;var k=-1,t="unknown";a&&("load"!==a.type||d[b].called||(a={type:"error"}),t=a.type,k="error"===a.type?404:200);c&&c(k,t)};rb(f,"load",g);rb(f,"error",g);8>=Q&&(f.onreadystatechange=function(){C(f.readyState)&&
/loaded|complete/.test(f.readyState)&&(f.onreadystatechange=null,g({type:"load"}))});e.body.appendChild(f);return g}var g=-1;return function(e,m,h,l,n,p,q,t){function K(){v=g;R&&R();u&&u.abort()}function x(a,d,e,f,g){I&&c.cancel(I);R=u=null;0===d&&(d=e?200:"file"==ua(m).protocol?404:0);a(1223===d?204:d,e,f,g||"");b.$$completeOutstandingRequest(z)}var v;b.$$incOutstandingRequestCount();m=m||b.url();if("jsonp"==M(e)){var A="_"+(d.counter++).toString(36);d[A]=function(a){d[A].data=a;d[A].called=!0};
var R=f(m.replace("JSON_CALLBACK","angular.callbacks."+A),A,function(a,b){x(l,a,d[A].data,"",b);d[A]=z})}else{var u=a(e);u.open(e,m,!0);r(n,function(a,b){D(a)&&u.setRequestHeader(b,a)});u.onreadystatechange=function(){if(u&&4==u.readyState){var a=null,b=null,c="";v!==g&&(a=u.getAllResponseHeaders(),b="response"in u?u.response:u.responseText);v===g&&10>Q||(c=u.statusText);x(l,v||u.status,b,a,c)}};q&&(u.withCredentials=!0);if(t)try{u.responseType=t}catch(da){if("json"!==t)throw da;}u.send(h||null)}if(0<
p)var I=c(K,p);else p&&J(p.then)&&p.then(K)}}function Sd(){var b="{{",a="}}";this.startSymbol=function(a){return a?(b=a,this):b};this.endSymbol=function(b){return b?(a=b,this):a};this.$get=["$parse","$exceptionHandler","$sce",function(c,d,e){function f(f,h,l){for(var n,p,q=0,t=[],K=f.length,x=!1,v=[];q<K;)-1!=(n=f.indexOf(b,q))&&-1!=(p=f.indexOf(a,n+g))?(q!=n&&t.push(f.substring(q,n)),t.push(q=c(x=f.substring(n+g,p))),q.exp=x,q=p+k,x=!0):(q!=K&&t.push(f.substring(q)),q=K);(K=t.length)||(t.push(""),
K=1);if(l&&1<t.length)throw yc("noconcat",f);if(!h||x)return v.length=K,q=function(a){try{for(var b=0,c=K,g;b<c;b++){if("function"==typeof(g=t[b]))if(g=g(a),g=l?e.getTrusted(l,g):e.valueOf(g),null==g)g="";else switch(typeof g){case "string":break;case "number":g=""+g;break;default:g=ta(g)}v[b]=g}return v.join("")}catch(k){a=yc("interr",f,k.toString()),d(a)}},q.exp=f,q.parts=t,q}var g=b.length,k=a.length;f.startSymbol=function(){return b};f.endSymbol=function(){return a};return f}]}function Td(){this.$get=
["$rootScope","$window","$q",function(b,a,c){function d(d,g,k,m){var h=a.setInterval,l=a.clearInterval,n=c.defer(),p=n.promise,q=0,t=D(m)&&!m;k=D(k)?k:0;p.then(null,null,d);p.$$intervalId=h(function(){n.notify(q++);0<k&&q>=k&&(n.resolve(q),l(p.$$intervalId),delete e[p.$$intervalId]);t||b.$apply()},g);e[p.$$intervalId]=n;return p}var e={};d.cancel=function(b){return b&&b.$$intervalId in e?(e[b.$$intervalId].reject("canceled"),a.clearInterval(b.$$intervalId),delete e[b.$$intervalId],!0):!1};return d}]}
function bd(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"\u00a4",posSuf:"",negPre:"(\u00a4",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January February March April May June July August September October November December".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(b){return 1===b?"one":"other"}}}}function Qb(b){b=b.split("/");for(var a=b.length;a--;)b[a]=jb(b[a]);return b.join("/")}function zc(b,a,c){b=ua(b,c);a.$$protocol=
b.protocol;a.$$host=b.hostname;a.$$port=Z(b.port)||xe[b.protocol]||null}function Ac(b,a,c){var d="/"!==b.charAt(0);d&&(b="/"+b);b=ua(b,c);a.$$path=decodeURIComponent(d&&"/"===b.pathname.charAt(0)?b.pathname.substring(1):b.pathname);a.$$search=ec(b.search);a.$$hash=decodeURIComponent(b.hash);a.$$path&&"/"!=a.$$path.charAt(0)&&(a.$$path="/"+a.$$path)}function qa(b,a){if(0===a.indexOf(b))return a.substr(b.length)}function cb(b){var a=b.indexOf("#");return-1==a?b:b.substr(0,a)}function Rb(b){return b.substr(0,
cb(b).lastIndexOf("/")+1)}function Bc(b,a){this.$$html5=!0;a=a||"";var c=Rb(b);zc(b,this,b);this.$$parse=function(a){var e=qa(c,a);if(!C(e))throw Sb("ipthprfx",a,c);Ac(e,this,b);this.$$path||(this.$$path="/");this.$$compose()};this.$$compose=function(){var a=Cb(this.$$search),b=this.$$hash?"#"+jb(this.$$hash):"";this.$$url=Qb(this.$$path)+(a?"?"+a:"")+b;this.$$absUrl=c+this.$$url.substr(1)};this.$$rewrite=function(d){var e;if((e=qa(b,d))!==s)return d=e,(e=qa(a,e))!==s?c+(qa("/",e)||e):b+d;if((e=qa(c,
d))!==s)return c+e;if(c==d+"/")return c}}function Tb(b,a){var c=Rb(b);zc(b,this,b);this.$$parse=function(d){var e=qa(b,d)||qa(c,d),e="#"==e.charAt(0)?qa(a,e):this.$$html5?e:"";if(!C(e))throw Sb("ihshprfx",d,a);Ac(e,this,b);d=this.$$path;var f=/^\/[A-Z]:(\/.*)/;0===e.indexOf(b)&&(e=e.replace(b,""));f.exec(e)||(d=(e=f.exec(d))?e[1]:d);this.$$path=d;this.$$compose()};this.$$compose=function(){var c=Cb(this.$$search),e=this.$$hash?"#"+jb(this.$$hash):"";this.$$url=Qb(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=
b+(this.$$url?a+this.$$url:"")};this.$$rewrite=function(a){if(cb(b)==cb(a))return a}}function Ub(b,a){this.$$html5=!0;Tb.apply(this,arguments);var c=Rb(b);this.$$rewrite=function(d){var e;if(b==cb(d))return d;if(e=qa(c,d))return b+a+e;if(c===d+"/")return c};this.$$compose=function(){var c=Cb(this.$$search),e=this.$$hash?"#"+jb(this.$$hash):"";this.$$url=Qb(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=b+a+this.$$url}}function sb(b){return function(){return this[b]}}function Cc(b,a){return function(c){if(F(c))return this[b];
this[b]=a(c);this.$$compose();return this}}function Wd(){var b="",a=!1;this.hashPrefix=function(a){return D(a)?(b=a,this):b};this.html5Mode=function(b){return D(b)?(a=b,this):a};this.$get=["$rootScope","$browser","$sniffer","$rootElement",function(c,d,e,f){function g(a){c.$broadcast("$locationChangeSuccess",k.absUrl(),a)}var k,m,h=d.baseHref(),l=d.url(),n;a?(n=l.substring(0,l.indexOf("/",l.indexOf("//")+2))+(h||"/"),m=e.history?Bc:Ub):(n=cb(l),m=Tb);k=new m(n,"#"+b);k.$$parse(k.$$rewrite(l));var p=
/^\s*(javascript|mailto):/i;f.on("click",function(a){if(!a.ctrlKey&&!a.metaKey&&2!=a.which){for(var e=y(a.target);"a"!==M(e[0].nodeName);)if(e[0]===f[0]||!(e=e.parent())[0])return;var g=e.prop("href");T(g)&&"[object SVGAnimatedString]"===g.toString()&&(g=ua(g.animVal).href);if(!p.test(g)){if(m===Ub){var h=e.attr("href")||e.attr("xlink:href");if(0>h.indexOf("://"))if(g="#"+b,"/"==h[0])g=n+g+h;else if("#"==h[0])g=n+g+(k.path()||"/")+h;else{for(var l=k.path().split("/"),h=h.split("/"),q=0;q<h.length;q++)"."!=
h[q]&&(".."==h[q]?l.pop():h[q].length&&l.push(h[q]));g=n+g+l.join("/")}}l=k.$$rewrite(g);g&&(!e.attr("target")&&l&&!a.isDefaultPrevented())&&(a.preventDefault(),l!=d.url()&&(k.$$parse(l),c.$apply(),P.angular["ff-684208-preventDefault"]=!0))}}});k.absUrl()!=l&&d.url(k.absUrl(),!0);d.onUrlChange(function(a){k.absUrl()!=a&&(c.$evalAsync(function(){var b=k.absUrl();k.$$parse(a);c.$broadcast("$locationChangeStart",a,b).defaultPrevented?(k.$$parse(b),d.url(b)):g(b)}),c.$$phase||c.$digest())});var q=0;c.$watch(function(){var a=
d.url(),b=k.$$replace;q&&a==k.absUrl()||(q++,c.$evalAsync(function(){c.$broadcast("$locationChangeStart",k.absUrl(),a).defaultPrevented?k.$$parse(a):(d.url(k.absUrl(),b),g(a))}));k.$$replace=!1;return q});return k}]}function Xd(){var b=!0,a=this;this.debugEnabled=function(a){return D(a)?(b=a,this):b};this.$get=["$window",function(c){function d(a){a instanceof Error&&(a.stack?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+
":"+a.line));return a}function e(a){var b=c.console||{},e=b[a]||b.log||z;a=!1;try{a=!!e.apply}catch(m){}return a?function(){var a=[];r(arguments,function(b){a.push(d(b))});return e.apply(b,a)}:function(a,b){e(a,null==b?"":b)}}return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){b&&c.apply(a,arguments)}}()}}]}function ja(b,a){if("__defineGetter__"===b||"__defineSetter__"===b||"__lookupGetter__"===b||"__lookupSetter__"===b||"__proto__"===
b)throw ka("isecfld",a);return b}function Oa(b,a){if(b){if(b.constructor===b)throw ka("isecfn",a);if(b.document&&b.location&&b.alert&&b.setInterval)throw ka("isecwindow",a);if(b.children&&(b.nodeName||b.prop&&b.attr&&b.find))throw ka("isecdom",a);if(b===Object)throw ka("isecobj",a);}return b}function tb(b,a,c,d,e){e=e||{};a=a.split(".");for(var f,g=0;1<a.length;g++){f=ja(a.shift(),d);var k=b[f];k||(k={},b[f]=k);b=k;b.then&&e.unwrapPromises&&(va(d),"$$v"in b||function(a){a.then(function(b){a.$$v=b})}(b),
b.$$v===s&&(b.$$v={}),b=b.$$v)}f=ja(a.shift(),d);Oa(b,d);Oa(b[f],d);return b[f]=c}function Dc(b,a,c,d,e,f,g){ja(b,f);ja(a,f);ja(c,f);ja(d,f);ja(e,f);return g.unwrapPromises?function(g,m){var h=m&&m.hasOwnProperty(b)?m:g,l;if(null==h)return h;(h=h[b])&&h.then&&(va(f),"$$v"in h||(l=h,l.$$v=s,l.then(function(a){l.$$v=a})),h=h.$$v);if(!a)return h;if(null==h)return s;(h=h[a])&&h.then&&(va(f),"$$v"in h||(l=h,l.$$v=s,l.then(function(a){l.$$v=a})),h=h.$$v);if(!c)return h;if(null==h)return s;(h=h[c])&&h.then&&
(va(f),"$$v"in h||(l=h,l.$$v=s,l.then(function(a){l.$$v=a})),h=h.$$v);if(!d)return h;if(null==h)return s;(h=h[d])&&h.then&&(va(f),"$$v"in h||(l=h,l.$$v=s,l.then(function(a){l.$$v=a})),h=h.$$v);if(!e)return h;if(null==h)return s;(h=h[e])&&h.then&&(va(f),"$$v"in h||(l=h,l.$$v=s,l.then(function(a){l.$$v=a})),h=h.$$v);return h}:function(f,g){var h=g&&g.hasOwnProperty(b)?g:f;if(null==h)return h;h=h[b];if(!a)return h;if(null==h)return s;h=h[a];if(!c)return h;if(null==h)return s;h=h[c];if(!d)return h;if(null==
h)return s;h=h[d];return e?null==h?s:h=h[e]:h}}function Ec(b,a,c){if(Vb.hasOwnProperty(b))return Vb[b];var d=b.split("."),e=d.length,f;if(a.csp)f=6>e?Dc(d[0],d[1],d[2],d[3],d[4],c,a):function(b,f){var g=0,k;do k=Dc(d[g++],d[g++],d[g++],d[g++],d[g++],c,a)(b,f),f=s,b=k;while(g<e);return k};else{var g="var p;\n";r(d,function(b,d){ja(b,c);g+="if(s == null) return undefined;\ns="+(d?"s":'((k&&k.hasOwnProperty("'+b+'"))?k:s)')+'["'+b+'"];\n'+(a.unwrapPromises?'if (s && s.then) {\n pw("'+c.replace(/(["\r\n])/g,
"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v=v;});\n}\n s=s.$$v\n}\n':"")});var g=g+"return s;",k=new Function("s","k","pw",g);k.toString=$(g);f=a.unwrapPromises?function(a,b){return k(a,b,va)}:k}"hasOwnProperty"!==b&&(Vb[b]=f);return f}function Yd(){var b={},a={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0};this.unwrapPromises=function(b){return D(b)?(a.unwrapPromises=!!b,this):a.unwrapPromises};this.logPromiseWarnings=function(b){return D(b)?(a.logPromiseWarnings=
b,this):a.logPromiseWarnings};this.$get=["$filter","$sniffer","$log",function(c,d,e){a.csp=d.csp;va=function(b){a.logPromiseWarnings&&!Fc.hasOwnProperty(b)&&(Fc[b]=!0,e.warn("[$parse] Promise found in the expression `"+b+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))};return function(d){var e;switch(typeof d){case "string":if(b.hasOwnProperty(d))return b[d];e=new Wb(a);e=(new db(e,c,a)).parse(d);"hasOwnProperty"!==d&&(b[d]=e);return e;case "function":return d;default:return z}}}]}
function $d(){this.$get=["$rootScope","$exceptionHandler",function(b,a){return ye(function(a){b.$evalAsync(a)},a)}]}function ye(b,a){function c(a){return a}function d(a){return g(a)}var e=function(){var g=[],h,l;return l={resolve:function(a){if(g){var c=g;g=s;h=f(a);c.length&&b(function(){for(var a,b=0,d=c.length;b<d;b++)a=c[b],h.then(a[0],a[1],a[2])})}},reject:function(a){l.resolve(k(a))},notify:function(a){if(g){var c=g;g.length&&b(function(){for(var b,d=0,e=c.length;d<e;d++)b=c[d],b[2](a)})}},
promise:{then:function(b,f,k){var l=e(),K=function(d){try{l.resolve((J(b)?b:c)(d))}catch(e){l.reject(e),a(e)}},x=function(b){try{l.resolve((J(f)?f:d)(b))}catch(c){l.reject(c),a(c)}},v=function(b){try{l.notify((J(k)?k:c)(b))}catch(d){a(d)}};g?g.push([K,x,v]):h.then(K,x,v);return l.promise},"catch":function(a){return this.then(null,a)},"finally":function(a){function b(a,c){var d=e();c?d.resolve(a):d.reject(a);return d.promise}function d(e,f){var g=null;try{g=(a||c)()}catch(k){return b(k,!1)}return g&&
J(g.then)?g.then(function(){return b(e,f)},function(a){return b(a,!1)}):b(e,f)}return this.then(function(a){return d(a,!0)},function(a){return d(a,!1)})}}}},f=function(a){return a&&J(a.then)?a:{then:function(c){var d=e();b(function(){d.resolve(c(a))});return d.promise}}},g=function(a){var b=e();b.reject(a);return b.promise},k=function(c){return{then:function(f,g){var k=e();b(function(){try{k.resolve((J(g)?g:d)(c))}catch(b){k.reject(b),a(b)}});return k.promise}}};return{defer:e,reject:g,when:function(k,
h,l,n){var p=e(),q,t=function(b){try{return(J(h)?h:c)(b)}catch(d){return a(d),g(d)}},K=function(b){try{return(J(l)?l:d)(b)}catch(c){return a(c),g(c)}},x=function(b){try{return(J(n)?n:c)(b)}catch(d){a(d)}};b(function(){f(k).then(function(a){q||(q=!0,p.resolve(f(a).then(t,K,x)))},function(a){q||(q=!0,p.resolve(K(a)))},function(a){q||p.notify(x(a))})});return p.promise},all:function(a){var b=e(),c=0,d=L(a)?[]:{};r(a,function(a,e){c++;f(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},
function(a){d.hasOwnProperty(e)||b.reject(a)})});0===c&&b.resolve(d);return b.promise}}}function ge(){this.$get=["$window","$timeout",function(b,a){var c=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame,d=b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.mozCancelAnimationFrame||b.webkitCancelRequestAnimationFrame,e=!!c,f=e?function(a){var b=c(a);return function(){d(b)}}:function(b){var c=a(b,16.66,!1);return function(){a.cancel(c)}};f.supported=e;return f}]}
function Zd(){var b=10,a=w("$rootScope"),c=null;this.digestTtl=function(a){arguments.length&&(b=a);return b};this.$get=["$injector","$exceptionHandler","$parse","$browser",function(d,e,f,g){function k(){this.$id=gb();this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null;this["this"]=this.$root=this;this.$$destroyed=!1;this.$$asyncQueue=[];this.$$postDigestQueue=[];this.$$listeners={};this.$$listenerCount={};this.$$isolateBindings={}}
function m(b){if(p.$$phase)throw a("inprog",p.$$phase);p.$$phase=b}function h(a,b){var c=f(a);Va(c,b);return c}function l(a,b,c){do a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function n(){}k.prototype={constructor:k,$new:function(a){a?(a=new k,a.$root=this.$root,a.$$asyncQueue=this.$$asyncQueue,a.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=
this.$$childTail=null;this.$$listeners={};this.$$listenerCount={};this.$id=gb();this.$$childScopeClass=null},this.$$childScopeClass.prototype=this),a=new this.$$childScopeClass);a["this"]=a;a.$parent=this;a.$$prevSibling=this.$$childTail;this.$$childHead?this.$$childTail=this.$$childTail.$$nextSibling=a:this.$$childHead=this.$$childTail=a;return a},$watch:function(a,b,d){var e=h(a,"watch"),f=this.$$watchers,g={fn:b,last:n,get:e,exp:a,eq:!!d};c=null;if(!J(b)){var k=h(b||z,"listener");g.fn=function(a,
b,c){k(c)}}if("string"==typeof a&&e.constant){var m=g.fn;g.fn=function(a,b,c){m.call(this,a,b,c);Ra(f,g)}}f||(f=this.$$watchers=[]);f.unshift(g);return function(){Ra(f,g);c=null}},$watchCollection:function(a,b){var c=this,d,e,g,k=1<b.length,h=0,m=f(a),l=[],p={},n=!0,r=0;return this.$watch(function(){d=m(c);var a,b,f;if(T(d))if(fb(d))for(e!==l&&(e=l,r=e.length=0,h++),a=d.length,r!==a&&(h++,e.length=r=a),b=0;b<a;b++)f=e[b]!==e[b]&&d[b]!==d[b],f||e[b]===d[b]||(h++,e[b]=d[b]);else{e!==p&&(e=p={},r=0,
h++);a=0;for(b in d)d.hasOwnProperty(b)&&(a++,e.hasOwnProperty(b)?(f=e[b]!==e[b]&&d[b]!==d[b],f||e[b]===d[b]||(h++,e[b]=d[b])):(r++,e[b]=d[b],h++));if(r>a)for(b in h++,e)e.hasOwnProperty(b)&&!d.hasOwnProperty(b)&&(r--,delete e[b])}else e!==d&&(e=d,h++);return h},function(){n?(n=!1,b(d,d,c)):b(d,g,c);if(k)if(T(d))if(fb(d)){g=Array(d.length);for(var a=0;a<d.length;a++)g[a]=d[a]}else for(a in g={},d)ib.call(d,a)&&(g[a]=d[a]);else g=d})},$digest:function(){var d,f,g,k,h=this.$$asyncQueue,l=this.$$postDigestQueue,
r,u,s=b,I,W=[],y,N,B;m("$digest");c=null;do{u=!1;for(I=this;h.length;){try{B=h.shift(),B.scope.$eval(B.expression)}catch(G){p.$$phase=null,e(G)}c=null}a:do{if(k=I.$$watchers)for(r=k.length;r--;)try{if(d=k[r])if((f=d.get(I))!==(g=d.last)&&!(d.eq?za(f,g):"number"===typeof f&&"number"===typeof g&&isNaN(f)&&isNaN(g)))u=!0,c=d,d.last=d.eq?Ha(f,null):f,d.fn(f,g===n?f:g,I),5>s&&(y=4-s,W[y]||(W[y]=[]),N=J(d.exp)?"fn: "+(d.exp.name||d.exp.toString()):d.exp,N+="; newVal: "+ta(f)+"; oldVal: "+ta(g),W[y].push(N));
else if(d===c){u=!1;break a}}catch(D){p.$$phase=null,e(D)}if(!(k=I.$$childHead||I!==this&&I.$$nextSibling))for(;I!==this&&!(k=I.$$nextSibling);)I=I.$parent}while(I=k);if((u||h.length)&&!s--)throw p.$$phase=null,a("infdig",b,ta(W));}while(u||h.length);for(p.$$phase=null;l.length;)try{l.shift()()}catch(w){e(w)}},$destroy:function(){if(!this.$$destroyed){var a=this.$parent;this.$broadcast("$destroy");this.$$destroyed=!0;this!==p&&(r(this.$$listenerCount,Bb(null,l,this)),a.$$childHead==this&&(a.$$childHead=
this.$$nextSibling),a.$$childTail==this&&(a.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=z,this.$on=this.$watch=function(){return z})}},$eval:function(a,
b){return f(a)(this,b)},$evalAsync:function(a){p.$$phase||p.$$asyncQueue.length||g.defer(function(){p.$$asyncQueue.length&&p.$digest()});this.$$asyncQueue.push({scope:this,expression:a})},$$postDigest:function(a){this.$$postDigestQueue.push(a)},$apply:function(a){try{return m("$apply"),this.$eval(a)}catch(b){e(b)}finally{p.$$phase=null;try{p.$digest()}catch(c){throw e(c),c;}}},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]);c.push(b);var d=this;do d.$$listenerCount[a]||(d.$$listenerCount[a]=
0),d.$$listenerCount[a]++;while(d=d.$parent);var e=this;return function(){c[Qa(c,b)]=null;l(e,1,a)}},$emit:function(a,b){var c=[],d,f=this,g=!1,k={name:a,targetScope:f,stopPropagation:function(){g=!0},preventDefault:function(){k.defaultPrevented=!0},defaultPrevented:!1},h=[k].concat(Aa.call(arguments,1)),m,l;do{d=f.$$listeners[a]||c;k.currentScope=f;m=0;for(l=d.length;m<l;m++)if(d[m])try{d[m].apply(null,h)}catch(p){e(p)}else d.splice(m,1),m--,l--;if(g)break;f=f.$parent}while(f);return k},$broadcast:function(a,
b){for(var c=this,d=this,f={name:a,targetScope:this,preventDefault:function(){f.defaultPrevented=!0},defaultPrevented:!1},g=[f].concat(Aa.call(arguments,1)),k,h;c=d;){f.currentScope=c;d=c.$$listeners[a]||[];k=0;for(h=d.length;k<h;k++)if(d[k])try{d[k].apply(null,g)}catch(m){e(m)}else d.splice(k,1),k--,h--;if(!(d=c.$$listenerCount[a]&&c.$$childHead||c!==this&&c.$$nextSibling))for(;c!==this&&!(d=c.$$nextSibling);)c=c.$parent}return f}};var p=new k;return p}]}function cd(){var b=/^\s*(https?|ftp|mailto|tel|file):/,
a=/^\s*(https?|ftp|file):|data:image\//;this.aHrefSanitizationWhitelist=function(a){return D(a)?(b=a,this):b};this.imgSrcSanitizationWhitelist=function(b){return D(b)?(a=b,this):a};this.$get=function(){return function(c,d){var e=d?a:b,f;if(!Q||8<=Q)if(f=ua(c).href,""!==f&&!f.match(e))return"unsafe:"+f;return c}}}function ze(b){if("self"===b)return b;if(C(b)){if(-1<b.indexOf("***"))throw wa("iwcard",b);b=b.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08").replace("\\*\\*",".*").replace("\\*",
"[^:/.?&;]*");return RegExp("^"+b+"$")}if(hb(b))return RegExp("^"+b.source+"$");throw wa("imatcher");}function Gc(b){var a=[];D(b)&&r(b,function(b){a.push(ze(b))});return a}function be(){this.SCE_CONTEXTS=fa;var b=["self"],a=[];this.resourceUrlWhitelist=function(a){arguments.length&&(b=Gc(a));return b};this.resourceUrlBlacklist=function(b){arguments.length&&(a=Gc(b));return a};this.$get=["$injector",function(c){function d(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};a&&(b.prototype=
new a);b.prototype.valueOf=function(){return this.$$unwrapTrustedValue()};b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()};return b}var e=function(a){throw wa("unsafe");};c.has("$sanitize")&&(e=c.get("$sanitize"));var f=d(),g={};g[fa.HTML]=d(f);g[fa.CSS]=d(f);g[fa.URL]=d(f);g[fa.JS]=d(f);g[fa.RESOURCE_URL]=d(g[fa.URL]);return{trustAs:function(a,b){var c=g.hasOwnProperty(a)?g[a]:null;if(!c)throw wa("icontext",a,b);if(null===b||b===s||""===b)return b;if("string"!==typeof b)throw wa("itype",
a);return new c(b)},getTrusted:function(c,d){if(null===d||d===s||""===d)return d;var f=g.hasOwnProperty(c)?g[c]:null;if(f&&d instanceof f)return d.$$unwrapTrustedValue();if(c===fa.RESOURCE_URL){var f=ua(d.toString()),l,n,p=!1;l=0;for(n=b.length;l<n;l++)if("self"===b[l]?Pb(f):b[l].exec(f.href)){p=!0;break}if(p)for(l=0,n=a.length;l<n;l++)if("self"===a[l]?Pb(f):a[l].exec(f.href)){p=!1;break}if(p)return d;throw wa("insecurl",d.toString());}if(c===fa.HTML)return e(d);throw wa("unsafe");},valueOf:function(a){return a instanceof
f?a.$$unwrapTrustedValue():a}}}]}function ae(){var b=!0;this.enabled=function(a){arguments.length&&(b=!!a);return b};this.$get=["$parse","$sniffer","$sceDelegate",function(a,c,d){if(b&&c.msie&&8>c.msieDocumentMode)throw wa("iequirks");var e=ga(fa);e.isEnabled=function(){return b};e.trustAs=d.trustAs;e.getTrusted=d.getTrusted;e.valueOf=d.valueOf;b||(e.trustAs=e.getTrusted=function(a,b){return b},e.valueOf=Ga);e.parseAs=function(b,c){var d=a(c);return d.literal&&d.constant?d:function(a,c){return e.getTrusted(b,
d(a,c))}};var f=e.parseAs,g=e.getTrusted,k=e.trustAs;r(fa,function(a,b){var c=M(b);e[Ya("parse_as_"+c)]=function(b){return f(a,b)};e[Ya("get_trusted_"+c)]=function(b){return g(a,b)};e[Ya("trust_as_"+c)]=function(b){return k(a,b)}});return e}]}function ce(){this.$get=["$window","$document",function(b,a){var c={},d=Z((/android (\d+)/.exec(M((b.navigator||{}).userAgent))||[])[1]),e=/Boxee/i.test((b.navigator||{}).userAgent),f=a[0]||{},g=f.documentMode,k,m=/^(Moz|webkit|O|ms)(?=[A-Z])/,h=f.body&&f.body.style,
l=!1,n=!1;if(h){for(var p in h)if(l=m.exec(p)){k=l[0];k=k.substr(0,1).toUpperCase()+k.substr(1);break}k||(k="WebkitOpacity"in h&&"webkit");l=!!("transition"in h||k+"Transition"in h);n=!!("animation"in h||k+"Animation"in h);!d||l&&n||(l=C(f.body.style.webkitTransition),n=C(f.body.style.webkitAnimation))}return{history:!(!b.history||!b.history.pushState||4>d||e),hashchange:"onhashchange"in b&&(!g||7<g),hasEvent:function(a){if("input"==a&&9==Q)return!1;if(F(c[a])){var b=f.createElement("div");c[a]="on"+
a in b}return c[a]},csp:Wa(),vendorPrefix:k,transitions:l,animations:n,android:d,msie:Q,msieDocumentMode:g}}]}function ee(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function(b,a,c,d){function e(e,k,m){var h=c.defer(),l=h.promise,n=D(m)&&!m;k=a.defer(function(){try{h.resolve(e())}catch(a){h.reject(a),d(a)}finally{delete f[l.$$timeoutId]}n||b.$apply()},k);l.$$timeoutId=k;f[k]=h;return l}var f={};e.cancel=function(b){return b&&b.$$timeoutId in f?(f[b.$$timeoutId].reject("canceled"),
delete f[b.$$timeoutId],a.defer.cancel(b.$$timeoutId)):!1};return e}]}function ua(b,a){var c=b;Q&&(V.setAttribute("href",c),c=V.href);V.setAttribute("href",c);return{href:V.href,protocol:V.protocol?V.protocol.replace(/:$/,""):"",host:V.host,search:V.search?V.search.replace(/^\?/,""):"",hash:V.hash?V.hash.replace(/^#/,""):"",hostname:V.hostname,port:V.port,pathname:"/"===V.pathname.charAt(0)?V.pathname:"/"+V.pathname}}function Pb(b){b=C(b)?ua(b):b;return b.protocol===Hc.protocol&&b.host===Hc.host}
function fe(){this.$get=$(P)}function mc(b){function a(d,e){if(T(d)){var f={};r(d,function(b,c){f[c]=a(c,b)});return f}return b.factory(d+c,e)}var c="Filter";this.register=a;this.$get=["$injector",function(a){return function(b){return a.get(b+c)}}];a("currency",Ic);a("date",Jc);a("filter",Ae);a("json",Be);a("limitTo",Ce);a("lowercase",De);a("number",Kc);a("orderBy",Lc);a("uppercase",Ee)}function Ae(){return function(b,a,c){if(!L(b))return b;var d=typeof c,e=[];e.check=function(a){for(var b=0;b<e.length;b++)if(!e[b](a))return!1;
return!0};"function"!==d&&(c="boolean"===d&&c?function(a,b){return Ua.equals(a,b)}:function(a,b){if(a&&b&&"object"===typeof a&&"object"===typeof b){for(var d in a)if("$"!==d.charAt(0)&&ib.call(a,d)&&c(a[d],b[d]))return!0;return!1}b=(""+b).toLowerCase();return-1<(""+a).toLowerCase().indexOf(b)});var f=function(a,b){if("string"==typeof b&&"!"===b.charAt(0))return!f(a,b.substr(1));switch(typeof a){case "boolean":case "number":case "string":return c(a,b);case "object":switch(typeof b){case "object":return c(a,
b);default:for(var d in a)if("$"!==d.charAt(0)&&f(a[d],b))return!0}return!1;case "array":for(d=0;d<a.length;d++)if(f(a[d],b))return!0;return!1;default:return!1}};switch(typeof a){case "boolean":case "number":case "string":a={$:a};case "object":for(var g in a)(function(b){"undefined"!==typeof a[b]&&e.push(function(c){return f("$"==b?c:c&&c[b],a[b])})})(g);break;case "function":e.push(a);break;default:return b}d=[];for(g=0;g<b.length;g++){var k=b[g];e.check(k)&&d.push(k)}return d}}function Ic(b){var a=
b.NUMBER_FORMATS;return function(b,d){F(d)&&(d=a.CURRENCY_SYM);return Mc(b,a.PATTERNS[1],a.GROUP_SEP,a.DECIMAL_SEP,2).replace(/\u00A4/g,d)}}function Kc(b){var a=b.NUMBER_FORMATS;return function(b,d){return Mc(b,a.PATTERNS[0],a.GROUP_SEP,a.DECIMAL_SEP,d)}}function Mc(b,a,c,d,e){if(null==b||!isFinite(b)||T(b))return"";var f=0>b;b=Math.abs(b);var g=b+"",k="",m=[],h=!1;if(-1!==g.indexOf("e")){var l=g.match(/([\d\.]+)e(-?)(\d+)/);l&&"-"==l[2]&&l[3]>e+1?(g="0",b=0):(k=g,h=!0)}if(h)0<e&&(-1<b&&1>b)&&(k=
b.toFixed(e));else{g=(g.split(Nc)[1]||"").length;F(e)&&(e=Math.min(Math.max(a.minFrac,g),a.maxFrac));b=+(Math.round(+(b.toString()+"e"+e)).toString()+"e"+-e);b=(""+b).split(Nc);g=b[0];b=b[1]||"";var l=0,n=a.lgSize,p=a.gSize;if(g.length>=n+p)for(l=g.length-n,h=0;h<l;h++)0===(l-h)%p&&0!==h&&(k+=c),k+=g.charAt(h);for(h=l;h<g.length;h++)0===(g.length-h)%n&&0!==h&&(k+=c),k+=g.charAt(h);for(;b.length<e;)b+="0";e&&"0"!==e&&(k+=d+b.substr(0,e))}m.push(f?a.negPre:a.posPre);m.push(k);m.push(f?a.negSuf:a.posSuf);
return m.join("")}function Xb(b,a,c){var d="";0>b&&(d="-",b=-b);for(b=""+b;b.length<a;)b="0"+b;c&&(b=b.substr(b.length-a));return d+b}function Y(b,a,c,d){c=c||0;return function(e){e=e["get"+b]();if(0<c||e>-c)e+=c;0===e&&-12==c&&(e=12);return Xb(e,a,d)}}function ub(b,a){return function(c,d){var e=c["get"+b](),f=Ia(a?"SHORT"+b:b);return d[f][e]}}function Jc(b){function a(a){var b;if(b=a.match(c)){a=new Date(0);var f=0,g=0,k=b[8]?a.setUTCFullYear:a.setFullYear,m=b[8]?a.setUTCHours:a.setHours;b[9]&&(f=
Z(b[9]+b[10]),g=Z(b[9]+b[11]));k.call(a,Z(b[1]),Z(b[2])-1,Z(b[3]));f=Z(b[4]||0)-f;g=Z(b[5]||0)-g;k=Z(b[6]||0);b=Math.round(1E3*parseFloat("0."+(b[7]||0)));m.call(a,f,g,k,b)}return a}var c=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(c,e){var f="",g=[],k,m;e=e||"mediumDate";e=b.DATETIME_FORMATS[e]||e;C(c)&&(c=Fe.test(c)?Z(c):a(c));Ab(c)&&(c=new Date(c));if(!sa(c))return c;for(;e;)(m=Ge.exec(e))?(g=g.concat(Aa.call(m,1)),e=g.pop()):
(g.push(e),e=null);r(g,function(a){k=He[a];f+=k?k(c,b.DATETIME_FORMATS):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return f}}function Be(){return function(b){return ta(b,!0)}}function Ce(){return function(b,a){if(!L(b)&&!C(b))return b;a=Infinity===Math.abs(Number(a))?Number(a):Z(a);if(C(b))return a?0<=a?b.slice(0,a):b.slice(a,b.length):"";var c=[],d,e;a>b.length?a=b.length:a<-b.length&&(a=-b.length);0<a?(d=0,e=a):(d=b.length+a,e=b.length);for(;d<e;d++)c.push(b[d]);return c}}function Lc(b){return function(a,
c,d){function e(a,b){return Ta(b)?function(b,c){return a(c,b)}:a}function f(a,b){var c=typeof a,d=typeof b;return c==d?(sa(a)&&sa(b)&&(a=a.valueOf(),b=b.valueOf()),"string"==c&&(a=a.toLowerCase(),b=b.toLowerCase()),a===b?0:a<b?-1:1):c<d?-1:1}if(!L(a)||!c)return a;c=L(c)?c:[c];c=Vc(c,function(a){var c=!1,d=a||Ga;if(C(a)){if("+"==a.charAt(0)||"-"==a.charAt(0))c="-"==a.charAt(0),a=a.substring(1);d=b(a);if(d.constant){var g=d();return e(function(a,b){return f(a[g],b[g])},c)}}return e(function(a,b){return f(d(a),
d(b))},c)});for(var g=[],k=0;k<a.length;k++)g.push(a[k]);return g.sort(e(function(a,b){for(var d=0;d<c.length;d++){var e=c[d](a,b);if(0!==e)return e}return 0},d))}}function xa(b){J(b)&&(b={link:b});b.restrict=b.restrict||"AC";return $(b)}function Oc(b,a,c,d){function e(a,c){c=c?"-"+kb(c,"-"):"";d.removeClass(b,(a?vb:wb)+c);d.addClass(b,(a?wb:vb)+c)}var f=this,g=b.parent().controller("form")||xb,k=0,m=f.$error={},h=[];f.$name=a.name||a.ngForm;f.$dirty=!1;f.$pristine=!0;f.$valid=!0;f.$invalid=!1;g.$addControl(f);
b.addClass(Pa);e(!0);f.$addControl=function(a){Ca(a.$name,"input");h.push(a);a.$name&&(f[a.$name]=a)};f.$removeControl=function(a){a.$name&&f[a.$name]===a&&delete f[a.$name];r(m,function(b,c){f.$setValidity(c,!0,a)});Ra(h,a)};f.$setValidity=function(a,b,c){var d=m[a];if(b)d&&(Ra(d,c),d.length||(k--,k||(e(b),f.$valid=!0,f.$invalid=!1),m[a]=!1,e(!0,a),g.$setValidity(a,!0,f)));else{k||e(b);if(d){if(-1!=Qa(d,c))return}else m[a]=d=[],k++,e(!1,a),g.$setValidity(a,!1,f);d.push(c);f.$valid=!1;f.$invalid=
!0}};f.$setDirty=function(){d.removeClass(b,Pa);d.addClass(b,yb);f.$dirty=!0;f.$pristine=!1;g.$setDirty()};f.$setPristine=function(){d.removeClass(b,yb);d.addClass(b,Pa);f.$dirty=!1;f.$pristine=!0;r(h,function(a){a.$setPristine()})}}function ra(b,a,c,d){b.$setValidity(a,c);return c?d:s}function Pc(b,a){var c,d;if(a)for(c=0;c<a.length;++c)if(d=a[c],b[d])return!0;return!1}function Ie(b,a,c,d,e){T(e)&&(b.$$hasNativeValidators=!0,b.$parsers.push(function(f){if(b.$error[a]||Pc(e,d)||!Pc(e,c))return f;
b.$setValidity(a,!1)}))}function zb(b,a,c,d,e,f){var g=a.prop(Je),k=a[0].placeholder,m={};d.$$validityState=g;if(!e.android){var h=!1;a.on("compositionstart",function(a){h=!0});a.on("compositionend",function(){h=!1;l()})}var l=function(e){if(!h){var f=a.val();if(Q&&"input"===(e||m).type&&a[0].placeholder!==k)k=a[0].placeholder;else if(Ta(c.ngTrim||"T")&&(f=aa(f)),e=g&&d.$$hasNativeValidators,d.$viewValue!==f||""===f&&e)b.$$phase?d.$setViewValue(f):b.$apply(function(){d.$setViewValue(f)})}};if(e.hasEvent("input"))a.on("input",
l);else{var n,p=function(){n||(n=f.defer(function(){l();n=null}))};a.on("keydown",function(a){a=a.keyCode;91===a||(15<a&&19>a||37<=a&&40>=a)||p()});if(e.hasEvent("paste"))a.on("paste cut",p)}a.on("change",l);d.$render=function(){a.val(d.$isEmpty(d.$viewValue)?"":d.$viewValue)};var q=c.ngPattern;q&&((e=q.match(/^\/(.*)\/([gim]*)$/))?(q=RegExp(e[1],e[2]),e=function(a){return ra(d,"pattern",d.$isEmpty(a)||q.test(a),a)}):e=function(c){var e=b.$eval(q);if(!e||!e.test)throw w("ngPattern")("noregexp",q,
e,ha(a));return ra(d,"pattern",d.$isEmpty(c)||e.test(c),c)},d.$formatters.push(e),d.$parsers.push(e));if(c.ngMinlength){var t=Z(c.ngMinlength);e=function(a){return ra(d,"minlength",d.$isEmpty(a)||a.length>=t,a)};d.$parsers.push(e);d.$formatters.push(e)}if(c.ngMaxlength){var r=Z(c.ngMaxlength);e=function(a){return ra(d,"maxlength",d.$isEmpty(a)||a.length<=r,a)};d.$parsers.push(e);d.$formatters.push(e)}}function Yb(b,a){b="ngClass"+b;return["$animate",function(c){function d(a,b){var c=[],d=0;a:for(;d<
a.length;d++){for(var e=a[d],l=0;l<b.length;l++)if(e==b[l])continue a;c.push(e)}return c}function e(a){if(!L(a)){if(C(a))return a.split(" ");if(T(a)){var b=[];r(a,function(a,c){a&&(b=b.concat(c.split(" ")))});return b}}return a}return{restrict:"AC",link:function(f,g,k){function m(a,b){var c=g.data("$classCounts")||{},d=[];r(a,function(a){if(0<b||c[a])c[a]=(c[a]||0)+b,c[a]===+(0<b)&&d.push(a)});g.data("$classCounts",c);return d.join(" ")}function h(b){if(!0===a||f.$index%2===a){var h=e(b||[]);if(!l){var q=
m(h,1);k.$addClass(q)}else if(!za(b,l)){var r=e(l),q=d(h,r),h=d(r,h),h=m(h,-1),q=m(q,1);0===q.length?c.removeClass(g,h):0===h.length?c.addClass(g,q):c.setClass(g,q,h)}}l=ga(b)}var l;f.$watch(k[b],h,!0);k.$observe("class",function(a){h(f.$eval(k[b]))});"ngClass"!==b&&f.$watch("$index",function(c,d){var g=c&1;if(g!==(d&1)){var h=e(f.$eval(k[b]));g===a?(g=m(h,1),k.$addClass(g)):(g=m(h,-1),k.$removeClass(g))}})}}}]}var Je="validity",M=function(b){return C(b)?b.toLowerCase():b},ib=Object.prototype.hasOwnProperty,
Ia=function(b){return C(b)?b.toUpperCase():b},Q,y,Da,Aa=[].slice,Ke=[].push,ya=Object.prototype.toString,Sa=w("ng"),Ua=P.angular||(P.angular={}),Xa,Ma,la=["0","0","0"];Q=Z((/msie (\d+)/.exec(M(navigator.userAgent))||[])[1]);isNaN(Q)&&(Q=Z((/trident\/.*; rv:(\d+)/.exec(M(navigator.userAgent))||[])[1]));z.$inject=[];Ga.$inject=[];var L=function(){return J(Array.isArray)?Array.isArray:function(b){return"[object Array]"===ya.call(b)}}(),aa=function(){return String.prototype.trim?function(b){return C(b)?
b.trim():b}:function(b){return C(b)?b.replace(/^\s\s*/,"").replace(/\s\s*$/,""):b}}();Ma=9>Q?function(b){b=b.nodeName?b:b[0];return b.scopeName&&"HTML"!=b.scopeName?Ia(b.scopeName+":"+b.nodeName):b.nodeName}:function(b){return b.nodeName?b.nodeName:b[0].nodeName};var Wa=function(){if(D(Wa.isActive_))return Wa.isActive_;var b=!(!X.querySelector("[ng-csp]")&&!X.querySelector("[data-ng-csp]"));if(!b)try{new Function("")}catch(a){b=!0}return Wa.isActive_=b},Yc=/[A-Z]/g,ad={full:"1.2.22",major:1,minor:2,
dot:22,codeName:"finicky-pleasure"};S.expando="ng339";var $a=S.cache={},ne=1,rb=P.document.addEventListener?function(b,a,c){b.addEventListener(a,c,!1)}:function(b,a,c){b.attachEvent("on"+a,c)},Za=P.document.removeEventListener?function(b,a,c){b.removeEventListener(a,c,!1)}:function(b,a,c){b.detachEvent("on"+a,c)};S._data=function(b){return this.cache[b[this.expando]]||{}};var ie=/([\:\-\_]+(.))/g,je=/^moz([A-Z])/,Hb=w("jqLite"),ke=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Ib=/<|&#?\w+;/,le=/<([\w:]+)/,me=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
ba={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ba.optgroup=ba.option;ba.tbody=ba.tfoot=ba.colgroup=ba.caption=ba.thead;ba.th=ba.td;var La=S.prototype={ready:function(b){function a(){c||(c=!0,b())}var c=!1;"complete"===X.readyState?setTimeout(a):(this.on("DOMContentLoaded",a),S(P).on("load",a))},
toString:function(){var b=[];r(this,function(a){b.push(""+a)});return"["+b.join(", ")+"]"},eq:function(b){return 0<=b?y(this[b]):y(this[this.length+b])},length:0,push:Ke,sort:[].sort,splice:[].splice},ob={};r("multiple selected checked disabled readOnly required open".split(" "),function(b){ob[M(b)]=b});var rc={};r("input select option textarea button form details".split(" "),function(b){rc[Ia(b)]=!0});r({data:Mb,removeData:Lb},function(b,a){S[a]=b});r({data:Mb,inheritedData:nb,scope:function(b){return y.data(b,
"$scope")||nb(b.parentNode||b,["$isolateScope","$scope"])},isolateScope:function(b){return y.data(b,"$isolateScope")||y.data(b,"$isolateScopeNoTemplate")},controller:oc,injector:function(b){return nb(b,"$injector")},removeAttr:function(b,a){b.removeAttribute(a)},hasClass:Nb,css:function(b,a,c){a=Ya(a);if(D(c))b.style[a]=c;else{var d;8>=Q&&(d=b.currentStyle&&b.currentStyle[a],""===d&&(d="auto"));d=d||b.style[a];8>=Q&&(d=""===d?s:d);return d}},attr:function(b,a,c){var d=M(a);if(ob[d])if(D(c))c?(b[a]=
!0,b.setAttribute(a,d)):(b[a]=!1,b.removeAttribute(d));else return b[a]||(b.attributes.getNamedItem(a)||z).specified?d:s;else if(D(c))b.setAttribute(a,c);else if(b.getAttribute)return b=b.getAttribute(a,2),null===b?s:b},prop:function(b,a,c){if(D(c))b[a]=c;else return b[a]},text:function(){function b(b,d){var e=a[b.nodeType];if(F(d))return e?b[e]:"";b[e]=d}var a=[];9>Q?(a[1]="innerText",a[3]="nodeValue"):a[1]=a[3]="textContent";b.$dv="";return b}(),val:function(b,a){if(F(a)){if("SELECT"===Ma(b)&&b.multiple){var c=
[];r(b.options,function(a){a.selected&&c.push(a.value||a.text)});return 0===c.length?null:c}return b.value}b.value=a},html:function(b,a){if(F(a))return b.innerHTML;for(var c=0,d=b.childNodes;c<d.length;c++)Ja(d[c]);b.innerHTML=a},empty:pc},function(b,a){S.prototype[a]=function(a,d){var e,f,g=this.length;if(b!==pc&&(2==b.length&&b!==Nb&&b!==oc?a:d)===s){if(T(a)){for(e=0;e<g;e++)if(b===Mb)b(this[e],a);else for(f in a)b(this[e],f,a[f]);return this}e=b.$dv;g=e===s?Math.min(g,1):g;for(f=0;f<g;f++){var k=
b(this[f],a,d);e=e?e+k:k}return e}for(e=0;e<g;e++)b(this[e],a,d);return this}});r({removeData:Lb,dealoc:Ja,on:function a(c,d,e,f){if(D(f))throw Hb("onargs");var g=ma(c,"events"),k=ma(c,"handle");g||ma(c,"events",g={});k||ma(c,"handle",k=oe(c,g));r(d.split(" "),function(d){var f=g[d];if(!f){if("mouseenter"==d||"mouseleave"==d){var l=X.body.contains||X.body.compareDocumentPosition?function(a,c){var d=9===a.nodeType?a.documentElement:a,e=c&&c.parentNode;return a===e||!!(e&&1===e.nodeType&&(d.contains?
d.contains(e):a.compareDocumentPosition&&a.compareDocumentPosition(e)&16))}:function(a,c){if(c)for(;c=c.parentNode;)if(c===a)return!0;return!1};g[d]=[];a(c,{mouseleave:"mouseout",mouseenter:"mouseover"}[d],function(a){var c=a.relatedTarget;c&&(c===this||l(this,c))||k(a,d)})}else rb(c,d,k),g[d]=[];f=g[d]}f.push(e)})},off:nc,one:function(a,c,d){a=y(a);a.on(c,function f(){a.off(c,d);a.off(c,f)});a.on(c,d)},replaceWith:function(a,c){var d,e=a.parentNode;Ja(a);r(new S(c),function(c){d?e.insertBefore(c,
d.nextSibling):e.replaceChild(c,a);d=c})},children:function(a){var c=[];r(a.childNodes,function(a){1===a.nodeType&&c.push(a)});return c},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,c){r(new S(c),function(c){1!==a.nodeType&&11!==a.nodeType||a.appendChild(c)})},prepend:function(a,c){if(1===a.nodeType){var d=a.firstChild;r(new S(c),function(c){a.insertBefore(c,d)})}},wrap:function(a,c){c=y(c)[0];var d=a.parentNode;d&&d.replaceChild(c,a);c.appendChild(a)},remove:function(a){Ja(a);
var c=a.parentNode;c&&c.removeChild(a)},after:function(a,c){var d=a,e=a.parentNode;r(new S(c),function(a){e.insertBefore(a,d.nextSibling);d=a})},addClass:mb,removeClass:lb,toggleClass:function(a,c,d){c&&r(c.split(" "),function(c){var f=d;F(f)&&(f=!Nb(a,c));(f?mb:lb)(a,c)})},parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},next:function(a){if(a.nextElementSibling)return a.nextElementSibling;for(a=a.nextSibling;null!=a&&1!==a.nodeType;)a=a.nextSibling;return a},find:function(a,c){return a.getElementsByTagName?
a.getElementsByTagName(c):[]},clone:Kb,triggerHandler:function(a,c,d){var e,f;e=c.type||c;var g=(ma(a,"events")||{})[e];g&&(e={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopPropagation:z,type:e,target:a},c.type&&(e=E(e,c)),c=ga(g),f=d?[e].concat(d):[e],r(c,function(c){c.apply(a,f)}))}},function(a,c){S.prototype[c]=function(c,e,f){for(var g,k=0;k<this.length;k++)F(g)?(g=a(this[k],c,e,f),D(g)&&(g=y(g))):Jb(g,a(this[k],c,e,f));
return D(g)?g:this};S.prototype.bind=S.prototype.on;S.prototype.unbind=S.prototype.off});ab.prototype={put:function(a,c){this[Ka(a,this.nextUid)]=c},get:function(a){return this[Ka(a,this.nextUid)]},remove:function(a){var c=this[a=Ka(a,this.nextUid)];delete this[a];return c}};var qe=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,re=/,/,se=/^\s*(_?)(\S+?)\1\s*$/,pe=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,bb=w("$injector"),Le=w("$animate"),Md=["$provide",function(a){this.$$selectors={};this.register=function(c,d){var e=
c+"-animation";if(c&&"."!=c.charAt(0))throw Le("notcsel",c);this.$$selectors[c.substr(1)]=e;a.factory(e,d)};this.classNameFilter=function(a){1===arguments.length&&(this.$$classNameFilter=a instanceof RegExp?a:null);return this.$$classNameFilter};this.$get=["$timeout","$$asyncCallback",function(a,d){return{enter:function(a,c,g,k){g?g.after(a):(c&&c[0]||(c=g.parent()),c.append(a));k&&d(k)},leave:function(a,c){a.remove();c&&d(c)},move:function(a,c,d,k){this.enter(a,c,d,k)},addClass:function(a,c,g){c=
C(c)?c:L(c)?c.join(" "):"";r(a,function(a){mb(a,c)});g&&d(g)},removeClass:function(a,c,g){c=C(c)?c:L(c)?c.join(" "):"";r(a,function(a){lb(a,c)});g&&d(g)},setClass:function(a,c,g,k){r(a,function(a){mb(a,c);lb(a,g)});k&&d(k)},enabled:z}}]}],ia=w("$compile");ic.$inject=["$provide","$$sanitizeUriProvider"];var ue=/^(x[\:\-_]|data[\:\-_])/i,yc=w("$interpolate"),Me=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,xe={http:80,https:443,ftp:21},Sb=w("$location");Ub.prototype=Tb.prototype=Bc.prototype={$$html5:!1,$$replace:!1,
absUrl:sb("$$absUrl"),url:function(a,c){if(F(a))return this.$$url;var d=Me.exec(a);d[1]&&this.path(decodeURIComponent(d[1]));(d[2]||d[1])&&this.search(d[3]||"");this.hash(d[5]||"",c);return this},protocol:sb("$$protocol"),host:sb("$$host"),port:sb("$$port"),path:Cc("$$path",function(a){return"/"==a.charAt(0)?a:"/"+a}),search:function(a,c){switch(arguments.length){case 0:return this.$$search;case 1:if(C(a))this.$$search=ec(a);else if(T(a))r(a,function(c,e){null==c&&delete a[e]}),this.$$search=a;else throw Sb("isrcharg");
break;default:F(c)||null===c?delete this.$$search[a]:this.$$search[a]=c}this.$$compose();return this},hash:Cc("$$hash",Ga),replace:function(){this.$$replace=!0;return this}};var ka=w("$parse"),Fc={},va,Ne=Function.prototype.call,Oe=Function.prototype.apply,Qc=Function.prototype.bind,eb={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:z,"+":function(a,c,d,e){d=d(a,c);e=e(a,c);return D(d)?D(e)?d+e:d:D(e)?e:s},"-":function(a,c,d,e){d=d(a,c);e=e(a,c);
return(D(d)?d:0)-(D(e)?e:0)},"*":function(a,c,d,e){return d(a,c)*e(a,c)},"/":function(a,c,d,e){return d(a,c)/e(a,c)},"%":function(a,c,d,e){return d(a,c)%e(a,c)},"^":function(a,c,d,e){return d(a,c)^e(a,c)},"=":z,"===":function(a,c,d,e){return d(a,c)===e(a,c)},"!==":function(a,c,d,e){return d(a,c)!==e(a,c)},"==":function(a,c,d,e){return d(a,c)==e(a,c)},"!=":function(a,c,d,e){return d(a,c)!=e(a,c)},"<":function(a,c,d,e){return d(a,c)<e(a,c)},">":function(a,c,d,e){return d(a,c)>e(a,c)},"<=":function(a,
c,d,e){return d(a,c)<=e(a,c)},">=":function(a,c,d,e){return d(a,c)>=e(a,c)},"&&":function(a,c,d,e){return d(a,c)&&e(a,c)},"||":function(a,c,d,e){return d(a,c)||e(a,c)},"&":function(a,c,d,e){return d(a,c)&e(a,c)},"|":function(a,c,d,e){return e(a,c)(a,c,d(a,c))},"!":function(a,c,d){return!d(a,c)}},Pe={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},Wb=function(a){this.options=a};Wb.prototype={constructor:Wb,lex:function(a){this.text=a;this.index=0;this.ch=s;this.lastCh=":";for(this.tokens=[];this.index<
this.text.length;){this.ch=this.text.charAt(this.index);if(this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent();else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch}),this.index++;else if(this.isWhitespace(this.ch)){this.index++;continue}else{a=this.ch+this.peek();var c=a+this.peek(2),d=eb[this.ch],e=eb[a],f=eb[c];f?(this.tokens.push({index:this.index,
text:c,fn:f}),this.index+=3):e?(this.tokens.push({index:this.index,text:a,fn:e}),this.index+=2):d?(this.tokens.push({index:this.index,text:this.ch,fn:d}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(a){return-1!==a.indexOf(this.ch)},was:function(a){return-1!==a.indexOf(this.lastCh)},peek:function(a){a=a||1;return this.index+a<this.text.length?this.text.charAt(this.index+a):!1},isNumber:function(a){return"0"<=
a&&"9">=a},isWhitespace:function(a){return" "===a||"\r"===a||"\t"===a||"\n"===a||"\v"===a||"\u00a0"===a},isIdent:function(a){return"a"<=a&&"z">=a||"A"<=a&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,c,d){d=d||this.index;c=D(c)?"s "+c+"-"+this.index+" ["+this.text.substring(c,d)+"]":" "+d;throw ka("lexerr",a,c,this.text);},readNumber:function(){for(var a="",c=this.index;this.index<this.text.length;){var d=M(this.text.charAt(this.index));
if("."==d||this.isNumber(d))a+=d;else{var e=this.peek();if("e"==d&&this.isExpOperator(e))a+=d;else if(this.isExpOperator(d)&&e&&this.isNumber(e)&&"e"==a.charAt(a.length-1))a+=d;else if(!this.isExpOperator(d)||e&&this.isNumber(e)||"e"!=a.charAt(a.length-1))break;else this.throwError("Invalid exponent")}this.index++}a*=1;this.tokens.push({index:c,text:a,literal:!0,constant:!0,fn:function(){return a}})},readIdent:function(){for(var a=this,c="",d=this.index,e,f,g,k;this.index<this.text.length;){k=this.text.charAt(this.index);
if("."===k||this.isIdent(k)||this.isNumber(k))"."===k&&(e=this.index),c+=k;else break;this.index++}if(e)for(f=this.index;f<this.text.length;){k=this.text.charAt(f);if("("===k){g=c.substr(e-d+1);c=c.substr(0,e-d);this.index=f;break}if(this.isWhitespace(k))f++;else break}d={index:d,text:c};if(eb.hasOwnProperty(c))d.fn=eb[c],d.literal=!0,d.constant=!0;else{var m=Ec(c,this.options,this.text);d.fn=E(function(a,c){return m(a,c)},{assign:function(d,e){return tb(d,c,e,a.text,a.options)}})}this.tokens.push(d);
g&&(this.tokens.push({index:e,text:"."}),this.tokens.push({index:e+1,text:g}))},readString:function(a){var c=this.index;this.index++;for(var d="",e=a,f=!1;this.index<this.text.length;){var g=this.text.charAt(this.index),e=e+g;if(f)"u"===g?(f=this.text.substring(this.index+1,this.index+5),f.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+f+"]"),this.index+=4,d+=String.fromCharCode(parseInt(f,16))):d+=Pe[g]||g,f=!1;else if("\\"===g)f=!0;else{if(g===a){this.index++;this.tokens.push({index:c,
text:e,string:d,literal:!0,constant:!0,fn:function(){return d}});return}d+=g}this.index++}this.throwError("Unterminated quote",c)}};var db=function(a,c,d){this.lexer=a;this.$filter=c;this.options=d};db.ZERO=E(function(){return 0},{constant:!0});db.prototype={constructor:db,parse:function(a){this.text=a;this.tokens=this.lexer.lex(a);a=this.statements();0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]);a.literal=!!a.literal;a.constant=!!a.constant;return a},primary:function(){var a;
if(this.expect("("))a=this.filterChain(),this.consume(")");else if(this.expect("["))a=this.arrayDeclaration();else if(this.expect("{"))a=this.object();else{var c=this.expect();(a=c.fn)||this.throwError("not a primary expression",c);a.literal=!!c.literal;a.constant=!!c.constant}for(var d;c=this.expect("(","[",".");)"("===c.text?(a=this.functionCall(a,d),d=null):"["===c.text?(d=a,a=this.objectIndex(a)):"."===c.text?(d=a,a=this.fieldAccess(a)):this.throwError("IMPOSSIBLE");return a},throwError:function(a,
c){throw ka("syntax",c.text,a,c.index+1,this.text,this.text.substring(c.index));},peekToken:function(){if(0===this.tokens.length)throw ka("ueoe",this.text);return this.tokens[0]},peek:function(a,c,d,e){if(0<this.tokens.length){var f=this.tokens[0],g=f.text;if(g===a||g===c||g===d||g===e||!(a||c||d||e))return f}return!1},expect:function(a,c,d,e){return(a=this.peek(a,c,d,e))?(this.tokens.shift(),a):!1},consume:function(a){this.expect(a)||this.throwError("is unexpected, expecting ["+a+"]",this.peek())},
unaryFn:function(a,c){return E(function(d,e){return a(d,e,c)},{constant:c.constant})},ternaryFn:function(a,c,d){return E(function(e,f){return a(e,f)?c(e,f):d(e,f)},{constant:a.constant&&c.constant&&d.constant})},binaryFn:function(a,c,d){return E(function(e,f){return c(e,f,a,d)},{constant:a.constant&&d.constant})},statements:function(){for(var a=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&a.push(this.filterChain()),!this.expect(";"))return 1===a.length?a[0]:function(c,d){for(var e,f=
0;f<a.length;f++){var g=a[f];g&&(e=g(c,d))}return e}},filterChain:function(){for(var a=this.expression(),c;;)if(c=this.expect("|"))a=this.binaryFn(a,c.fn,this.filter());else return a},filter:function(){for(var a=this.expect(),c=this.$filter(a.text),d=[];;)if(a=this.expect(":"))d.push(this.expression());else{var e=function(a,e,k){k=[k];for(var m=0;m<d.length;m++)k.push(d[m](a,e));return c.apply(a,k)};return function(){return e}}},expression:function(){return this.assignment()},assignment:function(){var a=
this.ternary(),c,d;return(d=this.expect("="))?(a.assign||this.throwError("implies assignment but ["+this.text.substring(0,d.index)+"] can not be assigned to",d),c=this.ternary(),function(d,f){return a.assign(d,c(d,f),f)}):a},ternary:function(){var a=this.logicalOR(),c,d;if(this.expect("?")){c=this.assignment();if(d=this.expect(":"))return this.ternaryFn(a,c,this.assignment());this.throwError("expected :",d)}else return a},logicalOR:function(){for(var a=this.logicalAND(),c;;)if(c=this.expect("||"))a=
this.binaryFn(a,c.fn,this.logicalAND());else return a},logicalAND:function(){var a=this.equality(),c;if(c=this.expect("&&"))a=this.binaryFn(a,c.fn,this.logicalAND());return a},equality:function(){var a=this.relational(),c;if(c=this.expect("==","!=","===","!=="))a=this.binaryFn(a,c.fn,this.equality());return a},relational:function(){var a=this.additive(),c;if(c=this.expect("<",">","<=",">="))a=this.binaryFn(a,c.fn,this.relational());return a},additive:function(){for(var a=this.multiplicative(),c;c=
this.expect("+","-");)a=this.binaryFn(a,c.fn,this.multiplicative());return a},multiplicative:function(){for(var a=this.unary(),c;c=this.expect("*","/","%");)a=this.binaryFn(a,c.fn,this.unary());return a},unary:function(){var a;return this.expect("+")?this.primary():(a=this.expect("-"))?this.binaryFn(db.ZERO,a.fn,this.unary()):(a=this.expect("!"))?this.unaryFn(a.fn,this.unary()):this.primary()},fieldAccess:function(a){var c=this,d=this.expect().text,e=Ec(d,this.options,this.text);return E(function(c,
d,k){return e(k||a(c,d))},{assign:function(e,g,k){(k=a(e,k))||a.assign(e,k={});return tb(k,d,g,c.text,c.options)}})},objectIndex:function(a){var c=this,d=this.expression();this.consume("]");return E(function(e,f){var g=a(e,f),k=d(e,f),m;ja(k,c.text);if(!g)return s;(g=Oa(g[k],c.text))&&(g.then&&c.options.unwrapPromises)&&(m=g,"$$v"in g||(m.$$v=s,m.then(function(a){m.$$v=a})),g=g.$$v);return g},{assign:function(e,f,g){var k=ja(d(e,g),c.text);(g=Oa(a(e,g),c.text))||a.assign(e,g={});return g[k]=f}})},
functionCall:function(a,c){var d=[];if(")"!==this.peekToken().text){do d.push(this.expression());while(this.expect(","))}this.consume(")");var e=this;return function(f,g){for(var k=[],m=c?c(f,g):f,h=0;h<d.length;h++)k.push(d[h](f,g));h=a(f,g,m)||z;Oa(m,e.text);var l=e.text;if(h){if(h.constructor===h)throw ka("isecfn",l);if(h===Ne||h===Oe||Qc&&h===Qc)throw ka("isecff",l);}k=h.apply?h.apply(m,k):h(k[0],k[1],k[2],k[3],k[4]);return Oa(k,e.text)}},arrayDeclaration:function(){var a=[],c=!0;if("]"!==this.peekToken().text){do{if(this.peek("]"))break;
var d=this.expression();a.push(d);d.constant||(c=!1)}while(this.expect(","))}this.consume("]");return E(function(c,d){for(var g=[],k=0;k<a.length;k++)g.push(a[k](c,d));return g},{literal:!0,constant:c})},object:function(){var a=[],c=!0;if("}"!==this.peekToken().text){do{if(this.peek("}"))break;var d=this.expect(),d=d.string||d.text;this.consume(":");var e=this.expression();a.push({key:d,value:e});e.constant||(c=!1)}while(this.expect(","))}this.consume("}");return E(function(c,d){for(var e={},m=0;m<
a.length;m++){var h=a[m];e[h.key]=h.value(c,d)}return e},{literal:!0,constant:c})}};var Vb={},wa=w("$sce"),fa={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},V=X.createElement("a"),Hc=ua(P.location.href,!0);mc.$inject=["$provide"];Ic.$inject=["$locale"];Kc.$inject=["$locale"];var Nc=".",He={yyyy:Y("FullYear",4),yy:Y("FullYear",2,0,!0),y:Y("FullYear",1),MMMM:ub("Month"),MMM:ub("Month",!0),MM:Y("Month",2,1),M:Y("Month",1,1),dd:Y("Date",2),d:Y("Date",1),HH:Y("Hours",2),H:Y("Hours",
1),hh:Y("Hours",2,-12),h:Y("Hours",1,-12),mm:Y("Minutes",2),m:Y("Minutes",1),ss:Y("Seconds",2),s:Y("Seconds",1),sss:Y("Milliseconds",3),EEEE:ub("Day"),EEE:ub("Day",!0),a:function(a,c){return 12>a.getHours()?c.AMPMS[0]:c.AMPMS[1]},Z:function(a){a=-1*a.getTimezoneOffset();return a=(0<=a?"+":"")+(Xb(Math[0<a?"floor":"ceil"](a/60),2)+Xb(Math.abs(a%60),2))}},Ge=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,Fe=/^\-?\d+$/;Jc.$inject=["$locale"];var De=$(M),Ee=$(Ia);Lc.$inject=
["$parse"];var dd=$({restrict:"E",compile:function(a,c){8>=Q&&(c.href||c.name||c.$set("href",""),a.append(X.createComment("IE fix")));if(!c.href&&!c.xlinkHref&&!c.name)return function(a,c){var f="[object SVGAnimatedString]"===ya.call(c.prop("href"))?"xlink:href":"href";c.on("click",function(a){c.attr(f)||a.preventDefault()})}}}),Fb={};r(ob,function(a,c){if("multiple"!=a){var d=na("ng-"+c);Fb[d]=function(){return{priority:100,link:function(a,f,g){a.$watch(g[d],function(a){g.$set(c,!!a)})}}}}});r(["src",
"srcset","href"],function(a){var c=na("ng-"+a);Fb[c]=function(){return{priority:99,link:function(d,e,f){var g=a,k=a;"href"===a&&"[object SVGAnimatedString]"===ya.call(e.prop("href"))&&(k="xlinkHref",f.$attr[k]="xlink:href",g=null);f.$observe(c,function(a){a&&(f.$set(k,a),Q&&g&&e.prop(g,f[k]))})}}}});var xb={$addControl:z,$removeControl:z,$setValidity:z,$setDirty:z,$setPristine:z};Oc.$inject=["$element","$attrs","$scope","$animate"];var Rc=function(a){return["$timeout",function(c){return{name:"form",
restrict:a?"EAC":"E",controller:Oc,compile:function(){return{pre:function(a,e,f,g){if(!f.action){var k=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};rb(e[0],"submit",k);e.on("$destroy",function(){c(function(){Za(e[0],"submit",k)},0,!1)})}var m=e.parent().controller("form"),h=f.name||f.ngForm;h&&tb(a,h,g,h);if(m)e.on("$destroy",function(){m.$removeControl(g);h&&tb(a,h,s,h);E(g,xb)})}}}}}]},ed=Rc(),rd=Rc(!0),Qe=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,
Re=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,Se=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,Sc={text:zb,number:function(a,c,d,e,f,g){zb(a,c,d,e,f,g);e.$parsers.push(function(a){var c=e.$isEmpty(a);if(c||Se.test(a))return e.$setValidity("number",!0),""===a?null:c?a:parseFloat(a);e.$setValidity("number",!1);return s});Ie(e,"number",Te,null,e.$$validityState);e.$formatters.push(function(a){return e.$isEmpty(a)?"":""+a});d.min&&(a=function(a){var c=parseFloat(d.min);
return ra(e,"min",e.$isEmpty(a)||a>=c,a)},e.$parsers.push(a),e.$formatters.push(a));d.max&&(a=function(a){var c=parseFloat(d.max);return ra(e,"max",e.$isEmpty(a)||a<=c,a)},e.$parsers.push(a),e.$formatters.push(a));e.$formatters.push(function(a){return ra(e,"number",e.$isEmpty(a)||Ab(a),a)})},url:function(a,c,d,e,f,g){zb(a,c,d,e,f,g);a=function(a){return ra(e,"url",e.$isEmpty(a)||Qe.test(a),a)};e.$formatters.push(a);e.$parsers.push(a)},email:function(a,c,d,e,f,g){zb(a,c,d,e,f,g);a=function(a){return ra(e,
"email",e.$isEmpty(a)||Re.test(a),a)};e.$formatters.push(a);e.$parsers.push(a)},radio:function(a,c,d,e){F(d.name)&&c.attr("name",gb());c.on("click",function(){c[0].checked&&a.$apply(function(){e.$setViewValue(d.value)})});e.$render=function(){c[0].checked=d.value==e.$viewValue};d.$observe("value",e.$render)},checkbox:function(a,c,d,e){var f=d.ngTrueValue,g=d.ngFalseValue;C(f)||(f=!0);C(g)||(g=!1);c.on("click",function(){a.$apply(function(){e.$setViewValue(c[0].checked)})});e.$render=function(){c[0].checked=
e.$viewValue};e.$isEmpty=function(a){return a!==f};e.$formatters.push(function(a){return a===f});e.$parsers.push(function(a){return a?f:g})},hidden:z,button:z,submit:z,reset:z,file:z},Te=["badInput"],jc=["$browser","$sniffer",function(a,c){return{restrict:"E",require:"?ngModel",link:function(d,e,f,g){g&&(Sc[M(f.type)]||Sc.text)(d,e,f,g,c,a)}}}],wb="ng-valid",vb="ng-invalid",Pa="ng-pristine",yb="ng-dirty",Ue=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate",function(a,c,d,e,f,g){function k(a,
c){c=c?"-"+kb(c,"-"):"";g.removeClass(e,(a?vb:wb)+c);g.addClass(e,(a?wb:vb)+c)}this.$modelValue=this.$viewValue=Number.NaN;this.$parsers=[];this.$formatters=[];this.$viewChangeListeners=[];this.$pristine=!0;this.$dirty=!1;this.$valid=!0;this.$invalid=!1;this.$name=d.name;var m=f(d.ngModel),h=m.assign;if(!h)throw w("ngModel")("nonassign",d.ngModel,ha(e));this.$render=z;this.$isEmpty=function(a){return F(a)||""===a||null===a||a!==a};var l=e.inheritedData("$formController")||xb,n=0,p=this.$error={};
e.addClass(Pa);k(!0);this.$setValidity=function(a,c){p[a]!==!c&&(c?(p[a]&&n--,n||(k(!0),this.$valid=!0,this.$invalid=!1)):(k(!1),this.$invalid=!0,this.$valid=!1,n++),p[a]=!c,k(c,a),l.$setValidity(a,c,this))};this.$setPristine=function(){this.$dirty=!1;this.$pristine=!0;g.removeClass(e,yb);g.addClass(e,Pa)};this.$setViewValue=function(d){this.$viewValue=d;this.$pristine&&(this.$dirty=!0,this.$pristine=!1,g.removeClass(e,Pa),g.addClass(e,yb),l.$setDirty());r(this.$parsers,function(a){d=a(d)});this.$modelValue!==
d&&(this.$modelValue=d,h(a,d),r(this.$viewChangeListeners,function(a){try{a()}catch(d){c(d)}}))};var q=this;a.$watch(function(){var c=m(a);if(q.$modelValue!==c){var d=q.$formatters,e=d.length;for(q.$modelValue=c;e--;)c=d[e](c);q.$viewValue!==c&&(q.$viewValue=c,q.$render())}return c})}],Gd=function(){return{require:["ngModel","^?form"],controller:Ue,link:function(a,c,d,e){var f=e[0],g=e[1]||xb;g.$addControl(f);a.$on("$destroy",function(){g.$removeControl(f)})}}},Id=$({require:"ngModel",link:function(a,
c,d,e){e.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),kc=function(){return{require:"?ngModel",link:function(a,c,d,e){if(e){d.required=!0;var f=function(a){if(d.required&&e.$isEmpty(a))e.$setValidity("required",!1);else return e.$setValidity("required",!0),a};e.$formatters.push(f);e.$parsers.unshift(f);d.$observe("required",function(){f(e.$viewValue)})}}}},Hd=function(){return{require:"ngModel",link:function(a,c,d,e){var f=(a=/\/(.*)\//.exec(d.ngList))&&RegExp(a[1])||d.ngList||",";
e.$parsers.push(function(a){if(!F(a)){var c=[];a&&r(a.split(f),function(a){a&&c.push(aa(a))});return c}});e.$formatters.push(function(a){return L(a)?a.join(", "):s});e.$isEmpty=function(a){return!a||!a.length}}}},Ve=/^(true|false|\d+)$/,Jd=function(){return{priority:100,compile:function(a,c){return Ve.test(c.ngValue)?function(a,c,f){f.$set("value",a.$eval(f.ngValue))}:function(a,c,f){a.$watch(f.ngValue,function(a){f.$set("value",a)})}}}},jd=xa({compile:function(a){a.addClass("ng-binding");return function(a,
d,e){d.data("$binding",e.ngBind);a.$watch(e.ngBind,function(a){d.text(a==s?"":a)})}}}),ld=["$interpolate",function(a){return function(c,d,e){c=a(d.attr(e.$attr.ngBindTemplate));d.addClass("ng-binding").data("$binding",c);e.$observe("ngBindTemplate",function(a){d.text(a)})}}],kd=["$sce","$parse",function(a,c){return{compile:function(d){d.addClass("ng-binding");return function(d,f,g){f.data("$binding",g.ngBindHtml);var k=c(g.ngBindHtml);d.$watch(function(){return(k(d)||"").toString()},function(c){f.html(a.getTrustedHtml(k(d))||
"")})}}}}],md=Yb("",!0),od=Yb("Odd",0),nd=Yb("Even",1),pd=xa({compile:function(a,c){c.$set("ngCloak",s);a.removeClass("ng-cloak")}}),qd=[function(){return{scope:!0,controller:"@",priority:500}}],lc={};r("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var c=na("ng-"+a);lc[c]=["$parse",function(d){return{compile:function(e,f){var g=d(f[c]);return function(c,d){d.on(M(a),function(a){c.$apply(function(){g(c,
{$event:a})})})}}}}]});var td=["$animate",function(a){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(c,d,e,f,g){var k,m,h;c.$watch(e.ngIf,function(f){Ta(f)?m||(m=c.$new(),g(m,function(c){c[c.length++]=X.createComment(" end ngIf: "+e.ngIf+" ");k={clone:c};a.enter(c,d.parent(),d)})):(h&&(h.remove(),h=null),m&&(m.$destroy(),m=null),k&&(h=Eb(k.clone),a.leave(h,function(){h=null}),k=null))})}}}],ud=["$http","$templateCache","$anchorScroll","$animate","$sce",function(a,
c,d,e,f){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:Ua.noop,compile:function(g,k){var m=k.ngInclude||k.src,h=k.onload||"",l=k.autoscroll;return function(g,k,q,r,K){var x=0,v,A,s,u=function(){A&&(A.remove(),A=null);v&&(v.$destroy(),v=null);s&&(e.leave(s,function(){A=null}),A=s,s=null)};g.$watch(f.parseAsResourceUrl(m),function(f){var m=function(){!D(l)||l&&!g.$eval(l)||d()},q=++x;f?(a.get(f,{cache:c}).success(function(a){if(q===x){var c=g.$new();r.template=a;a=K(c,
function(a){u();e.enter(a,null,k,m)});v=c;s=a;v.$emit("$includeContentLoaded");g.$eval(h)}}).error(function(){q===x&&u()}),g.$emit("$includeContentRequested")):(u(),r.template=null)})}}}}],Kd=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(c,d,e,f){d.html(f.template);a(d.contents())(c)}}}],vd=xa({priority:450,compile:function(){return{pre:function(a,c,d){a.$eval(d.ngInit)}}}}),wd=xa({terminal:!0,priority:1E3}),xd=["$locale","$interpolate",function(a,c){var d=
/{}/g;return{restrict:"EA",link:function(e,f,g){var k=g.count,m=g.$attr.when&&f.attr(g.$attr.when),h=g.offset||0,l=e.$eval(m)||{},n={},p=c.startSymbol(),q=c.endSymbol(),t=/^when(Minus)?(.+)$/;r(g,function(a,c){t.test(c)&&(l[M(c.replace("when","").replace("Minus","-"))]=f.attr(g.$attr[c]))});r(l,function(a,e){n[e]=c(a.replace(d,p+k+"-"+h+q))});e.$watch(function(){var c=parseFloat(e.$eval(k));if(isNaN(c))return"";c in l||(c=a.pluralCat(c-h));return n[c](e,f,!0)},function(a){f.text(a)})}}}],yd=["$parse",
"$animate",function(a,c){var d=w("ngRepeat");return{transclude:"element",priority:1E3,terminal:!0,$$tlb:!0,link:function(e,f,g,k,m){var h=g.ngRepeat,l=h.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),n,p,q,t,s,x,v={$id:Ka};if(!l)throw d("iexp",h);g=l[1];k=l[2];(l=l[3])?(n=a(l),p=function(a,c,d){x&&(v[x]=a);v[s]=c;v.$index=d;return n(e,v)}):(q=function(a,c){return Ka(c)},t=function(a){return a});l=g.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/);if(!l)throw d("iidexp",
g);s=l[3]||l[1];x=l[2];var A={};e.$watchCollection(k,function(a){var g,k,l=f[0],n,v={},D,B,G,w,C,z,F=[];if(fb(a))C=a,n=p||q;else{n=p||t;C=[];for(G in a)a.hasOwnProperty(G)&&"$"!=G.charAt(0)&&C.push(G);C.sort()}D=C.length;k=F.length=C.length;for(g=0;g<k;g++)if(G=a===C?g:C[g],w=a[G],w=n(G,w,g),Ca(w,"`track by` id"),A.hasOwnProperty(w))z=A[w],delete A[w],v[w]=z,F[g]=z;else{if(v.hasOwnProperty(w))throw r(F,function(a){a&&a.scope&&(A[a.id]=a)}),d("dupes",h,w);F[g]={id:w};v[w]=!1}for(G in A)A.hasOwnProperty(G)&&
(z=A[G],g=Eb(z.clone),c.leave(g),r(g,function(a){a.$$NG_REMOVED=!0}),z.scope.$destroy());g=0;for(k=C.length;g<k;g++){G=a===C?g:C[g];w=a[G];z=F[g];F[g-1]&&(l=F[g-1].clone[F[g-1].clone.length-1]);if(z.scope){B=z.scope;n=l;do n=n.nextSibling;while(n&&n.$$NG_REMOVED);z.clone[0]!=n&&c.move(Eb(z.clone),null,y(l));l=z.clone[z.clone.length-1]}else B=e.$new();B[s]=w;x&&(B[x]=G);B.$index=g;B.$first=0===g;B.$last=g===D-1;B.$middle=!(B.$first||B.$last);B.$odd=!(B.$even=0===(g&1));z.scope||m(B,function(a){a[a.length++]=
X.createComment(" end ngRepeat: "+h+" ");c.enter(a,null,y(l));l=a;z.scope=B;z.clone=a;v[z.id]=z})}A=v})}}}],zd=["$animate",function(a){return function(c,d,e){c.$watch(e.ngShow,function(c){a[Ta(c)?"removeClass":"addClass"](d,"ng-hide")})}}],sd=["$animate",function(a){return function(c,d,e){c.$watch(e.ngHide,function(c){a[Ta(c)?"addClass":"removeClass"](d,"ng-hide")})}}],Ad=xa(function(a,c,d){a.$watch(d.ngStyle,function(a,d){d&&a!==d&&r(d,function(a,d){c.css(d,"")});a&&c.css(a)},!0)}),Bd=["$animate",
function(a){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(c,d,e,f){var g=[],k=[],m=[],h=[];c.$watch(e.ngSwitch||e.on,function(d){var n,p;n=0;for(p=m.length;n<p;++n)m[n].remove();n=m.length=0;for(p=h.length;n<p;++n){var q=k[n];h[n].$destroy();m[n]=q;a.leave(q,function(){m.splice(n,1)})}k.length=0;h.length=0;if(g=f.cases["!"+d]||f.cases["?"])c.$eval(e.change),r(g,function(d){var e=c.$new();h.push(e);d.transclude(e,function(c){var e=d.element;k.push(c);
a.enter(c,e.parent(),e)})})})}}}],Cd=xa({transclude:"element",priority:800,require:"^ngSwitch",link:function(a,c,d,e,f){e.cases["!"+d.ngSwitchWhen]=e.cases["!"+d.ngSwitchWhen]||[];e.cases["!"+d.ngSwitchWhen].push({transclude:f,element:c})}}),Dd=xa({transclude:"element",priority:800,require:"^ngSwitch",link:function(a,c,d,e,f){e.cases["?"]=e.cases["?"]||[];e.cases["?"].push({transclude:f,element:c})}}),Fd=xa({link:function(a,c,d,e,f){if(!f)throw w("ngTransclude")("orphan",ha(c));f(function(a){c.empty();
c.append(a)})}}),fd=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(c,d){"text/ng-template"==d.type&&a.put(d.id,c[0].text)}}}],We=w("ngOptions"),Ed=$({terminal:!0}),gd=["$compile","$parse",function(a,c){var d=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,e={$setViewValue:z};return{restrict:"E",require:["select","?ngModel"],
controller:["$element","$scope","$attrs",function(a,c,d){var m=this,h={},l=e,n;m.databound=d.ngModel;m.init=function(a,c,d){l=a;n=d};m.addOption=function(c){Ca(c,'"option value"');h[c]=!0;l.$viewValue==c&&(a.val(c),n.parent()&&n.remove())};m.removeOption=function(a){this.hasOption(a)&&(delete h[a],l.$viewValue==a&&this.renderUnknownOption(a))};m.renderUnknownOption=function(c){c="? "+Ka(c)+" ?";n.val(c);a.prepend(n);a.val(c);n.prop("selected",!0)};m.hasOption=function(a){return h.hasOwnProperty(a)};
c.$on("$destroy",function(){m.renderUnknownOption=z})}],link:function(e,g,k,m){function h(a,c,d,e){d.$render=function(){var a=d.$viewValue;e.hasOption(a)?(z.parent()&&z.remove(),c.val(a),""===a&&x.prop("selected",!0)):F(a)&&x?c.val(""):e.renderUnknownOption(a)};c.on("change",function(){a.$apply(function(){z.parent()&&z.remove();d.$setViewValue(c.val())})})}function l(a,c,d){var e;d.$render=function(){var a=new ab(d.$viewValue);r(c.find("option"),function(c){c.selected=D(a.get(c.value))})};a.$watch(function(){za(e,
d.$viewValue)||(e=ga(d.$viewValue),d.$render())});c.on("change",function(){a.$apply(function(){var a=[];r(c.find("option"),function(c){c.selected&&a.push(c.value)});d.$setViewValue(a)})})}function n(e,f,g){function k(){var a={"":[]},c=[""],d,h,s,t,u;s=g.$modelValue;t=z(e)||[];var C=n?Zb(t):t,F,O,B;O={};B=!1;if(q)if(h=g.$modelValue,x&&L(h))for(B=new ab([]),d={},u=0;u<h.length;u++)d[m]=h[u],B.put(x(e,d),h[u]);else B=new ab(h);u=B;var E,J;for(B=0;F=C.length,B<F;B++){h=B;if(n){h=C[B];if("$"===h.charAt(0))continue;
O[n]=h}O[m]=t[h];d=p(e,O)||"";(h=a[d])||(h=a[d]=[],c.push(d));q?d=D(u.remove(x?x(e,O):r(e,O))):(x?(d={},d[m]=s,d=x(e,d)===x(e,O)):d=s===r(e,O),u=u||d);E=l(e,O);E=D(E)?E:"";h.push({id:x?x(e,O):n?C[B]:B,label:E,selected:d})}q||(w||null===s?a[""].unshift({id:"",label:"",selected:!u}):u||a[""].unshift({id:"?",label:"",selected:!0}));O=0;for(C=c.length;O<C;O++){d=c[O];h=a[d];y.length<=O?(s={element:A.clone().attr("label",d),label:h.label},t=[s],y.push(t),f.append(s.element)):(t=y[O],s=t[0],s.label!=d&&
s.element.attr("label",s.label=d));E=null;B=0;for(F=h.length;B<F;B++)d=h[B],(u=t[B+1])?(E=u.element,u.label!==d.label&&E.text(u.label=d.label),u.id!==d.id&&E.val(u.id=d.id),E[0].selected!==d.selected&&(E.prop("selected",u.selected=d.selected),Q&&E.prop("selected",u.selected))):(""===d.id&&w?J=w:(J=v.clone()).val(d.id).prop("selected",d.selected).attr("selected",d.selected).text(d.label),t.push({element:J,label:d.label,id:d.id,selected:d.selected}),E?E.after(J):s.element.append(J),E=J);for(B++;t.length>
B;)t.pop().element.remove()}for(;y.length>O;)y.pop()[0].element.remove()}var h;if(!(h=t.match(d)))throw We("iexp",t,ha(f));var l=c(h[2]||h[1]),m=h[4]||h[6],n=h[5],p=c(h[3]||""),r=c(h[2]?h[1]:m),z=c(h[7]),x=h[8]?c(h[8]):null,y=[[{element:f,label:""}]];w&&(a(w)(e),w.removeClass("ng-scope"),w.remove());f.empty();f.on("change",function(){e.$apply(function(){var a,c=z(e)||[],d={},h,l,p,t,u,w,v;if(q)for(l=[],t=0,w=y.length;t<w;t++)for(a=y[t],p=1,u=a.length;p<u;p++){if((h=a[p].element)[0].selected){h=h.val();
n&&(d[n]=h);if(x)for(v=0;v<c.length&&(d[m]=c[v],x(e,d)!=h);v++);else d[m]=c[h];l.push(r(e,d))}}else if(h=f.val(),"?"==h)l=s;else if(""===h)l=null;else if(x)for(v=0;v<c.length;v++){if(d[m]=c[v],x(e,d)==h){l=r(e,d);break}}else d[m]=c[h],n&&(d[n]=h),l=r(e,d);g.$setViewValue(l);k()})});g.$render=k;e.$watchCollection(z,k);q&&e.$watchCollection(function(){return g.$modelValue},k)}if(m[1]){var p=m[0];m=m[1];var q=k.multiple,t=k.ngOptions,w=!1,x,v=y(X.createElement("option")),A=y(X.createElement("optgroup")),
z=v.clone();k=0;for(var u=g.children(),C=u.length;k<C;k++)if(""===u[k].value){x=w=u.eq(k);break}p.init(m,w,z);q&&(m.$isEmpty=function(a){return!a||0===a.length});t?n(e,g,m):q?l(e,g,m):h(e,g,m,p)}}}}],id=["$interpolate",function(a){var c={addOption:z,removeOption:z};return{restrict:"E",priority:100,compile:function(d,e){if(F(e.value)){var f=a(d.text(),!0);f||e.$set("value",d.text())}return function(a,d,e){var h=d.parent(),l=h.data("$selectController")||h.parent().data("$selectController");l&&l.databound?
d.prop("selected",!1):l=c;f?a.$watch(f,function(a,c){e.$set("value",a);a!==c&&l.removeOption(c);l.addOption(a)}):l.addOption(e.value);d.on("$destroy",function(){l.removeOption(e.value)})}}}}],hd=$({restrict:"E",terminal:!0});P.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):((Da=P.jQuery)&&Da.fn.on?(y=Da,E(Da.fn,{scope:La.scope,isolateScope:La.isolateScope,controller:La.controller,injector:La.injector,inheritedData:La.inheritedData}),Gb("remove",!0,!0,!1),Gb("empty",
!1,!1,!1),Gb("html",!1,!1,!0)):y=S,Ua.element=y,$c(Ua),y(X).ready(function(){Xc(X,fc)}))})(window,document);!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}.ng-hide-add-active,.ng-hide-remove{display:block!important;}</style>');
;
;
/*! angular-route.min.js */ 
;
;
/*
AngularJS v1.2.22
(c) 2010-2014 Google, Inc. http://angularjs.org
License: MIT
*/
(function(n,e,A){'use strict';function x(s,g,h){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,c,b,f,w){function y(){p&&(p.remove(),p=null);k&&(k.$destroy(),k=null);l&&(h.leave(l,function(){p=null}),p=l,l=null)}function v(){var b=s.current&&s.current.locals;if(e.isDefined(b&&b.$template)){var b=a.$new(),d=s.current;l=w(b,function(d){h.enter(d,null,l||c,function(){!e.isDefined(t)||t&&!a.$eval(t)||g()});y()});k=d.scope=b;k.$emit("$viewContentLoaded");k.$eval(u)}else y()}
var k,l,p,t=b.autoscroll,u=b.onload||"";a.$on("$routeChangeSuccess",v);v()}}}function z(e,g,h){return{restrict:"ECA",priority:-400,link:function(a,c){var b=h.current,f=b.locals;c.html(f.$template);var w=e(c.contents());b.controller&&(f.$scope=a,f=g(b.controller,f),b.controllerAs&&(a[b.controllerAs]=f),c.data("$ngControllerController",f),c.children().data("$ngControllerController",f));w(a)}}}n=e.module("ngRoute",["ng"]).provider("$route",function(){function s(a,c){return e.extend(new (e.extend(function(){},
{prototype:a})),c)}function g(a,e){var b=e.caseInsensitiveMatch,f={originalPath:a,regexp:a},h=f.keys=[];a=a.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?\*])?/g,function(a,e,b,c){a="?"===c?c:null;c="*"===c?c:null;h.push({name:b,optional:!!a});e=e||"";return""+(a?"":e)+"(?:"+(a?e:"")+(c&&"(.+?)"||"([^/]+)")+(a||"")+")"+(a||"")}).replace(/([\/$\*])/g,"\\$1");f.regexp=RegExp("^"+a+"$",b?"i":"");return f}var h={};this.when=function(a,c){h[a]=e.extend({reloadOnSearch:!0},c,a&&g(a,c));if(a){var b=
"/"==a[a.length-1]?a.substr(0,a.length-1):a+"/";h[b]=e.extend({redirectTo:a},g(b,c))}return this};this.otherwise=function(a){this.when(null,a);return this};this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(a,c,b,f,g,n,v,k){function l(){var d=p(),m=r.current;if(d&&m&&d.$$route===m.$$route&&e.equals(d.pathParams,m.pathParams)&&!d.reloadOnSearch&&!u)m.params=d.params,e.copy(m.params,b),a.$broadcast("$routeUpdate",m);else if(d||m)u=!1,a.$broadcast("$routeChangeStart",
d,m),(r.current=d)&&d.redirectTo&&(e.isString(d.redirectTo)?c.path(t(d.redirectTo,d.params)).search(d.params).replace():c.url(d.redirectTo(d.pathParams,c.path(),c.search())).replace()),f.when(d).then(function(){if(d){var a=e.extend({},d.resolve),c,b;e.forEach(a,function(d,c){a[c]=e.isString(d)?g.get(d):g.invoke(d)});e.isDefined(c=d.template)?e.isFunction(c)&&(c=c(d.params)):e.isDefined(b=d.templateUrl)&&(e.isFunction(b)&&(b=b(d.params)),b=k.getTrustedResourceUrl(b),e.isDefined(b)&&(d.loadedTemplateUrl=
b,c=n.get(b,{cache:v}).then(function(a){return a.data})));e.isDefined(c)&&(a.$template=c);return f.all(a)}}).then(function(c){d==r.current&&(d&&(d.locals=c,e.copy(d.params,b)),a.$broadcast("$routeChangeSuccess",d,m))},function(c){d==r.current&&a.$broadcast("$routeChangeError",d,m,c)})}function p(){var a,b;e.forEach(h,function(f,h){var q;if(q=!b){var g=c.path();q=f.keys;var l={};if(f.regexp)if(g=f.regexp.exec(g)){for(var k=1,p=g.length;k<p;++k){var n=q[k-1],r=g[k];n&&r&&(l[n.name]=r)}q=l}else q=null;
else q=null;q=a=q}q&&(b=s(f,{params:e.extend({},c.search(),a),pathParams:a}),b.$$route=f)});return b||h[null]&&s(h[null],{params:{},pathParams:{}})}function t(a,c){var b=[];e.forEach((a||"").split(":"),function(a,d){if(0===d)b.push(a);else{var e=a.match(/(\w+)(.*)/),f=e[1];b.push(c[f]);b.push(e[2]||"");delete c[f]}});return b.join("")}var u=!1,r={routes:h,reload:function(){u=!0;a.$evalAsync(l)}};a.$on("$locationChangeSuccess",l);return r}]});n.provider("$routeParams",function(){this.$get=function(){return{}}});
n.directive("ngView",x);n.directive("ngView",z);x.$inject=["$route","$anchorScroll","$animate"];z.$inject=["$compile","$controller","$route"]})(window,window.angular);
;
;
/*! angular-resource.min.js */ 
;
;
/*
AngularJS v1.2.22
(c) 2010-2014 Google, Inc. http://angularjs.org
License: MIT
*/
(function(H,a,A){'use strict';
function monkeyPatchFromBen( errorType, httpConfig ) {
try {
return( errorType + "(monkey-patch:" + httpConfig.url + ")" );
} catch ( error ) {
return( errorType );
}
}
function D(p,g){g=g||{};a.forEach(g,function(a,c){delete g[c]});for(var c in p)!p.hasOwnProperty(c)||"$"===c.charAt(0)&&"$"===c.charAt(1)||(g[c]=p[c]);return g}var v=a.$$minErr("$resource"),C=/^(\.[a-zA-Z_$][0-9a-zA-Z_$]*)+$/;a.module("ngResource",["ng"]).factory("$resource",["$http","$q",function(p,g){function c(a,c){this.template=a;this.defaults=c||{};this.urlParams={}}function t(n,w,l){function r(h,d){var e={};d=x({},w,d);s(d,function(b,d){u(b)&&(b=b());var k;if(b&&
b.charAt&&"@"==b.charAt(0)){k=h;var a=b.substr(1);if(null==a||""===a||"hasOwnProperty"===a||!C.test("."+a))throw v("badmember",a);for(var a=a.split("."),f=0,c=a.length;f<c&&k!==A;f++){var g=a[f];k=null!==k?k[g]:A}}else k=b;e[d]=k});return e}function e(a){return a.resource}function f(a){D(a||{},this)}var F=new c(n);l=x({},B,l);s(l,function(h,d){var c=/^(POST|PUT|PATCH)$/i.test(h.method);f[d]=function(b,d,k,w){var q={},n,l,y;switch(arguments.length){case 4:y=w,l=k;case 3:case 2:if(u(d)){if(u(b)){l=
b;y=d;break}l=d;y=k}else{q=b;n=d;l=k;break}case 1:u(b)?l=b:c?n=b:q=b;break;case 0:break;default:throw v("badargs",arguments.length);}var t=this instanceof f,m=t?n:h.isArray?[]:new f(n),z={},B=h.interceptor&&h.interceptor.response||e,C=h.interceptor&&h.interceptor.responseError||A;s(h,function(a,b){"params"!=b&&("isArray"!=b&&"interceptor"!=b)&&(z[b]=G(a))});c&&(z.data=n);F.setUrlParams(z,x({},r(n,h.params||{}),q),h.url);q=p(z).then(function(b){var d=b.data,k=m.$promise;if(d){if(a.isArray(d)!==!!h.isArray)throw v(monkeyPatchFromBen("badcfg",z),
h.isArray?"array":"object",a.isArray(d)?"array":"object");h.isArray?(m.length=0,s(d,function(b){"object"===typeof b?m.push(new f(b)):m.push(b)})):(D(d,m),m.$promise=k)}m.$resolved=!0;b.resource=m;return b},function(b){m.$resolved=!0;(y||E)(b);return g.reject(b)});q=q.then(function(b){var a=B(b);(l||E)(a,b.headers);return a},C);return t?q:(m.$promise=q,m.$resolved=!1,m)};f.prototype["$"+d]=function(b,a,k){u(b)&&(k=a,a=b,b={});b=f[d].call(this,b,this,a,k);return b.$promise||b}});f.bind=function(a){return t(n,
x({},w,a),l)};return f}var B={get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}},E=a.noop,s=a.forEach,x=a.extend,G=a.copy,u=a.isFunction;c.prototype={setUrlParams:function(c,g,l){var r=this,e=l||r.template,f,p,h=r.urlParams={};s(e.split(/\W/),function(a){if("hasOwnProperty"===a)throw v("badname");!/^\d+$/.test(a)&&(a&&RegExp("(^|[^\\\\]):"+a+"(\\W|$)").test(e))&&(h[a]=!0)});e=e.replace(/\\:/g,":");g=g||{};s(r.urlParams,function(d,
c){f=g.hasOwnProperty(c)?g[c]:r.defaults[c];a.isDefined(f)&&null!==f?(p=encodeURIComponent(f).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"%20").replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+"),e=e.replace(RegExp(":"+c+"(\\W|$)","g"),function(a,c){return p+c})):e=e.replace(RegExp("(/?):"+c+"(\\W|$)","g"),function(a,c,d){return"/"==d.charAt(0)?d:c+d})});e=e.replace(/\/+$/,"")||"/";e=e.replace(/\/\.(?=\w+($|\?))/,".");c.url=e.replace(/\/\\\./,
"/.");s(g,function(a,e){r.urlParams[e]||(c.params=c.params||{},c.params[e]=a)})}};return t}])})(window,window.angular);
;
;
/*! angular-sanitize.min.js */ 
;
;
/*
AngularJS v1.2.22
(c) 2010-2014 Google, Inc. http://angularjs.org
License: MIT
*/
(function(q,g,r){'use strict';function F(a){var d=[];t(d,g.noop).chars(a);return d.join("")}function m(a){var d={};a=a.split(",");var c;for(c=0;c<a.length;c++)d[a[c]]=!0;return d}function G(a,d){function c(a,b,c,h){b=g.lowercase(b);if(u[b])for(;f.last()&&v[f.last()];)e("",f.last());w[b]&&f.last()==b&&e("",b);(h=x[b]||!!h)||f.push(b);var n={};c.replace(H,function(a,b,d,c,e){n[b]=s(d||c||e||"")});d.start&&d.start(b,n,h)}function e(a,b){var c=0,e;if(b=g.lowercase(b))for(c=f.length-1;0<=c&&f[c]!=b;c--);
if(0<=c){for(e=f.length-1;e>=c;e--)d.end&&d.end(f[e]);f.length=c}}"string"!==typeof a&&(a=null===a||"undefined"===typeof a?"":""+a);var b,l,f=[],n=a,h;for(f.last=function(){return f[f.length-1]};a;){h="";l=!0;if(f.last()&&y[f.last()])a=a.replace(RegExp("(.*)<\\s*\\/\\s*"+f.last()+"[^>]*>","i"),function(a,b){b=b.replace(I,"$1").replace(J,"$1");d.chars&&d.chars(s(b));return""}),e("",f.last());else{if(0===a.indexOf("\x3c!--"))b=a.indexOf("--",4),0<=b&&a.lastIndexOf("--\x3e",b)===b&&(d.comment&&d.comment(a.substring(4,
b)),a=a.substring(b+3),l=!1);else if(z.test(a)){if(b=a.match(z))a=a.replace(b[0],""),l=!1}else if(K.test(a)){if(b=a.match(A))a=a.substring(b[0].length),b[0].replace(A,e),l=!1}else L.test(a)&&((b=a.match(B))?(b[4]&&(a=a.substring(b[0].length),b[0].replace(B,c)),l=!1):(h+="<",a=a.substring(1)));l&&(b=a.indexOf("<"),h+=0>b?a:a.substring(0,b),a=0>b?"":a.substring(b),d.chars&&d.chars(s(h)))}if(a==n)throw M("badparse",a);n=a}e()}function s(a){if(!a)return"";var d=N.exec(a);a=d[1];var c=d[3];if(d=d[2])p.innerHTML=
d.replace(/</g,"&lt;"),d="textContent"in p?p.textContent:p.innerText;return a+d+c}function C(a){return a.replace(/&/g,"&amp;").replace(O,function(a){var c=a.charCodeAt(0);a=a.charCodeAt(1);return"&#"+(1024*(c-55296)+(a-56320)+65536)+";"}).replace(P,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function t(a,d){var c=!1,e=g.bind(a,a.push);return{start:function(a,l,f){a=g.lowercase(a);!c&&y[a]&&(c=a);c||!0!==D[a]||(e("<"),e(a),g.forEach(l,function(c,f){var k=
g.lowercase(f),l="img"===a&&"src"===k||"background"===k;!0!==Q[k]||!0===E[k]&&!d(c,l)||(e(" "),e(f),e('="'),e(C(c)),e('"'))}),e(f?"/>":">"))},end:function(a){a=g.lowercase(a);c||!0!==D[a]||(e("</"),e(a),e(">"));a==c&&(c=!1)},chars:function(a){c||e(C(a))}}}var M=g.$$minErr("$sanitize"),B=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,A=/^<\/\s*([\w:-]+)[^>]*>/,H=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,L=/^</,
K=/^<\//,I=/\x3c!--(.*?)--\x3e/g,z=/<!DOCTYPE([^>]*?)>/i,J=/<!\[CDATA\[(.*?)]]\x3e/g,O=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,P=/([^\#-~| |!])/g,x=m("area,br,col,hr,img,wbr");q=m("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr");r=m("rp,rt");var w=g.extend({},r,q),u=g.extend({},q,m("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),v=g.extend({},r,m("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),
y=m("script,style"),D=g.extend({},x,u,v,w),E=m("background,cite,href,longdesc,src,usemap"),Q=g.extend({},E,m("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),p=document.createElement("pre"),N=/^(\s*)([\s\S]*?)(\s*)$/;g.module("ngSanitize",[]).provider("$sanitize",
function(){this.$get=["$$sanitizeUri",function(a){return function(d){var c=[];G(d,t(c,function(c,b){return!/^unsafe/.test(a(c,b))}));return c.join("")}}]});g.module("ngSanitize").filter("linky",["$sanitize",function(a){var d=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,c=/^mailto:/;return function(e,b){function l(a){a&&k.push(F(a))}function f(a,c){k.push("<a ");g.isDefined(b)&&(k.push('target="'),k.push(b),k.push('" '));k.push('href="');k.push(a);k.push('">');l(c);k.push("</a>")}
if(!e)return e;for(var n,h=e,k=[],m,p;n=h.match(d);)m=n[0],n[2]==n[3]&&(m="mailto:"+m),p=n.index,l(h.substr(0,p)),f(m,n[0].replace(c,"")),h=h.substring(p+n[0].length);l(h);return a(k.join(""))}}])})(window,window.angular);
;
;
/*! angular-ui.min.js */ 
;
;
/**
* AngularUI - The companion suite for AngularJS
* @version v0.4.0 - 2013-02-15
* @link http://angular-ui.github.com
* @license MIT License, http://www.opensource.org/licenses/MIT
*/
angular.module("ui.config",[]).value("ui.config",{}),angular.module("ui.filters",["ui.config"]),angular.module("ui.directives",["ui.config"]),angular.module("ui",["ui.filters","ui.directives","ui.config"]),angular.module("ui.directives").directive("uiAnimate",["ui.config","$timeout",function(e,t){var n={};return angular.isString(e.animate)?n["class"]=e.animate:e.animate&&(n=e.animate),{restrict:"A",link:function(e,r,i){var s={};i.uiAnimate&&(s=e.$eval(i.uiAnimate),angular.isString(s)&&(s={"class":s})),s=angular.extend({"class":"ui-animate"},n,s),r.addClass(s["class"]),t(function(){r.removeClass(s["class"])},20,!1)}}}]),angular.module("ui.directives").directive("uiCalendar",["ui.config","$parse",function(e,t){return e.uiCalendar=e.uiCalendar||{},{require:"ngModel",restrict:"A",link:function(t,n,r,i){function a(){t.calendar=n.html("");var i=t.calendar.fullCalendar("getView");i&&(i=i.name);var o,u={defaultView:i,eventSources:s};r.uiCalendar?o=t.$eval(r.uiCalendar):o={},angular.extend(u,e.uiCalendar,o),t.calendar.fullCalendar(u)}var s=t.$eval(r.ngModel),o=0,u=function(){var e=t.$eval(r.equalsTracker);return o=0,angular.forEach(s,function(e,t){angular.isArray(e)&&(o+=e.length)}),angular.isNumber(e)?o+s.length+e:o+s.length};a(),t.$watch(u,function(e,t){a()})}}}]),angular.module("ui.directives").directive("uiCodemirror",["ui.config","$timeout",function(e,t){"use strict";var n=["cursorActivity","viewportChange","gutterClick","focus","blur","scroll","update"];return{restrict:"A",require:"ngModel",link:function(r,i,s,o){var u,a,f,l,c;if(i[0].type!=="textarea")throw new Error("uiCodemirror3 can only be applied to a textarea element");u=e.codemirror||{},a=angular.extend({},u,r.$eval(s.uiCodemirror)),f=function(e){return function(t,n){var i=t.getValue();i!==o.$viewValue&&(o.$setViewValue(i),r.$apply()),typeof e=="function"&&e(t,n)}},l=function(){c=CodeMirror.fromTextArea(i[0],a),c.on("change",f(a.onChange));for(var e=0,u=n.length,l;e<u;++e){l=a["on"+n[e].charAt(0).toUpperCase()+n[e].slice(1)];if(l===void 0)continue;if(typeof l!="function")continue;c.on(n[e],l)}o.$formatters.push(function(e){if(angular.isUndefined(e)||e===null)return"";if(angular.isObject(e)||angular.isArray(e))throw new Error("ui-codemirror cannot use an object or an array as a model");return e}),o.$render=function(){c.setValue(o.$viewValue)},s.uiRefresh&&r.$watch(s.uiRefresh,function(e,n){e!==n&&t(c.refresh)})},t(l)}}}]),angular.module("ui.directives").directive("uiCurrency",["ui.config","currencyFilter",function(e,t){var n={pos:"ui-currency-pos",neg:"ui-currency-neg",zero:"ui-currency-zero"};return e.currency&&angular.extend(n,e.currency),{restrict:"EAC",require:"ngModel",link:function(e,r,i,s){var o,u,a;o=angular.extend({},n,e.$eval(i.uiCurrency)),u=function(e){var n;return n=e*1,r.toggleClass(o.pos,n>0),r.toggleClass(o.neg,n<0),r.toggleClass(o.zero,n===0),e===""?r.text(""):r.text(t(n,o.symbol)),!0},s.$render=function(){a=s.$viewValue,r.val(a),u(a)}}}}]),angular.module("ui.directives").directive("uiDate",["ui.config",function(e){"use strict";var t;return t={},angular.isObject(e.date)&&angular.extend(t,e.date),{require:"?ngModel",link:function(t,n,r,i){var s=function(){return angular.extend({},e.date,t.$eval(r.uiDate))},o=function(){var e=s();if(i){var r=function(){t.$apply(function(){var e=n.datepicker("getDate");n.datepicker("setDate",n.val()),i.$setViewValue(e),n.blur()})};if(e.onSelect){var o=e.onSelect;e.onSelect=function(e,n){r(),t.$apply(function(){o(e,n)})}}else e.onSelect=r;n.bind("change",r),i.$render=function(){var e=i.$viewValue;if(angular.isDefined(e)&&e!==null&&!angular.isDate(e))throw new Error("ng-Model value must be a Date object - currently it is a "+typeof e+" - use ui-date-format to convert it from a string");n.datepicker("setDate",e)}}n.datepicker("destroy"),n.datepicker(e),i&&i.$render()};t.$watch(s,o,!0)}}}]).directive("uiDateFormat",["ui.config",function(e){var t={require:"ngModel",link:function(t,n,r,i){var s=r.uiDateFormat||e.dateFormat;s?(i.$formatters.push(function(e){if(angular.isString(e))return $.datepicker.parseDate(s,e)}),i.$parsers.push(function(e){if(e)return $.datepicker.formatDate(s,e)})):(i.$formatters.push(function(e){if(angular.isString(e))return new Date(e)}),i.$parsers.push(function(e){if(e)return e.toISOString()}))}};return t}]),angular.module("ui.directives").directive("uiEvent",["$parse",function(e){return function(t,n,r){var i=t.$eval(r.uiEvent);angular.forEach(i,function(r,i){var s=e(r);n.bind(i,function(e){var n=Array.prototype.slice.call(arguments);n=n.splice(1),t.$apply(function(){s(t,{$event:e,$params:n})})})})}}]),angular.module("ui.directives").directive("uiIf",[function(){return{transclude:"element",priority:1e3,terminal:!0,restrict:"A",compile:function(e,t,n){return function(e,t,r){var i,s;e.$watch(r.uiIf,function(r){i&&(i.remove(),i=undefined),s&&(s.$destroy(),s=undefined),r&&(s=e.$new(),n(s,function(e){i=e,t.after(e)}))})}}}}]),angular.module("ui.directives").directive("uiJq",["ui.config","$timeout",function(t,n){return{restrict:"A",compile:function(r,i){if(!angular.isFunction(r[i.uiJq]))throw new Error('ui-jq: The "'+i.uiJq+'" function does not exist');var s=t.jq&&t.jq[i.uiJq];return function(t,r,i){function u(){n(function(){r[i.uiJq].apply(r,o)},0,!1)}var o=[];i.uiOptions?(o=t.$eval("["+i.uiOptions+"]"),angular.isObject(s)&&angular.isObject(o[0])&&(o[0]=angular.extend({},s,o[0]))):s&&(o=[s]),i.ngModel&&r.is("select,input,textarea")&&r.on("change",function(){r.trigger("input")}),i.uiRefresh&&t.$watch(i.uiRefresh,function(e){u()}),u()}}}}]),angular.module("ui.directives").factory("keypressHelper",["$parse",function(t){var n={8:"backspace",9:"tab",13:"enter",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete"},r=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};return function(e,i,s,o){var u,a=[];u=i.$eval(o["ui"+r(e)]),angular.forEach(u,function(e,n){var r,i;i=t(e),angular.forEach(n.split(" "),function(e){r={expression:i,keys:{}},angular.forEach(e.split("-"),function(e){r.keys[e]=!0}),a.push(r)})}),s.bind(e,function(t){var r=t.metaKey||t.altKey,s=t.ctrlKey,o=t.shiftKey,u=t.keyCode;e==="keypress"&&!o&&u>=97&&u<=122&&(u-=32),angular.forEach(a,function(e){var u=e.keys[n[t.keyCode]]||e.keys[t.keyCode.toString()]||!1,a=e.keys.alt||!1,f=e.keys.ctrl||!1,l=e.keys.shift||!1;u&&a==r&&f==s&&l==o&&i.$apply(function(){e.expression(i,{$event:t})})})})}}]),angular.module("ui.directives").directive("uiKeydown",["keypressHelper",function(e){return{link:function(t,n,r){e("keydown",t,n,r)}}}]),angular.module("ui.directives").directive("uiKeypress",["keypressHelper",function(e){return{link:function(t,n,r){e("keypress",t,n,r)}}}]),angular.module("ui.directives").directive("uiKeyup",["keypressHelper",function(e){return{link:function(t,n,r){e("keyup",t,n,r)}}}]),function(){function t(e,t,n,r){angular.forEach(t.split(" "),function(t){var i={type:"map-"+t};google.maps.event.addListener(n,t,function(t){r.triggerHandler(angular.extend({},i,t)),e.$$phase||e.$apply()})})}function n(n,r){e.directive(n,[function(){return{restrict:"A",link:function(e,i,s){e.$watch(s[n],function(n){t(e,r,n,i)})}}}])}var e=angular.module("ui.directives");e.directive("uiMap",["ui.config","$parse",function(e,n){var r="bounds_changed center_changed click dblclick drag dragend dragstart heading_changed idle maptypeid_changed mousemove mouseout mouseover projection_changed resize rightclick tilesloaded tilt_changed zoom_changed",i=e.map||{};return{restrict:"A",link:function(e,s,o){var u=angular.extend({},i,e.$eval(o.uiOptions)),a=new google.maps.Map(s[0],u),f=n(o.uiMap);f.assign(e,a),t(e,r,a,s)}}}]),e.directive("uiMapInfoWindow",["ui.config","$parse","$compile",function(e,n,r){var i="closeclick content_change domready position_changed zindex_changed",s=e.mapInfoWindow||{};return{link:function(e,o,u){var a=angular.extend({},s,e.$eval(u.uiOptions));a.content=o[0];var f=n(u.uiMapInfoWindow),l=f(e);l||(l=new google.maps.InfoWindow(a),f.assign(e,l)),t(e,i,l,o),o.replaceWith("<div></div>");var c=l.open;l.open=function(n,i,s,u,a,f){r(o.contents())(e),c.call(l,n,i,s,u,a,f)}}}}]),n("uiMapMarker","animation_changed click clickable_changed cursor_changed dblclick drag dragend draggable_changed dragstart flat_changed icon_changed mousedown mouseout mouseover mouseup position_changed rightclick shadow_changed shape_changed title_changed visible_changed zindex_changed"),n("uiMapPolyline","click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),n("uiMapPolygon","click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),n("uiMapRectangle","bounds_changed click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),n("uiMapCircle","center_changed click dblclick mousedown mousemove mouseout mouseover mouseup radius_changed rightclick"),n("uiMapGroundOverlay","click dblclick")}(),angular.module("ui.directives").directive("uiMask",[function(){return{require:"ngModel",link:function(e,t,n,r){r.$render=function(){var i=r.$viewValue||"";t.val(i),t.mask(e.$eval(n.uiMask))},r.$parsers.push(function(e){var n=t.isMaskValid()||angular.isUndefined(t.isMaskValid())&&t.val().length>0;return r.$setValidity("mask",n),n?e:undefined}),t.bind("keyup",function(){e.$apply(function(){r.$setViewValue(t.mask())})})}}}]),angular.module("ui.directives").directive("uiReset",["ui.config",function(e){var t=null;return e.reset!==undefined&&(t=e.reset),{require:"ngModel",link:function(e,n,r,i){var s;s=angular.element('<a class="ui-reset" />'),n.wrap('<span class="ui-resetwrap" />').after(s),s.bind("click",function(n){n.preventDefault(),e.$apply(function(){r.uiReset?i.$setViewValue(e.$eval(r.uiReset)):i.$setViewValue(t),i.$render()})})}}}]),angular.module("ui.directives").directive("uiRoute",["$location","$parse",function(e,t){return{restrict:"AC",compile:function(n,r){var i;if(r.uiRoute)i="uiRoute";else if(r.ngHref)i="ngHref";else{if(!r.href)throw new Error("uiRoute missing a route or href property on "+n[0]);i="href"}return function(n,r,s){function a(t){(hash=t.indexOf("#"))>-1&&(t=t.substr(hash+1)),u=function(){o(n,e.path().indexOf(t)>-1)},u()}function f(t){(hash=t.indexOf("#"))>-1&&(t=t.substr(hash+1)),u=function(){var i=new RegExp("^"+t+"$",["i"]);o(n,i.test(e.path()))},u()}var o=t(s.ngModel||s.routeModel||"$uiRoute").assign,u=angular.noop;switch(i){case"uiRoute":s.uiRoute?f(s.uiRoute):s.$observe("uiRoute",f);break;case"ngHref":s.ngHref?a(s.ngHref):s.$observe("ngHref",a);break;case"href":a(s.href)}n.$on("$routeChangeSuccess",function(){u()})}}}}]),angular.module("ui.directives").directive("uiScrollfix",["$window",function(e){"use strict";return{link:function(t,n,r){var i=n.offset().top;r.uiScrollfix?r.uiScrollfix.charAt(0)==="-"?r.uiScrollfix=i-r.uiScrollfix.substr(1):r.uiScrollfix.charAt(0)==="+"&&(r.uiScrollfix=i+parseFloat(r.uiScrollfix.substr(1))):r.uiScrollfix=i,angular.element(e).on("scroll.ui-scrollfix",function(){var t;if(angular.isDefined(e.pageYOffset))t=e.pageYOffset;else{var i=document.compatMode&&document.compatMode!=="BackCompat"?document.documentElement:document.body;t=i.scrollTop}!n.hasClass("ui-scrollfix")&&t>r.uiScrollfix?n.addClass("ui-scrollfix"):n.hasClass("ui-scrollfix")&&t<r.uiScrollfix&&n.removeClass("ui-scrollfix")})}}}]),angular.module("ui.directives").directive("uiSelect2",["ui.config","$timeout",function(e,t){var n={};return e.select2&&angular.extend(n,e.select2),{require:"?ngModel",compile:function(e,r){var i,s,o,u=e.is("select"),a=r.multiple!==undefined;return e.is("select")&&(s=e.find("option[ng-repeat], option[data-ng-repeat]"),s.length&&(o=s.attr("ng-repeat")||s.attr("data-ng-repeat"),i=jQuery.trim(o.split("|")[0]).split(" ").pop())),function(e,r,s,o){var f=angular.extend({},n,e.$eval(s.uiSelect2));u?(delete f.multiple,delete f.initSelection):a&&(f.multiple=!0);if(o){o.$render=function(){u?r.select2("val",o.$modelValue):a?o.$modelValue?angular.isArray(o.$modelValue)?r.select2("data",o.$modelValue):r.select2("val",o.$modelValue):r.select2("data",[]):angular.isObject(o.$modelValue)?r.select2("data",o.$modelValue):r.select2("val",o.$modelValue)},i&&e.$watch(i,function(e,n,i){if(!e)return;t(function(){r.select2("val",o.$viewValue),r.trigger("change")})});if(!u){r.bind("change",function(){e.$apply(function(){o.$setViewValue(r.select2("data"))})});if(f.initSelection){var l=f.initSelection;f.initSelection=function(e,t){l(e,function(e){o.$setViewValue(e),t(e)})}}}}s.$observe("disabled",function(e){r.select2(e&&"disable"||"enable")}),s.ngMultiple&&e.$watch(s.ngMultiple,function(e){r.select2(f)}),r.val(e.$eval(s.ngModel)),t(function(){r.select2(f),!f.initSelection&&!u&&o.$setViewValue(r.select2("data"))})}}}}]),angular.module("ui.directives").directive("uiShow",[function(){return function(e,t,n){e.$watch(n.uiShow,function(e,n){e?t.addClass("ui-show"):t.removeClass("ui-show")})}}]).directive("uiHide",[function(){return function(e,t,n){e.$watch(n.uiHide,function(e,n){e?t.addClass("ui-hide"):t.removeClass("ui-hide")})}}]).directive("uiToggle",[function(){return function(e,t,n){e.$watch(n.uiToggle,function(e,n){e?t.removeClass("ui-hide").addClass("ui-show"):t.removeClass("ui-show").addClass("ui-hide")})}}]),angular.module("ui.directives").directive("uiSortable",["ui.config",function(e){return{require:"?ngModel",link:function(t,n,r,i){var s,o,u,a,f,l,c,h,p;f=angular.extend({},e.sortable,t.$eval(r.uiSortable)),i&&(i.$render=function(){n.sortable("refresh")},u=function(e,t){t.item.sortable={index:t.item.index()}},a=function(e,t){t.item.sortable.resort=i},s=function(e,t){t.item.sortable.relocate=!0,i.$modelValue.splice(t.item.index(),0,t.item.sortable.moved)},o=function(e,t){i.$modelValue.length===1?t.item.sortable.moved=i.$modelValue.splice(0,1)[0]:t.item.sortable.moved=i.$modelValue.splice(t.item.sortable.index,1)[0]},onStop=function(e,n){if(n.item.sortable.resort&&!n.item.sortable.relocate){var r,i;i=n.item.sortable.index,r=n.item.index(),i<r&&r--,n.item.sortable.resort.$modelValue.splice(r,0,n.item.sortable.resort.$modelValue.splice(i,1)[0])}(n.item.sortable.resort||n.item.sortable.relocate)&&t.$apply()},h=f.start,f.start=function(e,t){u(e,t),typeof h=="function"&&h(e,t)},_stop=f.stop,f.stop=function(e,t){onStop(e,t),typeof _stop=="function"&&_stop(e,t)},p=f.update,f.update=function(e,t){a(e,t),typeof p=="function"&&p(e,t)},l=f.receive,f.receive=function(e,t){s(e,t),typeof l=="function"&&l(e,t)},c=f.remove,f.remove=function(e,t){o(e,t),typeof c=="function"&&c(e,t)}),n.sortable(f)}}}]),angular.module("ui.directives").directive("uiTinymce",["ui.config",function(e){return e.tinymce=e.tinymce||{},{require:"ngModel",link:function(t,n,r,i){var s,o={onchange_callback:function(e){e.isDirty()&&(e.save(),i.$setViewValue(n.val()),t.$$phase||t.$apply())},handle_event_callback:function(e){return this.isDirty()&&(this.save(),i.$setViewValue(n.val()),t.$$phase||t.$apply()),!0},setup:function(e){e.onSetContent.add(function(e,r){e.isDirty()&&(e.save(),i.$setViewValue(n.val()),t.$$phase||t.$apply())})}};r.uiTinymce?s=t.$eval(r.uiTinymce):s={},angular.extend(o,e.tinymce,s),setTimeout(function(){n.tinymce(o)})}}}]),angular.module("ui.directives").directive("uiValidate",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){var i,s,o={},u=e.$eval(n.uiValidate);if(!u)return;angular.isString(u)&&(u={validator:u}),angular.forEach(u,function(t,n){i=function(i){return e.$eval(t,{$value:i})?(r.$setValidity(n,!0),i):(r.$setValidity(n,!1),undefined)},o[n]=i,r.$formatters.push(i),r.$parsers.push(i)}),n.uiValidateWatch&&(s=e.$eval(n.uiValidateWatch),angular.isString(s)?e.$watch(s,function(){angular.forEach(o,function(e,t){e(r.$modelValue)})}):angular.forEach(s,function(t,n){e.$watch(t,function(){o[n](r.$modelValue)})}))}}}),angular.module("ui.filters").filter("format",function(){return function(e,t){if(!e)return e;var n=e.toString(),r;return t===undefined?n:!angular.isArray(t)&&!angular.isObject(t)?n.split("$0").join(t):(r=angular.isArray(t)&&"$"||":",angular.forEach(t,function(e,t){n=n.split(r+t).join(e)}),n)}}),angular.module("ui.filters").filter("highlight",function(){return function(e,t,n){return t||angular.isNumber(t)?(e=e.toString(),t=t.toString(),n?e.split(t).join('<span class="ui-match">'+t+"</span>"):e.replace(new RegExp(t,"gi"),'<span class="ui-match">$&</span>')):e}}),angular.module("ui.filters").filter("inflector",function(){function e(e){return e.replace(/^([a-z])|\s+([a-z])/g,function(e){return e.toUpperCase()})}function t(e,t){return e.replace(/[A-Z]/g,function(e){return t+e})}var n={humanize:function(n){return e(t(n," ").split("_").join(" "))},underscore:function(e){return e.substr(0,1).toLowerCase()+t(e.substr(1),"_").toLowerCase().split(" ").join("_")},variable:function(t){return t=t.substr(0,1).toLowerCase()+e(t.split("_").join(" ")).substr(1).split(" ").join(""),t}};return function(e,t,r){return t!==!1&&angular.isString(e)?(t=t||"humanize",n[t](e)):e}}),angular.module("ui.filters").filter("unique",function(){return function(e,t){if(t===!1)return e;if((t||angular.isUndefined(t))&&angular.isArray(e)){var n={},r=[],i=function(e){return angular.isObject(e)&&angular.isString(t)?e[t]:e};angular.forEach(e,function(e){var t,n=!1;for(var s=0;s<r.length;s++)if(angular.equals(i(r[s]),i(e))){n=!0;break}n||r.push(e)}),e=r}return e}});
;
;
/*! react-with-addons-0.14.1.min.js */ 
;
;
/**
* React (with addons) v0.14.1
*
* Copyright 2013-2015, Facebook, Inc.
* All rights reserved.
*
* This source code is licensed under the BSD-style license found in the
* LICENSE file in the root directory of this source tree. An additional grant
* of patent rights can be found in the PATENTS file in the same directory.
*
*/
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.React=e()}}(function(){return function e(t,n,r){function o(i,u){if(!n[i]){if(!t[i]){var s="function"==typeof require&&require;if(!u&&s)return s(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return o(n?n:e)},c,c.exports,e,t,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t,n){"use strict";var r=e(22),o=e(26),a=e(37),i=e(29),u=e(62),s=e(91),l=e(93),c=e(115),p=e(137),d=e(140);e(168);o.addons={CSSTransitionGroup:i,LinkedStateMixin:r,PureRenderMixin:a,TransitionGroup:s,batchedUpdates:function(){return l.batchedUpdates.apply(this,arguments)},cloneWithProps:c,createFragment:u.create,shallowCompare:p,update:d},t.exports=o},{115:115,137:137,140:140,168:168,22:22,26:26,29:29,37:37,62:62,91:91,93:93}],2:[function(e,t,n){"use strict";var r=e(70),o=e(119),a=e(152),i={componentDidMount:function(){this.props.autoFocus&&a(o(this))}},u={Mixin:i,focusDOMComponent:function(){a(r.getNode(this._rootNodeID))}};t.exports=u},{119:119,152:152,70:70}],3:[function(e,t,n){"use strict";function r(){var e=window.opera;return"object"==typeof e&&"function"==typeof e.version&&parseInt(e.version(),10)<=12}function o(e){return(e.ctrlKey||e.altKey||e.metaKey)&&!(e.ctrlKey&&e.altKey)}function a(e){switch(e){case N.topCompositionStart:return w.compositionStart;case N.topCompositionEnd:return w.compositionEnd;case N.topCompositionUpdate:return w.compositionUpdate}}function i(e,t){return e===N.topKeyDown&&t.keyCode===E}function u(e,t){switch(e){case N.topKeyUp:return-1!==b.indexOf(t.keyCode);case N.topKeyDown:return t.keyCode!==E;case N.topKeyPress:case N.topMouseDown:case N.topBlur:return!0;default:return!1}}function s(e){var t=e.detail;return"object"==typeof t&&"data"in t?t.data:null}function l(e,t,n,r,o){var l,c;if(_?l=a(e):R?u(e,r)&&(l=w.compositionEnd):i(e,r)&&(l=w.compositionStart),!l)return null;P&&(R||l!==w.compositionStart?l===w.compositionEnd&&R&&(c=R.getData()):R=m.getPooled(t));var p=g.getPooled(l,n,r,o);if(c)p.data=c;else{var d=s(r);null!==d&&(p.data=d)}return h.accumulateTwoPhaseDispatches(p),p}function c(e,t){switch(e){case N.topCompositionEnd:return s(t);case N.topKeyPress:var n=t.which;return n!==T?null:(S=!0,M);case N.topTextInput:var r=t.data;return r===M&&S?null:r;default:return null}}function p(e,t){if(R){if(e===N.topCompositionEnd||u(e,t)){var n=R.getData();return m.release(R),R=null,n}return null}switch(e){case N.topPaste:return null;case N.topKeyPress:return t.which&&!o(t)?String.fromCharCode(t.which):null;case N.topCompositionEnd:return P?null:t.data;default:return null}}function d(e,t,n,r,o){var a;if(a=D?c(e,r):p(e,r),!a)return null;var i=y.getPooled(w.beforeInput,n,r,o);return i.data=a,h.accumulateTwoPhaseDispatches(i),i}var f=e(15),h=e(19),v=e(144),m=e(20),g=e(100),y=e(104),C=e(163),b=[9,13,27,32],E=229,_=v.canUseDOM&&"CompositionEvent"in window,x=null;v.canUseDOM&&"documentMode"in document&&(x=document.documentMode);var D=v.canUseDOM&&"TextEvent"in window&&!x&&!r(),P=v.canUseDOM&&(!_||x&&x>8&&11>=x),T=32,M=String.fromCharCode(T),N=f.topLevelTypes,w={beforeInput:{phasedRegistrationNames:{bubbled:C({onBeforeInput:null}),captured:C({onBeforeInputCapture:null})},dependencies:[N.topCompositionEnd,N.topKeyPress,N.topTextInput,N.topPaste]},compositionEnd:{phasedRegistrationNames:{bubbled:C({onCompositionEnd:null}),captured:C({onCompositionEndCapture:null})},dependencies:[N.topBlur,N.topCompositionEnd,N.topKeyDown,N.topKeyPress,N.topKeyUp,N.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:C({onCompositionStart:null}),captured:C({onCompositionStartCapture:null})},dependencies:[N.topBlur,N.topCompositionStart,N.topKeyDown,N.topKeyPress,N.topKeyUp,N.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:C({onCompositionUpdate:null}),captured:C({onCompositionUpdateCapture:null})},dependencies:[N.topBlur,N.topCompositionUpdate,N.topKeyDown,N.topKeyPress,N.topKeyUp,N.topMouseDown]}},S=!1,R=null,I={eventTypes:w,extractEvents:function(e,t,n,r,o){return[l(e,t,n,r,o),d(e,t,n,r,o)]}};t.exports=I},{100:100,104:104,144:144,15:15,163:163,19:19,20:20}],4:[function(e,t,n){"use strict";function r(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var o={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0},a=["Webkit","ms","Moz","O"];Object.keys(o).forEach(function(e){a.forEach(function(t){o[r(t,e)]=o[e]})});var i={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},u={isUnitlessNumber:o,shorthandPropertyExpansions:i};t.exports=u},{}],5:[function(e,t,n){"use strict";var r=e(4),o=e(144),a=e(76),i=(e(146),e(116)),u=e(157),s=e(165),l=(e(168),s(function(e){return u(e)})),c=!1,p="cssFloat";if(o.canUseDOM){var d=document.createElement("div").style;try{d.font=""}catch(f){c=!0}void 0===document.documentElement.style.cssFloat&&(p="styleFloat")}var h={createMarkupForStyles:function(e){var t="";for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];null!=r&&(t+=l(n)+":",t+=i(n,r)+";")}return t||null},setValueForStyles:function(e,t){var n=e.style;for(var o in t)if(t.hasOwnProperty(o)){var a=i(o,t[o]);if("float"===o&&(o=p),a)n[o]=a;else{var u=c&&r.shorthandPropertyExpansions[o];if(u)for(var s in u)n[s]="";else n[o]=""}}}};a.measureMethods(h,"CSSPropertyOperations",{setValueForStyles:"setValueForStyles"}),t.exports=h},{116:116,144:144,146:146,157:157,165:165,168:168,4:4,76:76}],6:[function(e,t,n){"use strict";function r(){this._callbacks=null,this._contexts=null}var o=e(25),a=e(24),i=e(158);a(r.prototype,{enqueue:function(e,t){this._callbacks=this._callbacks||[],this._contexts=this._contexts||[],this._callbacks.push(e),this._contexts.push(t)},notifyAll:function(){var e=this._callbacks,t=this._contexts;if(e){e.length!==t.length?i(!1):void 0,this._callbacks=null,this._contexts=null;for(var n=0;n<e.length;n++)e[n].call(t[n]);e.length=0,t.length=0}},reset:function(){this._callbacks=null,this._contexts=null},destructor:function(){this.reset()}}),o.addPoolingTo(r),t.exports=r},{158:158,24:24,25:25}],7:[function(e,t,n){"use strict";function r(e){var t=e.nodeName&&e.nodeName.toLowerCase();return"select"===t||"input"===t&&"file"===e.type}function o(e){var t=x.getPooled(w.change,R,e,D(e));b.accumulateTwoPhaseDispatches(t),_.batchedUpdates(a,t)}function a(e){C.enqueueEvents(e),C.processEventQueue(!1)}function i(e,t){S=e,R=t,S.attachEvent("onchange",o)}function u(){S&&(S.detachEvent("onchange",o),S=null,R=null)}function s(e,t,n){return e===N.topChange?n:void 0}function l(e,t,n){e===N.topFocus?(u(),i(t,n)):e===N.topBlur&&u()}function c(e,t){S=e,R=t,I=e.value,k=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value"),Object.defineProperty(S,"value",L),S.attachEvent("onpropertychange",d)}function p(){S&&(delete S.value,S.detachEvent("onpropertychange",d),S=null,R=null,I=null,k=null)}function d(e){if("value"===e.propertyName){var t=e.srcElement.value;t!==I&&(I=t,o(e))}}function f(e,t,n){return e===N.topInput?n:void 0}function h(e,t,n){e===N.topFocus?(p(),c(t,n)):e===N.topBlur&&p()}function v(e,t,n){return e!==N.topSelectionChange&&e!==N.topKeyUp&&e!==N.topKeyDown||!S||S.value===I?void 0:(I=S.value,R)}function m(e){return e.nodeName&&"input"===e.nodeName.toLowerCase()&&("checkbox"===e.type||"radio"===e.type)}function g(e,t,n){return e===N.topClick?n:void 0}var y=e(15),C=e(16),b=e(19),E=e(144),_=e(93),x=e(102),D=e(125),P=e(130),T=e(131),M=e(163),N=y.topLevelTypes,w={change:{phasedRegistrationNames:{bubbled:M({onChange:null}),captured:M({onChangeCapture:null})},dependencies:[N.topBlur,N.topChange,N.topClick,N.topFocus,N.topInput,N.topKeyDown,N.topKeyUp,N.topSelectionChange]}},S=null,R=null,I=null,k=null,O=!1;E.canUseDOM&&(O=P("change")&&(!("documentMode"in document)||document.documentMode>8));var A=!1;E.canUseDOM&&(A=P("input")&&(!("documentMode"in document)||document.documentMode>9));var L={get:function(){return k.get.call(this)},set:function(e){I=""+e,k.set.call(this,e)}},U={eventTypes:w,extractEvents:function(e,t,n,o,a){var i,u;if(r(t)?O?i=s:u=l:T(t)?A?i=f:(i=v,u=h):m(t)&&(i=g),i){var c=i(e,t,n);if(c){var p=x.getPooled(w.change,c,o,a);return p.type="change",b.accumulateTwoPhaseDispatches(p),p}}u&&u(e,t,n)}};t.exports=U},{102:102,125:125,130:130,131:131,144:144,15:15,16:16,163:163,19:19,93:93}],8:[function(e,t,n){"use strict";var r=0,o={createReactRootIndex:function(){return r++}};t.exports=o},{}],9:[function(e,t,n){"use strict";function r(e,t,n){var r=n>=e.childNodes.length?null:e.childNodes.item(n);e.insertBefore(t,r)}var o=e(12),a=e(72),i=e(76),u=e(135),s=e(136),l=e(158),c={dangerouslyReplaceNodeWithMarkup:o.dangerouslyReplaceNodeWithMarkup,updateTextContent:s,processUpdates:function(e,t){for(var n,i=null,c=null,p=0;p<e.length;p++)if(n=e[p],n.type===a.MOVE_EXISTING||n.type===a.REMOVE_NODE){var d=n.fromIndex,f=n.parentNode.childNodes[d],h=n.parentID;f?void 0:l(!1),i=i||{},i[h]=i[h]||[],i[h][d]=f,c=c||[],c.push(f)}var v;if(v=t.length&&"string"==typeof t[0]?o.dangerouslyRenderMarkup(t):t,c)for(var m=0;m<c.length;m++)c[m].parentNode.removeChild(c[m]);for(var g=0;g<e.length;g++)switch(n=e[g],n.type){case a.INSERT_MARKUP:r(n.parentNode,v[n.markupIndex],n.toIndex);break;case a.MOVE_EXISTING:r(n.parentNode,i[n.parentID][n.fromIndex],n.toIndex);break;case a.SET_MARKUP:u(n.parentNode,n.content);break;case a.TEXT_CONTENT:s(n.parentNode,n.content);break;case a.REMOVE_NODE:}}};i.measureMethods(c,"DOMChildrenOperations",{updateTextContent:"updateTextContent"}),t.exports=c},{12:12,135:135,136:136,158:158,72:72,76:76}],10:[function(e,t,n){"use strict";function r(e,t){return(e&t)===t}var o=e(158),a={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_NUMERIC_VALUE:16,HAS_POSITIVE_NUMERIC_VALUE:48,HAS_OVERLOADED_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function(e){var t=a,n=e.Properties||{},i=e.DOMAttributeNamespaces||{},s=e.DOMAttributeNames||{},l=e.DOMPropertyNames||{},c=e.DOMMutationMethods||{};e.isCustomAttribute&&u._isCustomAttributeFunctions.push(e.isCustomAttribute);for(var p in n){u.properties.hasOwnProperty(p)?o(!1):void 0;var d=p.toLowerCase(),f=n[p],h={attributeName:d,attributeNamespace:null,propertyName:p,mutationMethod:null,mustUseAttribute:r(f,t.MUST_USE_ATTRIBUTE),mustUseProperty:r(f,t.MUST_USE_PROPERTY),hasSideEffects:r(f,t.HAS_SIDE_EFFECTS),hasBooleanValue:r(f,t.HAS_BOOLEAN_VALUE),hasNumericValue:r(f,t.HAS_NUMERIC_VALUE),hasPositiveNumericValue:r(f,t.HAS_POSITIVE_NUMERIC_VALUE),hasOverloadedBooleanValue:r(f,t.HAS_OVERLOADED_BOOLEAN_VALUE)};if(h.mustUseAttribute&&h.mustUseProperty?o(!1):void 0,!h.mustUseProperty&&h.hasSideEffects?o(!1):void 0,h.hasBooleanValue+h.hasNumericValue+h.hasOverloadedBooleanValue<=1?void 0:o(!1),s.hasOwnProperty(p)){var v=s[p];h.attributeName=v}i.hasOwnProperty(p)&&(h.attributeNamespace=i[p]),l.hasOwnProperty(p)&&(h.propertyName=l[p]),c.hasOwnProperty(p)&&(h.mutationMethod=c[p]),u.properties[p]=h}}},i={},u={ID_ATTRIBUTE_NAME:"data-reactid",properties:{},getPossibleStandardName:null,_isCustomAttributeFunctions:[],isCustomAttribute:function(e){for(var t=0;t<u._isCustomAttributeFunctions.length;t++){var n=u._isCustomAttributeFunctions[t];if(n(e))return!0}return!1},getDefaultValueForProperty:function(e,t){var n,r=i[e];return r||(i[e]=r={}),t in r||(n=document.createElement(e),r[t]=n[t]),r[t]},injection:a};t.exports=u},{158:158}],11:[function(e,t,n){"use strict";function r(e){return c.hasOwnProperty(e)?!0:l.hasOwnProperty(e)?!1:s.test(e)?(c[e]=!0,!0):(l[e]=!0,!1)}function o(e,t){return null==t||e.hasBooleanValue&&!t||e.hasNumericValue&&isNaN(t)||e.hasPositiveNumericValue&&1>t||e.hasOverloadedBooleanValue&&t===!1}var a=e(10),i=e(76),u=e(133),s=(e(168),/^[a-zA-Z_][\w\.\-]*$/),l={},c={},p={createMarkupForID:function(e){return a.ID_ATTRIBUTE_NAME+"="+u(e)},setAttributeForID:function(e,t){e.setAttribute(a.ID_ATTRIBUTE_NAME,t)},createMarkupForProperty:function(e,t){var n=a.properties.hasOwnProperty(e)?a.properties[e]:null;if(n){if(o(n,t))return"";var r=n.attributeName;return n.hasBooleanValue||n.hasOverloadedBooleanValue&&t===!0?r+'=""':r+"="+u(t)}return a.isCustomAttribute(e)?null==t?"":e+"="+u(t):null},createMarkupForCustomAttribute:function(e,t){return r(e)&&null!=t?e+"="+u(t):""},setValueForProperty:function(e,t,n){var r=a.properties.hasOwnProperty(t)?a.properties[t]:null;if(r){var i=r.mutationMethod;if(i)i(e,n);else if(o(r,n))this.deleteValueForProperty(e,t);else if(r.mustUseAttribute){var u=r.attributeName,s=r.attributeNamespace;s?e.setAttributeNS(s,u,""+n):r.hasBooleanValue||r.hasOverloadedBooleanValue&&n===!0?e.setAttribute(u,""):e.setAttribute(u,""+n)}else{var l=r.propertyName;r.hasSideEffects&&""+e[l]==""+n||(e[l]=n)}}else a.isCustomAttribute(t)&&p.setValueForAttribute(e,t,n)},setValueForAttribute:function(e,t,n){r(t)&&(null==n?e.removeAttribute(t):e.setAttribute(t,""+n))},deleteValueForProperty:function(e,t){var n=a.properties.hasOwnProperty(t)?a.properties[t]:null;if(n){var r=n.mutationMethod;if(r)r(e,void 0);else if(n.mustUseAttribute)e.removeAttribute(n.attributeName);else{var o=n.propertyName,i=a.getDefaultValueForProperty(e.nodeName,o);n.hasSideEffects&&""+e[o]===i||(e[o]=i)}}else a.isCustomAttribute(t)&&e.removeAttribute(t)}};i.measureMethods(p,"DOMPropertyOperations",{setValueForProperty:"setValueForProperty",setValueForAttribute:"setValueForAttribute",deleteValueForProperty:"deleteValueForProperty"}),t.exports=p},{10:10,133:133,168:168,76:76}],12:[function(e,t,n){"use strict";function r(e){return e.substring(1,e.indexOf(" "))}var o=e(144),a=e(149),i=e(150),u=e(154),s=e(158),l=/^(<[^ \/>]+)/,c="data-danger-index",p={dangerouslyRenderMarkup:function(e){o.canUseDOM?void 0:s(!1);for(var t,n={},p=0;p<e.length;p++)e[p]?void 0:s(!1),t=r(e[p]),t=u(t)?t:"*",n[t]=n[t]||[],n[t][p]=e[p];var d=[],f=0;for(t in n)if(n.hasOwnProperty(t)){var h,v=n[t];for(h in v)if(v.hasOwnProperty(h)){var m=v[h];v[h]=m.replace(l,"$1 "+c+'="'+h+'" ')}for(var g=a(v.join(""),i),y=0;y<g.length;++y){var C=g[y];C.hasAttribute&&C.hasAttribute(c)&&(h=+C.getAttribute(c),C.removeAttribute(c),d.hasOwnProperty(h)?s(!1):void 0,d[h]=C,f+=1)}}return f!==d.length?s(!1):void 0,d.length!==e.length?s(!1):void 0,d},dangerouslyReplaceNodeWithMarkup:function(e,t){o.canUseDOM?void 0:s(!1),t?void 0:s(!1),"html"===e.tagName.toLowerCase()?s(!1):void 0;var n;n="string"==typeof t?a(t,i)[0]:t,e.parentNode.replaceChild(n,e)}};t.exports=p},{144:144,149:149,150:150,154:154,158:158}],13:[function(e,t,n){"use strict";var r=e(163),o=[r({ResponderEventPlugin:null}),r({SimpleEventPlugin:null}),r({TapEventPlugin:null}),r({EnterLeaveEventPlugin:null}),r({ChangeEventPlugin:null}),r({SelectEventPlugin:null}),r({BeforeInputEventPlugin:null})];t.exports=o},{163:163}],14:[function(e,t,n){"use strict";var r=e(15),o=e(19),a=e(106),i=e(70),u=e(163),s=r.topLevelTypes,l=i.getFirstReactDOM,c={mouseEnter:{registrationName:u({onMouseEnter:null}),dependencies:[s.topMouseOut,s.topMouseOver]},mouseLeave:{registrationName:u({onMouseLeave:null}),dependencies:[s.topMouseOut,s.topMouseOver]}},p=[null,null],d={eventTypes:c,extractEvents:function(e,t,n,r,u){if(e===s.topMouseOver&&(r.relatedTarget||r.fromElement))return null;if(e!==s.topMouseOut&&e!==s.topMouseOver)return null;var d;if(t.window===t)d=t;else{var f=t.ownerDocument;d=f?f.defaultView||f.parentWindow:window}var h,v,m="",g="";if(e===s.topMouseOut?(h=t,m=n,v=l(r.relatedTarget||r.toElement),v?g=i.getID(v):v=d,v=v||d):(h=d,v=t,g=n),h===v)return null;var y=a.getPooled(c.mouseLeave,m,r,u);y.type="mouseleave",y.target=h,y.relatedTarget=v;var C=a.getPooled(c.mouseEnter,g,r,u);return C.type="mouseenter",C.target=v,C.relatedTarget=h,o.accumulateEnterLeaveDispatches(y,C,m,g),p[0]=y,p[1]=C,p}};t.exports=d},{106:106,15:15,163:163,19:19,70:70}],15:[function(e,t,n){"use strict";var r=e(162),o=r({bubbled:null,captured:null}),a=r({topAbort:null,topBlur:null,topCanPlay:null,topCanPlayThrough:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topDurationChange:null,topEmptied:null,topEncrypted:null,topEnded:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topLoadedData:null,topLoadedMetadata:null,topLoadStart:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topPause:null,topPlay:null,topPlaying:null,topProgress:null,topRateChange:null,topReset:null,topScroll:null,topSeeked:null,topSeeking:null,topSelectionChange:null,topStalled:null,topSubmit:null,topSuspend:null,topTextInput:null,topTimeUpdate:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topVolumeChange:null,topWaiting:null,topWheel:null}),i={topLevelTypes:a,PropagationPhases:o};t.exports=i},{162:162}],16:[function(e,t,n){"use strict";var r=e(17),o=e(18),a=e(59),i=e(112),u=e(121),s=e(158),l=(e(168),{}),c=null,p=function(e,t){e&&(o.executeDispatchesInOrder(e,t),e.isPersistent()||e.constructor.release(e))},d=function(e){return p(e,!0)},f=function(e){return p(e,!1)},h=null,v={injection:{injectMount:o.injection.injectMount,injectInstanceHandle:function(e){h=e},getInstanceHandle:function(){return h},injectEventPluginOrder:r.injectEventPluginOrder,injectEventPluginsByName:r.injectEventPluginsByName},eventNameDispatchConfigs:r.eventNameDispatchConfigs,registrationNameModules:r.registrationNameModules,putListener:function(e,t,n){"function"!=typeof n?s(!1):void 0;var o=l[t]||(l[t]={});o[e]=n;var a=r.registrationNameModules[t];a&&a.didPutListener&&a.didPutListener(e,t,n)},getListener:function(e,t){var n=l[t];return n&&n[e]},deleteListener:function(e,t){var n=r.registrationNameModules[t];n&&n.willDeleteListener&&n.willDeleteListener(e,t);var o=l[t];o&&delete o[e]},deleteAllListeners:function(e){for(var t in l)if(l[t][e]){var n=r.registrationNameModules[t];n&&n.willDeleteListener&&n.willDeleteListener(e,t),delete l[t][e]}},extractEvents:function(e,t,n,o,a){for(var u,s=r.plugins,l=0;l<s.length;l++){var c=s[l];if(c){var p=c.extractEvents(e,t,n,o,a);p&&(u=i(u,p))}}return u},enqueueEvents:function(e){e&&(c=i(c,e))},processEventQueue:function(e){var t=c;c=null,e?u(t,d):u(t,f),c?s(!1):void 0,a.rethrowCaughtError()},__purge:function(){l={}},__getListenerBank:function(){return l}};t.exports=v},{112:112,121:121,158:158,168:168,17:17,18:18,59:59}],17:[function(e,t,n){"use strict";function r(){if(u)for(var e in s){var t=s[e],n=u.indexOf(e);if(n>-1?void 0:i(!1),!l.plugins[n]){t.extractEvents?void 0:i(!1),l.plugins[n]=t;var r=t.eventTypes;for(var a in r)o(r[a],t,a)?void 0:i(!1)}}}function o(e,t,n){l.eventNameDispatchConfigs.hasOwnProperty(n)?i(!1):void 0,l.eventNameDispatchConfigs[n]=e;var r=e.phasedRegistrationNames;if(r){for(var o in r)if(r.hasOwnProperty(o)){var u=r[o];a(u,t,n)}return!0}return e.registrationName?(a(e.registrationName,t,n),!0):!1}function a(e,t,n){l.registrationNameModules[e]?i(!1):void 0,l.registrationNameModules[e]=t,l.registrationNameDependencies[e]=t.eventTypes[n].dependencies}var i=e(158),u=null,s={},l={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(e){u?i(!1):void 0,u=Array.prototype.slice.call(e),r()},injectEventPluginsByName:function(e){var t=!1;for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];s.hasOwnProperty(n)&&s[n]===o||(s[n]?i(!1):void 0,s[n]=o,t=!0)}t&&r()},getPluginModuleForEvent:function(e){var t=e.dispatchConfig;if(t.registrationName)return l.registrationNameModules[t.registrationName]||null;for(var n in t.phasedRegistrationNames)if(t.phasedRegistrationNames.hasOwnProperty(n)){var r=l.registrationNameModules[t.phasedRegistrationNames[n]];if(r)return r}return null},_resetEventPlugins:function(){u=null;for(var e in s)s.hasOwnProperty(e)&&delete s[e];l.plugins.length=0;var t=l.eventNameDispatchConfigs;for(var n in t)t.hasOwnProperty(n)&&delete t[n];var r=l.registrationNameModules;for(var o in r)r.hasOwnProperty(o)&&delete r[o]}};t.exports=l},{158:158}],18:[function(e,t,n){"use strict";function r(e){return e===m.topMouseUp||e===m.topTouchEnd||e===m.topTouchCancel}function o(e){return e===m.topMouseMove||e===m.topTouchMove}function a(e){return e===m.topMouseDown||e===m.topTouchStart}function i(e,t,n,r){var o=e.type||"unknown-event";e.currentTarget=v.Mount.getNode(r),t?f.invokeGuardedCallbackWithCatch(o,n,e,r):f.invokeGuardedCallback(o,n,e,r),e.currentTarget=null}function u(e,t){var n=e._dispatchListeners,r=e._dispatchIDs;if(Array.isArray(n))for(var o=0;o<n.length&&!e.isPropagationStopped();o++)i(e,t,n[o],r[o]);else n&&i(e,t,n,r);e._dispatchListeners=null,e._dispatchIDs=null}function s(e){var t=e._dispatchListeners,n=e._dispatchIDs;if(Array.isArray(t)){for(var r=0;r<t.length&&!e.isPropagationStopped();r++)if(t[r](e,n[r]))return n[r]}else if(t&&t(e,n))return n;return null}function l(e){var t=s(e);return e._dispatchIDs=null,e._dispatchListeners=null,t}function c(e){var t=e._dispatchListeners,n=e._dispatchIDs;Array.isArray(t)?h(!1):void 0;var r=t?t(e,n):null;return e._dispatchListeners=null,e._dispatchIDs=null,r}function p(e){return!!e._dispatchListeners}var d=e(15),f=e(59),h=e(158),v=(e(168),{Mount:null,injectMount:function(e){v.Mount=e}}),m=d.topLevelTypes,g={isEndish:r,isMoveish:o,isStartish:a,executeDirectDispatch:c,executeDispatchesInOrder:u,executeDispatchesInOrderStopAtTrue:l,hasDispatches:p,getNode:function(e){return v.Mount.getNode(e)},getID:function(e){return v.Mount.getID(e)},injection:v};t.exports=g},{15:15,158:158,168:168,59:59}],19:[function(e,t,n){"use strict";function r(e,t,n){var r=t.dispatchConfig.phasedRegistrationNames[n];return y(e,r)}function o(e,t,n){var o=t?g.bubbled:g.captured,a=r(e,n,o);a&&(n._dispatchListeners=v(n._dispatchListeners,a),n._dispatchIDs=v(n._dispatchIDs,e))}function a(e){e&&e.dispatchConfig.phasedRegistrationNames&&h.injection.getInstanceHandle().traverseTwoPhase(e.dispatchMarker,o,e)}function i(e){e&&e.dispatchConfig.phasedRegistrationNames&&h.injection.getInstanceHandle().traverseTwoPhaseSkipTarget(e.dispatchMarker,o,e)}function u(e,t,n){if(n&&n.dispatchConfig.registrationName){var r=n.dispatchConfig.registrationName,o=y(e,r);o&&(n._dispatchListeners=v(n._dispatchListeners,o),n._dispatchIDs=v(n._dispatchIDs,e))}}function s(e){e&&e.dispatchConfig.registrationName&&u(e.dispatchMarker,null,e)}function l(e){m(e,a)}function c(e){m(e,i)}function p(e,t,n,r){h.injection.getInstanceHandle().traverseEnterLeave(n,r,u,e,t)}function d(e){m(e,s)}var f=e(15),h=e(16),v=(e(168),e(112)),m=e(121),g=f.PropagationPhases,y=h.getListener,C={accumulateTwoPhaseDispatches:l,accumulateTwoPhaseDispatchesSkipTarget:c,accumulateDirectDispatches:d,accumulateEnterLeaveDispatches:p};t.exports=C},{112:112,121:121,15:15,16:16,168:168}],20:[function(e,t,n){"use strict";function r(e){this._root=e,this._startText=this.getText(),this._fallbackText=null}var o=e(25),a=e(24),i=e(128);a(r.prototype,{destructor:function(){this._root=null,this._startText=null,this._fallbackText=null},getText:function(){return"value"in this._root?this._root.value:this._root[i()]},getData:function(){if(this._fallbackText)return this._fallbackText;var e,t,n=this._startText,r=n.length,o=this.getText(),a=o.length;for(e=0;r>e&&n[e]===o[e];e++);var i=r-e;for(t=1;i>=t&&n[r-t]===o[a-t];t++);var u=t>1?1-t:void 0;return this._fallbackText=o.slice(e,u),this._fallbackText}}),o.addPoolingTo(r),t.exports=r},{128:128,24:24,25:25}],21:[function(e,t,n){"use strict";var r,o=e(10),a=e(144),i=o.injection.MUST_USE_ATTRIBUTE,u=o.injection.MUST_USE_PROPERTY,s=o.injection.HAS_BOOLEAN_VALUE,l=o.injection.HAS_SIDE_EFFECTS,c=o.injection.HAS_NUMERIC_VALUE,p=o.injection.HAS_POSITIVE_NUMERIC_VALUE,d=o.injection.HAS_OVERLOADED_BOOLEAN_VALUE;if(a.canUseDOM){var f=document.implementation;r=f&&f.hasFeature&&f.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}var h={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,acceptCharset:null,accessKey:null,action:null,allowFullScreen:i|s,allowTransparency:i,alt:null,async:s,autoComplete:null,autoPlay:s,capture:i|s,cellPadding:null,cellSpacing:null,charSet:i,challenge:i,checked:u|s,classID:i,className:r?i:u,cols:i|p,colSpan:null,content:null,contentEditable:null,contextMenu:i,controls:u|s,coords:null,crossOrigin:null,data:null,dateTime:i,"default":s,defer:s,dir:null,disabled:i|s,download:d,draggable:null,encType:null,form:i,formAction:i,formEncType:i,formMethod:i,formNoValidate:s,formTarget:i,frameBorder:i,headers:null,height:i,hidden:i|s,high:null,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:u,inputMode:i,is:i,keyParams:i,keyType:i,kind:null,label:null,lang:null,list:i,loop:u|s,low:null,manifest:i,marginHeight:null,marginWidth:null,max:null,maxLength:i,media:i,mediaGroup:null,method:null,min:null,minLength:i,multiple:u|s,muted:u|s,name:null,noValidate:s,open:s,optimum:null,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:u|s,rel:null,required:s,role:i,rows:i|p,rowSpan:null,sandbox:null,scope:null,scoped:s,scrolling:null,seamless:i|s,selected:u|s,shape:null,size:i|p,sizes:i,span:p,spellCheck:null,src:null,srcDoc:u,srcLang:null,srcSet:i,start:c,step:null,style:null,summary:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:u|l,width:i,wmode:i,wrap:null,about:i,datatype:i,inlist:i,prefix:i,property:i,resource:i,"typeof":i,vocab:i,autoCapitalize:null,autoCorrect:null,autoSave:null,color:null,itemProp:i,itemScope:i|s,itemType:i,itemID:i,itemRef:i,results:null,security:i,unselectable:i},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMPropertyNames:{autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",autoSave:"autosave",encType:"encoding",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};t.exports=h},{10:10,144:144}],22:[function(e,t,n){"use strict";var r=e(68),o=e(88),a={linkState:function(e){return new r(this.state[e],o.createStateKeySetter(this,e))}};t.exports=a},{68:68,88:88}],23:[function(e,t,n){"use strict";function r(e){null!=e.checkedLink&&null!=e.valueLink?l(!1):void 0}function o(e){r(e),null!=e.value||null!=e.onChange?l(!1):void 0}function a(e){r(e),null!=e.checked||null!=e.onChange?l(!1):void 0}function i(e){if(e){var t=e.getName();if(t)return" Check the render method of `"+t+"`."}return""}var u=e(80),s=e(79),l=e(158),c=(e(168),{button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0}),p={value:function(e,t,n){return!e[t]||c[e.type]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function(e,t,n){return!e[t]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")},onChange:u.func},d={},f={checkPropTypes:function(e,t,n){for(var r in p){if(p.hasOwnProperty(r))var o=p[r](t,r,e,s.prop);o instanceof Error&&!(o.message in d)&&(d[o.message]=!0,i(n))}},getValue:function(e){return e.valueLink?(o(e),e.valueLink.value):e.value},getChecked:function(e){return e.checkedLink?(a(e),e.checkedLink.value):e.checked},executeOnChange:function(e,t){return e.valueLink?(o(e),e.valueLink.requestChange(t.target.value)):e.checkedLink?(a(e),e.checkedLink.requestChange(t.target.checked)):e.onChange?e.onChange.call(void 0,t):void 0}};t.exports=f},{158:158,168:168,79:79,80:80}],24:[function(e,t,n){"use strict";function r(e,t){if(null==e)throw new TypeError("Object.assign target cannot be null or undefined");for(var n=Object(e),r=Object.prototype.hasOwnProperty,o=1;o<arguments.length;o++){var a=arguments[o];if(null!=a){var i=Object(a);for(var u in i)r.call(i,u)&&(n[u]=i[u])}}return n}t.exports=r},{}],25:[function(e,t,n){"use strict";var r=e(158),o=function(e){var t=this;if(t.instancePool.length){var n=t.instancePool.pop();return t.call(n,e),n}return new t(e)},a=function(e,t){var n=this;if(n.instancePool.length){var r=n.instancePool.pop();return n.call(r,e,t),r}return new n(e,t)},i=function(e,t,n){var r=this;if(r.instancePool.length){var o=r.instancePool.pop();return r.call(o,e,t,n),o}return new r(e,t,n)},u=function(e,t,n,r){var o=this;if(o.instancePool.length){var a=o.instancePool.pop();return o.call(a,e,t,n,r),a}return new o(e,t,n,r)},s=function(e,t,n,r,o){var a=this;if(a.instancePool.length){var i=a.instancePool.pop();return a.call(i,e,t,n,r,o),i}return new a(e,t,n,r,o)},l=function(e){var t=this;e instanceof t?void 0:r(!1),e.destructor(),t.instancePool.length<t.poolSize&&t.instancePool.push(e)},c=10,p=o,d=function(e,t){var n=e;return n.instancePool=[],n.getPooled=t||p,n.poolSize||(n.poolSize=c),n.release=l,n},f={addPoolingTo:d,oneArgumentPooler:o,twoArgumentPooler:a,threeArgumentPooler:i,fourArgumentPooler:u,fiveArgumentPooler:s};t.exports=f},{158:158}],26:[function(e,t,n){"use strict";var r=e(40),o=e(50),a=e(67),i=e(24),u=e(117),s={};i(s,a),i(s,{findDOMNode:u("findDOMNode","ReactDOM","react-dom",r,r.findDOMNode),render:u("render","ReactDOM","react-dom",r,r.render),unmountComponentAtNode:u("unmountComponentAtNode","ReactDOM","react-dom",r,r.unmountComponentAtNode),renderToString:u("renderToString","ReactDOMServer","react-dom/server",o,o.renderToString),renderToStaticMarkup:u("renderToStaticMarkup","ReactDOMServer","react-dom/server",o,o.renderToStaticMarkup)}),s.__SECRET_DOM_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=r,t.exports=s},{117:117,24:24,40:40,50:50,67:67}],27:[function(e,t,n){"use strict";var r=(e(66),e(119)),o=(e(168),"_getDOMNodeDidWarn"),a={getDOMNode:function(){return this.constructor[o]=!0,r(this)}};t.exports=a},{119:119,168:168,66:66}],28:[function(e,t,n){"use strict";function r(e){return Object.prototype.hasOwnProperty.call(e,m)||(e[m]=h++,d[e[m]]={}),d[e[m]]}var o=e(15),a=e(16),i=e(17),u=e(60),s=e(76),l=e(111),c=e(24),p=e(130),d={},f=!1,h=0,v={topAbort:"abort",topBlur:"blur",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",
topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topScroll:"scroll",topSeeked:"seeked",topSeeking:"seeking",topSelectionChange:"selectionchange",topStalled:"stalled",topSuspend:"suspend",topTextInput:"textInput",topTimeUpdate:"timeupdate",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topVolumeChange:"volumechange",topWaiting:"waiting",topWheel:"wheel"},m="_reactListenersID"+String(Math.random()).slice(2),g=c({},u,{ReactEventListener:null,injection:{injectReactEventListener:function(e){e.setHandleTopLevel(g.handleTopLevel),g.ReactEventListener=e}},setEnabled:function(e){g.ReactEventListener&&g.ReactEventListener.setEnabled(e)},isEnabled:function(){return!(!g.ReactEventListener||!g.ReactEventListener.isEnabled())},listenTo:function(e,t){for(var n=t,a=r(n),u=i.registrationNameDependencies[e],s=o.topLevelTypes,l=0;l<u.length;l++){var c=u[l];a.hasOwnProperty(c)&&a[c]||(c===s.topWheel?p("wheel")?g.ReactEventListener.trapBubbledEvent(s.topWheel,"wheel",n):p("mousewheel")?g.ReactEventListener.trapBubbledEvent(s.topWheel,"mousewheel",n):g.ReactEventListener.trapBubbledEvent(s.topWheel,"DOMMouseScroll",n):c===s.topScroll?p("scroll",!0)?g.ReactEventListener.trapCapturedEvent(s.topScroll,"scroll",n):g.ReactEventListener.trapBubbledEvent(s.topScroll,"scroll",g.ReactEventListener.WINDOW_HANDLE):c===s.topFocus||c===s.topBlur?(p("focus",!0)?(g.ReactEventListener.trapCapturedEvent(s.topFocus,"focus",n),g.ReactEventListener.trapCapturedEvent(s.topBlur,"blur",n)):p("focusin")&&(g.ReactEventListener.trapBubbledEvent(s.topFocus,"focusin",n),g.ReactEventListener.trapBubbledEvent(s.topBlur,"focusout",n)),a[s.topBlur]=!0,a[s.topFocus]=!0):v.hasOwnProperty(c)&&g.ReactEventListener.trapBubbledEvent(c,v[c],n),a[c]=!0)}},trapBubbledEvent:function(e,t,n){return g.ReactEventListener.trapBubbledEvent(e,t,n)},trapCapturedEvent:function(e,t,n){return g.ReactEventListener.trapCapturedEvent(e,t,n)},ensureScrollValueMonitoring:function(){if(!f){var e=l.refreshScrollValues;g.ReactEventListener.monitorScrollValue(e),f=!0}},eventNameDispatchConfigs:a.eventNameDispatchConfigs,registrationNameModules:a.registrationNameModules,putListener:a.putListener,getListener:a.getListener,deleteListener:a.deleteListener,deleteAllListeners:a.deleteAllListeners});s.measureMethods(g,"ReactBrowserEventEmitter",{putListener:"putListener",deleteListener:"deleteListener"}),t.exports=g},{111:111,130:130,15:15,16:16,17:17,24:24,60:60,76:76}],29:[function(e,t,n){"use strict";function r(e){var t="transition"+e+"Timeout",n="transition"+e;return function(e){if(e[n]){if(null==e[t])return new Error(t+" wasn't supplied to ReactCSSTransitionGroup: this can cause unreliable animations and won't be supported in a future version of React. See https://fb.me/react-animation-transition-group-timeout for more information.");if("number"!=typeof e[t])return new Error(t+" must be a number (in milliseconds)")}}}var o=e(26),a=e(24),i=e(91),u=e(30),s=o.createClass({displayName:"ReactCSSTransitionGroup",propTypes:{transitionName:u.propTypes.name,transitionAppear:o.PropTypes.bool,transitionEnter:o.PropTypes.bool,transitionLeave:o.PropTypes.bool,transitionAppearTimeout:r("Appear"),transitionEnterTimeout:r("Enter"),transitionLeaveTimeout:r("Leave")},getDefaultProps:function(){return{transitionAppear:!1,transitionEnter:!0,transitionLeave:!0}},_wrapChild:function(e){return o.createElement(u,{name:this.props.transitionName,appear:this.props.transitionAppear,enter:this.props.transitionEnter,leave:this.props.transitionLeave,appearTimeout:this.props.transitionAppearTimeout,enterTimeout:this.props.transitionEnterTimeout,leaveTimeout:this.props.transitionLeaveTimeout},e)},render:function(){return o.createElement(i,a({},this.props,{childFactory:this._wrapChild}))}});t.exports=s},{24:24,26:26,30:30,91:91}],30:[function(e,t,n){"use strict";var r=e(26),o=e(40),a=e(142),i=e(90),u=e(132),s=17,l=r.createClass({displayName:"ReactCSSTransitionGroupChild",propTypes:{name:r.PropTypes.oneOfType([r.PropTypes.string,r.PropTypes.shape({enter:r.PropTypes.string,leave:r.PropTypes.string,active:r.PropTypes.string}),r.PropTypes.shape({enter:r.PropTypes.string,enterActive:r.PropTypes.string,leave:r.PropTypes.string,leaveActive:r.PropTypes.string,appear:r.PropTypes.string,appearActive:r.PropTypes.string})]).isRequired,appear:r.PropTypes.bool,enter:r.PropTypes.bool,leave:r.PropTypes.bool,appearTimeout:r.PropTypes.number,enterTimeout:r.PropTypes.number,leaveTimeout:r.PropTypes.number},transition:function(e,t,n){var r=o.findDOMNode(this);if(!r)return void(t&&t());var u=this.props.name[e]||this.props.name+"-"+e,s=this.props.name[e+"Active"]||u+"-active",l=null,c=function(e){e&&e.target!==r||(clearTimeout(l),a.removeClass(r,u),a.removeClass(r,s),i.removeEndEventListener(r,c),t&&t())};a.addClass(r,u),this.queueClass(s),n?l=setTimeout(c,n):i.addEndEventListener(r,c)},queueClass:function(e){this.classNameQueue.push(e),this.timeout||(this.timeout=setTimeout(this.flushClassNameQueue,s))},flushClassNameQueue:function(){this.isMounted()&&this.classNameQueue.forEach(a.addClass.bind(a,o.findDOMNode(this))),this.classNameQueue.length=0,this.timeout=null},componentWillMount:function(){this.classNameQueue=[]},componentWillUnmount:function(){this.timeout&&clearTimeout(this.timeout)},componentWillAppear:function(e){this.props.appear?this.transition("appear",e,this.props.appearTimeout):e()},componentWillEnter:function(e){this.props.enter?this.transition("enter",e,this.props.enterTimeout):e()},componentWillLeave:function(e){this.props.leave?this.transition("leave",e,this.props.leaveTimeout):e()},render:function(){return u(this.props.children)}});t.exports=l},{132:132,142:142,26:26,40:40,90:90}],31:[function(e,t,n){"use strict";function r(e,t,n){var r=void 0===e[n];null!=t&&r&&(e[n]=a(t,null))}var o=e(82),a=e(129),i=e(138),u=e(139),s=(e(168),{instantiateChildren:function(e,t,n){if(null==e)return null;var o={};return u(e,r,o),o},updateChildren:function(e,t,n,r){if(!t&&!e)return null;var u;for(u in t)if(t.hasOwnProperty(u)){var s=e&&e[u],l=s&&s._currentElement,c=t[u];if(null!=s&&i(l,c))o.receiveComponent(s,c,n,r),t[u]=s;else{s&&o.unmountComponent(s,u);var p=a(c,null);t[u]=p}}for(u in e)!e.hasOwnProperty(u)||t&&t.hasOwnProperty(u)||o.unmountComponent(e[u]);return t},unmountChildren:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];o.unmountComponent(n)}}});t.exports=s},{129:129,138:138,139:139,168:168,82:82}],32:[function(e,t,n){"use strict";function r(e){return(""+e).replace(b,"//")}function o(e,t){this.func=e,this.context=t,this.count=0}function a(e,t,n){var r=e.func,o=e.context;r.call(o,t,e.count++)}function i(e,t,n){if(null==e)return e;var r=o.getPooled(t,n);g(e,a,r),o.release(r)}function u(e,t,n,r){this.result=e,this.keyPrefix=t,this.func=n,this.context=r,this.count=0}function s(e,t,n){var o=e.result,a=e.keyPrefix,i=e.func,u=e.context,s=i.call(u,t,e.count++);Array.isArray(s)?l(s,o,n,m.thatReturnsArgument):null!=s&&(v.isValidElement(s)&&(s=v.cloneAndReplaceKey(s,a+(s!==t?r(s.key||"")+"/":"")+n)),o.push(s))}function l(e,t,n,o,a){var i="";null!=n&&(i=r(n)+"/");var l=u.getPooled(t,i,o,a);g(e,s,l),u.release(l)}function c(e,t,n){if(null==e)return e;var r=[];return l(e,r,null,t,n),r}function p(e,t,n){return null}function d(e,t){return g(e,p,null)}function f(e){var t=[];return l(e,t,null,m.thatReturnsArgument),t}var h=e(25),v=e(55),m=e(150),g=e(139),y=h.twoArgumentPooler,C=h.fourArgumentPooler,b=/\/(?!\/)/g;o.prototype.destructor=function(){this.func=null,this.context=null,this.count=0},h.addPoolingTo(o,y),u.prototype.destructor=function(){this.result=null,this.keyPrefix=null,this.func=null,this.context=null,this.count=0},h.addPoolingTo(u,C);var E={forEach:i,map:c,mapIntoWithKeyPrefixInternal:l,count:d,toArray:f};t.exports=E},{139:139,150:150,25:25,55:55}],33:[function(e,t,n){"use strict";function r(e,t){var n=_.hasOwnProperty(t)?_[t]:null;D.hasOwnProperty(t)&&(n!==b.OVERRIDE_BASE?m(!1):void 0),e.hasOwnProperty(t)&&(n!==b.DEFINE_MANY&&n!==b.DEFINE_MANY_MERGED?m(!1):void 0)}function o(e,t){if(t){"function"==typeof t?m(!1):void 0,d.isValidElement(t)?m(!1):void 0;var n=e.prototype;t.hasOwnProperty(C)&&x.mixins(e,t.mixins);for(var o in t)if(t.hasOwnProperty(o)&&o!==C){var a=t[o];if(r(n,o),x.hasOwnProperty(o))x[o](e,a);else{var i=_.hasOwnProperty(o),l=n.hasOwnProperty(o),c="function"==typeof a,p=c&&!i&&!l&&t.autobind!==!1;if(p)n.__reactAutoBindMap||(n.__reactAutoBindMap={}),n.__reactAutoBindMap[o]=a,n[o]=a;else if(l){var f=_[o];!i||f!==b.DEFINE_MANY_MERGED&&f!==b.DEFINE_MANY?m(!1):void 0,f===b.DEFINE_MANY_MERGED?n[o]=u(n[o],a):f===b.DEFINE_MANY&&(n[o]=s(n[o],a))}else n[o]=a}}}}function a(e,t){if(t)for(var n in t){var r=t[n];if(t.hasOwnProperty(n)){var o=n in x;o?m(!1):void 0;var a=n in e;a?m(!1):void 0,e[n]=r}}}function i(e,t){e&&t&&"object"==typeof e&&"object"==typeof t?void 0:m(!1);for(var n in t)t.hasOwnProperty(n)&&(void 0!==e[n]?m(!1):void 0,e[n]=t[n]);return e}function u(e,t){return function(){var n=e.apply(this,arguments),r=t.apply(this,arguments);if(null==n)return r;if(null==r)return n;var o={};return i(o,n),i(o,r),o}}function s(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function l(e,t){var n=t.bind(e);return n}function c(e){for(var t in e.__reactAutoBindMap)if(e.__reactAutoBindMap.hasOwnProperty(t)){var n=e.__reactAutoBindMap[t];e[t]=l(e,n)}}var p=e(34),d=e(55),f=(e(79),e(78),e(74)),h=e(24),v=e(151),m=e(158),g=e(162),y=e(163),C=(e(168),y({mixins:null})),b=g({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null}),E=[],_={mixins:b.DEFINE_MANY,statics:b.DEFINE_MANY,propTypes:b.DEFINE_MANY,contextTypes:b.DEFINE_MANY,childContextTypes:b.DEFINE_MANY,getDefaultProps:b.DEFINE_MANY_MERGED,getInitialState:b.DEFINE_MANY_MERGED,getChildContext:b.DEFINE_MANY_MERGED,render:b.DEFINE_ONCE,componentWillMount:b.DEFINE_MANY,componentDidMount:b.DEFINE_MANY,componentWillReceiveProps:b.DEFINE_MANY,shouldComponentUpdate:b.DEFINE_ONCE,componentWillUpdate:b.DEFINE_MANY,componentDidUpdate:b.DEFINE_MANY,componentWillUnmount:b.DEFINE_MANY,updateComponent:b.OVERRIDE_BASE},x={displayName:function(e,t){e.displayName=t},mixins:function(e,t){if(t)for(var n=0;n<t.length;n++)o(e,t[n])},childContextTypes:function(e,t){e.childContextTypes=h({},e.childContextTypes,t)},contextTypes:function(e,t){e.contextTypes=h({},e.contextTypes,t)},getDefaultProps:function(e,t){e.getDefaultProps?e.getDefaultProps=u(e.getDefaultProps,t):e.getDefaultProps=t},propTypes:function(e,t){e.propTypes=h({},e.propTypes,t)},statics:function(e,t){a(e,t)},autobind:function(){}},D={replaceState:function(e,t){this.updater.enqueueReplaceState(this,e),t&&this.updater.enqueueCallback(this,t)},isMounted:function(){return this.updater.isMounted(this)},setProps:function(e,t){this.updater.enqueueSetProps(this,e),t&&this.updater.enqueueCallback(this,t)},replaceProps:function(e,t){this.updater.enqueueReplaceProps(this,e),t&&this.updater.enqueueCallback(this,t)}},P=function(){};h(P.prototype,p.prototype,D);var T={createClass:function(e){var t=function(e,t,n){this.__reactAutoBindMap&&c(this),this.props=e,this.context=t,this.refs=v,this.updater=n||f,this.state=null;var r=this.getInitialState?this.getInitialState():null;"object"!=typeof r||Array.isArray(r)?m(!1):void 0,this.state=r};t.prototype=new P,t.prototype.constructor=t,E.forEach(o.bind(null,t)),o(t,e),t.getDefaultProps&&(t.defaultProps=t.getDefaultProps()),t.prototype.render?void 0:m(!1);for(var n in _)t.prototype[n]||(t.prototype[n]=null);return t},injection:{injectMixin:function(e){E.push(e)}}};t.exports=T},{151:151,158:158,162:162,163:163,168:168,24:24,34:34,55:55,74:74,78:78,79:79}],34:[function(e,t,n){"use strict";function r(e,t,n){this.props=e,this.context=t,this.refs=a,this.updater=n||o}var o=e(74),a=(e(114),e(151)),i=e(158);e(168);r.prototype.isReactComponent={},r.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e?i(!1):void 0,this.updater.enqueueSetState(this,e),t&&this.updater.enqueueCallback(this,t)},r.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this),e&&this.updater.enqueueCallback(this,e)};t.exports=r},{114:114,151:151,158:158,168:168,74:74}],35:[function(e,t,n){"use strict";var r=e(45),o=e(70),a={processChildrenUpdates:r.dangerouslyProcessChildrenUpdates,replaceNodeWithMarkupByID:r.dangerouslyReplaceNodeWithMarkupByID,unmountIDFromEnvironment:function(e){o.purgeID(e)}};t.exports=a},{45:45,70:70}],36:[function(e,t,n){"use strict";var r=e(158),o=!1,a={unmountIDFromEnvironment:null,replaceNodeWithMarkupByID:null,processChildrenUpdates:null,injection:{injectEnvironment:function(e){o?r(!1):void 0,a.unmountIDFromEnvironment=e.unmountIDFromEnvironment,a.replaceNodeWithMarkupByID=e.replaceNodeWithMarkupByID,a.processChildrenUpdates=e.processChildrenUpdates,o=!0}}};t.exports=a},{158:158}],37:[function(e,t,n){"use strict";var r=e(137),o={shouldComponentUpdate:function(e,t){return r(this,e,t)}};t.exports=o},{137:137}],38:[function(e,t,n){"use strict";function r(e){var t=e._currentElement._owner||null;if(t){var n=t.getName();if(n)return" Check the render method of `"+n+"`."}return""}function o(e){}var a=e(36),i=e(39),u=e(55),s=e(66),l=e(76),c=e(79),p=(e(78),e(82)),d=e(92),f=e(24),h=e(151),v=e(158),m=e(138);e(168);o.prototype.render=function(){var e=s.get(this)._currentElement.type;return e(this.props,this.context,this.updater)};var g=1,y={construct:function(e){this._currentElement=e,this._rootNodeID=null,this._instance=null,this._pendingElement=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._renderedComponent=null,this._context=null,this._mountOrder=0,this._topLevelWrapper=null,this._pendingCallbacks=null},mountComponent:function(e,t,n){this._context=n,this._mountOrder=g++,this._rootNodeID=e;var r,a,i=this._processProps(this._currentElement.props),l=this._processContext(n),c=this._currentElement.type,f="prototype"in c;f&&(r=new c(i,l,d)),(!f||null===r||r===!1||u.isValidElement(r))&&(a=r,r=new o(c)),r.props=i,r.context=l,r.refs=h,r.updater=d,this._instance=r,s.set(r,this);var m=r.state;void 0===m&&(r.state=m=null),"object"!=typeof m||Array.isArray(m)?v(!1):void 0,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,r.componentWillMount&&(r.componentWillMount(),this._pendingStateQueue&&(r.state=this._processPendingState(r.props,r.context))),void 0===a&&(a=this._renderValidatedComponent()),this._renderedComponent=this._instantiateReactComponent(a);var y=p.mountComponent(this._renderedComponent,e,t,this._processChildContext(n));return r.componentDidMount&&t.getReactMountReady().enqueue(r.componentDidMount,r),y},unmountComponent:function(){var e=this._instance;e.componentWillUnmount&&e.componentWillUnmount(),p.unmountComponent(this._renderedComponent),this._renderedComponent=null,this._instance=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._pendingCallbacks=null,this._pendingElement=null,this._context=null,this._rootNodeID=null,this._topLevelWrapper=null,s.remove(e)},_maskContext:function(e){var t=null,n=this._currentElement.type,r=n.contextTypes;if(!r)return h;t={};for(var o in r)t[o]=e[o];return t},_processContext:function(e){var t=this._maskContext(e);return t},_processChildContext:function(e){var t=this._currentElement.type,n=this._instance,r=n.getChildContext&&n.getChildContext();if(r){"object"!=typeof t.childContextTypes?v(!1):void 0;for(var o in r)o in t.childContextTypes?void 0:v(!1);return f({},e,r)}return e},_processProps:function(e){return e},_checkPropTypes:function(e,t,n){var o=this.getName();for(var a in e)if(e.hasOwnProperty(a)){var i;try{"function"!=typeof e[a]?v(!1):void 0,i=e[a](t,a,o,n)}catch(u){i=u}i instanceof Error&&(r(this),n===c.prop)}},receiveComponent:function(e,t,n){var r=this._currentElement,o=this._context;this._pendingElement=null,this.updateComponent(t,r,e,o,n)},performUpdateIfNecessary:function(e){null!=this._pendingElement&&p.receiveComponent(this,this._pendingElement||this._currentElement,e,this._context),(null!==this._pendingStateQueue||this._pendingForceUpdate)&&this.updateComponent(e,this._currentElement,this._currentElement,this._context,this._context)},updateComponent:function(e,t,n,r,o){var a,i=this._instance,u=this._context===o?i.context:this._processContext(o);t===n?a=n.props:(a=this._processProps(n.props),i.componentWillReceiveProps&&i.componentWillReceiveProps(a,u));var s=this._processPendingState(a,u),l=this._pendingForceUpdate||!i.shouldComponentUpdate||i.shouldComponentUpdate(a,s,u);l?(this._pendingForceUpdate=!1,this._performComponentUpdate(n,a,s,u,e,o)):(this._currentElement=n,this._context=o,i.props=a,i.state=s,i.context=u)},_processPendingState:function(e,t){var n=this._instance,r=this._pendingStateQueue,o=this._pendingReplaceState;if(this._pendingReplaceState=!1,this._pendingStateQueue=null,!r)return n.state;if(o&&1===r.length)return r[0];for(var a=f({},o?r[0]:n.state),i=o?1:0;i<r.length;i++){var u=r[i];f(a,"function"==typeof u?u.call(n,a,e,t):u)}return a},_performComponentUpdate:function(e,t,n,r,o,a){var i,u,s,l=this._instance,c=Boolean(l.componentDidUpdate);c&&(i=l.props,u=l.state,s=l.context),l.componentWillUpdate&&l.componentWillUpdate(t,n,r),this._currentElement=e,this._context=a,l.props=t,l.state=n,l.context=r,this._updateRenderedComponent(o,a),c&&o.getReactMountReady().enqueue(l.componentDidUpdate.bind(l,i,u,s),l)},_updateRenderedComponent:function(e,t){var n=this._renderedComponent,r=n._currentElement,o=this._renderValidatedComponent();if(m(r,o))p.receiveComponent(n,o,e,this._processChildContext(t));else{var a=this._rootNodeID,i=n._rootNodeID;p.unmountComponent(n),this._renderedComponent=this._instantiateReactComponent(o);var u=p.mountComponent(this._renderedComponent,a,e,this._processChildContext(t));this._replaceNodeWithMarkupByID(i,u)}},_replaceNodeWithMarkupByID:function(e,t){a.replaceNodeWithMarkupByID(e,t)},_renderValidatedComponentWithoutOwnerOrContext:function(){var e=this._instance,t=e.render();return t},_renderValidatedComponent:function(){var e;i.current=this;try{e=this._renderValidatedComponentWithoutOwnerOrContext()}finally{i.current=null}return null===e||e===!1||u.isValidElement(e)?void 0:v(!1),e},attachRef:function(e,t){var n=this.getPublicInstance();null==n?v(!1):void 0;var r=t.getPublicInstance(),o=n.refs===h?n.refs={}:n.refs;o[e]=r},detachRef:function(e){var t=this.getPublicInstance().refs;delete t[e]},getName:function(){var e=this._currentElement.type,t=this._instance&&this._instance.constructor;return e.displayName||t&&t.displayName||e.name||t&&t.name||null},getPublicInstance:function(){var e=this._instance;return e instanceof o?null:e},_instantiateReactComponent:null};l.measureMethods(y,"ReactCompositeComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent",_renderValidatedComponent:"_renderValidatedComponent"});var C={Mixin:y};t.exports=C},{138:138,151:151,158:158,168:168,24:24,36:36,39:39,55:55,66:66,76:76,78:78,79:79,82:82,92:92}],39:[function(e,t,n){"use strict";var r={current:null};t.exports=r},{}],40:[function(e,t,n){"use strict";var r=e(39),o=e(51),a=e(54),i=e(65),u=e(70),s=e(76),l=e(82),c=e(93),p=e(94),d=e(119),f=e(134);e(168);a.inject();var h=s.measure("React","render",u.render),v={findDOMNode:d,render:h,unmountComponentAtNode:u.unmountComponentAtNode,version:p,unstable_batchedUpdates:c.batchedUpdates,unstable_renderSubtreeIntoContainer:f};"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.inject&&__REACT_DEVTOOLS_GLOBAL_HOOK__.inject({CurrentOwner:r,InstanceHandles:i,Mount:u,Reconciler:l,TextComponent:o});t.exports=v},{119:119,134:134,168:168,39:39,51:51,54:54,65:65,70:70,76:76,82:82,93:93,94:94}],41:[function(e,t,n){"use strict";var r={onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0},o={getNativeProps:function(e,t,n){if(!t.disabled)return t;var o={};for(var a in t)t.hasOwnProperty(a)&&!r[a]&&(o[a]=t[a]);return o}};t.exports=o},{}],42:[function(e,t,n){"use strict";function r(){return this}function o(){var e=this._reactInternalComponent;return!!e}function a(){}function i(e,t){var n=this._reactInternalComponent;n&&(I.enqueueSetPropsInternal(n,e),t&&I.enqueueCallbackInternal(n,t))}function u(e,t){var n=this._reactInternalComponent;n&&(I.enqueueReplacePropsInternal(n,e),t&&I.enqueueCallbackInternal(n,t))}function s(e,t){t&&(null!=t.dangerouslySetInnerHTML&&(null!=t.children?L(!1):void 0,"object"==typeof t.dangerouslySetInnerHTML&&H in t.dangerouslySetInnerHTML?void 0:L(!1)),null!=t.style&&"object"!=typeof t.style?L(!1):void 0)}function l(e,t,n,r){var o=w.findReactContainerForID(e);if(o){var a=o.nodeType===z?o.ownerDocument:o;j(t,a)}r.getReactMountReady().enqueue(c,{id:e,registrationName:t,listener:n})}function c(){var e=this;_.putListener(e.id,e.registrationName,e.listener)}function p(){var e=this;e._rootNodeID?void 0:L(!1);var t=w.getNode(e._rootNodeID);switch(t?void 0:L(!1),e._tag){case"iframe":e._wrapperState.listeners=[_.trapBubbledEvent(E.topLevelTypes.topLoad,"load",t)];break;case"video":case"audio":e._wrapperState.listeners=[];for(var n in Y)Y.hasOwnProperty(n)&&e._wrapperState.listeners.push(_.trapBubbledEvent(E.topLevelTypes[n],Y[n],t));break;case"img":e._wrapperState.listeners=[_.trapBubbledEvent(E.topLevelTypes.topError,"error",t),_.trapBubbledEvent(E.topLevelTypes.topLoad,"load",t)];break;case"form":e._wrapperState.listeners=[_.trapBubbledEvent(E.topLevelTypes.topReset,"reset",t),_.trapBubbledEvent(E.topLevelTypes.topSubmit,"submit",t)]}}function d(){P.mountReadyWrapper(this)}function f(){M.postUpdateWrapper(this)}function h(e){Z.call($,e)||(X.test(e)?void 0:L(!1),$[e]=!0)}function v(e,t){return e.indexOf("-")>=0||null!=t.is}function m(e){h(e),this._tag=e.toLowerCase(),this._renderedChildren=null,this._previousStyle=null,this._previousStyleCopy=null,this._rootNodeID=null,this._wrapperState=null,this._topLevelWrapper=null,this._nodeWithLegacyProperties=null}var g=e(2),y=e(5),C=e(10),b=e(11),E=e(15),_=e(28),x=e(35),D=e(41),P=e(46),T=e(47),M=e(48),N=e(52),w=e(70),S=e(71),R=e(76),I=e(92),k=e(24),O=e(114),A=e(118),L=e(158),U=(e(130),e(163)),F=e(135),B=e(136),V=(e(166),e(141),e(168),_.deleteListener),j=_.listenTo,W=_.registrationNameModules,K={string:!0,number:!0},q=U({style:null}),H=U({__html:null}),z=1,Y={topAbort:"abort",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topSeeked:"seeked",topSeeking:"seeking",topStalled:"stalled",topSuspend:"suspend",topTimeUpdate:"timeupdate",topVolumeChange:"volumechange",topWaiting:"waiting"},G={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},Q={listing:!0,pre:!0,textarea:!0},X=(k({menuitem:!0},G),/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/),$={},Z={}.hasOwnProperty;m.displayName="ReactDOMComponent",m.Mixin={construct:function(e){this._currentElement=e},mountComponent:function(e,t,n){this._rootNodeID=e;var r=this._currentElement.props;switch(this._tag){case"iframe":case"img":case"form":case"video":case"audio":this._wrapperState={listeners:null},t.getReactMountReady().enqueue(p,this);break;case"button":r=D.getNativeProps(this,r,n);break;case"input":P.mountWrapper(this,r,n),r=P.getNativeProps(this,r,n);break;case"option":T.mountWrapper(this,r,n),r=T.getNativeProps(this,r,n);break;case"select":M.mountWrapper(this,r,n),r=M.getNativeProps(this,r,n),n=M.processChildContext(this,r,n);break;case"textarea":N.mountWrapper(this,r,n),r=N.getNativeProps(this,r,n)}s(this,r);var o;if(t.useCreateElement){var a=n[w.ownerDocumentContextKey],i=a.createElement(this._currentElement.type);b.setAttributeForID(i,this._rootNodeID),w.getID(i),this._updateDOMProperties({},r,t,i),this._createInitialChildren(t,r,n,i),o=i}else{var u=this._createOpenTagMarkupAndPutListeners(t,r),l=this._createContentMarkup(t,r,n);o=!l&&G[this._tag]?u+"/>":u+">"+l+"</"+this._currentElement.type+">"}switch(this._tag){case"input":t.getReactMountReady().enqueue(d,this);case"button":case"select":case"textarea":r.autoFocus&&t.getReactMountReady().enqueue(g.focusDOMComponent,this)}return o},_createOpenTagMarkupAndPutListeners:function(e,t){var n="<"+this._currentElement.type;for(var r in t)if(t.hasOwnProperty(r)){var o=t[r];if(null!=o)if(W.hasOwnProperty(r))o&&l(this._rootNodeID,r,o,e);else{r===q&&(o&&(o=this._previousStyleCopy=k({},t.style)),o=y.createMarkupForStyles(o));var a=null;a=null!=this._tag&&v(this._tag,t)?b.createMarkupForCustomAttribute(r,o):b.createMarkupForProperty(r,o),a&&(n+=" "+a)}}if(e.renderToStaticMarkup)return n;var i=b.createMarkupForID(this._rootNodeID);return n+" "+i},_createContentMarkup:function(e,t,n){var r="",o=t.dangerouslySetInnerHTML;if(null!=o)null!=o.__html&&(r=o.__html);else{var a=K[typeof t.children]?t.children:null,i=null!=a?null:t.children;if(null!=a)r=A(a);else if(null!=i){var u=this.mountChildren(i,e,n);r=u.join("")}}return Q[this._tag]&&"\n"===r.charAt(0)?"\n"+r:r},_createInitialChildren:function(e,t,n,r){var o=t.dangerouslySetInnerHTML;if(null!=o)null!=o.__html&&F(r,o.__html);else{var a=K[typeof t.children]?t.children:null,i=null!=a?null:t.children;if(null!=a)B(r,a);else if(null!=i)for(var u=this.mountChildren(i,e,n),s=0;s<u.length;s++)r.appendChild(u[s])}},receiveComponent:function(e,t,n){var r=this._currentElement;this._currentElement=e,this.updateComponent(t,r,e,n)},updateComponent:function(e,t,n,r){var o=t.props,a=this._currentElement.props;switch(this._tag){case"button":o=D.getNativeProps(this,o),a=D.getNativeProps(this,a);break;case"input":P.updateWrapper(this),o=P.getNativeProps(this,o),a=P.getNativeProps(this,a);break;case"option":o=T.getNativeProps(this,o),a=T.getNativeProps(this,a);break;case"select":o=M.getNativeProps(this,o),a=M.getNativeProps(this,a);break;case"textarea":N.updateWrapper(this),o=N.getNativeProps(this,o),a=N.getNativeProps(this,a)}s(this,a),this._updateDOMProperties(o,a,e,null),this._updateDOMChildren(o,a,e,r),!O&&this._nodeWithLegacyProperties&&(this._nodeWithLegacyProperties.props=a),"select"===this._tag&&e.getReactMountReady().enqueue(f,this)},_updateDOMProperties:function(e,t,n,r){var o,a,i;for(o in e)if(!t.hasOwnProperty(o)&&e.hasOwnProperty(o))if(o===q){var u=this._previousStyleCopy;for(a in u)u.hasOwnProperty(a)&&(i=i||{},i[a]="");this._previousStyleCopy=null}else W.hasOwnProperty(o)?e[o]&&V(this._rootNodeID,o):(C.properties[o]||C.isCustomAttribute(o))&&(r||(r=w.getNode(this._rootNodeID)),b.deleteValueForProperty(r,o));for(o in t){var s=t[o],c=o===q?this._previousStyleCopy:e[o];if(t.hasOwnProperty(o)&&s!==c)if(o===q)if(s?s=this._previousStyleCopy=k({},s):this._previousStyleCopy=null,c){for(a in c)!c.hasOwnProperty(a)||s&&s.hasOwnProperty(a)||(i=i||{},i[a]="");for(a in s)s.hasOwnProperty(a)&&c[a]!==s[a]&&(i=i||{},i[a]=s[a])}else i=s;else W.hasOwnProperty(o)?s?l(this._rootNodeID,o,s,n):c&&V(this._rootNodeID,o):v(this._tag,t)?(r||(r=w.getNode(this._rootNodeID)),b.setValueForAttribute(r,o,s)):(C.properties[o]||C.isCustomAttribute(o))&&(r||(r=w.getNode(this._rootNodeID)),null!=s?b.setValueForProperty(r,o,s):b.deleteValueForProperty(r,o))}i&&(r||(r=w.getNode(this._rootNodeID)),y.setValueForStyles(r,i))},_updateDOMChildren:function(e,t,n,r){var o=K[typeof e.children]?e.children:null,a=K[typeof t.children]?t.children:null,i=e.dangerouslySetInnerHTML&&e.dangerouslySetInnerHTML.__html,u=t.dangerouslySetInnerHTML&&t.dangerouslySetInnerHTML.__html,s=null!=o?null:e.children,l=null!=a?null:t.children,c=null!=o||null!=i,p=null!=a||null!=u;null!=s&&null==l?this.updateChildren(null,n,r):c&&!p&&this.updateTextContent(""),null!=a?o!==a&&this.updateTextContent(""+a):null!=u?i!==u&&this.updateMarkup(""+u):null!=l&&this.updateChildren(l,n,r)},unmountComponent:function(){switch(this._tag){case"iframe":case"img":case"form":case"video":case"audio":var e=this._wrapperState.listeners;if(e)for(var t=0;t<e.length;t++)e[t].remove();break;case"input":P.unmountWrapper(this);break;case"html":case"head":case"body":L(!1)}if(this.unmountChildren(),_.deleteAllListeners(this._rootNodeID),x.unmountIDFromEnvironment(this._rootNodeID),this._rootNodeID=null,this._wrapperState=null,this._nodeWithLegacyProperties){var n=this._nodeWithLegacyProperties;n._reactInternalComponent=null,this._nodeWithLegacyProperties=null}},getPublicInstance:function(){if(!this._nodeWithLegacyProperties){var e=w.getNode(this._rootNodeID);e._reactInternalComponent=this,e.getDOMNode=r,e.isMounted=o,e.setState=a,e.replaceState=a,e.forceUpdate=a,e.setProps=i,e.replaceProps=u,e.props=this._currentElement.props,this._nodeWithLegacyProperties=e}return this._nodeWithLegacyProperties}},R.measureMethods(m,"ReactDOMComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent"}),k(m.prototype,m.Mixin,S.Mixin),t.exports=m},{10:10,11:11,114:114,118:118,130:130,135:135,136:136,141:141,15:15,158:158,163:163,166:166,168:168,2:2,24:24,28:28,35:35,41:41,46:46,47:47,48:48,5:5,52:52,70:70,71:71,76:76,92:92}],43:[function(e,t,n){"use strict";function r(e){return o.createFactory(e)}var o=e(55),a=(e(56),e(164)),i=a({a:"a",abbr:"abbr",address:"address",area:"area",article:"article",aside:"aside",audio:"audio",b:"b",base:"base",bdi:"bdi",bdo:"bdo",big:"big",blockquote:"blockquote",body:"body",br:"br",button:"button",canvas:"canvas",caption:"caption",cite:"cite",code:"code",col:"col",colgroup:"colgroup",data:"data",datalist:"datalist",dd:"dd",del:"del",details:"details",dfn:"dfn",dialog:"dialog",div:"div",dl:"dl",dt:"dt",em:"em",embed:"embed",fieldset:"fieldset",figcaption:"figcaption",figure:"figure",footer:"footer",form:"form",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",head:"head",header:"header",hgroup:"hgroup",hr:"hr",html:"html",i:"i",iframe:"iframe",img:"img",input:"input",ins:"ins",kbd:"kbd",keygen:"keygen",label:"label",legend:"legend",li:"li",link:"link",main:"main",map:"map",mark:"mark",menu:"menu",menuitem:"menuitem",meta:"meta",meter:"meter",nav:"nav",noscript:"noscript",object:"object",ol:"ol",optgroup:"optgroup",option:"option",output:"output",p:"p",param:"param",picture:"picture",pre:"pre",progress:"progress",q:"q",rp:"rp",rt:"rt",ruby:"ruby",s:"s",samp:"samp",script:"script",section:"section",select:"select",small:"small",source:"source",span:"span",strong:"strong",style:"style",sub:"sub",summary:"summary",sup:"sup",table:"table",tbody:"tbody",td:"td",textarea:"textarea",tfoot:"tfoot",th:"th",thead:"thead",time:"time",title:"title",tr:"tr",track:"track",u:"u",ul:"ul","var":"var",video:"video",wbr:"wbr",circle:"circle",clipPath:"clipPath",defs:"defs",ellipse:"ellipse",g:"g",image:"image",line:"line",linearGradient:"linearGradient",mask:"mask",path:"path",pattern:"pattern",polygon:"polygon",polyline:"polyline",radialGradient:"radialGradient",rect:"rect",stop:"stop",svg:"svg",text:"text",tspan:"tspan"},r);t.exports=i},{164:164,55:55,56:56}],44:[function(e,t,n){"use strict";var r={useCreateElement:!1};t.exports=r},{}],45:[function(e,t,n){"use strict";var r=e(9),o=e(11),a=e(70),i=e(76),u=e(158),s={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",
style:"`style` must be set using `updateStylesByID()`."},l={updatePropertyByID:function(e,t,n){var r=a.getNode(e);s.hasOwnProperty(t)?u(!1):void 0,null!=n?o.setValueForProperty(r,t,n):o.deleteValueForProperty(r,t)},dangerouslyReplaceNodeWithMarkupByID:function(e,t){var n=a.getNode(e);r.dangerouslyReplaceNodeWithMarkup(n,t)},dangerouslyProcessChildrenUpdates:function(e,t){for(var n=0;n<e.length;n++)e[n].parentNode=a.getNode(e[n].parentID);r.processUpdates(e,t)}};i.measureMethods(l,"ReactDOMIDOperations",{dangerouslyReplaceNodeWithMarkupByID:"dangerouslyReplaceNodeWithMarkupByID",dangerouslyProcessChildrenUpdates:"dangerouslyProcessChildrenUpdates"}),t.exports=l},{11:11,158:158,70:70,76:76,9:9}],46:[function(e,t,n){"use strict";function r(){this._rootNodeID&&d.updateWrapper(this)}function o(e){var t=this._currentElement.props,n=i.executeOnChange(t,e);s.asap(r,this);var o=t.name;if("radio"===t.type&&null!=o){for(var a=u.getNode(this._rootNodeID),l=a;l.parentNode;)l=l.parentNode;for(var d=l.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),f=0;f<d.length;f++){var h=d[f];if(h!==a&&h.form===a.form){var v=u.getID(h);v?void 0:c(!1);var m=p[v];m?void 0:c(!1),s.asap(r,m)}}}return n}var a=e(45),i=e(23),u=e(70),s=e(93),l=e(24),c=e(158),p={},d={getNativeProps:function(e,t,n){var r=i.getValue(t),o=i.getChecked(t),a=l({},t,{defaultChecked:void 0,defaultValue:void 0,value:null!=r?r:e._wrapperState.initialValue,checked:null!=o?o:e._wrapperState.initialChecked,onChange:e._wrapperState.onChange});return a},mountWrapper:function(e,t){var n=t.defaultValue;e._wrapperState={initialChecked:t.defaultChecked||!1,initialValue:null!=n?n:null,onChange:o.bind(e)}},mountReadyWrapper:function(e){p[e._rootNodeID]=e},unmountWrapper:function(e){delete p[e._rootNodeID]},updateWrapper:function(e){var t=e._currentElement.props,n=t.checked;null!=n&&a.updatePropertyByID(e._rootNodeID,"checked",n||!1);var r=i.getValue(t);null!=r&&a.updatePropertyByID(e._rootNodeID,"value",""+r)}};t.exports=d},{158:158,23:23,24:24,45:45,70:70,93:93}],47:[function(e,t,n){"use strict";var r=e(32),o=e(48),a=e(24),i=(e(168),o.valueContextKey),u={mountWrapper:function(e,t,n){var r=n[i],o=null;if(null!=r)if(o=!1,Array.isArray(r)){for(var a=0;a<r.length;a++)if(""+r[a]==""+t.value){o=!0;break}}else o=""+r==""+t.value;e._wrapperState={selected:o}},getNativeProps:function(e,t,n){var o=a({selected:void 0,children:void 0},t);null!=e._wrapperState.selected&&(o.selected=e._wrapperState.selected);var i="";return r.forEach(t.children,function(e){null!=e&&("string"==typeof e||"number"==typeof e)&&(i+=e)}),o.children=i,o}};t.exports=u},{168:168,24:24,32:32,48:48}],48:[function(e,t,n){"use strict";function r(){if(this._rootNodeID&&this._wrapperState.pendingUpdate){this._wrapperState.pendingUpdate=!1;var e=this._currentElement.props,t=i.getValue(e);null!=t&&o(this,e,t)}}function o(e,t,n){var r,o,a=u.getNode(e._rootNodeID).options;if(t){for(r={},o=0;o<n.length;o++)r[""+n[o]]=!0;for(o=0;o<a.length;o++){var i=r.hasOwnProperty(a[o].value);a[o].selected!==i&&(a[o].selected=i)}}else{for(r=""+n,o=0;o<a.length;o++)if(a[o].value===r)return void(a[o].selected=!0);a.length&&(a[0].selected=!0)}}function a(e){var t=this._currentElement.props,n=i.executeOnChange(t,e);return this._wrapperState.pendingUpdate=!0,s.asap(r,this),n}var i=e(23),u=e(70),s=e(93),l=e(24),c=(e(168),"__ReactDOMSelect_value$"+Math.random().toString(36).slice(2)),p={valueContextKey:c,getNativeProps:function(e,t,n){return l({},t,{onChange:e._wrapperState.onChange,value:void 0})},mountWrapper:function(e,t){var n=i.getValue(t);e._wrapperState={pendingUpdate:!1,initialValue:null!=n?n:t.defaultValue,onChange:a.bind(e),wasMultiple:Boolean(t.multiple)}},processChildContext:function(e,t,n){var r=l({},n);return r[c]=e._wrapperState.initialValue,r},postUpdateWrapper:function(e){var t=e._currentElement.props;e._wrapperState.initialValue=void 0;var n=e._wrapperState.wasMultiple;e._wrapperState.wasMultiple=Boolean(t.multiple);var r=i.getValue(t);null!=r?(e._wrapperState.pendingUpdate=!1,o(e,Boolean(t.multiple),r)):n!==Boolean(t.multiple)&&(null!=t.defaultValue?o(e,Boolean(t.multiple),t.defaultValue):o(e,Boolean(t.multiple),t.multiple?[]:""))}};t.exports=p},{168:168,23:23,24:24,70:70,93:93}],49:[function(e,t,n){"use strict";function r(e,t,n,r){return e===n&&t===r}function o(e){var t=document.selection,n=t.createRange(),r=n.text.length,o=n.duplicate();o.moveToElementText(e),o.setEndPoint("EndToStart",n);var a=o.text.length,i=a+r;return{start:a,end:i}}function a(e){var t=window.getSelection&&window.getSelection();if(!t||0===t.rangeCount)return null;var n=t.anchorNode,o=t.anchorOffset,a=t.focusNode,i=t.focusOffset,u=t.getRangeAt(0);try{u.startContainer.nodeType,u.endContainer.nodeType}catch(s){return null}var l=r(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),c=l?0:u.toString().length,p=u.cloneRange();p.selectNodeContents(e),p.setEnd(u.startContainer,u.startOffset);var d=r(p.startContainer,p.startOffset,p.endContainer,p.endOffset),f=d?0:p.toString().length,h=f+c,v=document.createRange();v.setStart(n,o),v.setEnd(a,i);var m=v.collapsed;return{start:m?h:f,end:m?f:h}}function i(e,t){var n,r,o=document.selection.createRange().duplicate();"undefined"==typeof t.end?(n=t.start,r=n):t.start>t.end?(n=t.end,r=t.start):(n=t.start,r=t.end),o.moveToElementText(e),o.moveStart("character",n),o.setEndPoint("EndToStart",o),o.moveEnd("character",r-n),o.select()}function u(e,t){if(window.getSelection){var n=window.getSelection(),r=e[c()].length,o=Math.min(t.start,r),a="undefined"==typeof t.end?o:Math.min(t.end,r);if(!n.extend&&o>a){var i=a;a=o,o=i}var u=l(e,o),s=l(e,a);if(u&&s){var p=document.createRange();p.setStart(u.node,u.offset),n.removeAllRanges(),o>a?(n.addRange(p),n.extend(s.node,s.offset)):(p.setEnd(s.node,s.offset),n.addRange(p))}}}var s=e(144),l=e(127),c=e(128),p=s.canUseDOM&&"selection"in document&&!("getSelection"in window),d={getOffsets:p?o:a,setOffsets:p?i:u};t.exports=d},{127:127,128:128,144:144}],50:[function(e,t,n){"use strict";var r=e(54),o=e(86),a=e(94);r.inject();var i={renderToString:o.renderToString,renderToStaticMarkup:o.renderToStaticMarkup,version:a};t.exports=i},{54:54,86:86,94:94}],51:[function(e,t,n){"use strict";var r=e(9),o=e(11),a=e(35),i=e(70),u=e(24),s=e(118),l=e(136),c=(e(141),function(e){});u(c.prototype,{construct:function(e){this._currentElement=e,this._stringText=""+e,this._rootNodeID=null,this._mountIndex=0},mountComponent:function(e,t,n){if(this._rootNodeID=e,t.useCreateElement){var r=n[i.ownerDocumentContextKey],a=r.createElement("span");return o.setAttributeForID(a,e),i.getID(a),l(a,this._stringText),a}var u=s(this._stringText);return t.renderToStaticMarkup?u:"<span "+o.createMarkupForID(e)+">"+u+"</span>"},receiveComponent:function(e,t){if(e!==this._currentElement){this._currentElement=e;var n=""+e;if(n!==this._stringText){this._stringText=n;var o=i.getNode(this._rootNodeID);r.updateTextContent(o,n)}}},unmountComponent:function(){a.unmountIDFromEnvironment(this._rootNodeID)}}),t.exports=c},{11:11,118:118,136:136,141:141,24:24,35:35,70:70,9:9}],52:[function(e,t,n){"use strict";function r(){this._rootNodeID&&c.updateWrapper(this)}function o(e){var t=this._currentElement.props,n=a.executeOnChange(t,e);return u.asap(r,this),n}var a=e(23),i=e(45),u=e(93),s=e(24),l=e(158),c=(e(168),{getNativeProps:function(e,t,n){null!=t.dangerouslySetInnerHTML?l(!1):void 0;var r=s({},t,{defaultValue:void 0,value:void 0,children:e._wrapperState.initialValue,onChange:e._wrapperState.onChange});return r},mountWrapper:function(e,t){var n=t.defaultValue,r=t.children;null!=r&&(null!=n?l(!1):void 0,Array.isArray(r)&&(r.length<=1?void 0:l(!1),r=r[0]),n=""+r),null==n&&(n="");var i=a.getValue(t);e._wrapperState={initialValue:""+(null!=i?i:n),onChange:o.bind(e)}},updateWrapper:function(e){var t=e._currentElement.props,n=a.getValue(t);null!=n&&i.updatePropertyByID(e._rootNodeID,"value",""+n)}});t.exports=c},{158:158,168:168,23:23,24:24,45:45,93:93}],53:[function(e,t,n){"use strict";function r(){this.reinitializeTransaction()}var o=e(93),a=e(110),i=e(24),u=e(150),s={initialize:u,close:function(){d.isBatchingUpdates=!1}},l={initialize:u,close:o.flushBatchedUpdates.bind(o)},c=[l,s];i(r.prototype,a.Mixin,{getTransactionWrappers:function(){return c}});var p=new r,d={isBatchingUpdates:!1,batchedUpdates:function(e,t,n,r,o,a){var i=d.isBatchingUpdates;d.isBatchingUpdates=!0,i?e(t,n,r,o,a):p.perform(e,null,t,n,r,o,a)}};t.exports=d},{110:110,150:150,24:24,93:93}],54:[function(e,t,n){"use strict";function r(){P||(P=!0,g.EventEmitter.injectReactEventListener(m),g.EventPluginHub.injectEventPluginOrder(u),g.EventPluginHub.injectInstanceHandle(y),g.EventPluginHub.injectMount(C),g.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:x,EnterLeaveEventPlugin:s,ChangeEventPlugin:a,SelectEventPlugin:E,BeforeInputEventPlugin:o}),g.NativeComponent.injectGenericComponentClass(h),g.NativeComponent.injectTextComponentClass(v),g.Class.injectMixin(p),g.DOMProperty.injectDOMPropertyConfig(c),g.DOMProperty.injectDOMPropertyConfig(D),g.EmptyComponent.injectEmptyComponent("noscript"),g.Updates.injectReconcileTransaction(b),g.Updates.injectBatchingStrategy(f),g.RootIndex.injectCreateReactRootIndex(l.canUseDOM?i.createReactRootIndex:_.createReactRootIndex),g.Component.injectEnvironment(d))}var o=e(3),a=e(7),i=e(8),u=e(13),s=e(14),l=e(144),c=e(21),p=e(27),d=e(35),f=e(53),h=e(42),v=e(51),m=e(61),g=e(63),y=e(65),C=e(70),b=e(81),E=e(96),_=e(97),x=e(98),D=e(95),P=!1;t.exports={inject:r}},{13:13,14:14,144:144,21:21,27:27,3:3,35:35,42:42,51:51,53:53,61:61,63:63,65:65,7:7,70:70,8:8,81:81,95:95,96:96,97:97,98:98}],55:[function(e,t,n){"use strict";var r=e(39),o=e(24),a=(e(114),"function"==typeof Symbol&&Symbol["for"]&&Symbol["for"]("react.element")||60103),i={key:!0,ref:!0,__self:!0,__source:!0},u=function(e,t,n,r,o,i,u){var s={$$typeof:a,type:e,key:t,ref:n,props:u,_owner:i};return s};u.createElement=function(e,t,n){var o,a={},s=null,l=null,c=null,p=null;if(null!=t){l=void 0===t.ref?null:t.ref,s=void 0===t.key?null:""+t.key,c=void 0===t.__self?null:t.__self,p=void 0===t.__source?null:t.__source;for(o in t)t.hasOwnProperty(o)&&!i.hasOwnProperty(o)&&(a[o]=t[o])}var d=arguments.length-2;if(1===d)a.children=n;else if(d>1){for(var f=Array(d),h=0;d>h;h++)f[h]=arguments[h+2];a.children=f}if(e&&e.defaultProps){var v=e.defaultProps;for(o in v)"undefined"==typeof a[o]&&(a[o]=v[o])}return u(e,s,l,c,p,r.current,a)},u.createFactory=function(e){var t=u.createElement.bind(null,e);return t.type=e,t},u.cloneAndReplaceKey=function(e,t){var n=u(e.type,t,e.ref,e._self,e._source,e._owner,e.props);return n},u.cloneAndReplaceProps=function(e,t){var n=u(e.type,e.key,e.ref,e._self,e._source,e._owner,t);return n},u.cloneElement=function(e,t,n){var a,s=o({},e.props),l=e.key,c=e.ref,p=e._self,d=e._source,f=e._owner;if(null!=t){void 0!==t.ref&&(c=t.ref,f=r.current),void 0!==t.key&&(l=""+t.key);for(a in t)t.hasOwnProperty(a)&&!i.hasOwnProperty(a)&&(s[a]=t[a])}var h=arguments.length-2;if(1===h)s.children=n;else if(h>1){for(var v=Array(h),m=0;h>m;m++)v[m]=arguments[m+2];s.children=v}return u(e.type,l,c,p,d,f,s)},u.isValidElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===a},t.exports=u},{114:114,24:24,39:39}],56:[function(e,t,n){"use strict";function r(){if(p.current){var e=p.current.getName();if(e)return" Check the render method of `"+e+"`."}return""}function o(e,t){e._store&&!e._store.validated&&null==e.key&&(e._store.validated=!0,a("uniqueKey",e,t))}function a(e,t,n){var o=r();if(!o){var a="string"==typeof n?n:n.displayName||n.name;a&&(o=" Check the top-level render call using <"+a+">.")}var i=h[e]||(h[e]={});if(i[o])return null;i[o]=!0;var u={parentOrOwner:o,url:" See https://fb.me/react-warning-keys for more information.",childOwner:null};return t&&t._owner&&t._owner!==p.current&&(u.childOwner=" It was passed a child from "+t._owner.getName()+"."),u}function i(e,t){if("object"==typeof e)if(Array.isArray(e))for(var n=0;n<e.length;n++){var r=e[n];l.isValidElement(r)&&o(r,t)}else if(l.isValidElement(e))e._store&&(e._store.validated=!0);else if(e){var a=d(e);if(a&&a!==e.entries)for(var i,u=a.call(e);!(i=u.next()).done;)l.isValidElement(i.value)&&o(i.value,t)}}function u(e,t,n,o){for(var a in t)if(t.hasOwnProperty(a)){var i;try{"function"!=typeof t[a]?f(!1):void 0,i=t[a](n,a,e,o)}catch(u){i=u}i instanceof Error&&!(i.message in v)&&(v[i.message]=!0,r())}}function s(e){var t=e.type;if("function"==typeof t){var n=t.displayName||t.name;t.propTypes&&u(n,t.propTypes,e.props,c.prop),"function"==typeof t.getDefaultProps}}var l=e(55),c=e(79),p=(e(78),e(39)),d=(e(114),e(126)),f=e(158),h=(e(168),{}),v={},m={createElement:function(e,t,n){var r="string"==typeof e||"function"==typeof e,o=l.createElement.apply(this,arguments);if(null==o)return o;if(r)for(var a=2;a<arguments.length;a++)i(arguments[a],e);return s(o),o},createFactory:function(e){var t=m.createElement.bind(null,e);return t.type=e,t},cloneElement:function(e,t,n){for(var r=l.cloneElement.apply(this,arguments),o=2;o<arguments.length;o++)i(arguments[o],r.type);return s(r),r}};t.exports=m},{114:114,126:126,158:158,168:168,39:39,55:55,78:78,79:79}],57:[function(e,t,n){"use strict";var r,o=e(55),a=e(58),i=e(82),u=e(24),s={injectEmptyComponent:function(e){r=o.createElement(e)}},l=function(e){this._currentElement=null,this._rootNodeID=null,this._renderedComponent=e(r)};u(l.prototype,{construct:function(e){},mountComponent:function(e,t,n){return a.registerNullComponentID(e),this._rootNodeID=e,i.mountComponent(this._renderedComponent,e,t,n)},receiveComponent:function(){},unmountComponent:function(e,t,n){i.unmountComponent(this._renderedComponent),a.deregisterNullComponentID(this._rootNodeID),this._rootNodeID=null,this._renderedComponent=null}}),l.injection=s,t.exports=l},{24:24,55:55,58:58,82:82}],58:[function(e,t,n){"use strict";function r(e){return!!i[e]}function o(e){i[e]=!0}function a(e){delete i[e]}var i={},u={isNullComponentID:r,registerNullComponentID:o,deregisterNullComponentID:a};t.exports=u},{}],59:[function(e,t,n){"use strict";function r(e,t,n,r){try{return t(n,r)}catch(a){return void(null===o&&(o=a))}}var o=null,a={invokeGuardedCallback:r,invokeGuardedCallbackWithCatch:r,rethrowCaughtError:function(){if(o){var e=o;throw o=null,e}}};t.exports=a},{}],60:[function(e,t,n){"use strict";function r(e){o.enqueueEvents(e),o.processEventQueue(!1)}var o=e(16),a={handleTopLevel:function(e,t,n,a,i){var u=o.extractEvents(e,t,n,a,i);r(u)}};t.exports=a},{16:16}],61:[function(e,t,n){"use strict";function r(e){var t=d.getID(e),n=p.getReactRootIDFromNodeID(t),r=d.findReactContainerForID(n),o=d.getFirstReactDOM(r);return o}function o(e,t){this.topLevelType=e,this.nativeEvent=t,this.ancestors=[]}function a(e){i(e)}function i(e){for(var t=d.getFirstReactDOM(v(e.nativeEvent))||window,n=t;n;)e.ancestors.push(n),n=r(n);for(var o=0;o<e.ancestors.length;o++){t=e.ancestors[o];var a=d.getID(t)||"";g._handleTopLevel(e.topLevelType,t,a,e.nativeEvent,v(e.nativeEvent))}}function u(e){var t=m(window);e(t)}var s=e(143),l=e(144),c=e(25),p=e(65),d=e(70),f=e(93),h=e(24),v=e(125),m=e(155);h(o.prototype,{destructor:function(){this.topLevelType=null,this.nativeEvent=null,this.ancestors.length=0}}),c.addPoolingTo(o,c.twoArgumentPooler);var g={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:l.canUseDOM?window:null,setHandleTopLevel:function(e){g._handleTopLevel=e},setEnabled:function(e){g._enabled=!!e},isEnabled:function(){return g._enabled},trapBubbledEvent:function(e,t,n){var r=n;return r?s.listen(r,t,g.dispatchEvent.bind(null,e)):null},trapCapturedEvent:function(e,t,n){var r=n;return r?s.capture(r,t,g.dispatchEvent.bind(null,e)):null},monitorScrollValue:function(e){var t=u.bind(null,e);s.listen(window,"scroll",t)},dispatchEvent:function(e,t){if(g._enabled){var n=o.getPooled(e,t);try{f.batchedUpdates(a,n)}finally{o.release(n)}}}};t.exports=g},{125:125,143:143,144:144,155:155,24:24,25:25,65:65,70:70,93:93}],62:[function(e,t,n){"use strict";var r=e(32),o=e(55),a=e(150),i=e(158),u=(e(168),{create:function(e){if("object"!=typeof e||!e||Array.isArray(e))return e;if(o.isValidElement(e))return e;1===e.nodeType?i(!1):void 0;var t=[];for(var n in e)r.mapIntoWithKeyPrefixInternal(e[n],t,n,a.thatReturnsArgument);return t}});t.exports=u},{150:150,158:158,168:168,32:32,55:55}],63:[function(e,t,n){"use strict";var r=e(10),o=e(16),a=e(36),i=e(33),u=e(57),s=e(28),l=e(73),c=e(76),p=e(84),d=e(93),f={Component:a.injection,Class:i.injection,DOMProperty:r.injection,EmptyComponent:u.injection,EventPluginHub:o.injection,EventEmitter:s.injection,NativeComponent:l.injection,Perf:c.injection,RootIndex:p.injection,Updates:d.injection};t.exports=f},{10:10,16:16,28:28,33:33,36:36,57:57,73:73,76:76,84:84,93:93}],64:[function(e,t,n){"use strict";function r(e){return a(document.documentElement,e)}var o=e(49),a=e(147),i=e(152),u=e(153),s={hasSelectionCapabilities:function(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&"text"===e.type||"textarea"===t||"true"===e.contentEditable)},getSelectionInformation:function(){var e=u();return{focusedElem:e,selectionRange:s.hasSelectionCapabilities(e)?s.getSelection(e):null}},restoreSelection:function(e){var t=u(),n=e.focusedElem,o=e.selectionRange;t!==n&&r(n)&&(s.hasSelectionCapabilities(n)&&s.setSelection(n,o),i(n))},getSelection:function(e){var t;if("selectionStart"in e)t={start:e.selectionStart,end:e.selectionEnd};else if(document.selection&&e.nodeName&&"input"===e.nodeName.toLowerCase()){var n=document.selection.createRange();n.parentElement()===e&&(t={start:-n.moveStart("character",-e.value.length),end:-n.moveEnd("character",-e.value.length)})}else t=o.getOffsets(e);return t||{start:0,end:0}},setSelection:function(e,t){var n=t.start,r=t.end;if("undefined"==typeof r&&(r=n),"selectionStart"in e)e.selectionStart=n,e.selectionEnd=Math.min(r,e.value.length);else if(document.selection&&e.nodeName&&"input"===e.nodeName.toLowerCase()){var a=e.createTextRange();a.collapse(!0),a.moveStart("character",n),a.moveEnd("character",r-n),a.select()}else o.setOffsets(e,t)}};t.exports=s},{147:147,152:152,153:153,49:49}],65:[function(e,t,n){"use strict";function r(e){return f+e.toString(36)}function o(e,t){return e.charAt(t)===f||t===e.length}function a(e){return""===e||e.charAt(0)===f&&e.charAt(e.length-1)!==f}function i(e,t){return 0===t.indexOf(e)&&o(t,e.length)}function u(e){return e?e.substr(0,e.lastIndexOf(f)):""}function s(e,t){if(a(e)&&a(t)?void 0:d(!1),i(e,t)?void 0:d(!1),e===t)return e;var n,r=e.length+h;for(n=r;n<t.length&&!o(t,n);n++);return t.substr(0,n)}function l(e,t){var n=Math.min(e.length,t.length);if(0===n)return"";for(var r=0,i=0;n>=i;i++)if(o(e,i)&&o(t,i))r=i;else if(e.charAt(i)!==t.charAt(i))break;var u=e.substr(0,r);return a(u)?void 0:d(!1),u}function c(e,t,n,r,o,a){e=e||"",t=t||"",e===t?d(!1):void 0;var l=i(t,e);l||i(e,t)?void 0:d(!1);for(var c=0,p=l?u:s,f=e;;f=p(f,t)){var h;if(o&&f===e||a&&f===t||(h=n(f,l,r)),h===!1||f===t)break;c++<v?void 0:d(!1)}}var p=e(84),d=e(158),f=".",h=f.length,v=1e4,m={createReactRootID:function(){return r(p.createReactRootIndex())},createReactID:function(e,t){return e+t},getReactRootIDFromNodeID:function(e){if(e&&e.charAt(0)===f&&e.length>1){var t=e.indexOf(f,1);return t>-1?e.substr(0,t):e}return null},traverseEnterLeave:function(e,t,n,r,o){var a=l(e,t);a!==e&&c(e,a,n,r,!1,!0),a!==t&&c(a,t,n,o,!0,!1)},traverseTwoPhase:function(e,t,n){e&&(c("",e,t,n,!0,!1),c(e,"",t,n,!1,!0))},traverseTwoPhaseSkipTarget:function(e,t,n){e&&(c("",e,t,n,!0,!0),c(e,"",t,n,!0,!0))},traverseAncestors:function(e,t,n){c("",e,t,n,!0,!1)},getFirstCommonAncestorID:l,_getNextDescendantID:s,isAncestorIDOf:i,SEPARATOR:f};t.exports=m},{158:158,84:84}],66:[function(e,t,n){"use strict";var r={remove:function(e){e._reactInternalInstance=void 0},get:function(e){return e._reactInternalInstance},has:function(e){return void 0!==e._reactInternalInstance},set:function(e,t){e._reactInternalInstance=t}};t.exports=r},{}],67:[function(e,t,n){"use strict";var r=e(32),o=e(34),a=e(33),i=e(43),u=e(55),s=(e(56),e(80)),l=e(94),c=e(24),p=e(132),d=u.createElement,f=u.createFactory,h=u.cloneElement,v={Children:{map:r.map,forEach:r.forEach,count:r.count,toArray:r.toArray,only:p},Component:o,createElement:d,cloneElement:h,isValidElement:u.isValidElement,PropTypes:s,createClass:a.createClass,createFactory:f,createMixin:function(e){return e},DOM:i,version:l,__spread:c};t.exports=v},{132:132,24:24,32:32,33:33,34:34,43:43,55:55,56:56,80:80,94:94}],68:[function(e,t,n){"use strict";function r(e,t){this.value=e,this.requestChange=t}function o(e){var t={value:"undefined"==typeof e?a.PropTypes.any.isRequired:e.isRequired,requestChange:a.PropTypes.func.isRequired};return a.PropTypes.shape(t)}var a=e(26);r.PropTypes={link:o},t.exports=r},{26:26}],69:[function(e,t,n){"use strict";var r=e(113),o=/\/?>/,a={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(e){var t=r(e);return e.replace(o," "+a.CHECKSUM_ATTR_NAME+'="'+t+'"$&')},canReuseMarkup:function(e,t){var n=t.getAttribute(a.CHECKSUM_ATTR_NAME);n=n&&parseInt(n,10);var o=r(e);return o===n}};t.exports=a},{113:113}],70:[function(e,t,n){"use strict";function r(e,t){for(var n=Math.min(e.length,t.length),r=0;n>r;r++)if(e.charAt(r)!==t.charAt(r))return r;return e.length===t.length?-1:n}function o(e){return e?e.nodeType===W?e.documentElement:e.firstChild:null}function a(e){var t=o(e);return t&&X.getID(t)}function i(e){var t=u(e);if(t)if(V.hasOwnProperty(t)){var n=V[t];n!==e&&(p(n,t)?L(!1):void 0,V[t]=e)}else V[t]=e;return t}function u(e){return e&&e.getAttribute&&e.getAttribute(B)||""}function s(e,t){var n=u(e);n!==t&&delete V[n],e.setAttribute(B,t),V[t]=e}function l(e){return V.hasOwnProperty(e)&&p(V[e],e)||(V[e]=X.findReactNodeByID(e)),V[e]}function c(e){var t=T.get(e)._rootNodeID;return D.isNullComponentID(t)?null:(V.hasOwnProperty(t)&&p(V[t],t)||(V[t]=X.findReactNodeByID(t)),V[t])}function p(e,t){if(e){u(e)!==t?L(!1):void 0;var n=X.findReactContainerForID(t);if(n&&O(n,e))return!0}return!1}function d(e){delete V[e]}function f(e){var t=V[e];return t&&p(t,e)?void(G=t):!1}function h(e){G=null,P.traverseAncestors(e,f);var t=G;return G=null,t}function v(e,t,n,r,o,a){_.useCreateElement&&(a=I({},a),n.nodeType===W?a[q]=n:a[q]=n.ownerDocument);var i=w.mountComponent(e,t,r,a);e._renderedComponent._topLevelWrapper=e,X._mountImageIntoNode(i,n,o,r)}function m(e,t,n,r,o){var a=R.ReactReconcileTransaction.getPooled(r);a.perform(v,null,e,t,n,a,r,o),R.ReactReconcileTransaction.release(a)}function g(e,t){for(w.unmountComponent(e),t.nodeType===W&&(t=t.documentElement);t.lastChild;)t.removeChild(t.lastChild)}function y(e){var t=a(e);return t?t!==P.getReactRootIDFromNodeID(t):!1}function C(e){for(;e&&e.parentNode!==e;e=e.parentNode)if(1===e.nodeType){var t=u(e);if(t){var n,r=P.getReactRootIDFromNodeID(t),o=e;do if(n=u(o),o=o.parentNode,null==o)return null;while(n!==r);if(o===z[r])return e}}return null}var b=e(10),E=e(28),_=(e(39),e(44)),x=e(55),D=e(58),P=e(65),T=e(66),M=e(69),N=e(76),w=e(82),S=e(92),R=e(93),I=e(24),k=e(151),O=e(147),A=e(129),L=e(158),U=e(135),F=e(138),B=(e(141),e(168),b.ID_ATTRIBUTE_NAME),V={},j=1,W=9,K=11,q="__ReactMount_ownerDocument$"+Math.random().toString(36).slice(2),H={},z={},Y=[],G=null,Q=function(){};Q.prototype.isReactComponent={},Q.prototype.render=function(){return this.props};var X={TopLevelWrapper:Q,_instancesByReactRootID:H,scrollMonitor:function(e,t){t()},_updateRootComponent:function(e,t,n,r){return X.scrollMonitor(n,function(){S.enqueueElementInternal(e,t),r&&S.enqueueCallbackInternal(e,r)}),e},_registerComponent:function(e,t){!t||t.nodeType!==j&&t.nodeType!==W&&t.nodeType!==K?L(!1):void 0,E.ensureScrollValueMonitoring();var n=X.registerContainer(t);return H[n]=e,n},_renderNewRootComponent:function(e,t,n,r){var o=A(e,null),a=X._registerComponent(o,t);return R.batchedUpdates(m,o,a,t,n,r),o},renderSubtreeIntoContainer:function(e,t,n,r){return null==e||null==e._reactInternalInstance?L(!1):void 0,X._renderSubtreeIntoContainer(e,t,n,r)},_renderSubtreeIntoContainer:function(e,t,n,r){x.isValidElement(t)?void 0:L(!1);var i=new x(Q,null,null,null,null,null,t),s=H[a(n)];if(s){var l=s._currentElement,c=l.props;if(F(c,t)){var p=s._renderedComponent.getPublicInstance(),d=r&&function(){r.call(p)};return X._updateRootComponent(s,i,n,d),p}X.unmountComponentAtNode(n)}var f=o(n),h=f&&!!u(f),v=y(n),m=h&&!s&&!v,g=X._renderNewRootComponent(i,n,m,null!=e?e._reactInternalInstance._processChildContext(e._reactInternalInstance._context):k)._renderedComponent.getPublicInstance();return r&&r.call(g),g},render:function(e,t,n){return X._renderSubtreeIntoContainer(null,e,t,n)},registerContainer:function(e){var t=a(e);return t&&(t=P.getReactRootIDFromNodeID(t)),t||(t=P.createReactRootID()),z[t]=e,t},unmountComponentAtNode:function(e){!e||e.nodeType!==j&&e.nodeType!==W&&e.nodeType!==K?L(!1):void 0;var t=a(e),n=H[t];if(!n){var r=(y(e),u(e));return r&&r===P.getReactRootIDFromNodeID(r),!1}return R.batchedUpdates(g,n,e),delete H[t],delete z[t],!0},findReactContainerForID:function(e){var t=P.getReactRootIDFromNodeID(e),n=z[t];return n},findReactNodeByID:function(e){var t=X.findReactContainerForID(e);return X.findComponentRoot(t,e)},getFirstReactDOM:function(e){return C(e)},findComponentRoot:function(e,t){var n=Y,r=0,o=h(t)||e;for(n[0]=o.firstChild,n.length=1;r<n.length;){for(var a,i=n[r++];i;){var u=X.getID(i);u?t===u?a=i:P.isAncestorIDOf(u,t)&&(n.length=r=0,n.push(i.firstChild)):n.push(i.firstChild),i=i.nextSibling}if(a)return n.length=0,a}n.length=0,L(!1)},_mountImageIntoNode:function(e,t,n,a){if(!t||t.nodeType!==j&&t.nodeType!==W&&t.nodeType!==K?L(!1):void 0,n){var i=o(t);if(M.canReuseMarkup(e,i))return;var u=i.getAttribute(M.CHECKSUM_ATTR_NAME);i.removeAttribute(M.CHECKSUM_ATTR_NAME);var s=i.outerHTML;i.setAttribute(M.CHECKSUM_ATTR_NAME,u);var l=e,c=r(l,s);" (client) "+l.substring(c-20,c+20)+"\n (server) "+s.substring(c-20,c+20),t.nodeType===W?L(!1):void 0}if(t.nodeType===W?L(!1):void 0,a.useCreateElement){for(;t.lastChild;)t.removeChild(t.lastChild);t.appendChild(e)}else U(t,e)},ownerDocumentContextKey:q,getReactRootID:a,getID:i,setID:s,getNode:l,getNodeFromInstance:c,isValid:p,purgeID:d};N.measureMethods(X,"ReactMount",{_renderNewRootComponent:"_renderNewRootComponent",_mountImageIntoNode:"_mountImageIntoNode"}),t.exports=X},{10:10,129:129,135:135,138:138,141:141,147:147,151:151,158:158,168:168,24:24,28:28,39:39,44:44,55:55,58:58,65:65,66:66,69:69,76:76,82:82,92:92,93:93}],71:[function(e,t,n){"use strict";function r(e,t,n){m.push({parentID:e,parentNode:null,type:p.INSERT_MARKUP,markupIndex:g.push(t)-1,content:null,fromIndex:null,toIndex:n})}function o(e,t,n){m.push({parentID:e,parentNode:null,type:p.MOVE_EXISTING,markupIndex:null,content:null,fromIndex:t,toIndex:n})}function a(e,t){m.push({parentID:e,parentNode:null,type:p.REMOVE_NODE,markupIndex:null,content:null,fromIndex:t,toIndex:null})}function i(e,t){m.push({parentID:e,parentNode:null,type:p.SET_MARKUP,markupIndex:null,content:t,fromIndex:null,toIndex:null})}function u(e,t){m.push({parentID:e,parentNode:null,type:p.TEXT_CONTENT,markupIndex:null,content:t,fromIndex:null,toIndex:null})}function s(){m.length&&(c.processChildrenUpdates(m,g),l())}function l(){m.length=0,g.length=0}var c=e(36),p=e(72),d=(e(39),e(82)),f=e(31),h=e(120),v=0,m=[],g=[],y={Mixin:{_reconcilerInstantiateChildren:function(e,t,n){return f.instantiateChildren(e,t,n)},_reconcilerUpdateChildren:function(e,t,n,r){var o;return o=h(t),f.updateChildren(e,o,n,r)},mountChildren:function(e,t,n){var r=this._reconcilerInstantiateChildren(e,t,n);this._renderedChildren=r;var o=[],a=0;for(var i in r)if(r.hasOwnProperty(i)){var u=r[i],s=this._rootNodeID+i,l=d.mountComponent(u,s,t,n);u._mountIndex=a++,o.push(l)}return o},updateTextContent:function(e){v++;var t=!0;try{var n=this._renderedChildren;f.unmountChildren(n);for(var r in n)n.hasOwnProperty(r)&&this._unmountChild(n[r]);this.setTextContent(e),t=!1}finally{v--,v||(t?l():s())}},updateMarkup:function(e){v++;var t=!0;try{var n=this._renderedChildren;f.unmountChildren(n);for(var r in n)n.hasOwnProperty(r)&&this._unmountChildByName(n[r],r);this.setMarkup(e),t=!1}finally{v--,v||(t?l():s())}},updateChildren:function(e,t,n){v++;var r=!0;try{this._updateChildren(e,t,n),r=!1}finally{v--,v||(r?l():s())}},_updateChildren:function(e,t,n){var r=this._renderedChildren,o=this._reconcilerUpdateChildren(r,e,t,n);if(this._renderedChildren=o,o||r){var a,i=0,u=0;for(a in o)if(o.hasOwnProperty(a)){var s=r&&r[a],l=o[a];s===l?(this.moveChild(s,u,i),i=Math.max(s._mountIndex,i),s._mountIndex=u):(s&&(i=Math.max(s._mountIndex,i),this._unmountChild(s)),this._mountChildByNameAtIndex(l,a,u,t,n)),u++}for(a in r)!r.hasOwnProperty(a)||o&&o.hasOwnProperty(a)||this._unmountChild(r[a])}},unmountChildren:function(){var e=this._renderedChildren;f.unmountChildren(e),this._renderedChildren=null},moveChild:function(e,t,n){e._mountIndex<n&&o(this._rootNodeID,e._mountIndex,t)},createChild:function(e,t){r(this._rootNodeID,t,e._mountIndex)},removeChild:function(e){a(this._rootNodeID,e._mountIndex)},setTextContent:function(e){u(this._rootNodeID,e)},setMarkup:function(e){i(this._rootNodeID,e)},_mountChildByNameAtIndex:function(e,t,n,r,o){var a=this._rootNodeID+t,i=d.mountComponent(e,a,r,o);e._mountIndex=n,this.createChild(e,i)},_unmountChild:function(e){this.removeChild(e),e._mountIndex=null}}};t.exports=y},{120:120,31:31,36:36,39:39,72:72,82:82}],72:[function(e,t,n){"use strict";var r=e(162),o=r({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,SET_MARKUP:null,TEXT_CONTENT:null});t.exports=o},{162:162}],73:[function(e,t,n){"use strict";function r(e){if("function"==typeof e.type)return e.type;var t=e.type,n=p[t];return null==n&&(p[t]=n=l(t)),n}function o(e){return c?void 0:s(!1),new c(e.type,e.props)}function a(e){return new d(e)}function i(e){return e instanceof d}var u=e(24),s=e(158),l=null,c=null,p={},d=null,f={injectGenericComponentClass:function(e){c=e},injectTextComponentClass:function(e){d=e},injectComponentClasses:function(e){u(p,e)}},h={getComponentClassForElement:r,createInternalComponent:o,createInstanceForText:a,isTextComponent:i,injection:f};t.exports=h},{158:158,24:24}],74:[function(e,t,n){"use strict";function r(e,t){}var o=(e(168),{isMounted:function(e){return!1},enqueueCallback:function(e,t){},enqueueForceUpdate:function(e){r(e,"forceUpdate")},enqueueReplaceState:function(e,t){r(e,"replaceState")},enqueueSetState:function(e,t){r(e,"setState")},enqueueSetProps:function(e,t){r(e,"setProps")},enqueueReplaceProps:function(e,t){r(e,"replaceProps")}});t.exports=o},{168:168}],75:[function(e,t,n){"use strict";var r=e(158),o={isValidOwner:function(e){return!(!e||"function"!=typeof e.attachRef||"function"!=typeof e.detachRef)},addComponentAsRefTo:function(e,t,n){o.isValidOwner(n)?void 0:r(!1),n.attachRef(t,e)},removeComponentAsRefFrom:function(e,t,n){o.isValidOwner(n)?void 0:r(!1),n.getPublicInstance().refs[t]===e.getPublicInstance()&&n.detachRef(t)}};t.exports=o},{158:158}],76:[function(e,t,n){"use strict";function r(e,t,n){return n}var o={enableMeasure:!1,storedMeasure:r,measureMethods:function(e,t,n){},measure:function(e,t,n){return n},injection:{injectMeasure:function(e){o.storedMeasure=e}}};t.exports=o},{}],77:[function(e,t,n){"use strict";function r(e){return function(t,n,r){t.hasOwnProperty(n)?t[n]=e(t[n],r):t[n]=r}}function o(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=l[n];r&&l.hasOwnProperty(n)?r(e,n,t[n]):e.hasOwnProperty(n)||(e[n]=t[n])}return e}var a=e(24),i=e(150),u=e(161),s=r(function(e,t){return a({},t,e)}),l={children:i,className:r(u),style:s},c={mergeProps:function(e,t){return o(a({},e),t)}};t.exports=c},{150:150,161:161,24:24}],78:[function(e,t,n){"use strict";var r={};t.exports=r},{}],79:[function(e,t,n){"use strict";var r=e(162),o=r({prop:null,context:null,childContext:null});t.exports=o},{162:162}],80:[function(e,t,n){"use strict";function r(e){function t(t,n,r,o,a,i){if(o=o||_,i=i||r,null==n[r]){var u=C[a];return t?new Error("Required "+u+" `"+i+"` was not specified in "+("`"+o+"`.")):null;
}return e(n,r,o,a,i)}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function o(e){function t(t,n,r,o,a){var i=t[n],u=v(i);if(u!==e){var s=C[o],l=m(i);return new Error("Invalid "+s+" `"+a+"` of type "+("`"+l+"` supplied to `"+r+"`, expected ")+("`"+e+"`."))}return null}return r(t)}function a(){return r(b.thatReturns(null))}function i(e){function t(t,n,r,o,a){var i=t[n];if(!Array.isArray(i)){var u=C[o],s=v(i);return new Error("Invalid "+u+" `"+a+"` of type "+("`"+s+"` supplied to `"+r+"`, expected an array."))}for(var l=0;l<i.length;l++){var c=e(i,l,r,o,a+"["+l+"]");if(c instanceof Error)return c}return null}return r(t)}function u(){function e(e,t,n,r,o){if(!y.isValidElement(e[t])){var a=C[r];return new Error("Invalid "+a+" `"+o+"` supplied to "+("`"+n+"`, expected a single ReactElement."))}return null}return r(e)}function s(e){function t(t,n,r,o,a){if(!(t[n]instanceof e)){var i=C[o],u=e.name||_,s=g(t[n]);return new Error("Invalid "+i+" `"+a+"` of type "+("`"+s+"` supplied to `"+r+"`, expected ")+("instance of `"+u+"`."))}return null}return r(t)}function l(e){function t(t,n,r,o,a){for(var i=t[n],u=0;u<e.length;u++)if(i===e[u])return null;var s=C[o],l=JSON.stringify(e);return new Error("Invalid "+s+" `"+a+"` of value `"+i+"` "+("supplied to `"+r+"`, expected one of "+l+"."))}return r(Array.isArray(e)?t:function(){return new Error("Invalid argument supplied to oneOf, expected an instance of array.")})}function c(e){function t(t,n,r,o,a){var i=t[n],u=v(i);if("object"!==u){var s=C[o];return new Error("Invalid "+s+" `"+a+"` of type "+("`"+u+"` supplied to `"+r+"`, expected an object."))}for(var l in i)if(i.hasOwnProperty(l)){var c=e(i,l,r,o,a+"."+l);if(c instanceof Error)return c}return null}return r(t)}function p(e){function t(t,n,r,o,a){for(var i=0;i<e.length;i++){var u=e[i];if(null==u(t,n,r,o,a))return null}var s=C[o];return new Error("Invalid "+s+" `"+a+"` supplied to "+("`"+r+"`."))}return r(Array.isArray(e)?t:function(){return new Error("Invalid argument supplied to oneOfType, expected an instance of array.")})}function d(){function e(e,t,n,r,o){if(!h(e[t])){var a=C[r];return new Error("Invalid "+a+" `"+o+"` supplied to "+("`"+n+"`, expected a ReactNode."))}return null}return r(e)}function f(e){function t(t,n,r,o,a){var i=t[n],u=v(i);if("object"!==u){var s=C[o];return new Error("Invalid "+s+" `"+a+"` of type `"+u+"` "+("supplied to `"+r+"`, expected `object`."))}for(var l in e){var c=e[l];if(c){var p=c(i,l,r,o,a+"."+l);if(p)return p}}return null}return r(t)}function h(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(h);if(null===e||y.isValidElement(e))return!0;var t=E(e);if(!t)return!1;var n,r=t.call(e);if(t!==e.entries){for(;!(n=r.next()).done;)if(!h(n.value))return!1}else for(;!(n=r.next()).done;){var o=n.value;if(o&&!h(o[1]))return!1}return!0;default:return!1}}function v(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":t}function m(e){var t=v(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function g(e){return e.constructor&&e.constructor.name?e.constructor.name:"<<anonymous>>"}var y=e(55),C=e(78),b=e(150),E=e(126),_="<<anonymous>>",x={array:o("array"),bool:o("boolean"),func:o("function"),number:o("number"),object:o("object"),string:o("string"),any:a(),arrayOf:i,element:u(),instanceOf:s,node:d(),objectOf:c,oneOf:l,oneOfType:p,shape:f};t.exports=x},{126:126,150:150,55:55,78:78}],81:[function(e,t,n){"use strict";function r(e){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=o.getPooled(null),this.useCreateElement=!e&&u.useCreateElement}var o=e(6),a=e(25),i=e(28),u=e(44),s=e(64),l=e(110),c=e(24),p={initialize:s.getSelectionInformation,close:s.restoreSelection},d={initialize:function(){var e=i.isEnabled();return i.setEnabled(!1),e},close:function(e){i.setEnabled(e)}},f={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},h=[p,d,f],v={getTransactionWrappers:function(){return h},getReactMountReady:function(){return this.reactMountReady},destructor:function(){o.release(this.reactMountReady),this.reactMountReady=null}};c(r.prototype,l.Mixin,v),a.addPoolingTo(r),t.exports=r},{110:110,24:24,25:25,28:28,44:44,6:6,64:64}],82:[function(e,t,n){"use strict";function r(){o.attachRefs(this,this._currentElement)}var o=e(83),a={mountComponent:function(e,t,n,o){var a=e.mountComponent(t,n,o);return e._currentElement&&null!=e._currentElement.ref&&n.getReactMountReady().enqueue(r,e),a},unmountComponent:function(e){o.detachRefs(e,e._currentElement),e.unmountComponent()},receiveComponent:function(e,t,n,a){var i=e._currentElement;if(t!==i||a!==e._context){var u=o.shouldUpdateRefs(i,t);u&&o.detachRefs(e,i),e.receiveComponent(t,n,a),u&&e._currentElement&&null!=e._currentElement.ref&&n.getReactMountReady().enqueue(r,e)}},performUpdateIfNecessary:function(e,t){e.performUpdateIfNecessary(t)}};t.exports=a},{83:83}],83:[function(e,t,n){"use strict";function r(e,t,n){"function"==typeof e?e(t.getPublicInstance()):a.addComponentAsRefTo(t,e,n)}function o(e,t,n){"function"==typeof e?e(null):a.removeComponentAsRefFrom(t,e,n)}var a=e(75),i={};i.attachRefs=function(e,t){if(null!==t&&t!==!1){var n=t.ref;null!=n&&r(n,e,t._owner)}},i.shouldUpdateRefs=function(e,t){var n=null===e||e===!1,r=null===t||t===!1;return n||r||t._owner!==e._owner||t.ref!==e.ref},i.detachRefs=function(e,t){if(null!==t&&t!==!1){var n=t.ref;null!=n&&o(n,e,t._owner)}},t.exports=i},{75:75}],84:[function(e,t,n){"use strict";var r={injectCreateReactRootIndex:function(e){o.createReactRootIndex=e}},o={createReactRootIndex:null,injection:r};t.exports=o},{}],85:[function(e,t,n){"use strict";var r={isBatchingUpdates:!1,batchedUpdates:function(e){}};t.exports=r},{}],86:[function(e,t,n){"use strict";function r(e){i.isValidElement(e)?void 0:h(!1);var t;try{p.injection.injectBatchingStrategy(l);var n=u.createReactRootID();return t=c.getPooled(!1),t.perform(function(){var r=f(e,null),o=r.mountComponent(n,t,d);return s.addChecksumToMarkup(o)},null)}finally{c.release(t),p.injection.injectBatchingStrategy(a)}}function o(e){i.isValidElement(e)?void 0:h(!1);var t;try{p.injection.injectBatchingStrategy(l);var n=u.createReactRootID();return t=c.getPooled(!0),t.perform(function(){var r=f(e,null);return r.mountComponent(n,t,d)},null)}finally{c.release(t),p.injection.injectBatchingStrategy(a)}}var a=e(53),i=e(55),u=e(65),s=e(69),l=e(85),c=e(87),p=e(93),d=e(151),f=e(129),h=e(158);t.exports={renderToString:r,renderToStaticMarkup:o}},{129:129,151:151,158:158,53:53,55:55,65:65,69:69,85:85,87:87,93:93}],87:[function(e,t,n){"use strict";function r(e){this.reinitializeTransaction(),this.renderToStaticMarkup=e,this.reactMountReady=a.getPooled(null),this.useCreateElement=!1}var o=e(25),a=e(6),i=e(110),u=e(24),s=e(150),l={initialize:function(){this.reactMountReady.reset()},close:s},c=[l],p={getTransactionWrappers:function(){return c},getReactMountReady:function(){return this.reactMountReady},destructor:function(){a.release(this.reactMountReady),this.reactMountReady=null}};u(r.prototype,i.Mixin,p),o.addPoolingTo(r),t.exports=r},{110:110,150:150,24:24,25:25,6:6}],88:[function(e,t,n){"use strict";function r(e,t){var n={};return function(r){n[t]=r,e.setState(n)}}var o={createStateSetter:function(e,t){return function(n,r,o,a,i,u){var s=t.call(e,n,r,o,a,i,u);s&&e.setState(s)}},createStateKeySetter:function(e,t){var n=e.__keySetters||(e.__keySetters={});return n[t]||(n[t]=r(e,t))}};o.Mixin={createStateSetter:function(e){return o.createStateSetter(this,e)},createStateKeySetter:function(e){return o.createStateKeySetter(this,e)}},t.exports=o},{}],89:[function(e,t,n){"use strict";var r=e(120),o={getChildMapping:function(e){return e?r(e):e},mergeChildMappings:function(e,t){function n(n){return t.hasOwnProperty(n)?t[n]:e[n]}e=e||{},t=t||{};var r={},o=[];for(var a in e)t.hasOwnProperty(a)?o.length&&(r[a]=o,o=[]):o.push(a);var i,u={};for(var s in t){if(r.hasOwnProperty(s))for(i=0;i<r[s].length;i++){var l=r[s][i];u[r[s][i]]=n(l)}u[s]=n(s)}for(i=0;i<o.length;i++)u[o[i]]=n(o[i]);return u}};t.exports=o},{120:120}],90:[function(e,t,n){"use strict";function r(){var e=document.createElement("div"),t=e.style;"AnimationEvent"in window||delete u.animationend.animation,"TransitionEvent"in window||delete u.transitionend.transition;for(var n in u){var r=u[n];for(var o in r)if(o in t){s.push(r[o]);break}}}function o(e,t,n){e.addEventListener(t,n,!1)}function a(e,t,n){e.removeEventListener(t,n,!1)}var i=e(144),u={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},s=[];i.canUseDOM&&r();var l={addEndEventListener:function(e,t){return 0===s.length?void window.setTimeout(t,0):void s.forEach(function(n){o(e,n,t)})},removeEndEventListener:function(e,t){0!==s.length&&s.forEach(function(n){a(e,n,t)})}};t.exports=l},{144:144}],91:[function(e,t,n){"use strict";var r=e(26),o=e(89),a=e(24),i=e(150),u=r.createClass({displayName:"ReactTransitionGroup",propTypes:{component:r.PropTypes.any,childFactory:r.PropTypes.func},getDefaultProps:function(){return{component:"span",childFactory:i.thatReturnsArgument}},getInitialState:function(){return{children:o.getChildMapping(this.props.children)}},componentWillMount:function(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]},componentDidMount:function(){var e=this.state.children;for(var t in e)e[t]&&this.performAppear(t)},componentWillReceiveProps:function(e){var t=o.getChildMapping(e.children),n=this.state.children;this.setState({children:o.mergeChildMappings(n,t)});var r;for(r in t){var a=n&&n.hasOwnProperty(r);!t[r]||a||this.currentlyTransitioningKeys[r]||this.keysToEnter.push(r)}for(r in n){var i=t&&t.hasOwnProperty(r);!n[r]||i||this.currentlyTransitioningKeys[r]||this.keysToLeave.push(r)}},componentDidUpdate:function(){var e=this.keysToEnter;this.keysToEnter=[],e.forEach(this.performEnter);var t=this.keysToLeave;this.keysToLeave=[],t.forEach(this.performLeave)},performAppear:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillAppear?t.componentWillAppear(this._handleDoneAppearing.bind(this,e)):this._handleDoneAppearing(e)},_handleDoneAppearing:function(e){var t=this.refs[e];t.componentDidAppear&&t.componentDidAppear(),delete this.currentlyTransitioningKeys[e];var n=o.getChildMapping(this.props.children);n&&n.hasOwnProperty(e)||this.performLeave(e)},performEnter:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)},_handleDoneEntering:function(e){var t=this.refs[e];t.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e];var n=o.getChildMapping(this.props.children);n&&n.hasOwnProperty(e)||this.performLeave(e)},performLeave:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillLeave?t.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)},_handleDoneLeaving:function(e){var t=this.refs[e];t.componentDidLeave&&t.componentDidLeave(),delete this.currentlyTransitioningKeys[e];var n=o.getChildMapping(this.props.children);n&&n.hasOwnProperty(e)?this.performEnter(e):this.setState(function(t){var n=a({},t.children);return delete n[e],{children:n}})},render:function(){var e=[];for(var t in this.state.children){var n=this.state.children[t];n&&e.push(r.cloneElement(this.props.childFactory(n),{ref:t,key:t}))}return r.createElement(this.props.component,this.props,e)}});t.exports=u},{150:150,24:24,26:26,89:89}],92:[function(e,t,n){"use strict";function r(e){u.enqueueUpdate(e)}function o(e,t){var n=i.get(e);return n?n:null}var a=(e(39),e(55)),i=e(66),u=e(93),s=e(24),l=e(158),c=(e(168),{isMounted:function(e){var t=i.get(e);return t?!!t._renderedComponent:!1},enqueueCallback:function(e,t){"function"!=typeof t?l(!1):void 0;var n=o(e);return n?(n._pendingCallbacks?n._pendingCallbacks.push(t):n._pendingCallbacks=[t],void r(n)):null},enqueueCallbackInternal:function(e,t){"function"!=typeof t?l(!1):void 0,e._pendingCallbacks?e._pendingCallbacks.push(t):e._pendingCallbacks=[t],r(e)},enqueueForceUpdate:function(e){var t=o(e,"forceUpdate");t&&(t._pendingForceUpdate=!0,r(t))},enqueueReplaceState:function(e,t){var n=o(e,"replaceState");n&&(n._pendingStateQueue=[t],n._pendingReplaceState=!0,r(n))},enqueueSetState:function(e,t){var n=o(e,"setState");if(n){var a=n._pendingStateQueue||(n._pendingStateQueue=[]);a.push(t),r(n)}},enqueueSetProps:function(e,t){var n=o(e,"setProps");n&&c.enqueueSetPropsInternal(n,t)},enqueueSetPropsInternal:function(e,t){var n=e._topLevelWrapper;n?void 0:l(!1);var o=n._pendingElement||n._currentElement,i=o.props,u=s({},i.props,t);n._pendingElement=a.cloneAndReplaceProps(o,a.cloneAndReplaceProps(i,u)),r(n)},enqueueReplaceProps:function(e,t){var n=o(e,"replaceProps");n&&c.enqueueReplacePropsInternal(n,t)},enqueueReplacePropsInternal:function(e,t){var n=e._topLevelWrapper;n?void 0:l(!1);var o=n._pendingElement||n._currentElement,i=o.props;n._pendingElement=a.cloneAndReplaceProps(o,a.cloneAndReplaceProps(i,t)),r(n)},enqueueElementInternal:function(e,t){e._pendingElement=t,r(e)}});t.exports=c},{158:158,168:168,24:24,39:39,55:55,66:66,93:93}],93:[function(e,t,n){"use strict";function r(){T.ReactReconcileTransaction&&b?void 0:m(!1)}function o(){this.reinitializeTransaction(),this.dirtyComponentsLength=null,this.callbackQueue=c.getPooled(),this.reconcileTransaction=T.ReactReconcileTransaction.getPooled(!1)}function a(e,t,n,o,a,i){r(),b.batchedUpdates(e,t,n,o,a,i)}function i(e,t){return e._mountOrder-t._mountOrder}function u(e){var t=e.dirtyComponentsLength;t!==g.length?m(!1):void 0,g.sort(i);for(var n=0;t>n;n++){var r=g[n],o=r._pendingCallbacks;if(r._pendingCallbacks=null,f.performUpdateIfNecessary(r,e.reconcileTransaction),o)for(var a=0;a<o.length;a++)e.callbackQueue.enqueue(o[a],r.getPublicInstance())}}function s(e){return r(),b.isBatchingUpdates?void g.push(e):void b.batchedUpdates(s,e)}function l(e,t){b.isBatchingUpdates?void 0:m(!1),y.enqueue(e,t),C=!0}var c=e(6),p=e(25),d=e(76),f=e(82),h=e(110),v=e(24),m=e(158),g=[],y=c.getPooled(),C=!1,b=null,E={initialize:function(){this.dirtyComponentsLength=g.length},close:function(){this.dirtyComponentsLength!==g.length?(g.splice(0,this.dirtyComponentsLength),D()):g.length=0}},_={initialize:function(){this.callbackQueue.reset()},close:function(){this.callbackQueue.notifyAll()}},x=[E,_];v(o.prototype,h.Mixin,{getTransactionWrappers:function(){return x},destructor:function(){this.dirtyComponentsLength=null,c.release(this.callbackQueue),this.callbackQueue=null,T.ReactReconcileTransaction.release(this.reconcileTransaction),this.reconcileTransaction=null},perform:function(e,t,n){return h.Mixin.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,e,t,n)}}),p.addPoolingTo(o);var D=function(){for(;g.length||C;){if(g.length){var e=o.getPooled();e.perform(u,null,e),o.release(e)}if(C){C=!1;var t=y;y=c.getPooled(),t.notifyAll(),c.release(t)}}};D=d.measure("ReactUpdates","flushBatchedUpdates",D);var P={injectReconcileTransaction:function(e){e?void 0:m(!1),T.ReactReconcileTransaction=e},injectBatchingStrategy:function(e){e?void 0:m(!1),"function"!=typeof e.batchedUpdates?m(!1):void 0,"boolean"!=typeof e.isBatchingUpdates?m(!1):void 0,b=e}},T={ReactReconcileTransaction:null,batchedUpdates:a,enqueueUpdate:s,flushBatchedUpdates:D,injection:P,asap:l};t.exports=T},{110:110,158:158,24:24,25:25,6:6,76:76,82:82}],94:[function(e,t,n){"use strict";t.exports="0.14.1"},{}],95:[function(e,t,n){"use strict";var r=e(10),o=r.injection.MUST_USE_ATTRIBUTE,a={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},i={Properties:{clipPath:o,cx:o,cy:o,d:o,dx:o,dy:o,fill:o,fillOpacity:o,fontFamily:o,fontSize:o,fx:o,fy:o,gradientTransform:o,gradientUnits:o,markerEnd:o,markerMid:o,markerStart:o,offset:o,opacity:o,patternContentUnits:o,patternUnits:o,points:o,preserveAspectRatio:o,r:o,rx:o,ry:o,spreadMethod:o,stopColor:o,stopOpacity:o,stroke:o,strokeDasharray:o,strokeLinecap:o,strokeOpacity:o,strokeWidth:o,textAnchor:o,transform:o,version:o,viewBox:o,x1:o,x2:o,x:o,xlinkActuate:o,xlinkArcrole:o,xlinkHref:o,xlinkRole:o,xlinkShow:o,xlinkTitle:o,xlinkType:o,xmlBase:o,xmlLang:o,xmlSpace:o,y1:o,y2:o,y:o},DOMAttributeNamespaces:{xlinkActuate:a.xlink,xlinkArcrole:a.xlink,xlinkHref:a.xlink,xlinkRole:a.xlink,xlinkShow:a.xlink,xlinkTitle:a.xlink,xlinkType:a.xlink,xmlBase:a.xml,xmlLang:a.xml,xmlSpace:a.xml},DOMAttributeNames:{clipPath:"clip-path",fillOpacity:"fill-opacity",fontFamily:"font-family",fontSize:"font-size",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",patternContentUnits:"patternContentUnits",patternUnits:"patternUnits",preserveAspectRatio:"preserveAspectRatio",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeDasharray:"stroke-dasharray",strokeLinecap:"stroke-linecap",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox",xlinkActuate:"xlink:actuate",xlinkArcrole:"xlink:arcrole",xlinkHref:"xlink:href",xlinkRole:"xlink:role",xlinkShow:"xlink:show",xlinkTitle:"xlink:title",xlinkType:"xlink:type",xmlBase:"xml:base",xmlLang:"xml:lang",xmlSpace:"xml:space"}};t.exports=i},{10:10}],96:[function(e,t,n){"use strict";function r(e){if("selectionStart"in e&&s.hasSelectionCapabilities(e))return{start:e.selectionStart,end:e.selectionEnd};if(window.getSelection){var t=window.getSelection();return{anchorNode:t.anchorNode,anchorOffset:t.anchorOffset,focusNode:t.focusNode,focusOffset:t.focusOffset}}if(document.selection){var n=document.selection.createRange();return{parentElement:n.parentElement(),text:n.text,top:n.boundingTop,left:n.boundingLeft}}}function o(e,t){if(b||null==g||g!==c())return null;var n=r(g);if(!C||!f(C,n)){C=n;var o=l.getPooled(m.select,y,e,t);return o.type="select",o.target=g,i.accumulateTwoPhaseDispatches(o),o}return null}var a=e(15),i=e(19),u=e(144),s=e(64),l=e(102),c=e(153),p=e(131),d=e(163),f=e(166),h=a.topLevelTypes,v=u.canUseDOM&&"documentMode"in document&&document.documentMode<=11,m={select:{phasedRegistrationNames:{bubbled:d({onSelect:null}),captured:d({onSelectCapture:null})},dependencies:[h.topBlur,h.topContextMenu,h.topFocus,h.topKeyDown,h.topMouseDown,h.topMouseUp,h.topSelectionChange]}},g=null,y=null,C=null,b=!1,E=!1,_=d({onSelect:null}),x={eventTypes:m,extractEvents:function(e,t,n,r,a){if(!E)return null;switch(e){case h.topFocus:(p(t)||"true"===t.contentEditable)&&(g=t,y=n,C=null);break;case h.topBlur:g=null,y=null,C=null;break;case h.topMouseDown:b=!0;break;case h.topContextMenu:case h.topMouseUp:return b=!1,o(r,a);case h.topSelectionChange:if(v)break;case h.topKeyDown:case h.topKeyUp:return o(r,a)}return null},didPutListener:function(e,t,n){t===_&&(E=!0)}};t.exports=x},{102:102,131:131,144:144,15:15,153:153,163:163,166:166,19:19,64:64}],97:[function(e,t,n){"use strict";var r=Math.pow(2,53),o={createReactRootIndex:function(){return Math.ceil(Math.random()*r)}};t.exports=o},{}],98:[function(e,t,n){"use strict";var r=e(15),o=e(143),a=e(19),i=e(70),u=e(99),s=e(102),l=e(103),c=e(105),p=e(106),d=e(101),f=e(107),h=e(108),v=e(109),m=e(150),g=e(122),y=e(158),C=e(163),b=r.topLevelTypes,E={abort:{phasedRegistrationNames:{bubbled:C({onAbort:!0}),captured:C({onAbortCapture:!0})}},blur:{phasedRegistrationNames:{bubbled:C({onBlur:!0}),captured:C({onBlurCapture:!0})}},canPlay:{phasedRegistrationNames:{bubbled:C({onCanPlay:!0}),captured:C({onCanPlayCapture:!0})}},canPlayThrough:{phasedRegistrationNames:{bubbled:C({onCanPlayThrough:!0}),captured:C({onCanPlayThroughCapture:!0})}},click:{phasedRegistrationNames:{bubbled:C({onClick:!0}),captured:C({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:C({onContextMenu:!0}),captured:C({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:C({onCopy:!0}),captured:C({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:C({onCut:!0}),captured:C({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:C({onDoubleClick:!0}),captured:C({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:C({onDrag:!0}),captured:C({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:C({onDragEnd:!0}),captured:C({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:C({onDragEnter:!0}),captured:C({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:C({onDragExit:!0}),captured:C({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:C({onDragLeave:!0}),captured:C({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:C({onDragOver:!0}),captured:C({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:C({onDragStart:!0}),captured:C({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:C({onDrop:!0}),captured:C({onDropCapture:!0})}},durationChange:{phasedRegistrationNames:{bubbled:C({onDurationChange:!0}),captured:C({onDurationChangeCapture:!0})}},emptied:{phasedRegistrationNames:{bubbled:C({onEmptied:!0}),captured:C({onEmptiedCapture:!0})}},encrypted:{phasedRegistrationNames:{bubbled:C({onEncrypted:!0}),captured:C({onEncryptedCapture:!0})}},ended:{phasedRegistrationNames:{bubbled:C({onEnded:!0}),captured:C({onEndedCapture:!0})}},error:{phasedRegistrationNames:{bubbled:C({onError:!0}),captured:C({onErrorCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:C({onFocus:!0}),captured:C({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:C({onInput:!0}),captured:C({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:C({onKeyDown:!0}),captured:C({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:C({onKeyPress:!0}),captured:C({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:C({onKeyUp:!0}),captured:C({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:C({onLoad:!0}),captured:C({onLoadCapture:!0})}},loadedData:{phasedRegistrationNames:{bubbled:C({onLoadedData:!0}),captured:C({onLoadedDataCapture:!0})}},loadedMetadata:{phasedRegistrationNames:{bubbled:C({onLoadedMetadata:!0}),captured:C({onLoadedMetadataCapture:!0})}},loadStart:{phasedRegistrationNames:{bubbled:C({onLoadStart:!0}),captured:C({onLoadStartCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:C({onMouseDown:!0}),captured:C({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:C({onMouseMove:!0}),captured:C({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:C({onMouseOut:!0}),captured:C({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:C({onMouseOver:!0}),captured:C({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:C({onMouseUp:!0}),captured:C({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:C({onPaste:!0}),captured:C({onPasteCapture:!0})}},pause:{phasedRegistrationNames:{bubbled:C({onPause:!0}),captured:C({onPauseCapture:!0})}},play:{phasedRegistrationNames:{bubbled:C({onPlay:!0}),captured:C({onPlayCapture:!0})}},playing:{phasedRegistrationNames:{bubbled:C({onPlaying:!0}),captured:C({onPlayingCapture:!0})}},progress:{phasedRegistrationNames:{bubbled:C({onProgress:!0}),captured:C({onProgressCapture:!0})}},rateChange:{phasedRegistrationNames:{bubbled:C({onRateChange:!0}),captured:C({onRateChangeCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:C({onReset:!0}),captured:C({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:C({onScroll:!0}),captured:C({onScrollCapture:!0})}},seeked:{phasedRegistrationNames:{bubbled:C({onSeeked:!0}),captured:C({onSeekedCapture:!0})}},seeking:{phasedRegistrationNames:{bubbled:C({onSeeking:!0}),captured:C({onSeekingCapture:!0})}},stalled:{phasedRegistrationNames:{bubbled:C({onStalled:!0}),captured:C({onStalledCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:C({onSubmit:!0}),captured:C({onSubmitCapture:!0})}},suspend:{phasedRegistrationNames:{bubbled:C({onSuspend:!0}),captured:C({onSuspendCapture:!0})}},timeUpdate:{phasedRegistrationNames:{bubbled:C({onTimeUpdate:!0}),captured:C({onTimeUpdateCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:C({onTouchCancel:!0}),captured:C({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:C({onTouchEnd:!0}),captured:C({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:C({onTouchMove:!0}),captured:C({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:C({onTouchStart:!0}),captured:C({onTouchStartCapture:!0})}},volumeChange:{phasedRegistrationNames:{bubbled:C({onVolumeChange:!0}),captured:C({onVolumeChangeCapture:!0})}},waiting:{phasedRegistrationNames:{bubbled:C({onWaiting:!0}),captured:C({onWaitingCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:C({onWheel:!0}),captured:C({onWheelCapture:!0})}}},_={topAbort:E.abort,topBlur:E.blur,topCanPlay:E.canPlay,topCanPlayThrough:E.canPlayThrough,topClick:E.click,topContextMenu:E.contextMenu,topCopy:E.copy,topCut:E.cut,topDoubleClick:E.doubleClick,topDrag:E.drag,topDragEnd:E.dragEnd,topDragEnter:E.dragEnter,topDragExit:E.dragExit,topDragLeave:E.dragLeave,topDragOver:E.dragOver,topDragStart:E.dragStart,topDrop:E.drop,topDurationChange:E.durationChange,topEmptied:E.emptied,topEncrypted:E.encrypted,topEnded:E.ended,topError:E.error,topFocus:E.focus,topInput:E.input,topKeyDown:E.keyDown,topKeyPress:E.keyPress,topKeyUp:E.keyUp,topLoad:E.load,topLoadedData:E.loadedData,topLoadedMetadata:E.loadedMetadata,topLoadStart:E.loadStart,topMouseDown:E.mouseDown,topMouseMove:E.mouseMove,topMouseOut:E.mouseOut,topMouseOver:E.mouseOver,topMouseUp:E.mouseUp,topPaste:E.paste,topPause:E.pause,topPlay:E.play,topPlaying:E.playing,topProgress:E.progress,topRateChange:E.rateChange,topReset:E.reset,topScroll:E.scroll,topSeeked:E.seeked,topSeeking:E.seeking,topStalled:E.stalled,topSubmit:E.submit,topSuspend:E.suspend,topTimeUpdate:E.timeUpdate,topTouchCancel:E.touchCancel,topTouchEnd:E.touchEnd,topTouchMove:E.touchMove,topTouchStart:E.touchStart,topVolumeChange:E.volumeChange,topWaiting:E.waiting,topWheel:E.wheel};for(var x in _)_[x].dependencies=[x];var D=C({onClick:null}),P={},T={eventTypes:E,extractEvents:function(e,t,n,r,o){var i=_[e];if(!i)return null;var m;switch(e){case b.topAbort:case b.topCanPlay:case b.topCanPlayThrough:case b.topDurationChange:case b.topEmptied:case b.topEncrypted:case b.topEnded:case b.topError:case b.topInput:case b.topLoad:case b.topLoadedData:case b.topLoadedMetadata:case b.topLoadStart:case b.topPause:case b.topPlay:case b.topPlaying:case b.topProgress:case b.topRateChange:case b.topReset:case b.topSeeked:case b.topSeeking:case b.topStalled:case b.topSubmit:case b.topSuspend:case b.topTimeUpdate:case b.topVolumeChange:case b.topWaiting:m=s;break;case b.topKeyPress:if(0===g(r))return null;case b.topKeyDown:case b.topKeyUp:m=c;break;case b.topBlur:case b.topFocus:m=l;break;case b.topClick:if(2===r.button)return null;case b.topContextMenu:case b.topDoubleClick:case b.topMouseDown:case b.topMouseMove:case b.topMouseOut:case b.topMouseOver:case b.topMouseUp:m=p;break;case b.topDrag:case b.topDragEnd:case b.topDragEnter:case b.topDragExit:case b.topDragLeave:case b.topDragOver:case b.topDragStart:case b.topDrop:m=d;break;case b.topTouchCancel:case b.topTouchEnd:case b.topTouchMove:case b.topTouchStart:m=f;break;case b.topScroll:m=h;break;case b.topWheel:m=v;break;case b.topCopy:case b.topCut:case b.topPaste:m=u}m?void 0:y(!1);var C=m.getPooled(i,n,r,o);return a.accumulateTwoPhaseDispatches(C),C},didPutListener:function(e,t,n){if(t===D){var r=i.getNode(e);P[e]||(P[e]=o.listen(r,"click",m))}},willDeleteListener:function(e,t){t===D&&(P[e].remove(),delete P[e])}};t.exports=T},{101:101,102:102,103:103,105:105,106:106,107:107,108:108,109:109,122:122,143:143,15:15,150:150,158:158,163:163,19:19,70:70,99:99}],99:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e(102),a={clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}};o.augmentClass(r,a),t.exports=r},{102:102}],100:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e(102),a={data:null};o.augmentClass(r,a),t.exports=r},{102:102}],101:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e(106),a={dataTransfer:null};o.augmentClass(r,a),t.exports=r},{106:106}],102:[function(e,t,n){"use strict";function r(e,t,n,r){this.dispatchConfig=e,this.dispatchMarker=t,this.nativeEvent=n,this.target=r,this.currentTarget=r;var o=this.constructor.Interface;for(var a in o)if(o.hasOwnProperty(a)){var u=o[a];u?this[a]=u(n):this[a]=n[a]}var s=null!=n.defaultPrevented?n.defaultPrevented:n.returnValue===!1;s?this.isDefaultPrevented=i.thatReturnsTrue:this.isDefaultPrevented=i.thatReturnsFalse,this.isPropagationStopped=i.thatReturnsFalse}var o=e(25),a=e(24),i=e(150),u=(e(168),{type:null,currentTarget:i.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null});a(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1,this.isDefaultPrevented=i.thatReturnsTrue)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.isPropagationStopped=i.thatReturnsTrue)},persist:function(){this.isPersistent=i.thatReturnsTrue},isPersistent:i.thatReturnsFalse,destructor:function(){var e=this.constructor.Interface;for(var t in e)this[t]=null;this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),r.Interface=u,r.augmentClass=function(e,t){var n=this,r=Object.create(n.prototype);a(r,e.prototype),e.prototype=r,e.prototype.constructor=e,e.Interface=a({},n.Interface,t),e.augmentClass=n.augmentClass,o.addPoolingTo(e,o.fourArgumentPooler)},o.addPoolingTo(r,o.fourArgumentPooler),t.exports=r},{150:150,168:168,24:24,25:25}],103:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e(108),a={relatedTarget:null};o.augmentClass(r,a),t.exports=r},{108:108}],104:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e(102),a={data:null};o.augmentClass(r,a),t.exports=r},{102:102}],105:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e(108),a=e(122),i=e(123),u=e(124),s={key:i,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:u,charCode:function(e){return"keypress"===e.type?a(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?a(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}};o.augmentClass(r,s),t.exports=r},{108:108,122:122,123:123,124:124}],106:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e(108),a=e(111),i=e(124),u={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:i,button:function(e){var t=e.button;return"which"in e?t:2===t?2:4===t?1:0},buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},pageX:function(e){return"pageX"in e?e.pageX:e.clientX+a.currentScrollLeft},pageY:function(e){return"pageY"in e?e.pageY:e.clientY+a.currentScrollTop}};o.augmentClass(r,u),t.exports=r},{108:108,111:111,124:124}],107:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e(108),a=e(124),i={touches:null,targetTouches:null,changedTouches:null,
altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:a};o.augmentClass(r,i),t.exports=r},{108:108,124:124}],108:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e(102),a=e(125),i={view:function(e){if(e.view)return e.view;var t=a(e);if(null!=t&&t.window===t)return t;var n=t.ownerDocument;return n?n.defaultView||n.parentWindow:window},detail:function(e){return e.detail||0}};o.augmentClass(r,i),t.exports=r},{102:102,125:125}],109:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e(106),a={deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null};o.augmentClass(r,a),t.exports=r},{106:106}],110:[function(e,t,n){"use strict";var r=e(158),o={reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(e,t,n,o,a,i,u,s){this.isInTransaction()?r(!1):void 0;var l,c;try{this._isInTransaction=!0,l=!0,this.initializeAll(0),c=e.call(t,n,o,a,i,u,s),l=!1}finally{try{if(l)try{this.closeAll(0)}catch(p){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return c},initializeAll:function(e){for(var t=this.transactionWrappers,n=e;n<t.length;n++){var r=t[n];try{this.wrapperInitData[n]=a.OBSERVED_ERROR,this.wrapperInitData[n]=r.initialize?r.initialize.call(this):null}finally{if(this.wrapperInitData[n]===a.OBSERVED_ERROR)try{this.initializeAll(n+1)}catch(o){}}}},closeAll:function(e){this.isInTransaction()?void 0:r(!1);for(var t=this.transactionWrappers,n=e;n<t.length;n++){var o,i=t[n],u=this.wrapperInitData[n];try{o=!0,u!==a.OBSERVED_ERROR&&i.close&&i.close.call(this,u),o=!1}finally{if(o)try{this.closeAll(n+1)}catch(s){}}}this.wrapperInitData.length=0}},a={Mixin:o,OBSERVED_ERROR:{}};t.exports=a},{158:158}],111:[function(e,t,n){"use strict";var r={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(e){r.currentScrollLeft=e.x,r.currentScrollTop=e.y}};t.exports=r},{}],112:[function(e,t,n){"use strict";function r(e,t){if(null==t?o(!1):void 0,null==e)return t;var n=Array.isArray(e),r=Array.isArray(t);return n&&r?(e.push.apply(e,t),e):n?(e.push(t),e):r?[e].concat(t):[e,t]}var o=e(158);t.exports=r},{158:158}],113:[function(e,t,n){"use strict";function r(e){for(var t=1,n=0,r=0,a=e.length,i=-4&a;i>r;){for(;r<Math.min(r+4096,i);r+=4)n+=(t+=e.charCodeAt(r))+(t+=e.charCodeAt(r+1))+(t+=e.charCodeAt(r+2))+(t+=e.charCodeAt(r+3));t%=o,n%=o}for(;a>r;r++)n+=t+=e.charCodeAt(r);return t%=o,n%=o,t|n<<16}var o=65521;t.exports=r},{}],114:[function(e,t,n){"use strict";var r=!1;t.exports=r},{}],115:[function(e,t,n){"use strict";function r(e,t){var n=a.mergeProps(t,e.props);return!n.hasOwnProperty(u)&&e.props.hasOwnProperty(u)&&(n.children=e.props.children),o.createElement(e.type,n)}var o=e(55),a=e(77),i=e(163),u=(e(168),i({children:null}));t.exports=r},{163:163,168:168,55:55,77:77}],116:[function(e,t,n){"use strict";function r(e,t){var n=null==t||"boolean"==typeof t||""===t;if(n)return"";var r=isNaN(t);return r||0===t||a.hasOwnProperty(e)&&a[e]?""+t:("string"==typeof t&&(t=t.trim()),t+"px")}var o=e(4),a=o.isUnitlessNumber;t.exports=r},{4:4}],117:[function(e,t,n){"use strict";function r(e,t,n,r,o){return o}e(24),e(168);t.exports=r},{168:168,24:24}],118:[function(e,t,n){"use strict";function r(e){return a[e]}function o(e){return(""+e).replace(i,r)}var a={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},i=/[&><"']/g;t.exports=o},{}],119:[function(e,t,n){"use strict";function r(e){return null==e?null:1===e.nodeType?e:o.has(e)?a.getNodeFromInstance(e):(null!=e.render&&"function"==typeof e.render?i(!1):void 0,void i(!1))}var o=(e(39),e(66)),a=e(70),i=e(158);e(168);t.exports=r},{158:158,168:168,39:39,66:66,70:70}],120:[function(e,t,n){"use strict";function r(e,t,n){var r=e,o=void 0===r[n];o&&null!=t&&(r[n]=t)}function o(e){if(null==e)return e;var t={};return a(e,r,t),t}var a=e(139);e(168);t.exports=o},{139:139,168:168}],121:[function(e,t,n){"use strict";var r=function(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)};t.exports=r},{}],122:[function(e,t,n){"use strict";function r(e){var t,n=e.keyCode;return"charCode"in e?(t=e.charCode,0===t&&13===n&&(t=13)):t=n,t>=32||13===t?t:0}t.exports=r},{}],123:[function(e,t,n){"use strict";function r(e){if(e.key){var t=a[e.key]||e.key;if("Unidentified"!==t)return t}if("keypress"===e.type){var n=o(e);return 13===n?"Enter":String.fromCharCode(n)}return"keydown"===e.type||"keyup"===e.type?i[e.keyCode]||"Unidentified":""}var o=e(122),a={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};t.exports=r},{122:122}],124:[function(e,t,n){"use strict";function r(e){var t=this,n=t.nativeEvent;if(n.getModifierState)return n.getModifierState(e);var r=a[e];return r?!!n[r]:!1}function o(e){return r}var a={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};t.exports=o},{}],125:[function(e,t,n){"use strict";function r(e){var t=e.target||e.srcElement||window;return 3===t.nodeType?t.parentNode:t}t.exports=r},{}],126:[function(e,t,n){"use strict";function r(e){var t=e&&(o&&e[o]||e[a]);return"function"==typeof t?t:void 0}var o="function"==typeof Symbol&&Symbol.iterator,a="@@iterator";t.exports=r},{}],127:[function(e,t,n){"use strict";function r(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function o(e){for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}}function a(e,t){for(var n=r(e),a=0,i=0;n;){if(3===n.nodeType){if(i=a+n.textContent.length,t>=a&&i>=t)return{node:n,offset:t-a};a=i}n=r(o(n))}}t.exports=a},{}],128:[function(e,t,n){"use strict";function r(){return!a&&o.canUseDOM&&(a="textContent"in document.documentElement?"textContent":"innerText"),a}var o=e(144),a=null;t.exports=r},{144:144}],129:[function(e,t,n){"use strict";function r(e){return"function"==typeof e&&"undefined"!=typeof e.prototype&&"function"==typeof e.prototype.mountComponent&&"function"==typeof e.prototype.receiveComponent}function o(e){var t;if(null===e||e===!1)t=new i(o);else if("object"==typeof e){var n=e;!n||"function"!=typeof n.type&&"string"!=typeof n.type?l(!1):void 0,t="string"==typeof n.type?u.createInternalComponent(n):r(n.type)?new n.type(n):new c}else"string"==typeof e||"number"==typeof e?t=u.createInstanceForText(e):l(!1);return t.construct(e),t._mountIndex=0,t._mountImage=null,t}var a=e(38),i=e(57),u=e(73),s=e(24),l=e(158),c=(e(168),function(){});s(c.prototype,a.Mixin,{_instantiateReactComponent:o}),t.exports=o},{158:158,168:168,24:24,38:38,57:57,73:73}],130:[function(e,t,n){"use strict";function r(e,t){if(!a.canUseDOM||t&&!("addEventListener"in document))return!1;var n="on"+e,r=n in document;if(!r){var i=document.createElement("div");i.setAttribute(n,"return;"),r="function"==typeof i[n]}return!r&&o&&"wheel"===e&&(r=document.implementation.hasFeature("Events.wheel","3.0")),r}var o,a=e(144);a.canUseDOM&&(o=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0),t.exports=r},{144:144}],131:[function(e,t,n){"use strict";function r(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&o[e.type]||"textarea"===t)}var o={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};t.exports=r},{}],132:[function(e,t,n){"use strict";function r(e){return o.isValidElement(e)?void 0:a(!1),e}var o=e(55),a=e(158);t.exports=r},{158:158,55:55}],133:[function(e,t,n){"use strict";function r(e){return'"'+o(e)+'"'}var o=e(118);t.exports=r},{118:118}],134:[function(e,t,n){"use strict";var r=e(70);t.exports=r.renderSubtreeIntoContainer},{70:70}],135:[function(e,t,n){"use strict";var r=e(144),o=/^[ \r\n\t\f]/,a=/<(!--|link|noscript|meta|script|style)[ \r\n\t\f\/>]/,i=function(e,t){e.innerHTML=t};if("undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction&&(i=function(e,t){MSApp.execUnsafeLocalFunction(function(){e.innerHTML=t})}),r.canUseDOM){var u=document.createElement("div");u.innerHTML=" ",""===u.innerHTML&&(i=function(e,t){if(e.parentNode&&e.parentNode.replaceChild(e,e),o.test(t)||"<"===t[0]&&a.test(t)){e.innerHTML=String.fromCharCode(65279)+t;var n=e.firstChild;1===n.data.length?e.removeChild(n):n.deleteData(0,1)}else e.innerHTML=t})}t.exports=i},{144:144}],136:[function(e,t,n){"use strict";var r=e(144),o=e(118),a=e(135),i=function(e,t){e.textContent=t};r.canUseDOM&&("textContent"in document.documentElement||(i=function(e,t){a(e,o(t))})),t.exports=i},{118:118,135:135,144:144}],137:[function(e,t,n){"use strict";function r(e,t,n){return!o(e.props,t)||!o(e.state,n)}var o=e(166);t.exports=r},{166:166}],138:[function(e,t,n){"use strict";function r(e,t){var n=null===e||e===!1,r=null===t||t===!1;if(n||r)return n===r;var o=typeof e,a=typeof t;return"string"===o||"number"===o?"string"===a||"number"===a:"object"===a&&e.type===t.type&&e.key===t.key}t.exports=r},{}],139:[function(e,t,n){"use strict";function r(e){return v[e]}function o(e,t){return e&&null!=e.key?i(e.key):t.toString(36)}function a(e){return(""+e).replace(m,r)}function i(e){return"$"+a(e)}function u(e,t,n,r){var a=typeof e;if(("undefined"===a||"boolean"===a)&&(e=null),null===e||"string"===a||"number"===a||l.isValidElement(e))return n(r,e,""===t?f+o(e,0):t),1;var s,c,v=0,m=""===t?f:t+h;if(Array.isArray(e))for(var g=0;g<e.length;g++)s=e[g],c=m+o(s,g),v+=u(s,c,n,r);else{var y=p(e);if(y){var C,b=y.call(e);if(y!==e.entries)for(var E=0;!(C=b.next()).done;)s=C.value,c=m+o(s,E++),v+=u(s,c,n,r);else for(;!(C=b.next()).done;){var _=C.value;_&&(s=_[1],c=m+i(_[0])+h+o(s,0),v+=u(s,c,n,r))}}else"object"===a&&(String(e),d(!1))}return v}function s(e,t,n){return null==e?0:u(e,"",t,n)}var l=(e(39),e(55)),c=e(65),p=e(126),d=e(158),f=(e(168),c.SEPARATOR),h=":",v={"=":"=0",".":"=1",":":"=2"},m=/[=.:]/g;t.exports=s},{126:126,158:158,168:168,39:39,55:55,65:65}],140:[function(e,t,n){"use strict";function r(e){return Array.isArray(e)?e.concat():e&&"object"==typeof e?i(new e.constructor,e):e}function o(e,t,n){Array.isArray(e)?void 0:s(!1);var r=t[n];Array.isArray(r)?void 0:s(!1)}function a(e,t){if("object"!=typeof t?s(!1):void 0,l.call(t,f))return 1!==Object.keys(t).length?s(!1):void 0,t[f];var n=r(e);if(l.call(t,h)){var u=t[h];u&&"object"==typeof u?void 0:s(!1),n&&"object"==typeof n?void 0:s(!1),i(n,t[h])}l.call(t,c)&&(o(e,t,c),t[c].forEach(function(e){n.push(e)})),l.call(t,p)&&(o(e,t,p),t[p].forEach(function(e){n.unshift(e)})),l.call(t,d)&&(Array.isArray(e)?void 0:s(!1),Array.isArray(t[d])?void 0:s(!1),t[d].forEach(function(e){Array.isArray(e)?void 0:s(!1),n.splice.apply(n,e)})),l.call(t,v)&&("function"!=typeof t[v]?s(!1):void 0,n=t[v](n));for(var m in t)g.hasOwnProperty(m)&&g[m]||(n[m]=a(e[m],t[m]));return n}var i=e(24),u=e(163),s=e(158),l={}.hasOwnProperty,c=u({$push:null}),p=u({$unshift:null}),d=u({$splice:null}),f=u({$set:null}),h=u({$merge:null}),v=u({$apply:null}),m=[c,p,d,f,h,v],g={};m.forEach(function(e){g[e]=!0}),t.exports=a},{158:158,163:163,24:24}],141:[function(e,t,n){"use strict";var r=(e(24),e(150)),o=(e(168),r);t.exports=o},{150:150,168:168,24:24}],142:[function(e,t,n){"use strict";var r=e(158),o={addClass:function(e,t){return/\s/.test(t)?r(!1):void 0,t&&(e.classList?e.classList.add(t):o.hasClass(e,t)||(e.className=e.className+" "+t)),e},removeClass:function(e,t){return/\s/.test(t)?r(!1):void 0,t&&(e.classList?e.classList.remove(t):o.hasClass(e,t)&&(e.className=e.className.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,""))),e},conditionClass:function(e,t,n){return(n?o.addClass:o.removeClass)(e,t)},hasClass:function(e,t){return/\s/.test(t)?r(!1):void 0,e.classList?!!t&&e.classList.contains(t):(" "+e.className+" ").indexOf(" "+t+" ")>-1}};t.exports=o},{158:158}],143:[function(e,t,n){"use strict";var r=e(150),o={listen:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),{remove:function(){e.removeEventListener(t,n,!1)}}):e.attachEvent?(e.attachEvent("on"+t,n),{remove:function(){e.detachEvent("on"+t,n)}}):void 0},capture:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!0),{remove:function(){e.removeEventListener(t,n,!0)}}):{remove:r}},registerDefault:function(){}};t.exports=o},{150:150}],144:[function(e,t,n){"use strict";var r=!("undefined"==typeof window||!window.document||!window.document.createElement),o={canUseDOM:r,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:r&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:r&&!!window.screen,isInWorker:!r};t.exports=o},{}],145:[function(e,t,n){"use strict";function r(e){return e.replace(o,function(e,t){return t.toUpperCase()})}var o=/-(.)/g;t.exports=r},{}],146:[function(e,t,n){"use strict";function r(e){return o(e.replace(a,"ms-"))}var o=e(145),a=/^-ms-/;t.exports=r},{145:145}],147:[function(e,t,n){"use strict";function r(e,t){var n=!0;e:for(;n;){var r=e,a=t;if(n=!1,r&&a){if(r===a)return!0;if(o(r))return!1;if(o(a)){e=r,t=a.parentNode,n=!0;continue e}return r.contains?r.contains(a):r.compareDocumentPosition?!!(16&r.compareDocumentPosition(a)):!1}return!1}}var o=e(160);t.exports=r},{160:160}],148:[function(e,t,n){"use strict";function r(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"length"in e&&!("setInterval"in e)&&"number"!=typeof e.nodeType&&(Array.isArray(e)||"callee"in e||"item"in e)}function o(e){return r(e)?Array.isArray(e)?e.slice():a(e):[e]}var a=e(167);t.exports=o},{167:167}],149:[function(e,t,n){"use strict";function r(e){var t=e.match(c);return t&&t[1].toLowerCase()}function o(e,t){var n=l;l?void 0:s(!1);var o=r(e),a=o&&u(o);if(a){n.innerHTML=a[1]+e+a[2];for(var c=a[0];c--;)n=n.lastChild}else n.innerHTML=e;var p=n.getElementsByTagName("script");p.length&&(t?void 0:s(!1),i(p).forEach(t));for(var d=i(n.childNodes);n.lastChild;)n.removeChild(n.lastChild);return d}var a=e(144),i=e(148),u=e(154),s=e(158),l=a.canUseDOM?document.createElement("div"):null,c=/^\s*<(\w+)/;t.exports=o},{144:144,148:148,154:154,158:158}],150:[function(e,t,n){"use strict";function r(e){return function(){return e}}function o(){}o.thatReturns=r,o.thatReturnsFalse=r(!1),o.thatReturnsTrue=r(!0),o.thatReturnsNull=r(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(e){return e},t.exports=o},{}],151:[function(e,t,n){"use strict";var r={};t.exports=r},{}],152:[function(e,t,n){"use strict";function r(e){try{e.focus()}catch(t){}}t.exports=r},{}],153:[function(e,t,n){"use strict";function r(){if("undefined"==typeof document)return null;try{return document.activeElement||document.body}catch(e){return document.body}}t.exports=r},{}],154:[function(e,t,n){"use strict";function r(e){return i?void 0:a(!1),d.hasOwnProperty(e)||(e="*"),u.hasOwnProperty(e)||("*"===e?i.innerHTML="<link />":i.innerHTML="<"+e+"></"+e+">",u[e]=!i.firstChild),u[e]?d[e]:null}var o=e(144),a=e(158),i=o.canUseDOM?document.createElement("div"):null,u={},s=[1,'<select multiple="true">',"</select>"],l=[1,"<table>","</table>"],c=[3,"<table><tbody><tr>","</tr></tbody></table>"],p=[1,'<svg xmlns="http://www.w3.org/2000/svg">',"</svg>"],d={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:s,option:s,caption:l,colgroup:l,tbody:l,tfoot:l,thead:l,td:c,th:c},f=["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","text","tspan"];f.forEach(function(e){d[e]=p,u[e]=!0}),t.exports=r},{144:144,158:158}],155:[function(e,t,n){"use strict";function r(e){return e===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:e.scrollLeft,y:e.scrollTop}}t.exports=r},{}],156:[function(e,t,n){"use strict";function r(e){return e.replace(o,"-$1").toLowerCase()}var o=/([A-Z])/g;t.exports=r},{}],157:[function(e,t,n){"use strict";function r(e){return o(e).replace(a,"-ms-")}var o=e(156),a=/^ms-/;t.exports=r},{156:156}],158:[function(e,t,n){"use strict";var r=function(e,t,n,r,o,a,i,u){if(!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,o,a,i,u],c=0;s=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return l[c++]}))}throw s.framesToPop=1,s}};t.exports=r},{}],159:[function(e,t,n){"use strict";function r(e){return!(!e||!("function"==typeof Node?e instanceof Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}t.exports=r},{}],160:[function(e,t,n){"use strict";function r(e){return o(e)&&3==e.nodeType}var o=e(159);t.exports=r},{159:159}],161:[function(e,t,n){"use strict";function r(e){e||(e="");var t,n=arguments.length;if(n>1)for(var r=1;n>r;r++)t=arguments[r],t&&(e=(e?e+" ":"")+t);return e}t.exports=r},{}],162:[function(e,t,n){"use strict";var r=e(158),o=function(e){var t,n={};e instanceof Object&&!Array.isArray(e)?void 0:r(!1);for(t in e)e.hasOwnProperty(t)&&(n[t]=t);return n};t.exports=o},{158:158}],163:[function(e,t,n){"use strict";var r=function(e){var t;for(t in e)if(e.hasOwnProperty(t))return t;return null};t.exports=r},{}],164:[function(e,t,n){"use strict";function r(e,t,n){if(!e)return null;var r={};for(var a in e)o.call(e,a)&&(r[a]=t.call(n,e[a],a,e));return r}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],165:[function(e,t,n){"use strict";function r(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}t.exports=r},{}],166:[function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var a=o.bind(t),i=0;i<n.length;i++)if(!a(n[i])||e[n[i]]!==t[n[i]])return!1;return!0}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],167:[function(e,t,n){"use strict";function r(e){var t=e.length;if(Array.isArray(e)||"object"!=typeof e&&"function"!=typeof e?o(!1):void 0,"number"!=typeof t?o(!1):void 0,0===t||t-1 in e?void 0:o(!1),e.hasOwnProperty)try{return Array.prototype.slice.call(e)}catch(n){}for(var r=Array(t),a=0;t>a;a++)r[a]=e[a];return r}var o=e(158);t.exports=r},{158:158}],168:[function(e,t,n){"use strict";var r=e(150),o=r;t.exports=o},{150:150}]},{},[1])(1)});
;
;
/*! react-dom-0.14.1.min.js */ 
;
;
/**
* ReactDOM v0.14.1
*
* Copyright 2013-2015, Facebook, Inc.
* All rights reserved.
*
* This source code is licensed under the BSD-style license found in the
* LICENSE file in the root directory of this source tree. An additional grant
* of patent rights can be found in the PATENTS file in the same directory.
*
*/
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e(require("react"));else if("function"==typeof define&&define.amd)define(["react"],e);else{var f;f="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,f.ReactDOM=e(f.React)}}(function(e){return e.__SECRET_DOM_DO_NOT_USE_OR_YOU_WILL_BE_FIRED});
;
;
/*! jquery.uniform.min.js */ 
;
;
!function(e,t,n){"use strict";function s(e){var t=Array.prototype.slice.call(arguments,1);return e.prop?e.prop.apply(e,t):e.attr.apply(e,t)}function a(e,t,n){var s,a;for(s in n)n.hasOwnProperty(s)&&(a=s.replace(/ |$/g,t.eventNamespace),e.bind(a,n[s]))}function r(e,t,n){a(e,n,{focus:function(){t.addClass(n.focusClass)},blur:function(){t.removeClass(n.focusClass),t.removeClass(n.activeClass)},mouseenter:function(){t.addClass(n.hoverClass)},mouseleave:function(){t.removeClass(n.hoverClass),t.removeClass(n.activeClass)},"mousedown touchbegin":function(){e.is(":disabled")||t.addClass(n.activeClass)},"mouseup touchend":function(){t.removeClass(n.activeClass)}})}function i(e,t){e.removeClass(t.hoverClass+" "+t.focusClass+" "+t.activeClass)}function l(e,t,n){n?e.addClass(t):e.removeClass(t)}function u(e,t,n){var s="checked",a=t.is(":"+s);t.prop?t.prop(s,a):a?t.attr(s,s):t.removeAttr(s),l(e,n.checkedClass,a)}function o(e,t,n){l(e,n.disabledClass,t.is(":disabled"))}function c(e,t,n){switch(n){case"after":return e.after(t),e.next();case"before":return e.before(t),e.prev();case"wrap":return e.wrap(t),e.parent()}return null}function d(e,n,a){var r,i,l;return a||(a={}),a=t.extend({bind:{},divClass:null,divWrap:"wrap",spanClass:null,spanHtml:null,spanWrap:"wrap"},a),r=t("<div />"),i=t("<span />"),n.autoHide&&e.is(":hidden")&&"none"===e.css("display")&&r.hide(),a.divClass&&r.addClass(a.divClass),n.wrapperClass&&r.addClass(n.wrapperClass),a.spanClass&&i.addClass(a.spanClass),l=s(e,"id"),n.useID&&l&&s(r,"id",n.idPrefix+"-"+l),a.spanHtml&&i.html(a.spanHtml),r=c(e,r,a.divWrap),i=c(e,i,a.spanWrap),o(r,e,n),{div:r,span:i}}function f(e,n){var s;return n.wrapperClass?(s=t("<span />").addClass(n.wrapperClass),s=c(e,s,"wrap")):null}function p(){var n,s,a,r;return r="rgb(120,2,153)",s=t('<div style="width:0;height:0;color:'+r+'">'),t("body").append(s),a=s.get(0),n=e.getComputedStyle?e.getComputedStyle(a,"").color:(a.currentStyle||a.style||{}).color,s.remove(),n.replace(/ /g,"")!==r}function m(e){return e?t("<span />").text(e).html():""}function v(){return navigator.cpuClass&&!navigator.product}function h(){return void 0!==e.XMLHttpRequest?!0:!1}function C(e){var t;return e[0].multiple?!0:(t=s(e,"size"),!t||1>=t?!1:!0)}function b(){return!1}function y(e,t){var n="none";a(e,t,{"selectstart dragstart mousedown":b}),e.css({MozUserSelect:n,msUserSelect:n,webkitUserSelect:n,userSelect:n})}function w(e,t,n){var s=e.val();""===s?s=n.fileDefaultHtml:(s=s.split(/[\/\\]+/),s=s[s.length-1]),t.text(s)}function g(e,t,n){var s,a;for(s=[],e.each(function(){var e;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&(s.push({el:this,name:e,old:this.style[e]}),this.style[e]=t[e])}),n();s.length;)a=s.pop(),a.el.style[a.name]=a.old}function k(e,t){var n;n=e.parents(),n.push(e[0]),n=n.not(":visible"),g(n,{visibility:"hidden",display:"block",position:"absolute"},t)}function H(e,t){return function(){e.unwrap().unwrap().unbind(t.eventNamespace)}}var x=!0,A=!1,W=[{match:function(e){return e.is("a, button, :submit, :reset, input[type='button']")},apply:function(t,n){var l,u,c,f,p;return u=n.submitDefaultHtml,t.is(":reset")&&(u=n.resetDefaultHtml),f=t.is("a, button")?function(){return t.html()||u}:function(){return m(s(t,"value"))||u},c=d(t,n,{divClass:n.buttonClass,spanHtml:f()}),l=c.div,r(t,l,n),p=!1,a(l,n,{"click touchend":function(){var n,a,r,i;p||t.is(":disabled")||(p=!0,t[0].dispatchEvent?(n=document.createEvent("MouseEvents"),n.initEvent("click",!0,!0),a=t[0].dispatchEvent(n),t.is("a")&&a&&(r=s(t,"target"),i=s(t,"href"),r&&"_self"!==r?e.open(i,r):document.location.href=i)):t.click(),p=!1)}}),y(l,n),{remove:function(){return l.after(t),l.remove(),t.unbind(n.eventNamespace),t},update:function(){i(l,n),o(l,t,n),t.detach(),c.span.html(f()).append(t)}}}},{match:function(e){return e.is(":checkbox")},apply:function(e,t){var n,s,l;return n=d(e,t,{divClass:t.checkboxClass}),s=n.div,l=n.span,r(e,s,t),a(e,t,{"click touchend":function(){u(l,e,t)}}),u(l,e,t),{remove:H(e,t),update:function(){i(s,t),l.removeClass(t.checkedClass),u(l,e,t),o(s,e,t)}}}},{match:function(e){return e.is(":file")},apply:function(e,n){function l(){w(e,p,n)}var u,f,p,m;return u=d(e,n,{divClass:n.fileClass,spanClass:n.fileButtonClass,spanHtml:n.fileButtonHtml,spanWrap:"after"}),f=u.div,m=u.span,p=t("<span />").html(n.fileDefaultHtml),p.addClass(n.filenameClass),p=c(e,p,"after"),s(e,"size")||s(e,"size",f.width()/10),r(e,f,n),l(),v()?a(e,n,{click:function(){e.trigger("change"),setTimeout(l,0)}}):a(e,n,{change:l}),y(p,n),y(m,n),{remove:function(){return p.remove(),m.remove(),e.unwrap().unbind(n.eventNamespace)},update:function(){i(f,n),w(e,p,n),o(f,e,n)}}}},{match:function(e){if(e.is("input")){var t=(" "+s(e,"type")+" ").toLowerCase(),n=" color date datetime datetime-local email month number password search tel text time url week ";return n.indexOf(t)>=0}return!1},apply:function(e,t){var n,a;return n=s(e,"type"),e.addClass(t.inputClass),a=f(e,t),r(e,e,t),t.inputAddTypeAsClass&&e.addClass(n),{remove:function(){e.removeClass(t.inputClass),t.inputAddTypeAsClass&&e.removeClass(n),a&&e.unwrap()},update:b}}},{match:function(e){return e.is(":radio")},apply:function(e,n){var l,c,f;return l=d(e,n,{divClass:n.radioClass}),c=l.div,f=l.span,r(e,c,n),a(e,n,{"click touchend":function(){t.uniform.update(t(':radio[name="'+s(e,"name")+'"]'))}}),u(f,e,n),{remove:H(e,n),update:function(){i(c,n),u(f,e,n),o(c,e,n)}}}},{match:function(e){return e.is("select")&&!C(e)?!0:!1},apply:function(e,n){var s,l,u,c;return n.selectAutoWidth&&k(e,function(){c=e.width()}),s=d(e,n,{divClass:n.selectClass,spanHtml:(e.find(":selected:first")||e.find("option:first")).html(),spanWrap:"before"}),l=s.div,u=s.span,n.selectAutoWidth?k(e,function(){g(t([u[0],l[0]]),{display:"block"},function(){var e;e=u.outerWidth()-u.width(),l.width(c+e),u.width(c)})}):l.addClass("fixedWidth"),r(e,l,n),a(e,n,{change:function(){u.html(e.find(":selected").html()),l.removeClass(n.activeClass)},"click touchend":function(){var t=e.find(":selected").html();u.html()!==t&&e.trigger("change")},keyup:function(){u.html(e.find(":selected").html())}}),y(u,n),{remove:function(){return u.remove(),e.unwrap().unbind(n.eventNamespace),e},update:function(){n.selectAutoWidth?(t.uniform.restore(e),e.uniform(n)):(i(l,n),u.html(e.find(":selected").html()),o(l,e,n))}}}},{match:function(e){return e.is("select")&&C(e)?!0:!1},apply:function(e,t){var n;return e.addClass(t.selectMultiClass),n=f(e,t),r(e,e,t),{remove:function(){e.removeClass(t.selectMultiClass),n&&e.unwrap()},update:b}}},{match:function(e){return e.is("textarea")},apply:function(e,t){var n;return e.addClass(t.textareaClass),n=f(e,t),r(e,e,t),{remove:function(){e.removeClass(t.textareaClass),n&&e.unwrap()},update:b}}}];v()&&!h()&&(x=!1),t.uniform={defaults:{activeClass:"active",autoHide:!0,buttonClass:"button",checkboxClass:"checker",checkedClass:"checked",disabledClass:"disabled",eventNamespace:".uniform",fileButtonClass:"action",fileButtonHtml:"Choose File",fileClass:"uploader",fileDefaultHtml:"No file selected",filenameClass:"filename",focusClass:"focus",hoverClass:"hover",idPrefix:"uniform",inputAddTypeAsClass:!0,inputClass:"uniform-input",radioClass:"radio",resetDefaultHtml:"Reset",resetSelector:!1,selectAutoWidth:!0,selectClass:"selector",selectMultiClass:"uniform-multiselect",submitDefaultHtml:"Submit",textareaClass:"uniform",useID:!0,wrapperClass:null},elements:[]},t.fn.uniform=function(n){var s=this;return n=t.extend({},t.uniform.defaults,n),A||(A=!0,p()&&(x=!1)),x?(n.resetSelector&&t(n.resetSelector).mouseup(function(){e.setTimeout(function(){t.uniform.update(s)},10)}),this.each(function(){var e,s,a,r=t(this);if(r.data("uniformed"))return t.uniform.update(r),void 0;for(e=0;e<W.length;e+=1)if(s=W[e],s.match(r,n))return a=s.apply(r,n),r.data("uniformed",a),t.uniform.elements.push(r.get(0)),void 0})):this},t.uniform.restore=t.fn.uniform.restore=function(e){e===n&&(e=t.uniform.elements),t(e).each(function(){var e,n,s=t(this);n=s.data("uniformed"),n&&(n.remove(),e=t.inArray(this,t.uniform.elements),e>=0&&t.uniform.elements.splice(e,1),s.removeData("uniformed"))})},t.uniform.update=t.fn.uniform.update=function(e){e===n&&(e=t.uniform.elements),t(e).each(function(){var e,n=t(this);e=n.data("uniformed"),e&&e.update(n,e.options)})}}(this,jQuery);
;
;
/*! jquery.autosize.js */ 
;
;
(function ($) {
var
defaults = {
className: 'autosizejs',
append: "",
callback: false
},
hidden = 'hidden',
borderBox = 'border-box',
lineHeight = 'lineHeight',
copy = '<textarea tabindex="-1" style="position:absolute; top:-9999px; left:-9999px; right:auto; bottom:auto; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden;"/>',
copyStyle = [
'fontFamily',
'fontSize',
'fontWeight',
'fontStyle',
'letterSpacing',
'textTransform',
'wordSpacing',
'textIndent'
],
oninput = 'oninput',
onpropertychange = 'onpropertychange',
test = $(copy)[0];
test.setAttribute(oninput, "return");
if ($.isFunction(test[oninput]) || onpropertychange in test) {
$(test).css(lineHeight, '99px');
if ($(test).css(lineHeight) === '99px') {
copyStyle.push(lineHeight);
}
$.fn.autosize = function (options) {
options = $.extend({}, defaults, options || {});
return this.each(function () {
var
ta = this,
$ta = $(ta),
mirror,
minHeight = $ta.height(),
maxHeight = parseInt($ta.css('maxHeight'), 10),
active,
i = copyStyle.length,
resize,
boxOffset = 0,
value = ta.value,
callback = $.isFunction(options.callback);
if ($ta.css('box-sizing') === borderBox || $ta.css('-moz-box-sizing') === borderBox || $ta.css('-webkit-box-sizing') === borderBox){
boxOffset = $ta.outerHeight() - $ta.height();
}
if ($ta.data('mirror') || $ta.data('ismirror')) {
return;
} else {
mirror = $(copy).data('ismirror', true).addClass(options.className)[0];
resize = $ta.css('resize') === 'none' ? 'none' : 'horizontal';
$ta.data('mirror', $(mirror)).css({
overflow: hidden,
overflowY: hidden,
wordWrap: 'break-word',
resize: resize
});
}
maxHeight = maxHeight && maxHeight > 0 ? maxHeight : 9e4;
function adjust() {
var height, overflow, original;
if (!active) {
active = true;
mirror.value = ta.value + options.append;
mirror.style.overflowY = ta.style.overflowY;
original = parseInt(ta.style.height,10);
mirror.style.width = $ta.css('width');
mirror.scrollTop = 0;
mirror.scrollTop = 9e4;
height = mirror.scrollTop;
overflow = hidden;
if (height > maxHeight) {
height = maxHeight;
overflow = 'scroll';
} else if (height < minHeight) {
height = minHeight;
}
height += boxOffset;
ta.style.overflowY = overflow;
if (original !== height) {
ta.style.height = height + 'px';
if (callback) {
options.callback.call(ta);
}
}
setTimeout(function () {
active = false;
}, 1);
}
}
while (i--) {
mirror.style[copyStyle[i]] = $ta.css(copyStyle[i]);
}
$('body').append(mirror);
if (onpropertychange in ta) {
if (oninput in ta) {
ta[oninput] = ta.onkeyup = adjust;
} else {
ta[onpropertychange] = adjust;
}
} else {
ta[oninput] = adjust;
ta.value = '';
ta.value = value;
}
$(window).resize(adjust);
$ta.bind('autosize', adjust);
adjust();
});
};
} else {
$.fn.autosize = function (callback) {
return this;
};
}
}(window.jQuery || window.Zepto));
;
;
/*! jquery.spin.min.js */ 
;
;
(function(t,e){if(typeof exports=="object")module.exports=e();else if(typeof define=="function"&&define.amd)define(e);else t.Spinner=e()})(this,function(){"use strict";var t=["webkit","Moz","ms","O"],e={},i;function o(t,e){var i=document.createElement(t||"div"),o;for(o in e)i[o]=e[o];return i}function n(t){for(var e=1,i=arguments.length;e<i;e++)t.appendChild(arguments[e]);return t}var r=function(){var t=o("style",{type:"text/css"});n(document.getElementsByTagName("head")[0],t);return t.sheet||t.styleSheet}();function s(t,o,n,s){var a=["opacity",o,~~(t*100),n,s].join("-"),f=.01+n/s*100,l=Math.max(1-(1-t)/o*(100-f),t),u=i.substring(0,i.indexOf("Animation")).toLowerCase(),d=u&&"-"+u+"-"||"";if(!e[a]){r.insertRule("@"+d+"keyframes "+a+"{"+"0%{opacity:"+l+"}"+f+"%{opacity:"+t+"}"+(f+.01)+"%{opacity:1}"+(f+o)%100+"%{opacity:"+t+"}"+"100%{opacity:"+l+"}"+"}",r.cssRules.length);e[a]=1}return a}function a(e,i){var o=e.style,n,r;i=i.charAt(0).toUpperCase()+i.slice(1);for(r=0;r<t.length;r++){n=t[r]+i;if(o[n]!==undefined)return n}if(o[i]!==undefined)return i}function f(t,e){for(var i in e)t.style[a(t,i)||i]=e[i];return t}function l(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)if(t[o]===undefined)t[o]=i[o]}return t}function u(t){var e={x:t.offsetLeft,y:t.offsetTop};while(t=t.offsetParent)e.x+=t.offsetLeft,e.y+=t.offsetTop;return e}function d(t,e){return typeof t=="string"?t:t[e%t.length]}var p={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:1/4,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};function c(t){if(typeof this=="undefined")return new c(t);this.opts=l(t||{},c.defaults,p)}c.defaults={};l(c.prototype,{spin:function(t){this.stop();var e=this,n=e.opts,r=e.el=f(o(0,{className:n.className}),{position:n.position,width:0,zIndex:n.zIndex}),s=n.radius+n.length+n.width,a,l;if(t){t.insertBefore(r,t.firstChild||null);l=u(t);a=u(r);f(r,{left:(n.left=="auto"?l.x-a.x+(t.offsetWidth>>1):parseInt(n.left,10)+s)+"px",top:(n.top=="auto"?l.y-a.y+(t.offsetHeight>>1):parseInt(n.top,10)+s)+"px"})}r.setAttribute("role","progressbar");e.lines(r,e.opts);if(!i){var d=0,p=(n.lines-1)*(1-n.direction)/2,c,h=n.fps,m=h/n.speed,y=(1-n.opacity)/(m*n.trail/100),g=m/n.lines;(function v(){d++;for(var t=0;t<n.lines;t++){c=Math.max(1-(d+(n.lines-t)*g)%m*y,n.opacity);e.opacity(r,t*n.direction+p,c,n)}e.timeout=e.el&&setTimeout(v,~~(1e3/h))})()}return e},stop:function(){var t=this.el;if(t){clearTimeout(this.timeout);if(t.parentNode)t.parentNode.removeChild(t);this.el=undefined}return this},lines:function(t,e){var r=0,a=(e.lines-1)*(1-e.direction)/2,l;function u(t,i){return f(o(),{position:"absolute",width:e.length+e.width+"px",height:e.width+"px",background:t,boxShadow:i,transformOrigin:"left",transform:"rotate("+~~(360/e.lines*r+e.rotate)+"deg) translate("+e.radius+"px"+",0)",borderRadius:(e.corners*e.width>>1)+"px"})}for(;r<e.lines;r++){l=f(o(),{position:"absolute",top:1+~(e.width/2)+"px",transform:e.hwaccel?"translate3d(0,0,0)":"",opacity:e.opacity,animation:i&&s(e.opacity,e.trail,a+r*e.direction,e.lines)+" "+1/e.speed+"s linear infinite"});if(e.shadow)n(l,f(u("#000","0 0 4px "+"#000"),{top:2+"px"}));n(t,n(l,u(d(e.color,r),"0 0 1px rgba(0,0,0,.1)")))}return t},opacity:function(t,e,i){if(e<t.childNodes.length)t.childNodes[e].style.opacity=i}});function h(){function t(t,e){return o("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',e)}r.addRule(".spin-vml","behavior:url(#default#VML)");c.prototype.lines=function(e,i){var o=i.length+i.width,r=2*o;function s(){return f(t("group",{coordsize:r+" "+r,coordorigin:-o+" "+-o}),{width:r,height:r})}var a=-(i.width+i.length)*2+"px",l=f(s(),{position:"absolute",top:a,left:a}),u;function p(e,r,a){n(l,n(f(s(),{rotation:360/i.lines*e+"deg",left:~~r}),n(f(t("roundrect",{arcsize:i.corners}),{width:o,height:i.width,left:i.radius,top:-i.width>>1,filter:a}),t("fill",{color:d(i.color,e),opacity:i.opacity}),t("stroke",{opacity:0}))))}if(i.shadow)for(u=1;u<=i.lines;u++)p(u,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(u=1;u<=i.lines;u++)p(u);return n(e,l)};c.prototype.opacity=function(t,e,i,o){var n=t.firstChild;o=o.shadow&&o.lines||0;if(n&&e+o<n.childNodes.length){n=n.childNodes[e+o];n=n&&n.firstChild;n=n&&n.firstChild;if(n)n.opacity=i}}}var m=f(o("group"),{behavior:"url(#default#VML)"});if(!a(m,"transform")&&m.adj)h();else i=a(m,"animation");return c});
;
;
/*! raphael-min.js */ 
;
;
(function(n){var e,t,r="0.4.2",f="hasOwnProperty",i=/[\.\/]/,o="*",u=function(){},l=function(n,e){return n-e},s={n:{}},p=function(n,r){n+="";var f,i=t,o=Array.prototype.slice.call(arguments,2),u=p.listeners(n),s=0,a=[],c={},h=[],d=e;e=n,t=0;for(var g=0,v=u.length;v>g;g++)"zIndex"in u[g]&&(a.push(u[g].zIndex),0>u[g].zIndex&&(c[u[g].zIndex]=u[g]));for(a.sort(l);0>a[s];)if(f=c[a[s++]],h.push(f.apply(r,o)),t)return t=i,h;for(g=0;v>g;g++)if(f=u[g],"zIndex"in f)if(f.zIndex==a[s]){if(h.push(f.apply(r,o)),t)break;do if(s++,f=c[a[s]],f&&h.push(f.apply(r,o)),t)break;while(f)}else c[f.zIndex]=f;else if(h.push(f.apply(r,o)),t)break;return t=i,e=d,h.length?h:null};p._events=s,p.listeners=function(n){var e,t,r,f,u,l,p,a,c=n.split(i),h=s,d=[h],g=[];for(f=0,u=c.length;u>f;f++){for(a=[],l=0,p=d.length;p>l;l++)for(h=d[l].n,t=[h[c[f]],h[o]],r=2;r--;)e=t[r],e&&(a.push(e),g=g.concat(e.f||[]));d=a}return g},p.on=function(n,e){if(n+="","function"!=typeof e)return function(){};for(var t=n.split(i),r=s,f=0,o=t.length;o>f;f++)r=r.n,r=r.hasOwnProperty(t[f])&&r[t[f]]||(r[t[f]]={n:{}});for(r.f=r.f||[],f=0,o=r.f.length;o>f;f++)if(r.f[f]==e)return u;return r.f.push(e),function(n){+n==+n&&(e.zIndex=+n)}},p.f=function(n){var e=[].slice.call(arguments,1);return function(){p.apply(null,[n,null].concat(e).concat([].slice.call(arguments,0)))}},p.stop=function(){t=1},p.nt=function(n){return n?RegExp("(?:\\.|\\/|^)"+n+"(?:\\.|\\/|$)").test(e):e},p.nts=function(){return e.split(i)},p.off=p.unbind=function(n,e){if(!n)return p._events=s={n:{}},void 0;var t,r,u,l,a,c,h,d=n.split(i),g=[s];for(l=0,a=d.length;a>l;l++)for(c=0;g.length>c;c+=u.length-2){if(u=[c,1],t=g[c].n,d[l]!=o)t[d[l]]&&u.push(t[d[l]]);else for(r in t)t[f](r)&&u.push(t[r]);g.splice.apply(g,u)}for(l=0,a=g.length;a>l;l++)for(t=g[l];t.n;){if(e){if(t.f){for(c=0,h=t.f.length;h>c;c++)if(t.f[c]==e){t.f.splice(c,1);break}!t.f.length&&delete t.f}for(r in t.n)if(t.n[f](r)&&t.n[r].f){var v=t.n[r].f;for(c=0,h=v.length;h>c;c++)if(v[c]==e){v.splice(c,1);break}!v.length&&delete t.n[r].f}}else{delete t.f;for(r in t.n)t.n[f](r)&&t.n[r].f&&delete t.n[r].f}t=t.n}},p.once=function(n,e){var t=function(){return p.unbind(n,t),e.apply(this,arguments)};return p.on(n,t)},p.version=r,p.toString=function(){return"You are running Eve "+r},"undefined"!=typeof module&&module.exports?module.exports=p:"undefined"!=typeof define?define("eve",[],function(){return p}):n.eve=p})(this);(function(){function t(e){if(t.is(e,"function"))return m?e():eve.on("raphael.DOMload",e);if(t.is(e,N))return t._engine.create[F](t,e.splice(0,3+t.is(e[0],Y))).add(e);var n=Array.prototype.slice.call(arguments,0);if(t.is(n[n.length-1],"function")){var r=n.pop();return m?r.call(t._engine.create[F](t,n)):eve.on("raphael.DOMload",function(){r.call(t._engine.create[F](t,n))})}return t._engine.create[F](t,arguments)}function e(t){if(Object(t)!==t)return t;var n=new t.constructor;for(var r in t)t[k](r)&&(n[r]=e(t[r]));return n}function n(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return t.push(t.splice(n,1)[0])}function r(t,e,r){function i(){var a=Array.prototype.slice.call(arguments,0),s=a.join("␀"),o=i.cache=i.cache||{},u=i.count=i.count||[];return o[k](s)?(n(u,s),r?r(o[s]):o[s]):(u.length>=1e3&&delete o[u.shift()],u.push(s),o[s]=t[F](e,a),r?r(o[s]):o[s])}return i}function i(){return this.hex}function a(t,e){for(var n=[],r=0,i=t.length;i-2*!e>r;r+=2){var a=[{x:+t[r-2],y:+t[r-1]},{x:+t[r],y:+t[r+1]},{x:+t[r+2],y:+t[r+3]},{x:+t[r+4],y:+t[r+5]}];e?r?i-4==r?a[3]={x:+t[0],y:+t[1]}:i-2==r&&(a[2]={x:+t[0],y:+t[1]},a[3]={x:+t[2],y:+t[3]}):a[0]={x:+t[i-2],y:+t[i-1]}:i-4==r?a[3]=a[2]:r||(a[0]={x:+t[r],y:+t[r+1]}),n.push(["C",(-a[0].x+6*a[1].x+a[2].x)/6,(-a[0].y+6*a[1].y+a[2].y)/6,(a[1].x+6*a[2].x-a[3].x)/6,(a[1].y+6*a[2].y-a[3].y)/6,a[2].x,a[2].y])}return n}function s(t,e,n,r,i){var a=-3*e+9*n-9*r+3*i,s=t*a+6*e-12*n+6*r;return t*s-3*e+3*n}function o(t,e,n,r,i,a,o,u,l){null==l&&(l=1),l=l>1?1:0>l?0:l;for(var h=l/2,c=12,f=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],p=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],d=0,g=0;c>g;g++){var x=h*f[g]+h,v=s(x,t,n,i,o),m=s(x,e,r,a,u),y=v*v+m*m;d+=p[g]*j.sqrt(y)}return h*d}function u(t,e,n,r,i,a,s,u,l){if(!(0>l||l>o(t,e,n,r,i,a,s,u))){var h,c=1,f=c/2,p=c-f,d=.01;for(h=o(t,e,n,r,i,a,s,u,p);O(h-l)>d;)f/=2,p+=(l>h?1:-1)*f,h=o(t,e,n,r,i,a,s,u,p);return p}}function l(t,e,n,r,i,a,s,o){if(!(D(t,n)<z(i,s)||z(t,n)>D(i,s)||D(e,r)<z(a,o)||z(e,r)>D(a,o))){var u=(t*r-e*n)*(i-s)-(t-n)*(i*o-a*s),l=(t*r-e*n)*(a-o)-(e-r)*(i*o-a*s),h=(t-n)*(a-o)-(e-r)*(i-s);if(h){var c=u/h,f=l/h,p=+c.toFixed(2),d=+f.toFixed(2);if(!(+z(t,n).toFixed(2)>p||p>+D(t,n).toFixed(2)||+z(i,s).toFixed(2)>p||p>+D(i,s).toFixed(2)||+z(e,r).toFixed(2)>d||d>+D(e,r).toFixed(2)||+z(a,o).toFixed(2)>d||d>+D(a,o).toFixed(2)))return{x:c,y:f}}}}function h(e,n,r){var i=t.bezierBBox(e),a=t.bezierBBox(n);if(!t.isBBoxIntersect(i,a))return r?0:[];for(var s=o.apply(0,e),u=o.apply(0,n),h=~~(s/5),c=~~(u/5),f=[],p=[],d={},g=r?0:[],x=0;h+1>x;x++){var v=t.findDotsAtSegment.apply(t,e.concat(x/h));f.push({x:v.x,y:v.y,t:x/h})}for(x=0;c+1>x;x++)v=t.findDotsAtSegment.apply(t,n.concat(x/c)),p.push({x:v.x,y:v.y,t:x/c});for(x=0;h>x;x++)for(var m=0;c>m;m++){var y=f[x],b=f[x+1],_=p[m],w=p[m+1],k=.001>O(b.x-y.x)?"y":"x",B=.001>O(w.x-_.x)?"y":"x",S=l(y.x,y.y,b.x,b.y,_.x,_.y,w.x,w.y);if(S){if(d[S.x.toFixed(4)]==S.y.toFixed(4))continue;d[S.x.toFixed(4)]=S.y.toFixed(4);var C=y.t+O((S[k]-y[k])/(b[k]-y[k]))*(b.t-y.t),F=_.t+O((S[B]-_[B])/(w[B]-_[B]))*(w.t-_.t);C>=0&&1>=C&&F>=0&&1>=F&&(r?g++:g.push({x:S.x,y:S.y,t1:C,t2:F}))}}return g}function c(e,n,r){e=t._path2curve(e),n=t._path2curve(n);for(var i,a,s,o,u,l,c,f,p,d,g=r?0:[],x=0,v=e.length;v>x;x++){var m=e[x];if("M"==m[0])i=u=m[1],a=l=m[2];else{"C"==m[0]?(p=[i,a].concat(m.slice(1)),i=p[6],a=p[7]):(p=[i,a,i,a,u,l,u,l],i=u,a=l);for(var y=0,b=n.length;b>y;y++){var _=n[y];if("M"==_[0])s=c=_[1],o=f=_[2];else{"C"==_[0]?(d=[s,o].concat(_.slice(1)),s=d[6],o=d[7]):(d=[s,o,s,o,c,f,c,f],s=c,o=f);var w=h(p,d,r);if(r)g+=w;else{for(var k=0,B=w.length;B>k;k++)w[k].segment1=x,w[k].segment2=y,w[k].bez1=p,w[k].bez2=d;g=g.concat(w)}}}}}return g}function f(t,e,n,r,i,a){null!=t?(this.a=+t,this.b=+e,this.c=+n,this.d=+r,this.e=+i,this.f=+a):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function p(){return this.x+P+this.y+P+this.width+" × "+this.height}function d(t,e,n,r,i,a){function s(t){return((c*t+h)*t+l)*t}function o(t,e){var n=u(t,e);return((d*n+p)*n+f)*n}function u(t,e){var n,r,i,a,o,u;for(i=t,u=0;8>u;u++){if(a=s(i)-t,e>O(a))return i;if(o=(3*c*i+2*h)*i+l,1e-6>O(o))break;i-=a/o}if(n=0,r=1,i=t,n>i)return n;if(i>r)return r;for(;r>n;){if(a=s(i),e>O(a-t))return i;t>a?n=i:r=i,i=(r-n)/2+n}return i}var l=3*e,h=3*(r-e)-l,c=1-l-h,f=3*n,p=3*(i-n)-f,d=1-f-p;return o(t,1/(200*a))}function g(t,e){var n=[],r={};if(this.ms=e,this.times=1,t){for(var i in t)t[k](i)&&(r[Q(i)]=t[i],n.push(Q(i)));n.sort(le)}this.anim=r,this.top=n[n.length-1],this.percents=n}function x(e,n,r,i,a,s){r=Q(r);var o,u,l,h,c,p,g=e.ms,x={},v={},m={};if(i)for(_=0,w=sn.length;w>_;_++){var y=sn[_];if(y.el.id==n.id&&y.anim==e){y.percent!=r?(sn.splice(_,1),l=1):u=y,n.attr(y.totalOrigin);break}}else i=+v;for(var _=0,w=e.percents.length;w>_;_++){if(e.percents[_]==r||e.percents[_]>i*e.top){r=e.percents[_],c=e.percents[_-1]||0,g=g/e.top*(r-c),h=e.percents[_+1],o=e.anim[r];break}i&&n.attr(e.anim[e.percents[_]])}if(o){if(u)u.initstatus=i,u.start=new Date-u.ms*i;else{for(var B in o)if(o[k](B)&&(ee[k](B)||n.paper.customAttributes[k](B)))switch(x[B]=n.attr(B),null==x[B]&&(x[B]=te[B]),v[B]=o[B],ee[B]){case Y:m[B]=(v[B]-x[B])/g;break;case"colour":x[B]=t.getRGB(x[B]);var S=t.getRGB(v[B]);m[B]={r:(S.r-x[B].r)/g,g:(S.g-x[B].g)/g,b:(S.b-x[B].b)/g};break;case"path":var C=Ie(x[B],v[B]),F=C[1];for(x[B]=C[0],m[B]=[],_=0,w=x[B].length;w>_;_++){m[B][_]=[0];for(var L=1,A=x[B][_].length;A>L;L++)m[B][_][L]=(F[_][L]-x[B][_][L])/g}break;case"transform":var P=n._,I=ze(P[B],v[B]);if(I)for(x[B]=I.from,v[B]=I.to,m[B]=[],m[B].real=!0,_=0,w=x[B].length;w>_;_++)for(m[B][_]=[x[B][_][0]],L=1,A=x[B][_].length;A>L;L++)m[B][_][L]=(v[B][_][L]-x[B][_][L])/g;else{var R=n.matrix||new f,q={_:{transform:P.transform},getBBox:function(){return n.getBBox(1)}};x[B]=[R.a,R.b,R.c,R.d,R.e,R.f],je(q,v[B]),v[B]=q._.transform,m[B]=[(q.matrix.a-R.a)/g,(q.matrix.b-R.b)/g,(q.matrix.c-R.c)/g,(q.matrix.d-R.d)/g,(q.matrix.e-R.e)/g,(q.matrix.f-R.f)/g]}break;case"csv":var j=E(o[B])[M](b),D=E(x[B])[M](b);if("clip-rect"==B)for(x[B]=D,m[B]=[],_=D.length;_--;)m[B][_]=(j[_]-x[B][_])/g;v[B]=j;break;default:for(j=[][T](o[B]),D=[][T](x[B]),m[B]=[],_=n.paper.customAttributes[B].length;_--;)m[B][_]=((j[_]||0)-(D[_]||0))/g}var z=o.easing,O=t.easing_formulas[z];if(!O)if(O=E(z).match(U),O&&5==O.length){var V=O;O=function(t){return d(t,+V[1],+V[2],+V[3],+V[4],g)}}else O=ce;if(p=o.start||e.start||+new Date,y={anim:e,percent:r,timestamp:p,start:p+(e.del||0),status:0,initstatus:i||0,stop:!1,ms:g,easing:O,from:x,diff:m,to:v,el:n,callback:o.callback,prev:c,next:h,repeat:s||e.times,origin:n.attr(),totalOrigin:a},sn.push(y),i&&!u&&!l&&(y.stop=!0,y.start=new Date-g*i,1==sn.length))return un();l&&(y.start=new Date-y.ms*i),1==sn.length&&on(un)}eve("raphael.anim.start."+n.id,n,e)}}function v(t){for(var e=0;sn.length>e;e++)sn[e].el.paper==t&&sn.splice(e--,1)}t.version="2.1.0",t.eve=eve;var m,y,b=/[, ]+/,_={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},w=/\{(\d+)\}/g,k="hasOwnProperty",B={doc:document,win:window},S={was:Object.prototype[k].call(B.win,"Raphael"),is:B.win.Raphael},C=function(){this.ca=this.customAttributes={}},F="apply",T="concat",L="createTouch"in B.doc,A="",P=" ",E=String,M="split",I="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[M](P),R={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},q=E.prototype.toLowerCase,j=Math,D=j.max,z=j.min,O=j.abs,V=j.pow,X=j.PI,Y="number",G="string",N="array",W=Object.prototype.toString,$=(t._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),H={NaN:1,Infinity:1,"-Infinity":1},U=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,Z=j.round,Q=parseFloat,J=parseInt,K=E.prototype.toUpperCase,te=t._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},ee=t._availableAnimAttrs={blur:Y,"clip-rect":"csv",cx:Y,cy:Y,fill:"colour","fill-opacity":Y,"font-size":Y,height:Y,opacity:Y,path:"path",r:Y,rx:Y,ry:Y,stroke:"colour","stroke-opacity":Y,"stroke-width":Y,transform:"transform",width:Y,x:Y,y:Y},ne=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,re={hs:1,rg:1},ie=/,?([achlmqrstvxz]),?/gi,ae=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,se=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,oe=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,ue=(t._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),le=function(t,e){return Q(t)-Q(e)},he=function(){},ce=function(t){return t},fe=t._rectPath=function(t,e,n,r,i){return i?[["M",t+i,e],["l",n-2*i,0],["a",i,i,0,0,1,i,i],["l",0,r-2*i],["a",i,i,0,0,1,-i,i],["l",2*i-n,0],["a",i,i,0,0,1,-i,-i],["l",0,2*i-r],["a",i,i,0,0,1,i,-i],["z"]]:[["M",t,e],["l",n,0],["l",0,r],["l",-n,0],["z"]]},pe=function(t,e,n,r){return null==r&&(r=n),[["M",t,e],["m",0,-r],["a",n,r,0,1,1,0,2*r],["a",n,r,0,1,1,0,-2*r],["z"]]},de=t._getPath={path:function(t){return t.attr("path")},circle:function(t){var e=t.attrs;return pe(e.cx,e.cy,e.r)},ellipse:function(t){var e=t.attrs;return pe(e.cx,e.cy,e.rx,e.ry)},rect:function(t){var e=t.attrs;return fe(e.x,e.y,e.width,e.height,e.r)},image:function(t){var e=t.attrs;return fe(e.x,e.y,e.width,e.height)},text:function(t){var e=t._getBBox();return fe(e.x,e.y,e.width,e.height)},set:function(t){var e=t._getBBox();return fe(e.x,e.y,e.width,e.height)}},ge=t.mapPath=function(t,e){if(!e)return t;var n,r,i,a,s,o,u;for(t=Ie(t),i=0,s=t.length;s>i;i++)for(u=t[i],a=1,o=u.length;o>a;a+=2)n=e.x(u[a],u[a+1]),r=e.y(u[a],u[a+1]),u[a]=n,u[a+1]=r;return t};if(t._g=B,t.type=B.win.SVGAngle||B.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==t.type){var xe,ve=B.doc.createElement("div");if(ve.innerHTML='<v:shape adj="1"/>',xe=ve.firstChild,xe.style.behavior="url(#default#VML)",!xe||"object"!=typeof xe.adj)return t.type=A;ve=null}t.svg=!(t.vml="VML"==t.type),t._Paper=C,t.fn=y=C.prototype=t.prototype,t._id=0,t._oid=0,t.is=function(t,e){return e=q.call(e),"finite"==e?!H[k](+t):"array"==e?t instanceof Array:"null"==e&&null===t||e==typeof t&&null!==t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||W.call(t).slice(8,-1).toLowerCase()==e},t.angle=function(e,n,r,i,a,s){if(null==a){var o=e-r,u=n-i;return o||u?(180+180*j.atan2(-u,-o)/X+360)%360:0}return t.angle(e,n,a,s)-t.angle(r,i,a,s)},t.rad=function(t){return t%360*X/180},t.deg=function(t){return 180*t/X%360},t.snapTo=function(e,n,r){if(r=t.is(r,"finite")?r:10,t.is(e,N)){for(var i=e.length;i--;)if(r>=O(e[i]-n))return e[i]}else{e=+e;var a=n%e;if(r>a)return n-a;if(a>e-r)return n-a+e}return n},t.createUUID=function(t,e){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(t,e).toUpperCase()}}(/[xy]/g,function(t){var e=0|16*j.random(),n="x"==t?e:8|3&e;return n.toString(16)}),t.setWindow=function(e){eve("raphael.setWindow",t,B.win,e),B.win=e,B.doc=B.win.document,t._engine.initWin&&t._engine.initWin(B.win)};var me=function(e){if(t.vml){var n,i=/^\s+|\s+$/g;try{var a=new ActiveXObject("htmlfile");a.write("<body>"),a.close(),n=a.body}catch(s){n=createPopup().document.body}var o=n.createTextRange();me=r(function(t){try{n.style.color=E(t).replace(i,A);var e=o.queryCommandValue("ForeColor");return e=(255&e)<<16|65280&e|(16711680&e)>>>16,"#"+("000000"+e.toString(16)).slice(-6)}catch(r){return"none"}})}else{var u=B.doc.createElement("i");u.title="Raphaël Colour Picker",u.style.display="none",B.doc.body.appendChild(u),me=r(function(t){return u.style.color=t,B.doc.defaultView.getComputedStyle(u,A).getPropertyValue("color")})}return me(e)},ye=function(){return"hsb("+[this.h,this.s,this.b]+")"},be=function(){return"hsl("+[this.h,this.s,this.l]+")"},_e=function(){return this.hex},we=function(e,n,r){if(null==n&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(r=e.b,n=e.g,e=e.r),null==n&&t.is(e,G)){var i=t.getRGB(e);e=i.r,n=i.g,r=i.b}return(e>1||n>1||r>1)&&(e/=255,n/=255,r/=255),[e,n,r]},ke=function(e,n,r,i){e*=255,n*=255,r*=255;var a={r:e,g:n,b:r,hex:t.rgb(e,n,r),toString:_e};return t.is(i,"finite")&&(a.opacity=i),a};t.color=function(e){var n;return t.is(e,"object")&&"h"in e&&"s"in e&&"b"in e?(n=t.hsb2rgb(e),e.r=n.r,e.g=n.g,e.b=n.b,e.hex=n.hex):t.is(e,"object")&&"h"in e&&"s"in e&&"l"in e?(n=t.hsl2rgb(e),e.r=n.r,e.g=n.g,e.b=n.b,e.hex=n.hex):(t.is(e,"string")&&(e=t.getRGB(e)),t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e?(n=t.rgb2hsl(e),e.h=n.h,e.s=n.s,e.l=n.l,n=t.rgb2hsb(e),e.v=n.b):(e={hex:"none"},e.r=e.g=e.b=e.h=e.s=e.v=e.l=-1)),e.toString=_e,e},t.hsb2rgb=function(t,e,n,r){this.is(t,"object")&&"h"in t&&"s"in t&&"b"in t&&(n=t.b,e=t.s,t=t.h,r=t.o),t*=360;var i,a,s,o,u;return t=t%360/60,u=n*e,o=u*(1-O(t%2-1)),i=a=s=n-u,t=~~t,i+=[u,o,0,0,o,u][t],a+=[o,u,u,o,0,0][t],s+=[0,0,o,u,u,o][t],ke(i,a,s,r)},t.hsl2rgb=function(t,e,n,r){this.is(t,"object")&&"h"in t&&"s"in t&&"l"in t&&(n=t.l,e=t.s,t=t.h),(t>1||e>1||n>1)&&(t/=360,e/=100,n/=100),t*=360;var i,a,s,o,u;return t=t%360/60,u=2*e*(.5>n?n:1-n),o=u*(1-O(t%2-1)),i=a=s=n-u/2,t=~~t,i+=[u,o,0,0,o,u][t],a+=[o,u,u,o,0,0][t],s+=[0,0,o,u,u,o][t],ke(i,a,s,r)},t.rgb2hsb=function(t,e,n){n=we(t,e,n),t=n[0],e=n[1],n=n[2];var r,i,a,s;return a=D(t,e,n),s=a-z(t,e,n),r=0==s?null:a==t?(e-n)/s:a==e?(n-t)/s+2:(t-e)/s+4,r=60*((r+360)%6)/360,i=0==s?0:s/a,{h:r,s:i,b:a,toString:ye}},t.rgb2hsl=function(t,e,n){n=we(t,e,n),t=n[0],e=n[1],n=n[2];var r,i,a,s,o,u;return s=D(t,e,n),o=z(t,e,n),u=s-o,r=0==u?null:s==t?(e-n)/u:s==e?(n-t)/u+2:(t-e)/u+4,r=60*((r+360)%6)/360,a=(s+o)/2,i=0==u?0:.5>a?u/(2*a):u/(2-2*a),{h:r,s:i,l:a,toString:be}},t._path2string=function(){return this.join(",").replace(ie,"$1")},t._preload=function(t,e){var n=B.doc.createElement("img");n.style.cssText="position:absolute;left:-9999em;top:-9999em",n.onload=function(){e.call(this),this.onload=null,B.doc.body.removeChild(this)},n.onerror=function(){B.doc.body.removeChild(this)},B.doc.body.appendChild(n),n.src=t},t.getRGB=r(function(e){if(!e||(e=E(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:i};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none",toString:i};!(re[k](e.toLowerCase().substring(0,2))||"#"==e.charAt())&&(e=me(e));var n,r,a,s,o,u,l=e.match($);return l?(l[2]&&(a=J(l[2].substring(5),16),r=J(l[2].substring(3,5),16),n=J(l[2].substring(1,3),16)),l[3]&&(a=J((o=l[3].charAt(3))+o,16),r=J((o=l[3].charAt(2))+o,16),n=J((o=l[3].charAt(1))+o,16)),l[4]&&(u=l[4][M](ne),n=Q(u[0]),"%"==u[0].slice(-1)&&(n*=2.55),r=Q(u[1]),"%"==u[1].slice(-1)&&(r*=2.55),a=Q(u[2]),"%"==u[2].slice(-1)&&(a*=2.55),"rgba"==l[1].toLowerCase().slice(0,4)&&(s=Q(u[3])),u[3]&&"%"==u[3].slice(-1)&&(s/=100)),l[5]?(u=l[5][M](ne),n=Q(u[0]),"%"==u[0].slice(-1)&&(n*=2.55),r=Q(u[1]),"%"==u[1].slice(-1)&&(r*=2.55),a=Q(u[2]),"%"==u[2].slice(-1)&&(a*=2.55),("deg"==u[0].slice(-3)||"°"==u[0].slice(-1))&&(n/=360),"hsba"==l[1].toLowerCase().slice(0,4)&&(s=Q(u[3])),u[3]&&"%"==u[3].slice(-1)&&(s/=100),t.hsb2rgb(n,r,a,s)):l[6]?(u=l[6][M](ne),n=Q(u[0]),"%"==u[0].slice(-1)&&(n*=2.55),r=Q(u[1]),"%"==u[1].slice(-1)&&(r*=2.55),a=Q(u[2]),"%"==u[2].slice(-1)&&(a*=2.55),("deg"==u[0].slice(-3)||"°"==u[0].slice(-1))&&(n/=360),"hsla"==l[1].toLowerCase().slice(0,4)&&(s=Q(u[3])),u[3]&&"%"==u[3].slice(-1)&&(s/=100),t.hsl2rgb(n,r,a,s)):(l={r:n,g:r,b:a,toString:i},l.hex="#"+(16777216|a|r<<8|n<<16).toString(16).slice(1),t.is(s,"finite")&&(l.opacity=s),l)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:i}},t),t.hsb=r(function(e,n,r){return t.hsb2rgb(e,n,r).hex}),t.hsl=r(function(e,n,r){return t.hsl2rgb(e,n,r).hex}),t.rgb=r(function(t,e,n){return"#"+(16777216|n|e<<8|t<<16).toString(16).slice(1)}),t.getColor=function(t){var e=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},n=this.hsb2rgb(e.h,e.s,e.b);return e.h+=.075,e.h>1&&(e.h=0,e.s-=.2,0>=e.s&&(this.getColor.start={h:0,s:1,b:e.b})),n.hex},t.getColor.reset=function(){delete this.start},t.parsePathString=function(e){if(!e)return null;var n=Be(e);if(n.arr)return Ce(n.arr);var r={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},i=[];return t.is(e,N)&&t.is(e[0],N)&&(i=Ce(e)),i.length||E(e).replace(ae,function(t,e,n){var a=[],s=e.toLowerCase();if(n.replace(oe,function(t,e){e&&a.push(+e)}),"m"==s&&a.length>2&&(i.push([e][T](a.splice(0,2))),s="l",e="m"==e?"l":"L"),"r"==s)i.push([e][T](a));else for(;a.length>=r[s]&&(i.push([e][T](a.splice(0,r[s]))),r[s]););}),i.toString=t._path2string,n.arr=Ce(i),i},t.parseTransformString=r(function(e){if(!e)return null;var n=[];return t.is(e,N)&&t.is(e[0],N)&&(n=Ce(e)),n.length||E(e).replace(se,function(t,e,r){var i=[];q.call(e),r.replace(oe,function(t,e){e&&i.push(+e)}),n.push([e][T](i))}),n.toString=t._path2string,n});var Be=function(t){var e=Be.ps=Be.ps||{};return e[t]?e[t].sleep=100:e[t]={sleep:100},setTimeout(function(){for(var n in e)e[k](n)&&n!=t&&(e[n].sleep--,!e[n].sleep&&delete e[n])}),e[t]};t.findDotsAtSegment=function(t,e,n,r,i,a,s,o,u){var l=1-u,h=V(l,3),c=V(l,2),f=u*u,p=f*u,d=h*t+3*c*u*n+3*l*u*u*i+p*s,g=h*e+3*c*u*r+3*l*u*u*a+p*o,x=t+2*u*(n-t)+f*(i-2*n+t),v=e+2*u*(r-e)+f*(a-2*r+e),m=n+2*u*(i-n)+f*(s-2*i+n),y=r+2*u*(a-r)+f*(o-2*a+r),b=l*t+u*n,_=l*e+u*r,w=l*i+u*s,k=l*a+u*o,B=90-180*j.atan2(x-m,v-y)/X;return(x>m||y>v)&&(B+=180),{x:d,y:g,m:{x:x,y:v},n:{x:m,y:y},start:{x:b,y:_},end:{x:w,y:k},alpha:B}},t.bezierBBox=function(e,n,r,i,a,s,o,u){t.is(e,"array")||(e=[e,n,r,i,a,s,o,u]);var l=Me.apply(null,e);return{x:l.min.x,y:l.min.y,x2:l.max.x,y2:l.max.y,width:l.max.x-l.min.x,height:l.max.y-l.min.y}},t.isPointInsideBBox=function(t,e,n){return e>=t.x&&t.x2>=e&&n>=t.y&&t.y2>=n},t.isBBoxIntersect=function(e,n){var r=t.isPointInsideBBox;return r(n,e.x,e.y)||r(n,e.x2,e.y)||r(n,e.x,e.y2)||r(n,e.x2,e.y2)||r(e,n.x,n.y)||r(e,n.x2,n.y)||r(e,n.x,n.y2)||r(e,n.x2,n.y2)||(e.x<n.x2&&e.x>n.x||n.x<e.x2&&n.x>e.x)&&(e.y<n.y2&&e.y>n.y||n.y<e.y2&&n.y>e.y)},t.pathIntersection=function(t,e){return c(t,e)},t.pathIntersectionNumber=function(t,e){return c(t,e,1)},t.isPointInsidePath=function(e,n,r){var i=t.pathBBox(e);return t.isPointInsideBBox(i,n,r)&&1==c(e,[["M",n,r],["H",i.x2+10]],1)%2},t._removedFactory=function(t){return function(){eve("raphael.log",null,"Raphaël: you are calling to method “"+t+"” of removed object",t)}};var Se=t.pathBBox=function(t){var n=Be(t);if(n.bbox)return e(n.bbox);if(!t)return{x:0,y:0,width:0,height:0,x2:0,y2:0};t=Ie(t);for(var r,i=0,a=0,s=[],o=[],u=0,l=t.length;l>u;u++)if(r=t[u],"M"==r[0])i=r[1],a=r[2],s.push(i),o.push(a);else{var h=Me(i,a,r[1],r[2],r[3],r[4],r[5],r[6]);s=s[T](h.min.x,h.max.x),o=o[T](h.min.y,h.max.y),i=r[5],a=r[6]}var c=z[F](0,s),f=z[F](0,o),p=D[F](0,s),d=D[F](0,o),g=p-c,x=d-f,v={x:c,y:f,x2:p,y2:d,width:g,height:x,cx:c+g/2,cy:f+x/2};return n.bbox=e(v),v},Ce=function(n){var r=e(n);return r.toString=t._path2string,r},Fe=t._pathToRelative=function(e){var n=Be(e);if(n.rel)return Ce(n.rel);t.is(e,N)&&t.is(e&&e[0],N)||(e=t.parsePathString(e));var r=[],i=0,a=0,s=0,o=0,u=0;"M"==e[0][0]&&(i=e[0][1],a=e[0][2],s=i,o=a,u++,r.push(["M",i,a]));for(var l=u,h=e.length;h>l;l++){var c=r[l]=[],f=e[l];if(f[0]!=q.call(f[0]))switch(c[0]=q.call(f[0]),c[0]){case"a":c[1]=f[1],c[2]=f[2],c[3]=f[3],c[4]=f[4],c[5]=f[5],c[6]=+(f[6]-i).toFixed(3),c[7]=+(f[7]-a).toFixed(3);break;case"v":c[1]=+(f[1]-a).toFixed(3);break;case"m":s=f[1],o=f[2];default:for(var p=1,d=f.length;d>p;p++)c[p]=+(f[p]-(p%2?i:a)).toFixed(3)}else{c=r[l]=[],"m"==f[0]&&(s=f[1]+i,o=f[2]+a);for(var g=0,x=f.length;x>g;g++)r[l][g]=f[g]}var v=r[l].length;switch(r[l][0]){case"z":i=s,a=o;break;case"h":i+=+r[l][v-1];break;case"v":a+=+r[l][v-1];break;default:i+=+r[l][v-2],a+=+r[l][v-1]}}return r.toString=t._path2string,n.rel=Ce(r),r},Te=t._pathToAbsolute=function(e){var n=Be(e);if(n.abs)return Ce(n.abs);if(t.is(e,N)&&t.is(e&&e[0],N)||(e=t.parsePathString(e)),!e||!e.length)return[["M",0,0]];var r=[],i=0,s=0,o=0,u=0,l=0;"M"==e[0][0]&&(i=+e[0][1],s=+e[0][2],o=i,u=s,l++,r[0]=["M",i,s]);for(var h,c,f=3==e.length&&"M"==e[0][0]&&"R"==e[1][0].toUpperCase()&&"Z"==e[2][0].toUpperCase(),p=l,d=e.length;d>p;p++){if(r.push(h=[]),c=e[p],c[0]!=K.call(c[0]))switch(h[0]=K.call(c[0]),h[0]){case"A":h[1]=c[1],h[2]=c[2],h[3]=c[3],h[4]=c[4],h[5]=c[5],h[6]=+(c[6]+i),h[7]=+(c[7]+s);break;case"V":h[1]=+c[1]+s;break;case"H":h[1]=+c[1]+i;break;case"R":for(var g=[i,s][T](c.slice(1)),x=2,v=g.length;v>x;x++)g[x]=+g[x]+i,g[++x]=+g[x]+s;r.pop(),r=r[T](a(g,f));break;case"M":o=+c[1]+i,u=+c[2]+s;default:for(x=1,v=c.length;v>x;x++)h[x]=+c[x]+(x%2?i:s)}else if("R"==c[0])g=[i,s][T](c.slice(1)),r.pop(),r=r[T](a(g,f)),h=["R"][T](c.slice(-2));else for(var m=0,y=c.length;y>m;m++)h[m]=c[m];switch(h[0]){case"Z":i=o,s=u;break;case"H":i=h[1];break;case"V":s=h[1];break;case"M":o=h[h.length-2],u=h[h.length-1];default:i=h[h.length-2],s=h[h.length-1]}}return r.toString=t._path2string,n.abs=Ce(r),r},Le=function(t,e,n,r){return[t,e,n,r,n,r]},Ae=function(t,e,n,r,i,a){var s=1/3,o=2/3;return[s*t+o*n,s*e+o*r,s*i+o*n,s*a+o*r,i,a]},Pe=function(t,e,n,i,a,s,o,u,l,h){var c,f=120*X/180,p=X/180*(+a||0),d=[],g=r(function(t,e,n){var r=t*j.cos(n)-e*j.sin(n),i=t*j.sin(n)+e*j.cos(n);return{x:r,y:i}});if(h)B=h[0],S=h[1],w=h[2],k=h[3];else{c=g(t,e,-p),t=c.x,e=c.y,c=g(u,l,-p),u=c.x,l=c.y;var x=(j.cos(X/180*a),j.sin(X/180*a),(t-u)/2),v=(e-l)/2,m=x*x/(n*n)+v*v/(i*i);m>1&&(m=j.sqrt(m),n=m*n,i=m*i);var y=n*n,b=i*i,_=(s==o?-1:1)*j.sqrt(O((y*b-y*v*v-b*x*x)/(y*v*v+b*x*x))),w=_*n*v/i+(t+u)/2,k=_*-i*x/n+(e+l)/2,B=j.asin(((e-k)/i).toFixed(9)),S=j.asin(((l-k)/i).toFixed(9));B=w>t?X-B:B,S=w>u?X-S:S,0>B&&(B=2*X+B),0>S&&(S=2*X+S),o&&B>S&&(B-=2*X),!o&&S>B&&(S-=2*X)}var C=S-B;if(O(C)>f){var F=S,L=u,A=l;S=B+f*(o&&S>B?1:-1),u=w+n*j.cos(S),l=k+i*j.sin(S),d=Pe(u,l,n,i,a,0,o,L,A,[S,F,w,k])}C=S-B;var P=j.cos(B),E=j.sin(B),I=j.cos(S),R=j.sin(S),q=j.tan(C/4),D=4/3*n*q,z=4/3*i*q,V=[t,e],Y=[t+D*E,e-z*P],G=[u+D*R,l-z*I],N=[u,l];if(Y[0]=2*V[0]-Y[0],Y[1]=2*V[1]-Y[1],h)return[Y,G,N][T](d);d=[Y,G,N][T](d).join()[M](",");for(var W=[],$=0,H=d.length;H>$;$++)W[$]=$%2?g(d[$-1],d[$],p).y:g(d[$],d[$+1],p).x;return W},Ee=function(t,e,n,r,i,a,s,o,u){var l=1-u;return{x:V(l,3)*t+3*V(l,2)*u*n+3*l*u*u*i+V(u,3)*s,y:V(l,3)*e+3*V(l,2)*u*r+3*l*u*u*a+V(u,3)*o}},Me=r(function(t,e,n,r,i,a,s,o){var u,l=i-2*n+t-(s-2*i+n),h=2*(n-t)-2*(i-n),c=t-n,f=(-h+j.sqrt(h*h-4*l*c))/2/l,p=(-h-j.sqrt(h*h-4*l*c))/2/l,d=[e,o],g=[t,s];return O(f)>"1e12"&&(f=.5),O(p)>"1e12"&&(p=.5),f>0&&1>f&&(u=Ee(t,e,n,r,i,a,s,o,f),g.push(u.x),d.push(u.y)),p>0&&1>p&&(u=Ee(t,e,n,r,i,a,s,o,p),g.push(u.x),d.push(u.y)),l=a-2*r+e-(o-2*a+r),h=2*(r-e)-2*(a-r),c=e-r,f=(-h+j.sqrt(h*h-4*l*c))/2/l,p=(-h-j.sqrt(h*h-4*l*c))/2/l,O(f)>"1e12"&&(f=.5),O(p)>"1e12"&&(p=.5),f>0&&1>f&&(u=Ee(t,e,n,r,i,a,s,o,f),g.push(u.x),d.push(u.y)),p>0&&1>p&&(u=Ee(t,e,n,r,i,a,s,o,p),g.push(u.x),d.push(u.y)),{min:{x:z[F](0,g),y:z[F](0,d)},max:{x:D[F](0,g),y:D[F](0,d)}}}),Ie=t._path2curve=r(function(t,e){var n=!e&&Be(t);if(!e&&n.curve)return Ce(n.curve);for(var r=Te(t),i=e&&Te(e),a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o=(function(t,e){var n,r;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][T](Pe[F](0,[e.x,e.y][T](t.slice(1))));break;case"S":n=e.x+(e.x-(e.bx||e.x)),r=e.y+(e.y-(e.by||e.y)),t=["C",n,r][T](t.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),t=["C"][T](Ae(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][T](Ae(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][T](Le(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][T](Le(e.x,e.y,t[1],e.y));break;case"V":t=["C"][T](Le(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][T](Le(e.x,e.y,e.X,e.Y))}return t}),u=function(t,e){if(t[e].length>7){t[e].shift();for(var n=t[e];n.length;)t.splice(e++,0,["C"][T](n.splice(0,6)));t.splice(e,1),c=D(r.length,i&&i.length||0)}},l=function(t,e,n,a,s){t&&e&&"M"==t[s][0]&&"M"!=e[s][0]&&(e.splice(s,0,["M",a.x,a.y]),n.bx=0,n.by=0,n.x=t[s][1],n.y=t[s][2],c=D(r.length,i&&i.length||0))},h=0,c=D(r.length,i&&i.length||0);c>h;h++){r[h]=o(r[h],a),u(r,h),i&&(i[h]=o(i[h],s)),i&&u(i,h),l(r,i,a,s,h),l(i,r,s,a,h);var f=r[h],p=i&&i[h],d=f.length,g=i&&p.length;a.x=f[d-2],a.y=f[d-1],a.bx=Q(f[d-4])||a.x,a.by=Q(f[d-3])||a.y,s.bx=i&&(Q(p[g-4])||s.x),s.by=i&&(Q(p[g-3])||s.y),s.x=i&&p[g-2],s.y=i&&p[g-1]}return i||(n.curve=Ce(r)),i?[r,i]:r},null,Ce),Re=(t._parseDots=r(function(e){for(var n=[],r=0,i=e.length;i>r;r++){var a={},s=e[r].match(/^([^:]*):?([\d\.]*)/);if(a.color=t.getRGB(s[1]),a.color.error)return null;a.color=a.color.hex,s[2]&&(a.offset=s[2]+"%"),n.push(a)}for(r=1,i=n.length-1;i>r;r++)if(!n[r].offset){for(var o=Q(n[r-1].offset||0),u=0,l=r+1;i>l;l++)if(n[l].offset){u=n[l].offset;break}u||(u=100,l=i),u=Q(u);for(var h=(u-o)/(l-r+1);l>r;r++)o+=h,n[r].offset=o+"%"}return n}),t._tear=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)}),qe=(t._tofront=function(t,e){e.top!==t&&(Re(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},t._toback=function(t,e){e.bottom!==t&&(Re(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},t._insertafter=function(t,e,n){Re(t,n),e==n.top&&(n.top=t),e.next&&(e.next.prev=t),t.next=e.next,t.prev=e,e.next=t},t._insertbefore=function(t,e,n){Re(t,n),e==n.bottom&&(n.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,e.prev=t,t.next=e},t.toMatrix=function(t,e){var n=Se(t),r={_:{transform:A},getBBox:function(){return n}};return je(r,e),r.matrix}),je=(t.transformPath=function(t,e){return ge(t,qe(t,e))},t._extractTransform=function(e,n){if(null==n)return e._.transform;n=E(n).replace(/\.{3}|\u2026/g,e._.transform||A);var r=t.parseTransformString(n),i=0,a=0,s=0,o=1,u=1,l=e._,h=new f;if(l.transform=r||[],r)for(var c=0,p=r.length;p>c;c++){var d,g,x,v,m,y=r[c],b=y.length,_=E(y[0]).toLowerCase(),w=y[0]!=_,k=w?h.invert():0;"t"==_&&3==b?w?(d=k.x(0,0),g=k.y(0,0),x=k.x(y[1],y[2]),v=k.y(y[1],y[2]),h.translate(x-d,v-g)):h.translate(y[1],y[2]):"r"==_?2==b?(m=m||e.getBBox(1),h.rotate(y[1],m.x+m.width/2,m.y+m.height/2),i+=y[1]):4==b&&(w?(x=k.x(y[2],y[3]),v=k.y(y[2],y[3]),h.rotate(y[1],x,v)):h.rotate(y[1],y[2],y[3]),i+=y[1]):"s"==_?2==b||3==b?(m=m||e.getBBox(1),h.scale(y[1],y[b-1],m.x+m.width/2,m.y+m.height/2),o*=y[1],u*=y[b-1]):5==b&&(w?(x=k.x(y[3],y[4]),v=k.y(y[3],y[4]),h.scale(y[1],y[2],x,v)):h.scale(y[1],y[2],y[3],y[4]),o*=y[1],u*=y[2]):"m"==_&&7==b&&h.add(y[1],y[2],y[3],y[4],y[5],y[6]),l.dirtyT=1,e.matrix=h}e.matrix=h,l.sx=o,l.sy=u,l.deg=i,l.dx=a=h.e,l.dy=s=h.f,1==o&&1==u&&!i&&l.bbox?(l.bbox.x+=+a,l.bbox.y+=+s):l.dirtyT=1}),De=function(t){var e=t[0];switch(e.toLowerCase()){case"t":return[e,0,0];case"m":return[e,1,0,0,1,0,0];case"r":return 4==t.length?[e,0,t[2],t[3]]:[e,0];case"s":return 5==t.length?[e,1,1,t[3],t[4]]:3==t.length?[e,1,1]:[e,1]}},ze=t._equaliseTransform=function(e,n){n=E(n).replace(/\.{3}|\u2026/g,e),e=t.parseTransformString(e)||[],n=t.parseTransformString(n)||[];for(var r,i,a,s,o=D(e.length,n.length),u=[],l=[],h=0;o>h;h++){if(a=e[h]||De(n[h]),s=n[h]||De(a),a[0]!=s[0]||"r"==a[0].toLowerCase()&&(a[2]!=s[2]||a[3]!=s[3])||"s"==a[0].toLowerCase()&&(a[3]!=s[3]||a[4]!=s[4]))return;for(u[h]=[],l[h]=[],r=0,i=D(a.length,s.length);i>r;r++)r in a&&(u[h][r]=a[r]),r in s&&(l[h][r]=s[r])}return{from:u,to:l}};t._getContainer=function(e,n,r,i){var a;return a=null!=i||t.is(e,"object")?e:B.doc.getElementById(e),null!=a?a.tagName?null==n?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||a.offsetHeight}:{container:a,width:n,height:r}:{container:1,x:e,y:n,width:r,height:i}:void 0},t.pathToRelative=Fe,t._engine={},t.path2curve=Ie,t.matrix=function(t,e,n,r,i,a){return new f(t,e,n,r,i,a)},function(e){function n(t){return t[0]*t[0]+t[1]*t[1]}function r(t){var e=j.sqrt(n(t));t[0]&&(t[0]/=e),t[1]&&(t[1]/=e)}e.add=function(t,e,n,r,i,a){var s,o,u,l,h=[[],[],[]],c=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],p=[[t,n,i],[e,r,a],[0,0,1]];for(t&&t instanceof f&&(p=[[t.a,t.c,t.e],[t.b,t.d,t.f],[0,0,1]]),s=0;3>s;s++)for(o=0;3>o;o++){for(l=0,u=0;3>u;u++)l+=c[s][u]*p[u][o];h[s][o]=l}this.a=h[0][0],this.b=h[1][0],this.c=h[0][1],this.d=h[1][1],this.e=h[0][2],this.f=h[1][2]},e.invert=function(){var t=this,e=t.a*t.d-t.b*t.c;return new f(t.d/e,-t.b/e,-t.c/e,t.a/e,(t.c*t.f-t.d*t.e)/e,(t.b*t.e-t.a*t.f)/e)},e.clone=function(){return new f(this.a,this.b,this.c,this.d,this.e,this.f)},e.translate=function(t,e){this.add(1,0,0,1,t,e)},e.scale=function(t,e,n,r){null==e&&(e=t),(n||r)&&this.add(1,0,0,1,n,r),this.add(t,0,0,e,0,0),(n||r)&&this.add(1,0,0,1,-n,-r)},e.rotate=function(e,n,r){e=t.rad(e),n=n||0,r=r||0;var i=+j.cos(e).toFixed(9),a=+j.sin(e).toFixed(9);this.add(i,a,-a,i,n,r),this.add(1,0,0,1,-n,-r)},e.x=function(t,e){return t*this.a+e*this.c+this.e},e.y=function(t,e){return t*this.b+e*this.d+this.f},e.get=function(t){return+this[E.fromCharCode(97+t)].toFixed(4)},e.toString=function(){return t.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},e.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},e.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},e.split=function(){var e={};e.dx=this.e,e.dy=this.f;var i=[[this.a,this.c],[this.b,this.d]];e.scalex=j.sqrt(n(i[0])),r(i[0]),e.shear=i[0][0]*i[1][0]+i[0][1]*i[1][1],i[1]=[i[1][0]-i[0][0]*e.shear,i[1][1]-i[0][1]*e.shear],e.scaley=j.sqrt(n(i[1])),r(i[1]),e.shear/=e.scaley;var a=-i[0][1],s=i[1][1];return 0>s?(e.rotate=t.deg(j.acos(s)),0>a&&(e.rotate=360-e.rotate)):e.rotate=t.deg(j.asin(a)),e.isSimple=!(+e.shear.toFixed(9)||e.scalex.toFixed(9)!=e.scaley.toFixed(9)&&e.rotate),e.isSuperSimple=!+e.shear.toFixed(9)&&e.scalex.toFixed(9)==e.scaley.toFixed(9)&&!e.rotate,e.noRotation=!+e.shear.toFixed(9)&&!e.rotate,e
},e.toTransformString=function(t){var e=t||this[M]();return e.isSimple?(e.scalex=+e.scalex.toFixed(4),e.scaley=+e.scaley.toFixed(4),e.rotate=+e.rotate.toFixed(4),(e.dx||e.dy?"t"+[e.dx,e.dy]:A)+(1!=e.scalex||1!=e.scaley?"s"+[e.scalex,e.scaley,0,0]:A)+(e.rotate?"r"+[e.rotate,0,0]:A)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(f.prototype);var Oe=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);y.safari="Apple Computer, Inc."==navigator.vendor&&(Oe&&4>Oe[1]||"iP"==navigator.platform.slice(0,2))||"Google Inc."==navigator.vendor&&Oe&&8>Oe[1]?function(){var t=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){t.remove()})}:he;for(var Ve=function(){this.returnValue=!1},Xe=function(){return this.originalEvent.preventDefault()},Ye=function(){this.cancelBubble=!0},Ge=function(){return this.originalEvent.stopPropagation()},Ne=function(){return B.doc.addEventListener?function(t,e,n,r){var i=L&&R[e]?R[e]:e,a=function(i){var a=B.doc.documentElement.scrollTop||B.doc.body.scrollTop,s=B.doc.documentElement.scrollLeft||B.doc.body.scrollLeft,o=i.clientX+s,u=i.clientY+a;if(L&&R[k](e))for(var l=0,h=i.targetTouches&&i.targetTouches.length;h>l;l++)if(i.targetTouches[l].target==t){var c=i;i=i.targetTouches[l],i.originalEvent=c,i.preventDefault=Xe,i.stopPropagation=Ge;break}return n.call(r,i,o,u)};return t.addEventListener(i,a,!1),function(){return t.removeEventListener(i,a,!1),!0}}:B.doc.attachEvent?function(t,e,n,r){var i=function(t){t=t||B.win.event;var e=B.doc.documentElement.scrollTop||B.doc.body.scrollTop,i=B.doc.documentElement.scrollLeft||B.doc.body.scrollLeft,a=t.clientX+i,s=t.clientY+e;return t.preventDefault=t.preventDefault||Ve,t.stopPropagation=t.stopPropagation||Ye,n.call(r,t,a,s)};t.attachEvent("on"+e,i);var a=function(){return t.detachEvent("on"+e,i),!0};return a}:void 0}(),We=[],$e=function(t){for(var e,n=t.clientX,r=t.clientY,i=B.doc.documentElement.scrollTop||B.doc.body.scrollTop,a=B.doc.documentElement.scrollLeft||B.doc.body.scrollLeft,s=We.length;s--;){if(e=We[s],L){for(var o,u=t.touches.length;u--;)if(o=t.touches[u],o.identifier==e.el._drag.id){n=o.clientX,r=o.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();var l,h=e.el.node,c=h.nextSibling,f=h.parentNode,p=h.style.display;B.win.opera&&f.removeChild(h),h.style.display="none",l=e.el.paper.getElementByPoint(n,r),h.style.display=p,B.win.opera&&(c?f.insertBefore(h,c):f.appendChild(h)),l&&eve("raphael.drag.over."+e.el.id,e.el,l),n+=a,r+=i,eve("raphael.drag.move."+e.el.id,e.move_scope||e.el,n-e.el._drag.x,r-e.el._drag.y,n,r,t)}},He=function(e){t.unmousemove($e).unmouseup(He);for(var n,r=We.length;r--;)n=We[r],n.el._drag={},eve("raphael.drag.end."+n.el.id,n.end_scope||n.start_scope||n.move_scope||n.el,e);We=[]},Ue=t.el={},Ze=I.length;Ze--;)(function(e){t[e]=Ue[e]=function(n,r){return t.is(n,"function")&&(this.events=this.events||[],this.events.push({name:e,f:n,unbind:Ne(this.shape||this.node||B.doc,e,n,r||this)})),this},t["un"+e]=Ue["un"+e]=function(t){for(var n=this.events||[],r=n.length;r--;)if(n[r].name==e&&n[r].f==t)return n[r].unbind(),n.splice(r,1),!n.length&&delete this.events,this;return this}})(I[Ze]);Ue.data=function(e,n){var r=ue[this.id]=ue[this.id]||{};if(1==arguments.length){if(t.is(e,"object")){for(var i in e)e[k](i)&&this.data(i,e[i]);return this}return eve("raphael.data.get."+this.id,this,r[e],e),r[e]}return r[e]=n,eve("raphael.data.set."+this.id,this,n,e),this},Ue.removeData=function(t){return null==t?ue[this.id]={}:ue[this.id]&&delete ue[this.id][t],this},Ue.getData=function(){return e(ue[this.id]||{})},Ue.hover=function(t,e,n,r){return this.mouseover(t,n).mouseout(e,r||n)},Ue.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)};var Qe=[];Ue.drag=function(e,n,r,i,a,s){function o(o){(o.originalEvent||o).preventDefault();var u=B.doc.documentElement.scrollTop||B.doc.body.scrollTop,l=B.doc.documentElement.scrollLeft||B.doc.body.scrollLeft;this._drag.x=o.clientX+l,this._drag.y=o.clientY+u,this._drag.id=o.identifier,!We.length&&t.mousemove($e).mouseup(He),We.push({el:this,move_scope:i,start_scope:a,end_scope:s}),n&&eve.on("raphael.drag.start."+this.id,n),e&&eve.on("raphael.drag.move."+this.id,e),r&&eve.on("raphael.drag.end."+this.id,r),eve("raphael.drag.start."+this.id,a||i||this,o.clientX+l,o.clientY+u,o)}return this._drag={},Qe.push({el:this,start:o}),this.mousedown(o),this},Ue.onDragOver=function(t){t?eve.on("raphael.drag.over."+this.id,t):eve.unbind("raphael.drag.over."+this.id)},Ue.undrag=function(){for(var e=Qe.length;e--;)Qe[e].el==this&&(this.unmousedown(Qe[e].start),Qe.splice(e,1),eve.unbind("raphael.drag.*."+this.id));!Qe.length&&t.unmousemove($e).unmouseup(He),We=[]},y.circle=function(e,n,r){var i=t._engine.circle(this,e||0,n||0,r||0);return this.__set__&&this.__set__.push(i),i},y.rect=function(e,n,r,i,a){var s=t._engine.rect(this,e||0,n||0,r||0,i||0,a||0);return this.__set__&&this.__set__.push(s),s},y.ellipse=function(e,n,r,i){var a=t._engine.ellipse(this,e||0,n||0,r||0,i||0);return this.__set__&&this.__set__.push(a),a},y.path=function(e){e&&!t.is(e,G)&&!t.is(e[0],N)&&(e+=A);var n=t._engine.path(t.format[F](t,arguments),this);return this.__set__&&this.__set__.push(n),n},y.image=function(e,n,r,i,a){var s=t._engine.image(this,e||"about:blank",n||0,r||0,i||0,a||0);return this.__set__&&this.__set__.push(s),s},y.text=function(e,n,r){var i=t._engine.text(this,e||0,n||0,E(r));return this.__set__&&this.__set__.push(i),i},y.set=function(e){!t.is(e,"array")&&(e=Array.prototype.splice.call(arguments,0,arguments.length));var n=new hn(e);return this.__set__&&this.__set__.push(n),n.paper=this,n.type="set",n},y.setStart=function(t){this.__set__=t||this.set()},y.setFinish=function(){var t=this.__set__;return delete this.__set__,t},y.setSize=function(e,n){return t._engine.setSize.call(this,e,n)},y.setViewBox=function(e,n,r,i,a){return t._engine.setViewBox.call(this,e,n,r,i,a)},y.top=y.bottom=null,y.raphael=t;var Je=function(t){var e=t.getBoundingClientRect(),n=t.ownerDocument,r=n.body,i=n.documentElement,a=i.clientTop||r.clientTop||0,s=i.clientLeft||r.clientLeft||0,o=e.top+(B.win.pageYOffset||i.scrollTop||r.scrollTop)-a,u=e.left+(B.win.pageXOffset||i.scrollLeft||r.scrollLeft)-s;return{y:o,x:u}};y.getElementByPoint=function(t,e){var n=this,r=n.canvas,i=B.doc.elementFromPoint(t,e);if(B.win.opera&&"svg"==i.tagName){var a=Je(r),s=r.createSVGRect();s.x=t-a.x,s.y=e-a.y,s.width=s.height=1;var o=r.getIntersectionList(s,null);o.length&&(i=o[o.length-1])}if(!i)return null;for(;i.parentNode&&i!=r.parentNode&&!i.raphael;)i=i.parentNode;return i==n.canvas.parentNode&&(i=r),i=i&&i.raphael?n.getById(i.raphaelid):null},y.getElementsByBBox=function(e){var n=this.set();return this.forEach(function(r){t.isBBoxIntersect(r.getBBox(),e)&&n.push(r)}),n},y.getById=function(t){for(var e=this.bottom;e;){if(e.id==t)return e;e=e.next}return null},y.forEach=function(t,e){for(var n=this.bottom;n;){if(t.call(e,n)===!1)return this;n=n.next}return this},y.getElementsByPoint=function(t,e){var n=this.set();return this.forEach(function(r){r.isPointInside(t,e)&&n.push(r)}),n},Ue.isPointInside=function(e,n){var r=this.realPath=this.realPath||de[this.type](this);return t.isPointInsidePath(r,e,n)},Ue.getBBox=function(t){if(this.removed)return{};var e=this._;return t?((e.dirty||!e.bboxwt)&&(this.realPath=de[this.type](this),e.bboxwt=Se(this.realPath),e.bboxwt.toString=p,e.dirty=0),e.bboxwt):((e.dirty||e.dirtyT||!e.bbox)&&((e.dirty||!this.realPath)&&(e.bboxwt=0,this.realPath=de[this.type](this)),e.bbox=Se(ge(this.realPath,this.matrix)),e.bbox.toString=p,e.dirty=e.dirtyT=0),e.bbox)},Ue.clone=function(){if(this.removed)return null;var t=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(t),t},Ue.glow=function(t){if("text"==this.type)return null;t=t||{};var e={width:(t.width||10)+(+this.attr("stroke-width")||1),fill:t.fill||!1,opacity:t.opacity||.5,offsetx:t.offsetx||0,offsety:t.offsety||0,color:t.color||"#000"},n=e.width/2,r=this.paper,i=r.set(),a=this.realPath||de[this.type](this);a=this.matrix?ge(a,this.matrix):a;for(var s=1;n+1>s;s++)i.push(r.path(a).attr({stroke:e.color,fill:e.fill?e.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(e.width/n*s).toFixed(3),opacity:+(e.opacity/n).toFixed(3)}));return i.insertBefore(this).translate(e.offsetx,e.offsety)};var Ke=function(e,n,r,i,a,s,l,h,c){return null==c?o(e,n,r,i,a,s,l,h):t.findDotsAtSegment(e,n,r,i,a,s,l,h,u(e,n,r,i,a,s,l,h,c))},tn=function(e,n){return function(r,i,a){r=Ie(r);for(var s,o,u,l,h,c="",f={},p=0,d=0,g=r.length;g>d;d++){if(u=r[d],"M"==u[0])s=+u[1],o=+u[2];else{if(l=Ke(s,o,u[1],u[2],u[3],u[4],u[5],u[6]),p+l>i){if(n&&!f.start){if(h=Ke(s,o,u[1],u[2],u[3],u[4],u[5],u[6],i-p),c+=["C"+h.start.x,h.start.y,h.m.x,h.m.y,h.x,h.y],a)return c;f.start=c,c=["M"+h.x,h.y+"C"+h.n.x,h.n.y,h.end.x,h.end.y,u[5],u[6]].join(),p+=l,s=+u[5],o=+u[6];continue}if(!e&&!n)return h=Ke(s,o,u[1],u[2],u[3],u[4],u[5],u[6],i-p),{x:h.x,y:h.y,alpha:h.alpha}}p+=l,s=+u[5],o=+u[6]}c+=u.shift()+u}return f.end=c,h=e?p:n?f:t.findDotsAtSegment(s,o,u[0],u[1],u[2],u[3],u[4],u[5],1),h.alpha&&(h={x:h.x,y:h.y,alpha:h.alpha}),h}},en=tn(1),nn=tn(),rn=tn(0,1);t.getTotalLength=en,t.getPointAtLength=nn,t.getSubpath=function(t,e,n){if(1e-6>this.getTotalLength(t)-n)return rn(t,e).end;var r=rn(t,n,1);return e?rn(r,e).end:r},Ue.getTotalLength=function(){return"path"==this.type?this.node.getTotalLength?this.node.getTotalLength():en(this.attrs.path):void 0},Ue.getPointAtLength=function(t){return"path"==this.type?nn(this.attrs.path,t):void 0},Ue.getSubpath=function(e,n){return"path"==this.type?t.getSubpath(this.attrs.path,e,n):void 0};var an=t.easing_formulas={linear:function(t){return t},"<":function(t){return V(t,1.7)},">":function(t){return V(t,.48)},"<>":function(t){var e=.48-t/1.04,n=j.sqrt(.1734+e*e),r=n-e,i=V(O(r),1/3)*(0>r?-1:1),a=-n-e,s=V(O(a),1/3)*(0>a?-1:1),o=i+s+.5;return 3*(1-o)*o*o+o*o*o},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},elastic:function(t){return t==!!t?t:V(2,-10*t)*j.sin((t-.075)*2*X/.3)+1},bounce:function(t){var e,n=7.5625,r=2.75;return 1/r>t?e=n*t*t:2/r>t?(t-=1.5/r,e=n*t*t+.75):2.5/r>t?(t-=2.25/r,e=n*t*t+.9375):(t-=2.625/r,e=n*t*t+.984375),e}};an.easeIn=an["ease-in"]=an["<"],an.easeOut=an["ease-out"]=an[">"],an.easeInOut=an["ease-in-out"]=an["<>"],an["back-in"]=an.backIn,an["back-out"]=an.backOut;var sn=[],on=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,16)},un=function(){for(var e=+new Date,n=0;sn.length>n;n++){var r=sn[n];if(!r.el.removed&&!r.paused){var i,a,s=e-r.start,o=r.ms,u=r.easing,l=r.from,h=r.diff,c=r.to,f=(r.t,r.el),p={},d={};if(r.initstatus?(s=(r.initstatus*r.anim.top-r.prev)/(r.percent-r.prev)*o,r.status=r.initstatus,delete r.initstatus,r.stop&&sn.splice(n--,1)):r.status=(r.prev+(r.percent-r.prev)*(s/o))/r.anim.top,!(0>s))if(o>s){var g=u(s/o);for(var v in l)if(l[k](v)){switch(ee[v]){case Y:i=+l[v]+g*o*h[v];break;case"colour":i="rgb("+[ln(Z(l[v].r+g*o*h[v].r)),ln(Z(l[v].g+g*o*h[v].g)),ln(Z(l[v].b+g*o*h[v].b))].join(",")+")";break;case"path":i=[];for(var m=0,y=l[v].length;y>m;m++){i[m]=[l[v][m][0]];for(var b=1,_=l[v][m].length;_>b;b++)i[m][b]=+l[v][m][b]+g*o*h[v][m][b];i[m]=i[m].join(P)}i=i.join(P);break;case"transform":if(h[v].real)for(i=[],m=0,y=l[v].length;y>m;m++)for(i[m]=[l[v][m][0]],b=1,_=l[v][m].length;_>b;b++)i[m][b]=l[v][m][b]+g*o*h[v][m][b];else{var w=function(t){return+l[v][t]+g*o*h[v][t]};i=[["m",w(0),w(1),w(2),w(3),w(4),w(5)]]}break;case"csv":if("clip-rect"==v)for(i=[],m=4;m--;)i[m]=+l[v][m]+g*o*h[v][m];break;default:var B=[][T](l[v]);for(i=[],m=f.paper.customAttributes[v].length;m--;)i[m]=+B[m]+g*o*h[v][m]}p[v]=i}f.attr(p),function(t,e,n){setTimeout(function(){eve("raphael.anim.frame."+t,e,n)})}(f.id,f,r.anim)}else{if(function(e,n,r){setTimeout(function(){eve("raphael.anim.frame."+n.id,n,r),eve("raphael.anim.finish."+n.id,n,r),t.is(e,"function")&&e.call(n)})}(r.callback,f,r.anim),f.attr(c),sn.splice(n--,1),r.repeat>1&&!r.next){for(a in c)c[k](a)&&(d[a]=r.totalOrigin[a]);r.el.attr(d),x(r.anim,r.el,r.anim.percents[0],null,r.totalOrigin,r.repeat-1)}r.next&&!r.stop&&x(r.anim,r.el,r.next,null,r.totalOrigin,r.repeat)}}}t.svg&&f&&f.paper&&f.paper.safari(),sn.length&&on(un)},ln=function(t){return t>255?255:0>t?0:t};Ue.animateWith=function(e,n,r,i,a,s){var o=this;if(o.removed)return s&&s.call(o),o;var u=r instanceof g?r:t.animation(r,i,a,s);x(u,o,u.percents[0],null,o.attr());for(var l=0,h=sn.length;h>l;l++)if(sn[l].anim==n&&sn[l].el==e){sn[h-1].start=sn[l].start;break}return o},Ue.onAnimation=function(t){return t?eve.on("raphael.anim.frame."+this.id,t):eve.unbind("raphael.anim.frame."+this.id),this},g.prototype.delay=function(t){var e=new g(this.anim,this.ms);return e.times=this.times,e.del=+t||0,e},g.prototype.repeat=function(t){var e=new g(this.anim,this.ms);return e.del=this.del,e.times=j.floor(D(t,0))||1,e},t.animation=function(e,n,r,i){if(e instanceof g)return e;(t.is(r,"function")||!r)&&(i=i||r||null,r=null),e=Object(e),n=+n||0;var a,s,o={};for(s in e)e[k](s)&&Q(s)!=s&&Q(s)+"%"!=s&&(a=!0,o[s]=e[s]);return a?(r&&(o.easing=r),i&&(o.callback=i),new g({100:o},n)):new g(e,n)},Ue.animate=function(e,n,r,i){var a=this;if(a.removed)return i&&i.call(a),a;var s=e instanceof g?e:t.animation(e,n,r,i);return x(s,a,s.percents[0],null,a.attr()),a},Ue.setTime=function(t,e){return t&&null!=e&&this.status(t,z(e,t.ms)/t.ms),this},Ue.status=function(t,e){var n,r,i=[],a=0;if(null!=e)return x(t,this,-1,z(e,1)),this;for(n=sn.length;n>a;a++)if(r=sn[a],r.el.id==this.id&&(!t||r.anim==t)){if(t)return r.status;i.push({anim:r.anim,status:r.status})}return t?0:i},Ue.pause=function(t){for(var e=0;sn.length>e;e++)sn[e].el.id!=this.id||t&&sn[e].anim!=t||eve("raphael.anim.pause."+this.id,this,sn[e].anim)!==!1&&(sn[e].paused=!0);return this},Ue.resume=function(t){for(var e=0;sn.length>e;e++)if(sn[e].el.id==this.id&&(!t||sn[e].anim==t)){var n=sn[e];eve("raphael.anim.resume."+this.id,this,n.anim)!==!1&&(delete n.paused,this.status(n.anim,n.status))}return this},Ue.stop=function(t){for(var e=0;sn.length>e;e++)sn[e].el.id!=this.id||t&&sn[e].anim!=t||eve("raphael.anim.stop."+this.id,this,sn[e].anim)!==!1&&sn.splice(e--,1);return this},eve.on("raphael.remove",v),eve.on("raphael.clear",v),Ue.toString=function(){return"Raphaël’s object"};var hn=function(t){if(this.items=[],this.length=0,this.type="set",t)for(var e=0,n=t.length;n>e;e++)!t[e]||t[e].constructor!=Ue.constructor&&t[e].constructor!=hn||(this[this.items.length]=this.items[this.items.length]=t[e],this.length++)},cn=hn.prototype;cn.push=function(){for(var t,e,n=0,r=arguments.length;r>n;n++)t=arguments[n],!t||t.constructor!=Ue.constructor&&t.constructor!=hn||(e=this.items.length,this[e]=this.items[e]=t,this.length++);return this},cn.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},cn.forEach=function(t,e){for(var n=0,r=this.items.length;r>n;n++)if(t.call(e,this.items[n],n)===!1)return this;return this};for(var fn in Ue)Ue[k](fn)&&(cn[fn]=function(t){return function(){var e=arguments;return this.forEach(function(n){n[t][F](n,e)})}}(fn));cn.attr=function(e,n){if(e&&t.is(e,N)&&t.is(e[0],"object"))for(var r=0,i=e.length;i>r;r++)this.items[r].attr(e[r]);else for(var a=0,s=this.items.length;s>a;a++)this.items[a].attr(e,n);return this},cn.clear=function(){for(;this.length;)this.pop()},cn.splice=function(t,e){t=0>t?D(this.length+t,0):t,e=D(0,z(this.length-t,e));var n,r=[],i=[],a=[];for(n=2;arguments.length>n;n++)a.push(arguments[n]);for(n=0;e>n;n++)i.push(this[t+n]);for(;this.length-t>n;n++)r.push(this[t+n]);var s=a.length;for(n=0;s+r.length>n;n++)this.items[t+n]=this[t+n]=s>n?a[n]:r[n-s];for(n=this.items.length=this.length-=e-s;this[n];)delete this[n++];return new hn(i)},cn.exclude=function(t){for(var e=0,n=this.length;n>e;e++)if(this[e]==t)return this.splice(e,1),!0},cn.animate=function(e,n,r,i){(t.is(r,"function")||!r)&&(i=r||null);var a,s,o=this.items.length,u=o,l=this;if(!o)return this;i&&(s=function(){!--o&&i.call(l)}),r=t.is(r,G)?r:s;var h=t.animation(e,n,r,s);for(a=this.items[--u].animate(h);u--;)this.items[u]&&!this.items[u].removed&&this.items[u].animateWith(a,h,h);return this},cn.insertAfter=function(t){for(var e=this.items.length;e--;)this.items[e].insertAfter(t);return this},cn.getBBox=function(){for(var t=[],e=[],n=[],r=[],i=this.items.length;i--;)if(!this.items[i].removed){var a=this.items[i].getBBox();t.push(a.x),e.push(a.y),n.push(a.x+a.width),r.push(a.y+a.height)}return t=z[F](0,t),e=z[F](0,e),n=D[F](0,n),r=D[F](0,r),{x:t,y:e,x2:n,y2:r,width:n-t,height:r-e}},cn.clone=function(t){t=this.paper.set();for(var e=0,n=this.items.length;n>e;e++)t.push(this.items[e].clone());return t},cn.toString=function(){return"Raphaël‘s set"},cn.glow=function(t){var e=this.paper.set();return this.forEach(function(n){var r=n.glow(t);null!=r&&r.forEach(function(t){e.push(t)})}),e},t.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e={w:t.w,face:{},glyphs:{}},n=t.face["font-family"];for(var r in t.face)t.face[k](r)&&(e.face[r]=t.face[r]);if(this.fonts[n]?this.fonts[n].push(e):this.fonts[n]=[e],!t.svg){e.face["units-per-em"]=J(t.face["units-per-em"],10);for(var i in t.glyphs)if(t.glyphs[k](i)){var a=t.glyphs[i];if(e.glyphs[i]={w:a.w,k:{},d:a.d&&"M"+a.d.replace(/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},a.k)for(var s in a.k)a[k](s)&&(e.glyphs[i].k[s]=a.k[s])}}return t},y.getFont=function(e,n,r,i){if(i=i||"normal",r=r||"normal",n=+n||{normal:400,bold:700,lighter:300,bolder:800}[n]||400,t.fonts){var a=t.fonts[e];if(!a){var s=RegExp("(^|\\s)"+e.replace(/[^\w\d\s+!~.:_-]/g,A)+"(\\s|$)","i");for(var o in t.fonts)if(t.fonts[k](o)&&s.test(o)){a=t.fonts[o];break}}var u;if(a)for(var l=0,h=a.length;h>l&&(u=a[l],u.face["font-weight"]!=n||u.face["font-style"]!=r&&u.face["font-style"]||u.face["font-stretch"]!=i);l++);return u}},y.print=function(e,n,r,i,a,s,o){s=s||"middle",o=D(z(o||0,1),-1);var u,l=E(r)[M](A),h=0,c=0,f=A;if(t.is(i,"string")&&(i=this.getFont(i)),i){u=(a||16)/i.face["units-per-em"];for(var p=i.face.bbox[M](b),d=+p[0],g=p[3]-p[1],x=0,v=+p[1]+("baseline"==s?g+ +i.face.descent:g/2),m=0,y=l.length;y>m;m++){if("\n"==l[m])h=0,w=0,c=0,x+=g;else{var _=c&&i.glyphs[l[m-1]]||{},w=i.glyphs[l[m]];h+=c?(_.w||i.w)+(_.k&&_.k[l[m]]||0)+i.w*o:0,c=1}w&&w.d&&(f+=t.transformPath(w.d,["t",h*u,x*u,"s",u,u,d,v,"t",(e-d)/u,(n-v)/u]))}}return this.path(f).attr({fill:"#000",stroke:"none"})},y.add=function(e){if(t.is(e,"array"))for(var n,r=this.set(),i=0,a=e.length;a>i;i++)n=e[i]||{},_[k](n.type)&&r.push(this[n.type]().attr(n));return r},t.format=function(e,n){var r=t.is(n,N)?[0][T](n):arguments;return e&&t.is(e,G)&&r.length-1&&(e=e.replace(w,function(t,e){return null==r[++e]?A:r[e]})),e||A},t.fullfill=function(){var t=/\{([^\}]+)\}/g,e=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(t,n,r){var i=r;return n.replace(e,function(t,e,n,r,a){e=e||r,i&&(e in i&&(i=i[e]),"function"==typeof i&&a&&(i=i()))}),i=(null==i||i==r?t:i)+""};return function(e,r){return(e+"").replace(t,function(t,e){return n(t,e,r)})}}(),t.ninja=function(){return S.was?B.win.Raphael=S.is:delete Raphael,t},t.st=cn,function(e,n,r){function i(){/in/.test(e.readyState)?setTimeout(i,9):t.eve("raphael.DOMload")}null==e.readyState&&e.addEventListener&&(e.addEventListener(n,r=function(){e.removeEventListener(n,r,!1),e.readyState="complete"},!1),e.readyState="loading"),i()}(document,"DOMContentLoaded"),S.was?B.win.Raphael=t:Raphael=t,eve.on("raphael.DOMload",function(){m=!0})})();window.Raphael&&window.Raphael.svg&&function(t){var e="hasOwnProperty",r=String,n=parseFloat,i=parseInt,a=Math,s=a.max,o=a.abs,u=a.pow,h=/[, ]+/,l=t.eve,c="",f=" ",p="http://www.w3.org/1999/xlink",d={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},g={};t.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var v=function(n,i){if(i){"string"==typeof n&&(n=v(n));for(var a in i)i[e](a)&&("xlink:"==a.substring(0,6)?n.setAttributeNS(p,a.substring(6),r(i[a])):n.setAttribute(a,r(i[a])))}else n=t._g.doc.createElementNS("http://www.w3.org/2000/svg",n),n.style&&(n.style.webkitTapHighlightColor="rgba(0,0,0,0)");return n},x=function(e,i){var h="linear",l=e.id+i,f=.5,p=.5,d=e.node,g=e.paper,x=d.style,y=t._g.doc.getElementById(l);if(!y){if(i=r(i).replace(t._radial_gradient,function(t,e,r){if(h="radial",e&&r){f=n(e),p=n(r);var i=2*(p>.5)-1;u(f-.5,2)+u(p-.5,2)>.25&&(p=a.sqrt(.25-u(f-.5,2))*i+.5)&&.5!=p&&(p=p.toFixed(5)-1e-5*i)}return c}),i=i.split(/\s*\-\s*/),"linear"==h){var m=i.shift();if(m=-n(m),isNaN(m))return null;var b=[0,0,a.cos(t.rad(m)),a.sin(t.rad(m))],_=1/(s(o(b[2]),o(b[3]))||1);b[2]*=_,b[3]*=_,0>b[2]&&(b[0]=-b[2],b[2]=0),0>b[3]&&(b[1]=-b[3],b[3]=0)}var w=t._parseDots(i);if(!w)return null;if(l=l.replace(/[\(\)\s,\xb0#]/g,"_"),e.gradient&&l!=e.gradient.id&&(g.defs.removeChild(e.gradient),delete e.gradient),!e.gradient){y=v(h+"Gradient",{id:l}),e.gradient=y,v(y,"radial"==h?{fx:f,fy:p}:{x1:b[0],y1:b[1],x2:b[2],y2:b[3],gradientTransform:e.matrix.invert()}),g.defs.appendChild(y);for(var k=0,C=w.length;C>k;k++)y.appendChild(v("stop",{offset:w[k].offset?w[k].offset:k?"100%":"0%","stop-color":w[k].color||"#fff"}))}}return v(d,{fill:"url(#"+l+")",opacity:1,"fill-opacity":1}),x.fill=c,x.opacity=1,x.fillOpacity=1,1},y=function(t){var e=t.getBBox(1);v(t.pattern,{patternTransform:t.matrix.invert()+" translate("+e.x+","+e.y+")"})},m=function(n,i,a){if("path"==n.type){for(var s,o,u,h,l,f=r(i).toLowerCase().split("-"),p=n.paper,x=a?"end":"start",y=n.node,m=n.attrs,b=m["stroke-width"],_=f.length,w="classic",k=3,C=3,B=5;_--;)switch(f[_]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":w=f[_];break;case"wide":C=5;break;case"narrow":C=2;break;case"long":k=5;break;case"short":k=2}if("open"==w?(k+=2,C+=2,B+=2,u=1,h=a?4:1,l={fill:"none",stroke:m.stroke}):(h=u=k/2,l={fill:m.stroke,stroke:"none"}),n._.arrows?a?(n._.arrows.endPath&&g[n._.arrows.endPath]--,n._.arrows.endMarker&&g[n._.arrows.endMarker]--):(n._.arrows.startPath&&g[n._.arrows.startPath]--,n._.arrows.startMarker&&g[n._.arrows.startMarker]--):n._.arrows={},"none"!=w){var S="raphael-marker-"+w,A="raphael-marker-"+x+w+k+C;t._g.doc.getElementById(S)?g[S]++:(p.defs.appendChild(v(v("path"),{"stroke-linecap":"round",d:d[w],id:S})),g[S]=1);var T,M=t._g.doc.getElementById(A);M?(g[A]++,T=M.getElementsByTagName("use")[0]):(M=v(v("marker"),{id:A,markerHeight:C,markerWidth:k,orient:"auto",refX:h,refY:C/2}),T=v(v("use"),{"xlink:href":"#"+S,transform:(a?"rotate(180 "+k/2+" "+C/2+") ":c)+"scale("+k/B+","+C/B+")","stroke-width":(1/((k/B+C/B)/2)).toFixed(4)}),M.appendChild(T),p.defs.appendChild(M),g[A]=1),v(T,l);var F=u*("diamond"!=w&&"oval"!=w);a?(s=n._.arrows.startdx*b||0,o=t.getTotalLength(m.path)-F*b):(s=F*b,o=t.getTotalLength(m.path)-(n._.arrows.enddx*b||0)),l={},l["marker-"+x]="url(#"+A+")",(o||s)&&(l.d=Raphael.getSubpath(m.path,s,o)),v(y,l),n._.arrows[x+"Path"]=S,n._.arrows[x+"Marker"]=A,n._.arrows[x+"dx"]=F,n._.arrows[x+"Type"]=w,n._.arrows[x+"String"]=i}else a?(s=n._.arrows.startdx*b||0,o=t.getTotalLength(m.path)-s):(s=0,o=t.getTotalLength(m.path)-(n._.arrows.enddx*b||0)),n._.arrows[x+"Path"]&&v(y,{d:Raphael.getSubpath(m.path,s,o)}),delete n._.arrows[x+"Path"],delete n._.arrows[x+"Marker"],delete n._.arrows[x+"dx"],delete n._.arrows[x+"Type"],delete n._.arrows[x+"String"];for(l in g)if(g[e](l)&&!g[l]){var L=t._g.doc.getElementById(l);L&&L.parentNode.removeChild(L)}}},b={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},_=function(t,e,n){if(e=b[r(e).toLowerCase()]){for(var i=t.attrs["stroke-width"]||"1",a={round:i,square:i,butt:0}[t.attrs["stroke-linecap"]||n["stroke-linecap"]]||0,s=[],o=e.length;o--;)s[o]=e[o]*i+(o%2?1:-1)*a;v(t.node,{"stroke-dasharray":s.join(",")})}},w=function(n,a){var u=n.node,l=n.attrs,f=u.style.visibility;u.style.visibility="hidden";for(var d in a)if(a[e](d)){if(!t._availableAttrs[e](d))continue;var g=a[d];switch(l[d]=g,d){case"blur":n.blur(g);break;case"href":case"title":case"target":var b=u.parentNode;if("a"!=b.tagName.toLowerCase()){var w=v("a");b.insertBefore(w,u),w.appendChild(u),b=w}"target"==d?b.setAttributeNS(p,"show","blank"==g?"new":g):b.setAttributeNS(p,d,g);break;case"cursor":u.style.cursor=g;break;case"transform":n.transform(g);break;case"arrow-start":m(n,g);break;case"arrow-end":m(n,g,1);break;case"clip-rect":var k=r(g).split(h);if(4==k.length){n.clip&&n.clip.parentNode.parentNode.removeChild(n.clip.parentNode);var B=v("clipPath"),S=v("rect");B.id=t.createUUID(),v(S,{x:k[0],y:k[1],width:k[2],height:k[3]}),B.appendChild(S),n.paper.defs.appendChild(B),v(u,{"clip-path":"url(#"+B.id+")"}),n.clip=S}if(!g){var A=u.getAttribute("clip-path");if(A){var T=t._g.doc.getElementById(A.replace(/(^url\(#|\)$)/g,c));T&&T.parentNode.removeChild(T),v(u,{"clip-path":c}),delete n.clip}}break;case"path":"path"==n.type&&(v(u,{d:g?l.path=t._pathToAbsolute(g):"M0,0"}),n._.dirty=1,n._.arrows&&("startString"in n._.arrows&&m(n,n._.arrows.startString),"endString"in n._.arrows&&m(n,n._.arrows.endString,1)));break;case"width":if(u.setAttribute(d,g),n._.dirty=1,!l.fx)break;d="x",g=l.x;case"x":l.fx&&(g=-l.x-(l.width||0));case"rx":if("rx"==d&&"rect"==n.type)break;case"cx":u.setAttribute(d,g),n.pattern&&y(n),n._.dirty=1;break;case"height":if(u.setAttribute(d,g),n._.dirty=1,!l.fy)break;d="y",g=l.y;case"y":l.fy&&(g=-l.y-(l.height||0));case"ry":if("ry"==d&&"rect"==n.type)break;case"cy":u.setAttribute(d,g),n.pattern&&y(n),n._.dirty=1;break;case"r":"rect"==n.type?v(u,{rx:g,ry:g}):u.setAttribute(d,g),n._.dirty=1;break;case"src":"image"==n.type&&u.setAttributeNS(p,"href",g);break;case"stroke-width":(1!=n._.sx||1!=n._.sy)&&(g/=s(o(n._.sx),o(n._.sy))||1),n.paper._vbSize&&(g*=n.paper._vbSize),u.setAttribute(d,g),l["stroke-dasharray"]&&_(n,l["stroke-dasharray"],a),n._.arrows&&("startString"in n._.arrows&&m(n,n._.arrows.startString),"endString"in n._.arrows&&m(n,n._.arrows.endString,1));break;case"stroke-dasharray":_(n,g,a);break;case"fill":var M=r(g).match(t._ISURL);if(M){B=v("pattern");var F=v("image");B.id=t.createUUID(),v(B,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),v(F,{x:0,y:0,"xlink:href":M[1]}),B.appendChild(F),function(e){t._preload(M[1],function(){var t=this.offsetWidth,r=this.offsetHeight;v(e,{width:t,height:r}),v(F,{width:t,height:r}),n.paper.safari()})}(B),n.paper.defs.appendChild(B),v(u,{fill:"url(#"+B.id+")"}),n.pattern=B,n.pattern&&y(n);break}var L=t.getRGB(g);if(L.error){if(("circle"==n.type||"ellipse"==n.type||"r"!=r(g).charAt())&&x(n,g)){if("opacity"in l||"fill-opacity"in l){var N=t._g.doc.getElementById(u.getAttribute("fill").replace(/^url\(#|\)$/g,c));if(N){var P=N.getElementsByTagName("stop");v(P[P.length-1],{"stop-opacity":("opacity"in l?l.opacity:1)*("fill-opacity"in l?l["fill-opacity"]:1)})}}l.gradient=g,l.fill="none";break}}else delete a.gradient,delete l.gradient,!t.is(l.opacity,"undefined")&&t.is(a.opacity,"undefined")&&v(u,{opacity:l.opacity}),!t.is(l["fill-opacity"],"undefined")&&t.is(a["fill-opacity"],"undefined")&&v(u,{"fill-opacity":l["fill-opacity"]});L[e]("opacity")&&v(u,{"fill-opacity":L.opacity>1?L.opacity/100:L.opacity});case"stroke":L=t.getRGB(g),u.setAttribute(d,L.hex),"stroke"==d&&L[e]("opacity")&&v(u,{"stroke-opacity":L.opacity>1?L.opacity/100:L.opacity}),"stroke"==d&&n._.arrows&&("startString"in n._.arrows&&m(n,n._.arrows.startString),"endString"in n._.arrows&&m(n,n._.arrows.endString,1));break;case"gradient":("circle"==n.type||"ellipse"==n.type||"r"!=r(g).charAt())&&x(n,g);break;case"opacity":l.gradient&&!l[e]("stroke-opacity")&&v(u,{"stroke-opacity":g>1?g/100:g});case"fill-opacity":if(l.gradient){N=t._g.doc.getElementById(u.getAttribute("fill").replace(/^url\(#|\)$/g,c)),N&&(P=N.getElementsByTagName("stop"),v(P[P.length-1],{"stop-opacity":g}));break}default:"font-size"==d&&(g=i(g,10)+"px");var E=d.replace(/(\-.)/g,function(t){return t.substring(1).toUpperCase()});u.style[E]=g,n._.dirty=1,u.setAttribute(d,g)}}C(n,a),u.style.visibility=f},k=1.2,C=function(n,a){if("text"==n.type&&(a[e]("text")||a[e]("font")||a[e]("font-size")||a[e]("x")||a[e]("y"))){var s=n.attrs,o=n.node,u=o.firstChild?i(t._g.doc.defaultView.getComputedStyle(o.firstChild,c).getPropertyValue("font-size"),10):10;if(a[e]("text")){for(s.text=a.text;o.firstChild;)o.removeChild(o.firstChild);for(var h,l=r(a.text).split("\n"),f=[],p=0,d=l.length;d>p;p++)h=v("tspan"),p&&v(h,{dy:u*k,x:s.x}),h.appendChild(t._g.doc.createTextNode(l[p])),o.appendChild(h),f[p]=h}else for(f=o.getElementsByTagName("tspan"),p=0,d=f.length;d>p;p++)p?v(f[p],{dy:u*k,x:s.x}):v(f[0],{dy:0});v(o,{x:s.x,y:s.y}),n._.dirty=1;var g=n._getBBox(),x=s.y-(g.y+g.height/2);x&&t.is(x,"finite")&&v(f[0],{dy:x})}},B=function(e,r){this[0]=this.node=e,e.raphael=!0,this.id=t._oid++,e.raphaelid=this.id,this.matrix=t.matrix(),this.realPath=null,this.paper=r,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!r.bottom&&(r.bottom=this),this.prev=r.top,r.top&&(r.top.next=this),r.top=this,this.next=null},S=t.el;B.prototype=S,S.constructor=B,t._engine.path=function(t,e){var r=v("path");e.canvas&&e.canvas.appendChild(r);var n=new B(r,e);return n.type="path",w(n,{fill:"none",stroke:"#000",path:t}),n},S.rotate=function(t,e,i){if(this.removed)return this;if(t=r(t).split(h),t.length-1&&(e=n(t[1]),i=n(t[2])),t=n(t[0]),null==i&&(e=i),null==e||null==i){var a=this.getBBox(1);e=a.x+a.width/2,i=a.y+a.height/2}return this.transform(this._.transform.concat([["r",t,e,i]])),this},S.scale=function(t,e,i,a){if(this.removed)return this;if(t=r(t).split(h),t.length-1&&(e=n(t[1]),i=n(t[2]),a=n(t[3])),t=n(t[0]),null==e&&(e=t),null==a&&(i=a),null==i||null==a)var s=this.getBBox(1);return i=null==i?s.x+s.width/2:i,a=null==a?s.y+s.height/2:a,this.transform(this._.transform.concat([["s",t,e,i,a]])),this},S.translate=function(t,e){return this.removed?this:(t=r(t).split(h),t.length-1&&(e=n(t[1])),t=n(t[0])||0,e=+e||0,this.transform(this._.transform.concat([["t",t,e]])),this)},S.transform=function(r){var n=this._;if(null==r)return n.transform;if(t._extractTransform(this,r),this.clip&&v(this.clip,{transform:this.matrix.invert()}),this.pattern&&y(this),this.node&&v(this.node,{transform:this.matrix}),1!=n.sx||1!=n.sy){var i=this.attrs[e]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":i})}return this},S.hide=function(){return!this.removed&&this.paper.safari(this.node.style.display="none"),this},S.show=function(){return!this.removed&&this.paper.safari(this.node.style.display=""),this},S.remove=function(){if(!this.removed&&this.node.parentNode){var e=this.paper;e.__set__&&e.__set__.exclude(this),l.unbind("raphael.*.*."+this.id),this.gradient&&e.defs.removeChild(this.gradient),t._tear(this,e),"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);for(var r in this)this[r]="function"==typeof this[r]?t._removedFactory(r):null;this.removed=!0}},S._getBBox=function(){if("none"==this.node.style.display){this.show();var t=!0}var e={};try{e=this.node.getBBox()}catch(r){}finally{e=e||{}}return t&&this.hide(),e},S.attr=function(r,n){if(this.removed)return this;if(null==r){var i={};for(var a in this.attrs)this.attrs[e](a)&&(i[a]=this.attrs[a]);return i.gradient&&"none"==i.fill&&(i.fill=i.gradient)&&delete i.gradient,i.transform=this._.transform,i}if(null==n&&t.is(r,"string")){if("fill"==r&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==r)return this._.transform;for(var s=r.split(h),o={},u=0,c=s.length;c>u;u++)r=s[u],o[r]=r in this.attrs?this.attrs[r]:t.is(this.paper.customAttributes[r],"function")?this.paper.customAttributes[r].def:t._availableAttrs[r];return c-1?o:o[s[0]]}if(null==n&&t.is(r,"array")){for(o={},u=0,c=r.length;c>u;u++)o[r[u]]=this.attr(r[u]);return o}if(null!=n){var f={};f[r]=n}else null!=r&&t.is(r,"object")&&(f=r);for(var p in f)l("raphael.attr."+p+"."+this.id,this,f[p]);for(p in this.paper.customAttributes)if(this.paper.customAttributes[e](p)&&f[e](p)&&t.is(this.paper.customAttributes[p],"function")){var d=this.paper.customAttributes[p].apply(this,[].concat(f[p]));this.attrs[p]=f[p];for(var g in d)d[e](g)&&(f[g]=d[g])}return w(this,f),this},S.toFront=function(){if(this.removed)return this;"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var e=this.paper;return e.top!=this&&t._tofront(this,e),this},S.toBack=function(){if(this.removed)return this;var e=this.node.parentNode;return"a"==e.tagName.toLowerCase()?e.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):e.firstChild!=this.node&&e.insertBefore(this.node,this.node.parentNode.firstChild),t._toback(this,this.paper),this.paper,this},S.insertAfter=function(e){if(this.removed)return this;var r=e.node||e[e.length-1].node;return r.nextSibling?r.parentNode.insertBefore(this.node,r.nextSibling):r.parentNode.appendChild(this.node),t._insertafter(this,e,this.paper),this},S.insertBefore=function(e){if(this.removed)return this;var r=e.node||e[0].node;return r.parentNode.insertBefore(this.node,r),t._insertbefore(this,e,this.paper),this},S.blur=function(e){var r=this;if(0!==+e){var n=v("filter"),i=v("feGaussianBlur");r.attrs.blur=e,n.id=t.createUUID(),v(i,{stdDeviation:+e||1.5}),n.appendChild(i),r.paper.defs.appendChild(n),r._blur=n,v(r.node,{filter:"url(#"+n.id+")"})}else r._blur&&(r._blur.parentNode.removeChild(r._blur),delete r._blur,delete r.attrs.blur),r.node.removeAttribute("filter")},t._engine.circle=function(t,e,r,n){var i=v("circle");t.canvas&&t.canvas.appendChild(i);var a=new B(i,t);return a.attrs={cx:e,cy:r,r:n,fill:"none",stroke:"#000"},a.type="circle",v(i,a.attrs),a},t._engine.rect=function(t,e,r,n,i,a){var s=v("rect");t.canvas&&t.canvas.appendChild(s);var o=new B(s,t);return o.attrs={x:e,y:r,width:n,height:i,r:a||0,rx:a||0,ry:a||0,fill:"none",stroke:"#000"},o.type="rect",v(s,o.attrs),o},t._engine.ellipse=function(t,e,r,n,i){var a=v("ellipse");t.canvas&&t.canvas.appendChild(a);var s=new B(a,t);return s.attrs={cx:e,cy:r,rx:n,ry:i,fill:"none",stroke:"#000"},s.type="ellipse",v(a,s.attrs),s},t._engine.image=function(t,e,r,n,i,a){var s=v("image");v(s,{x:r,y:n,width:i,height:a,preserveAspectRatio:"none"}),s.setAttributeNS(p,"href",e),t.canvas&&t.canvas.appendChild(s);var o=new B(s,t);return o.attrs={x:r,y:n,width:i,height:a,src:e},o.type="image",o},t._engine.text=function(e,r,n,i){var a=v("text");e.canvas&&e.canvas.appendChild(a);var s=new B(a,e);return s.attrs={x:r,y:n,"text-anchor":"middle",text:i,font:t._availableAttrs.font,stroke:"none",fill:"#000"},s.type="text",w(s,s.attrs),s},t._engine.setSize=function(t,e){return this.width=t||this.width,this.height=e||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},t._engine.create=function(){var e=t._getContainer.apply(0,arguments),r=e&&e.container,n=e.x,i=e.y,a=e.width,s=e.height;if(!r)throw Error("SVG container not found.");var o,u=v("svg"),h="overflow:hidden;";return n=n||0,i=i||0,a=a||512,s=s||342,v(u,{height:s,version:1.1,width:a,xmlns:"http://www.w3.org/2000/svg"}),1==r?(u.style.cssText=h+"position:absolute;left:"+n+"px;top:"+i+"px",t._g.doc.body.appendChild(u),o=1):(u.style.cssText=h+"position:relative",r.firstChild?r.insertBefore(u,r.firstChild):r.appendChild(u)),r=new t._Paper,r.width=a,r.height=s,r.canvas=u,r.clear(),r._left=r._top=0,o&&(r.renderfix=function(){}),r.renderfix(),r},t._engine.setViewBox=function(t,e,r,n,i){l("raphael.setViewBox",this,this._viewBox,[t,e,r,n,i]);var a,o,u=s(r/this.width,n/this.height),h=this.top,c=i?"meet":"xMinYMin";for(null==t?(this._vbSize&&(u=1),delete this._vbSize,a="0 0 "+this.width+f+this.height):(this._vbSize=u,a=t+f+e+f+r+f+n),v(this.canvas,{viewBox:a,preserveAspectRatio:c});u&&h;)o="stroke-width"in h.attrs?h.attrs["stroke-width"]:1,h.attr({"stroke-width":o}),h._.dirty=1,h._.dirtyT=1,h=h.prev;return this._viewBox=[t,e,r,n,!!i],this},t.prototype.renderfix=function(){var t,e=this.canvas,r=e.style;try{t=e.getScreenCTM()||e.createSVGMatrix()}catch(n){t=e.createSVGMatrix()}var i=-t.e%1,a=-t.f%1;(i||a)&&(i&&(this._left=(this._left+i)%1,r.left=this._left+"px"),a&&(this._top=(this._top+a)%1,r.top=this._top+"px"))},t.prototype.clear=function(){t.eve("raphael.clear",this);for(var e=this.canvas;e.firstChild;)e.removeChild(e.firstChild);this.bottom=this.top=null,(this.desc=v("desc")).appendChild(t._g.doc.createTextNode("Created with Raphaël "+t.version)),e.appendChild(this.desc),e.appendChild(this.defs=v("defs"))},t.prototype.remove=function(){l("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null};var A=t.st;for(var T in S)S[e](T)&&!A[e](T)&&(A[T]=function(t){return function(){var e=arguments;return this.forEach(function(r){r[t].apply(r,e)})}}(T))}(window.Raphael);window.Raphael&&window.Raphael.vml&&function(t){var e="hasOwnProperty",r=String,i=parseFloat,n=Math,a=n.round,s=n.max,o=n.min,l=n.abs,h="fill",u=/[, ]+/,c=t.eve,f=" progid:DXImageTransform.Microsoft",p=" ",d="",g={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},v=/([clmz]),?([^clmz]*)/gi,x=/ progid:\S+Blur\([^\)]+\)/g,y=/-?[^,\s-]+/g,m="position:absolute;left:0;top:0;width:1px;height:1px",b=21600,_={path:1,rect:1,image:1},w={circle:1,ellipse:1},k=function(e){var i=/[ahqstv]/gi,n=t._pathToAbsolute;if(r(e).match(i)&&(n=t._path2curve),i=/[clmz]/g,n==t._pathToAbsolute&&!r(e).match(i)){var s=r(e).replace(v,function(t,e,r){var i=[],n="m"==e.toLowerCase(),s=g[e];return r.replace(y,function(t){n&&2==i.length&&(s+=i+g["m"==e?"l":"L"],i=[]),i.push(a(t*b))}),s+i});return s}var o,l,h=n(e);s=[];for(var u=0,c=h.length;c>u;u++){o=h[u],l=h[u][0].toLowerCase(),"z"==l&&(l="x");for(var f=1,x=o.length;x>f;f++)l+=a(o[f]*b)+(f!=x-1?",":d);s.push(l)}return s.join(p)},C=function(e,r,i){var n=t.matrix();return n.rotate(-e,.5,.5),{dx:n.x(r,i),dy:n.y(r,i)}},B=function(t,e,r,i,n,a){var s=t._,o=t.matrix,u=s.fillpos,c=t.node,f=c.style,d=1,g="",v=b/e,x=b/r;if(f.visibility="hidden",e&&r){if(c.coordsize=l(v)+p+l(x),f.rotation=a*(0>e*r?-1:1),a){var y=C(a,i,n);i=y.dx,n=y.dy}if(0>e&&(g+="x"),0>r&&(g+=" y")&&(d=-1),f.flip=g,c.coordorigin=i*-v+p+n*-x,u||s.fillsize){var m=c.getElementsByTagName(h);m=m&&m[0],c.removeChild(m),u&&(y=C(a,o.x(u[0],u[1]),o.y(u[0],u[1])),m.position=y.dx*d+p+y.dy*d),s.fillsize&&(m.size=s.fillsize[0]*l(e)+p+s.fillsize[1]*l(r)),c.appendChild(m)}f.visibility="visible"}};t.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var S=function(t,e,i){for(var n=r(e).toLowerCase().split("-"),a=i?"end":"start",s=n.length,o="classic",l="medium",h="medium";s--;)switch(n[s]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":o=n[s];break;case"wide":case"narrow":h=n[s];break;case"long":case"short":l=n[s]}var u=t.node.getElementsByTagName("stroke")[0];u[a+"arrow"]=o,u[a+"arrowlength"]=l,u[a+"arrowwidth"]=h},A=function(n,l){n.attrs=n.attrs||{};var c=n.node,f=n.attrs,g=c.style,v=_[n.type]&&(l.x!=f.x||l.y!=f.y||l.width!=f.width||l.height!=f.height||l.cx!=f.cx||l.cy!=f.cy||l.rx!=f.rx||l.ry!=f.ry||l.r!=f.r),x=w[n.type]&&(f.cx!=l.cx||f.cy!=l.cy||f.r!=l.r||f.rx!=l.rx||f.ry!=l.ry),y=n;for(var m in l)l[e](m)&&(f[m]=l[m]);if(v&&(f.path=t._getPath[n.type](n),n._.dirty=1),l.href&&(c.href=l.href),l.title&&(c.title=l.title),l.target&&(c.target=l.target),l.cursor&&(g.cursor=l.cursor),"blur"in l&&n.blur(l.blur),(l.path&&"path"==n.type||v)&&(c.path=k(~r(f.path).toLowerCase().indexOf("r")?t._pathToAbsolute(f.path):f.path),"image"==n.type&&(n._.fillpos=[f.x,f.y],n._.fillsize=[f.width,f.height],B(n,1,1,0,0,0))),"transform"in l&&n.transform(l.transform),x){var C=+f.cx,A=+f.cy,N=+f.rx||+f.r||0,E=+f.ry||+f.r||0;c.path=t.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",a((C-N)*b),a((A-E)*b),a((C+N)*b),a((A+E)*b),a(C*b))}if("clip-rect"in l){var M=r(l["clip-rect"]).split(u);if(4==M.length){M[2]=+M[2]+ +M[0],M[3]=+M[3]+ +M[1];var z=c.clipRect||t._g.doc.createElement("div"),F=z.style;F.clip=t.format("rect({1}px {2}px {3}px {0}px)",M),c.clipRect||(F.position="absolute",F.top=0,F.left=0,F.width=n.paper.width+"px",F.height=n.paper.height+"px",c.parentNode.insertBefore(z,c),z.appendChild(c),c.clipRect=z)}l["clip-rect"]||c.clipRect&&(c.clipRect.style.clip="auto")}if(n.textpath){var R=n.textpath.style;l.font&&(R.font=l.font),l["font-family"]&&(R.fontFamily='"'+l["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,d)+'"'),l["font-size"]&&(R.fontSize=l["font-size"]),l["font-weight"]&&(R.fontWeight=l["font-weight"]),l["font-style"]&&(R.fontStyle=l["font-style"])}if("arrow-start"in l&&S(y,l["arrow-start"]),"arrow-end"in l&&S(y,l["arrow-end"],1),null!=l.opacity||null!=l["stroke-width"]||null!=l.fill||null!=l.src||null!=l.stroke||null!=l["stroke-width"]||null!=l["stroke-opacity"]||null!=l["fill-opacity"]||null!=l["stroke-dasharray"]||null!=l["stroke-miterlimit"]||null!=l["stroke-linejoin"]||null!=l["stroke-linecap"]){var P=c.getElementsByTagName(h),I=!1;if(P=P&&P[0],!P&&(I=P=L(h)),"image"==n.type&&l.src&&(P.src=l.src),l.fill&&(P.on=!0),(null==P.on||"none"==l.fill||null===l.fill)&&(P.on=!1),P.on&&l.fill){var j=r(l.fill).match(t._ISURL);if(j){P.parentNode==c&&c.removeChild(P),P.rotate=!0,P.src=j[1],P.type="tile";var q=n.getBBox(1);P.position=q.x+p+q.y,n._.fillpos=[q.x,q.y],t._preload(j[1],function(){n._.fillsize=[this.offsetWidth,this.offsetHeight]})}else P.color=t.getRGB(l.fill).hex,P.src=d,P.type="solid",t.getRGB(l.fill).error&&(y.type in{circle:1,ellipse:1}||"r"!=r(l.fill).charAt())&&T(y,l.fill,P)&&(f.fill="none",f.gradient=l.fill,P.rotate=!1)}if("fill-opacity"in l||"opacity"in l){var D=((+f["fill-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+t.getRGB(l.fill).o+1||2)-1);D=o(s(D,0),1),P.opacity=D,P.src&&(P.color="none")}c.appendChild(P);var O=c.getElementsByTagName("stroke")&&c.getElementsByTagName("stroke")[0],V=!1;!O&&(V=O=L("stroke")),(l.stroke&&"none"!=l.stroke||l["stroke-width"]||null!=l["stroke-opacity"]||l["stroke-dasharray"]||l["stroke-miterlimit"]||l["stroke-linejoin"]||l["stroke-linecap"])&&(O.on=!0),("none"==l.stroke||null===l.stroke||null==O.on||0==l.stroke||0==l["stroke-width"])&&(O.on=!1);var Y=t.getRGB(l.stroke);O.on&&l.stroke&&(O.color=Y.hex),D=((+f["stroke-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+Y.o+1||2)-1);var G=.75*(i(l["stroke-width"])||1);if(D=o(s(D,0),1),null==l["stroke-width"]&&(G=f["stroke-width"]),l["stroke-width"]&&(O.weight=G),G&&1>G&&(D*=G)&&(O.weight=1),O.opacity=D,l["stroke-linejoin"]&&(O.joinstyle=l["stroke-linejoin"]||"miter"),O.miterlimit=l["stroke-miterlimit"]||8,l["stroke-linecap"]&&(O.endcap="butt"==l["stroke-linecap"]?"flat":"square"==l["stroke-linecap"]?"square":"round"),l["stroke-dasharray"]){var W={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};O.dashstyle=W[e](l["stroke-dasharray"])?W[l["stroke-dasharray"]]:d}V&&c.appendChild(O)}if("text"==y.type){y.paper.canvas.style.display=d;var X=y.paper.span,H=100,U=f.font&&f.font.match(/\d+(?:\.\d*)?(?=px)/);g=X.style,f.font&&(g.font=f.font),f["font-family"]&&(g.fontFamily=f["font-family"]),f["font-weight"]&&(g.fontWeight=f["font-weight"]),f["font-style"]&&(g.fontStyle=f["font-style"]),U=i(f["font-size"]||U&&U[0])||10,g.fontSize=U*H+"px",y.textpath.string&&(X.innerHTML=r(y.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var $=X.getBoundingClientRect();y.W=f.w=($.right-$.left)/H,y.H=f.h=($.bottom-$.top)/H,y.X=f.x,y.Y=f.y+y.H/2,("x"in l||"y"in l)&&(y.path.v=t.format("m{0},{1}l{2},{1}",a(f.x*b),a(f.y*b),a(f.x*b)+1));for(var Z=["x","y","text","font","font-family","font-weight","font-style","font-size"],Q=0,J=Z.length;J>Q;Q++)if(Z[Q]in l){y._.dirty=1;break}switch(f["text-anchor"]){case"start":y.textpath.style["v-text-align"]="left",y.bbx=y.W/2;break;case"end":y.textpath.style["v-text-align"]="right",y.bbx=-y.W/2;break;default:y.textpath.style["v-text-align"]="center",y.bbx=0}y.textpath.style["v-text-kern"]=!0}},T=function(e,a,s){e.attrs=e.attrs||{};var o=(e.attrs,Math.pow),l="linear",h=".5 .5";if(e.attrs.gradient=a,a=r(a).replace(t._radial_gradient,function(t,e,r){return l="radial",e&&r&&(e=i(e),r=i(r),o(e-.5,2)+o(r-.5,2)>.25&&(r=n.sqrt(.25-o(e-.5,2))*(2*(r>.5)-1)+.5),h=e+p+r),d}),a=a.split(/\s*\-\s*/),"linear"==l){var u=a.shift();if(u=-i(u),isNaN(u))return null}var c=t._parseDots(a);if(!c)return null;if(e=e.shape||e.node,c.length){e.removeChild(s),s.on=!0,s.method="none",s.color=c[0].color,s.color2=c[c.length-1].color;for(var f=[],g=0,v=c.length;v>g;g++)c[g].offset&&f.push(c[g].offset+p+c[g].color);s.colors=f.length?f.join():"0% "+s.color,"radial"==l?(s.type="gradientTitle",s.focus="100%",s.focussize="0 0",s.focusposition=h,s.angle=0):(s.type="gradient",s.angle=(270-u)%360),e.appendChild(s)}return 1},N=function(e,r){this[0]=this.node=e,e.raphael=!0,this.id=t._oid++,e.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=r,this.matrix=t.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!r.bottom&&(r.bottom=this),this.prev=r.top,r.top&&(r.top.next=this),r.top=this,this.next=null},E=t.el;N.prototype=E,E.constructor=N,E.transform=function(e){if(null==e)return this._.transform;var i,n=this.paper._viewBoxShift,a=n?"s"+[n.scale,n.scale]+"-1-1t"+[n.dx,n.dy]:d;n&&(i=e=r(e).replace(/\.{3}|\u2026/g,this._.transform||d)),t._extractTransform(this,a+e);var s,o=this.matrix.clone(),l=this.skew,h=this.node,u=~r(this.attrs.fill).indexOf("-"),c=!r(this.attrs.fill).indexOf("url(");if(o.translate(-.5,-.5),c||u||"image"==this.type)if(l.matrix="1 0 0 1",l.offset="0 0",s=o.split(),u&&s.noRotation||!s.isSimple){h.style.filter=o.toFilter();var f=this.getBBox(),g=this.getBBox(1),v=f.x-g.x,x=f.y-g.y;h.coordorigin=v*-b+p+x*-b,B(this,1,1,v,x,0)}else h.style.filter=d,B(this,s.scalex,s.scaley,s.dx,s.dy,s.rotate);else h.style.filter=d,l.matrix=r(o),l.offset=o.offset();return i&&(this._.transform=i),this},E.rotate=function(t,e,n){if(this.removed)return this;if(null!=t){if(t=r(t).split(u),t.length-1&&(e=i(t[1]),n=i(t[2])),t=i(t[0]),null==n&&(e=n),null==e||null==n){var a=this.getBBox(1);e=a.x+a.width/2,n=a.y+a.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",t,e,n]])),this}},E.translate=function(t,e){return this.removed?this:(t=r(t).split(u),t.length-1&&(e=i(t[1])),t=i(t[0])||0,e=+e||0,this._.bbox&&(this._.bbox.x+=t,this._.bbox.y+=e),this.transform(this._.transform.concat([["t",t,e]])),this)},E.scale=function(t,e,n,a){if(this.removed)return this;if(t=r(t).split(u),t.length-1&&(e=i(t[1]),n=i(t[2]),a=i(t[3]),isNaN(n)&&(n=null),isNaN(a)&&(a=null)),t=i(t[0]),null==e&&(e=t),null==a&&(n=a),null==n||null==a)var s=this.getBBox(1);return n=null==n?s.x+s.width/2:n,a=null==a?s.y+s.height/2:a,this.transform(this._.transform.concat([["s",t,e,n,a]])),this._.dirtyT=1,this},E.hide=function(){return!this.removed&&(this.node.style.display="none"),this},E.show=function(){return!this.removed&&(this.node.style.display=d),this},E._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},E.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),t.eve.unbind("raphael.*.*."+this.id),t._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null;this.removed=!0}},E.attr=function(r,i){if(this.removed)return this;if(null==r){var n={};for(var a in this.attrs)this.attrs[e](a)&&(n[a]=this.attrs[a]);return n.gradient&&"none"==n.fill&&(n.fill=n.gradient)&&delete n.gradient,n.transform=this._.transform,n}if(null==i&&t.is(r,"string")){if(r==h&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var s=r.split(u),o={},l=0,f=s.length;f>l;l++)r=s[l],o[r]=r in this.attrs?this.attrs[r]:t.is(this.paper.customAttributes[r],"function")?this.paper.customAttributes[r].def:t._availableAttrs[r];return f-1?o:o[s[0]]}if(this.attrs&&null==i&&t.is(r,"array")){for(o={},l=0,f=r.length;f>l;l++)o[r[l]]=this.attr(r[l]);return o}var p;null!=i&&(p={},p[r]=i),null==i&&t.is(r,"object")&&(p=r);for(var d in p)c("raphael.attr."+d+"."+this.id,this,p[d]);if(p){for(d in this.paper.customAttributes)if(this.paper.customAttributes[e](d)&&p[e](d)&&t.is(this.paper.customAttributes[d],"function")){var g=this.paper.customAttributes[d].apply(this,[].concat(p[d]));this.attrs[d]=p[d];for(var v in g)g[e](v)&&(p[v]=g[v])}p.text&&"text"==this.type&&(this.textpath.string=p.text),A(this,p)}return this},E.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&t._tofront(this,this.paper),this},E.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),t._toback(this,this.paper)),this)},E.insertAfter=function(e){return this.removed?this:(e.constructor==t.st.constructor&&(e=e[e.length-1]),e.node.nextSibling?e.node.parentNode.insertBefore(this.node,e.node.nextSibling):e.node.parentNode.appendChild(this.node),t._insertafter(this,e,this.paper),this)},E.insertBefore=function(e){return this.removed?this:(e.constructor==t.st.constructor&&(e=e[0]),e.node.parentNode.insertBefore(this.node,e.node),t._insertbefore(this,e,this.paper),this)},E.blur=function(e){var r=this.node.runtimeStyle,i=r.filter;i=i.replace(x,d),0!==+e?(this.attrs.blur=e,r.filter=i+p+f+".Blur(pixelradius="+(+e||1.5)+")",r.margin=t.format("-{0}px 0 0 -{0}px",a(+e||1.5))):(r.filter=i,r.margin=0,delete this.attrs.blur)},t._engine.path=function(t,e){var r=L("shape");r.style.cssText=m,r.coordsize=b+p+b,r.coordorigin=e.coordorigin;var i=new N(r,e),n={fill:"none",stroke:"#000"};t&&(n.path=t),i.type="path",i.path=[],i.Path=d,A(i,n),e.canvas.appendChild(r);var a=L("skew");return a.on=!0,r.appendChild(a),i.skew=a,i.transform(d),i},t._engine.rect=function(e,r,i,n,a,s){var o=t._rectPath(r,i,n,a,s),l=e.path(o),h=l.attrs;return l.X=h.x=r,l.Y=h.y=i,l.W=h.width=n,l.H=h.height=a,h.r=s,h.path=o,l.type="rect",l},t._engine.ellipse=function(t,e,r,i,n){var a=t.path();return a.attrs,a.X=e-i,a.Y=r-n,a.W=2*i,a.H=2*n,a.type="ellipse",A(a,{cx:e,cy:r,rx:i,ry:n}),a},t._engine.circle=function(t,e,r,i){var n=t.path();return n.attrs,n.X=e-i,n.Y=r-i,n.W=n.H=2*i,n.type="circle",A(n,{cx:e,cy:r,r:i}),n},t._engine.image=function(e,r,i,n,a,s){var o=t._rectPath(i,n,a,s),l=e.path(o).attr({stroke:"none"}),u=l.attrs,c=l.node,f=c.getElementsByTagName(h)[0];return u.src=r,l.X=u.x=i,l.Y=u.y=n,l.W=u.width=a,l.H=u.height=s,u.path=o,l.type="image",f.parentNode==c&&c.removeChild(f),f.rotate=!0,f.src=r,f.type="tile",l._.fillpos=[i,n],l._.fillsize=[a,s],c.appendChild(f),B(l,1,1,0,0,0),l},t._engine.text=function(e,i,n,s){var o=L("shape"),l=L("path"),h=L("textpath");i=i||0,n=n||0,s=s||"",l.v=t.format("m{0},{1}l{2},{1}",a(i*b),a(n*b),a(i*b)+1),l.textpathok=!0,h.string=r(s),h.on=!0,o.style.cssText=m,o.coordsize=b+p+b,o.coordorigin="0 0";var u=new N(o,e),c={fill:"#000",stroke:"none",font:t._availableAttrs.font,text:s};u.shape=o,u.path=l,u.textpath=h,u.type="text",u.attrs.text=r(s),u.attrs.x=i,u.attrs.y=n,u.attrs.w=1,u.attrs.h=1,A(u,c),o.appendChild(h),o.appendChild(l),e.canvas.appendChild(o);var f=L("skew");return f.on=!0,o.appendChild(f),u.skew=f,u.transform(d),u},t._engine.setSize=function(e,r){var i=this.canvas.style;return this.width=e,this.height=r,e==+e&&(e+="px"),r==+r&&(r+="px"),i.width=e,i.height=r,i.clip="rect(0 "+e+" "+r+" 0)",this._viewBox&&t._engine.setViewBox.apply(this,this._viewBox),this},t._engine.setViewBox=function(e,r,i,n,a){t.eve("raphael.setViewBox",this,this._viewBox,[e,r,i,n,a]);var o,l,h=this.width,u=this.height,c=1/s(i/h,n/u);return a&&(o=u/n,l=h/i,h>i*o&&(e-=(h-i*o)/2/o),u>n*l&&(r-=(u-n*l)/2/l)),this._viewBox=[e,r,i,n,!!a],this._viewBoxShift={dx:-e,dy:-r,scale:c},this.forEach(function(t){t.transform("...")}),this};var L;t._engine.initWin=function(t){var e=t.document;e.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!e.namespaces.rvml&&e.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),L=function(t){return e.createElement("<rvml:"+t+' class="rvml">')}}catch(r){L=function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},t._engine.initWin(t._g.win),t._engine.create=function(){var e=t._getContainer.apply(0,arguments),r=e.container,i=e.height,n=e.width,a=e.x,s=e.y;if(!r)throw Error("VML container not found.");var o=new t._Paper,l=o.canvas=t._g.doc.createElement("div"),h=l.style;return a=a||0,s=s||0,n=n||512,i=i||342,o.width=n,o.height=i,n==+n&&(n+="px"),i==+i&&(i+="px"),o.coordsize=1e3*b+p+1e3*b,o.coordorigin="0 0",o.span=t._g.doc.createElement("span"),o.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",l.appendChild(o.span),h.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",n,i),1==r?(t._g.doc.body.appendChild(l),h.left=a+"px",h.top=s+"px",h.position="absolute"):r.firstChild?r.insertBefore(l,r.firstChild):r.appendChild(l),o.renderfix=function(){},o},t.prototype.clear=function(){t.eve("raphael.clear",this),this.canvas.innerHTML=d,this.span=t._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},t.prototype.remove=function(){t.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null;return!0};var M=t.st;for(var z in E)E[e](z)&&!M[e](z)&&(M[z]=function(t){return function(){var e=arguments;return this.forEach(function(r){r[t].apply(r,e)})}}(z))}(window.Raphael);
;
;
/*! raphael-export.js */ 
;
;
/**
* Raphael.Export https://github.com/ElbertF/Raphael.Export
*
* Licensed under the MIT license:
* http://www.opensource.org/licenses/mit-license.php
*
*/
(function(R) {
/**
* Escapes string for XML interpolation
* @param value string or number value to escape
* @returns string escaped
*/
function escapeXML(s) {
if ( typeof s === 'number' ) return s.toString();
var replace = { '&': 'amp', '<': 'lt', '>': 'gt', '"': 'quot', '\'': 'apos' };
for ( var entity in replace ) {
s = s.replace(new RegExp(entity, 'g'), '&' + replace[entity] + ';');
}
return s;
}
/**
* Generic map function
* @param iterable the array or object to be mapped
* @param callback the callback function(element, key)
* @returns array
*/
function map(iterable, callback) {
var mapped = new Array;
for ( var i in iterable ) {
if ( iterable.hasOwnProperty(i) ) {
var value = callback.call(this, iterable[i], i);
if ( value !== null ) mapped.push(value);
}
}
return mapped;
}
/**
* Generic reduce function
* @param iterable array or object to be reduced
* @param callback the callback function(initial, element, i)
* @param initial the initial value
* @return the reduced value
*/
function reduce(iterable, callback, initial) {
for ( var i in iterable ) {
if ( iterable.hasOwnProperty(i) ) {
initial = callback.call(this, initial, iterable[i], i);
}
}
return initial;
}
/**
* Utility method for creating a tag
* @param name the tag name, e.g., 'text'
* @param attrs the attribute string, e.g., name1="val1" name2="val2"
* or attribute map, e.g., { name1 : 'val1', name2 : 'val2' }
* @param content the content string inside the tag
* @returns string of the tag
*/
function tag(name, attrs, matrix, content) {
if ( typeof content === 'undefined' || content === null ) {
content = '';
}
if ( typeof attrs === 'object' ) {
attrs = map(attrs, function(element, name) {
switch ( name ) {
case 'transform':
return;
case 'fill':
if ( element.match(/^hsb/) ) {
var hsb = element.replace(/^hsb\(|\)$/g, '').split(',');
if ( hsb.length === 3 ) {
element = R.hsb2rgb(hsb[0], hsb[1], hsb[2]).toString();
}
}
}
return name + '="' + escapeXML(element) + '"';
}).join(' ');
}
return '<' + name + ( matrix ? ' transform="matrix(' + matrix.toString().replace(/^matrix\(|\)$/g, '') + ')" ' : ' ' ) + attrs + '>' +  content + '</' + name + '>';
}
/**
* @return object the style object
*/
function extractStyle(node) {
return {
font: {
family: node.attrs.font.replace(/^.*?"(\w+)".*$/, '$1'),
size:   typeof node.attrs['font-size'] === 'undefined' ? null : node.attrs['font-size']
}
};
}
/**
* @param style object from style()
* @return string
*/
function styleToString(style) {
return 'font: normal normal normal 10px/normal ' + style.font.family + ( style.font.size === null ? '' : '; font-size: ' + style.font.size);
}
/**
* Computes tspan dy using font size. This formula was empircally determined
* using a best-fit line. Works well in both VML and SVG browsers.
* @param fontSize number
* @return number
*/
function computeTSpanDy(fontSize, line, lines) {
if ( fontSize === null || isNaN(fontSize)) fontSize = 18;
return fontSize * 4.5 / 13 * ( line - .2 - lines / 2 ) * 3.5;
}
var serializer = {
'text': function(node) {
style = extractStyle(node);
var tags = new Array;
var GLOBAL_LINE = -1;
map(node.attrs['text'].split('\n'), function(text, iterable, line) {
line = line || 0;
GLOBAL_LINE += 1;
tags.push(tag(
'text',
reduce(
node.attrs,
function(initial, value, name) {
if ( name !== 'text' && name !== 'w' && name !== 'h' ) {
if ( name === 'font-size') value = value + 'px';
initial[name] = escapeXML(value.toString());
}
return initial;
},
{ style: styleToString(style) + ';' }
),
node.matrix,
tag('tspan', { dy: computeTSpanDy(style.font.size, GLOBAL_LINE + line + 1, node.attrs['text'].split('\n').length) }, null, escapeXML(text) )
));
});
return tags;
},
'path' : function(node) {
var initial = ( node.matrix.a === 1 && node.matrix.d === 1 ) ? {} : { 'transform' : node.matrix.toString() };
return tag(
'path',
reduce(
node.attrs,
function(initial, value, name) {
if ( name === 'path' ) name = 'd';
initial[name] = value.toString();
return initial;
},
{}
),
node.matrix
);
}
};
R.fn.toSVG = function() {
var
paper   = this,
restore = { svg: R.svg, vml: R.vml },
svg     = '<svg style="overflow: hidden; position: relative;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="' + paper.width + '" version="1.1" height="' + paper.height + '">'
;
R.svg = true;
R.vml = false;
for ( var node = paper.bottom; node != null; node = node.next ) {
if ( node.node.style.display === 'none' ) continue;
var attrs = '';
if ( typeof serializer[node.type] === 'function' ) {
svg += serializer[node.type](node);
continue;
}
switch ( node.type ) {
case 'image':
attrs += ' preserveAspectRatio="none"';
break;
}
for ( i in node.attrs ) {
var name = i;
switch ( i ) {
case 'src':
name = 'xlink:href';
break;
case 'transform':
name = '';
break;
}
if ( name ) {
attrs += ' ' + name + '="' + escapeXML(node.attrs[i].toString()) + '"';
}
}
svg += '<' + node.type + ' transform="matrix(' + node.matrix.toString().replace(/^matrix\(|\)$/g, '') + ')"' + attrs + '></' + node.type + '>';
}
svg += '</svg>';
R.svg = restore.svg;
R.vml = restore.vml;
return svg;
};
})(window.Raphael);
;
;
/*! jquery.nicescroll.min.js */ 
;
;
/* jquery.nicescroll
-- version 3.5.4 -- MODIFIED
-- copyright 2013-11-13 InuYaksa*2013
-- licensed under the MIT
--
-- http://areaaperta.com/nicescroll
-- https://github.com/inuyaksa/jquery.nicescroll
--
*/
(function (factory) {
if (typeof define === 'function' && define.amd) {
define(['jquery'], factory);
} else {
factory(jQuery);
}
}(function(jQuery){
var domfocus = false;
var mousefocus = false;
var zoomactive = false;
var tabindexcounter = 5000;
var ascrailcounter = 2000;
var globalmaxzindex = 0;
var $ = jQuery;  // sandbox
function getScriptPath() {
var scripts=document.getElementsByTagName('script');
var path=scripts[scripts.length-1].src.split('?')[0];
return (path.split('/').length>0) ? path.split('/').slice(0,-1).join('/')+'/' : '';
}
var vendors = ['ms','moz','webkit','o'];
var setAnimationFrame = window.requestAnimationFrame||false;
var clearAnimationFrame = window.cancelAnimationFrame||false;
if (!setAnimationFrame) {
for(var vx in vendors) {
var v = vendors[vx];
if (!setAnimationFrame) setAnimationFrame = window[v+'RequestAnimationFrame'];
if (!clearAnimationFrame) clearAnimationFrame = window[v+'CancelAnimationFrame']||window[v+'CancelRequestAnimationFrame'];
}
}
var clsMutationObserver = window.MutationObserver || window.WebKitMutationObserver || false;
var _globaloptions = {
zindex:"auto",
cursoropacitymin:0,
cursoropacitymax:1,
cursorcolor:"#424242",
cursorwidth:"5px",
cursorborder:"1px solid #fff",
cursorborderradius:"5px",
scrollspeed:60,
mousescrollstep:8*3,
touchbehavior:false,
hwacceleration:true,
usetransition:true,
boxzoom:false,
dblclickzoom:true,
gesturezoom:true,
grabcursorenabled:true,
autohidemode:true,
background:"",
iframeautoresize:true,
cursorminheight:32,
preservenativescrolling:true,
railoffset:false,
bouncescroll:true,
spacebarenabled:true,
railpadding:{top:0,right:0,left:0,bottom:0},
railmargin:{top:0,right:0,left:0,bottom:0}, 
railhpadding:{top:-1,right:-1,left:-1,bottom:-1}, //padding for hrail, if no custom input it'll take padding rail
railhmargin:{top:-1,right:-1,left:-1,bottom:-1}, //margin for hrail, if no custom input it'll take margin rail
mirrorrails:true, //If no margin or paddings for horizontal rail are provided, it'll copy them from the vertical rail
disableoutline:true,
horizrailenabled:true,
railalign:"right",
railvalign:"bottom",
enabletranslate3d:true,
enablemousewheel:true,
enablekeyboard:true,
smoothscroll:true,
sensitiverail:true,
enablemouselockapi:true,
cursorfixedheight:false,      
directionlockdeadzone:6,
hidecursordelay:400,
nativeparentscrolling:true,
enablescrollonselection:true,
overflowx:true,
overflowy:true,
cursordragspeed:0.3,
rtlmode:"auto",
cursordragontouch:false,
oneaxismousemode:"auto",
scriptpath:getScriptPath()
};
var browserdetected = false;
var getBrowserDetection = function() {
if (browserdetected) return browserdetected;
var domtest = document.createElement('DIV');
var d = {};
d.haspointerlock = "pointerLockElement" in document || "mozPointerLockElement" in document || "webkitPointerLockElement" in document;
d.isopera = ("opera" in window);
d.isopera12 = (d.isopera&&("getUserMedia" in navigator));
d.isoperamini = (Object.prototype.toString.call(window.operamini) === "[object OperaMini]");
d.isie = (("all" in document) && ("attachEvent" in domtest) && !d.isopera);
d.isieold = (d.isie && !("msInterpolationMode" in domtest.style));  // IE6 and older
d.isie7 = d.isie&&!d.isieold&&(!("documentMode" in document)||(document.documentMode==7));
d.isie8 = d.isie&&("documentMode" in document)&&(document.documentMode==8);
d.isie9 = d.isie&&("performance" in window)&&(document.documentMode>=9);
d.isie10 = d.isie&&("performance" in window)&&(document.documentMode>=10);
d.isie9mobile = /iemobile.9/i.test(navigator.userAgent);  //wp 7.1 mango
if (d.isie9mobile) d.isie9 = false;
d.isie7mobile = (!d.isie9mobile&&d.isie7) && /iemobile/i.test(navigator.userAgent);  //wp 7.0
d.ismozilla = ("MozAppearance" in domtest.style);
d.iswebkit = ("WebkitAppearance" in domtest.style);
d.ischrome = ("chrome" in window);
d.ischrome22 = (d.ischrome&&d.haspointerlock);
d.ischrome26 = (d.ischrome&&("transition" in domtest.style));  // issue with transform detection (maintain prefix)
d.cantouch = ("ontouchstart" in document.documentElement)||("ontouchstart" in window);  // detection for Chrome Touch Emulation
d.hasmstouch = (window.navigator.msPointerEnabled||false);  // IE10+ pointer events
d.ismac = /^mac$/i.test(navigator.platform);
d.isios = (d.cantouch && /iphone|ipad|ipod/i.test(navigator.platform));
d.isios4 = ((d.isios)&&!("seal" in Object));
d.isandroid = (/android/i.test(navigator.userAgent));
d.trstyle = false;
d.hastransform = false;
d.hastranslate3d = false;
d.transitionstyle = false;
d.hastransition = false;
d.transitionend = false;
var check = ['transform','msTransform','webkitTransform','MozTransform','OTransform'];
for(var a=0;a<check.length;a++){
if (typeof domtest.style[check[a]] != "undefined") {
d.trstyle = check[a];
break;
}
}
d.hastransform = (d.trstyle != false);
if (d.hastransform) {
domtest.style[d.trstyle] = "translate3d(1px,2px,3px)";
d.hastranslate3d = /translate3d/.test(domtest.style[d.trstyle]);
}
d.transitionstyle = false;
d.prefixstyle = '';
d.transitionend = false;
var check = ['transition','webkitTransition','MozTransition','OTransition','OTransition','msTransition','KhtmlTransition'];
var prefix = ['','-webkit-','-moz-','-o-','-o','-ms-','-khtml-'];
var evs = ['transitionend','webkitTransitionEnd','transitionend','otransitionend','oTransitionEnd','msTransitionEnd','KhtmlTransitionEnd'];
for(var a=0;a<check.length;a++) {
if (check[a] in domtest.style) {
d.transitionstyle = check[a];
d.prefixstyle = prefix[a];
d.transitionend = evs[a];
break;
}
}
if (d.ischrome26) {  // use always prefix
d.prefixstyle = prefix[1];
}
d.hastransition = (d.transitionstyle);
function detectCursorGrab() {      
var lst = ['-moz-grab','-webkit-grab','grab'];
if ((d.ischrome&&!d.ischrome22)||d.isie) lst=[];  // force setting for IE returns false positive and chrome cursor bug
for(var a=0;a<lst.length;a++) {
var p = lst[a];
domtest.style['cursor']=p;
if (domtest.style['cursor']==p) return p;
}
return 'url(http://www.google.com/intl/en_ALL/mapfiles/openhand.cur),n-resize';  // thank you google for custom cursor!
}
d.cursorgrabvalue = detectCursorGrab();
d.hasmousecapture = ("setCapture" in domtest);
d.hasMutationObserver = (clsMutationObserver !== false);
domtest = null;  //memory released
browserdetected = d;
return d;  
};
var NiceScrollClass = function(myopt,me) {
var self = this;
this.version = '3.5.4';
this.name = 'nicescroll';
this.me = me;
this.opt = {
doc:$("body"),
win:false
};
$.extend(this.opt,_globaloptions);
this.opt.snapbackspeed = 80;
if (myopt||false) {
for(var a in self.opt) {
if (typeof myopt[a] != "undefined") self.opt[a] = myopt[a];
}
}
if(this.opt.mirrorrails && this.opt.railhmargin.top==-1){this.opt.railhmargin.top=this.opt.railmargin.left};
if(this.opt.mirrorrails && this.opt.railhmargin.right==-1){this.opt.railhmargin.right=this.opt.railmargin.bottom};
if(this.opt.mirrorrails && this.opt.railhmargin.left==-1){this.opt.railhmargin.left=this.opt.railmargin.top};
if(this.opt.mirrorrails && this.opt.railhmargin.bottom==-1){this.opt.railhmargin.bottom=this.opt.railmargin.right};
if(this.opt.mirrorrails && this.opt.railhpadding.top==-1){this.opt.railhpadding.top=this.opt.railpadding.left;};
if(this.opt.mirrorrails && this.opt.railhpadding.right==-1){this.opt.railhpadding.right=this.opt.railpadding.bottom};
if(this.opt.mirrorrails && this.opt.railhpadding.left==-1){this.opt.railhpadding.left=this.opt.railpadding.top};
if(this.opt.mirrorrails && this.opt.railhpadding.bottom==-1){this.opt.railhpadding.bottom=this.opt.railpadding.right};
this.doc = self.opt.doc;
this.iddoc = (this.doc&&this.doc[0])?this.doc[0].id||'':'';    
this.ispage = /^BODY|HTML/.test((self.opt.win)?self.opt.win[0].nodeName:this.doc[0].nodeName);
this.haswrapper = (self.opt.win!==false);
this.win = self.opt.win||(this.ispage?$(window):this.doc);
this.docscroll = (this.ispage&&!this.haswrapper)?$(window):this.win;
this.body = $("body");
this.viewport = false;
this.isfixed = false;
this.iframe = false;
this.isiframe = ((this.doc[0].nodeName == 'IFRAME') && (this.win[0].nodeName == 'IFRAME'));
this.istextarea = (this.win[0].nodeName == 'TEXTAREA');
this.forcescreen = false; //force to use screen position on events
this.canshowonmouseevent = (self.opt.autohidemode!="scroll");
this.onmousedown = false;
this.onmouseup = false;
this.onmousemove = false;
this.onmousewheel = false;
this.onkeypress = false;
this.ongesturezoom = false;
this.onclick = false;
this.onscrollstart = false;
this.onscrollend = false;
this.onscrollcancel = false;    
this.onzoomin = false;
this.onzoomout = false;
this.view = false;
this.page = false;
this.scroll = {x:0,y:0};
this.scrollratio = {x:0,y:0};    
this.cursorheight = 20;
this.scrollvaluemax = 0;
this.isrtlmode = false; //(this.opt.rtlmode=="auto") ? (this.win.css("direction")=="rtl") : (this.opt.rtlmode===true);
this.scrollrunning = false;
this.scrollmom = false;
this.observer = false;
this.observerremover = false;  // observer on parent for remove detection
do {
this.id = "ascrail"+(ascrailcounter++);
} while (document.getElementById(this.id));
this.rail = false;
this.cursor = false;
this.cursorfreezed = false;  
this.selectiondrag = false;
this.zoom = false;
this.zoomactive = false;
this.hasfocus = false;
this.hasmousefocus = false;
this.visibility = true;
this.locked = false;
this.hidden = false; // rails always hidden
this.cursoractive = true; // user can interact with cursors
this.wheelprevented = false;  //prevent mousewheel event
this.overflowx = self.opt.overflowx;
this.overflowy = self.opt.overflowy;
this.nativescrollingarea = false;
this.checkarea = 0;
this.events = [];  // event list for unbind
this.saved = {};
this.delaylist = {};
this.synclist = {};
this.lastdeltax = 0;
this.lastdeltay = 0;
this.detected = getBrowserDetection(); 
var cap = $.extend({},this.detected);
this.canhwscroll = (cap.hastransform&&self.opt.hwacceleration);
this.ishwscroll = (this.canhwscroll&&self.haswrapper);
this.istouchcapable = false;  // desktop devices with touch screen support
if (cap.cantouch&&cap.ischrome&&!cap.isios&&!cap.isandroid) {
this.istouchcapable = true;
cap.cantouch = false;  // parse normal desktop events
}    
if (cap.cantouch&&cap.ismozilla&&!cap.isios&&!cap.isandroid) {
this.istouchcapable = true;
cap.cantouch = false;  // parse normal desktop events
}    
if (!self.opt.enablemouselockapi) {
cap.hasmousecapture = false;
cap.haspointerlock = false;
}
this.delayed = function(name,fn,tm,lazy) {
var dd = self.delaylist[name];
var nw = (new Date()).getTime();
if (!lazy&&dd&&dd.tt) return false;
if (dd&&dd.tt) clearTimeout(dd.tt);
if (dd&&dd.last+tm>nw&&!dd.tt) {      
self.delaylist[name] = {
last:nw+tm,
tt:setTimeout(function(){if(self||false){self.delaylist[name].tt=0;fn.call()}},tm)
}
}
else if (!dd||!dd.tt) {
self.delaylist[name] = {
last:nw,
tt:0
};
setTimeout(function(){fn.call();},0);
}
};
this.debounced = function(name,fn,tm) {
var dd = self.delaylist[name];
var nw = (new Date()).getTime();      
self.delaylist[name] = fn;
if (!dd) {        
setTimeout(function(){var fn=self.delaylist[name];self.delaylist[name]=false;fn.call();},tm);
}
};
var _onsync = false;
this.synched = function(name,fn) {
function requestSync() {
if (_onsync) return;
setAnimationFrame(function(){
_onsync = false;
for(name in self.synclist){
var fn = self.synclist[name];
if (fn) fn.call(self);
self.synclist[name] = false;
}
});
_onsync = true;
};    
self.synclist[name] = fn;
requestSync();
return name;
};
this.unsynched = function(name) {
if (self.synclist[name]) self.synclist[name] = false;
};
this.css = function(el,pars) {  // save & set
for(var n in pars) {
self.saved.css.push([el,n,el.css(n)]);
el.css(n,pars[n]);
}
};
this.scrollTop = function(val) {
return (typeof val == "undefined") ? self.getScrollTop() : self.setScrollTop(val);
};
this.scrollLeft = function(val) {
return (typeof val == "undefined") ? self.getScrollLeft() : self.setScrollLeft(val);
};
BezierClass = function(st,ed,spd,p1,p2,p3,p4) {
this.st = st;
this.ed = ed;
this.spd = spd;
this.p1 = p1||0;
this.p2 = p2||1;
this.p3 = p3||0;
this.p4 = p4||1;
this.ts = (new Date()).getTime();
this.df = this.ed-this.st;
};
BezierClass.prototype = {
B2:function(t){ return 3*t*t*(1-t) },
B3:function(t){ return 3*t*(1-t)*(1-t) },
B4:function(t){ return (1-t)*(1-t)*(1-t) },
getNow:function(){
var nw = (new Date()).getTime();
var pc = 1-((nw-this.ts)/this.spd);
var bz = this.B2(pc) + this.B3(pc) + this.B4(pc);
return (pc<0) ? this.ed : this.st+Math.round(this.df*bz);
},
update:function(ed,spd){
this.st = this.getNow();
this.ed = ed;
this.spd = spd;
this.ts = (new Date()).getTime();
this.df = this.ed-this.st;
return this;
}
};
if (this.ishwscroll) {  
this.doc.translate = {x:0,y:0,tx:"0px",ty:"0px"};
if (cap.hastranslate3d&&cap.isios) this.doc.css("-webkit-backface-visibility","hidden");  // prevent flickering http://stackoverflow.com/questions/3461441/      
function getMatrixValues() {
var tr = self.doc.css(cap.trstyle);
if (tr&&(tr.substr(0,6)=="matrix")) {
return tr.replace(/^.*\((.*)\)$/g, "$1").replace(/px/g,'').split(/, +/);
}
return false;
}
this.getScrollTop = function(last) {
if (!last) {
var mtx = getMatrixValues();
if (mtx) return (mtx.length==16) ? -mtx[13] : -mtx[5];  //matrix3d 16 on IE10
if (self.timerscroll&&self.timerscroll.bz) return self.timerscroll.bz.getNow();
}
return self.doc.translate.y;
};
this.getScrollLeft = function(last) {
if (!last) {
var mtx = getMatrixValues();          
if (mtx) return (mtx.length==16) ? -mtx[12] : -mtx[4];  //matrix3d 16 on IE10
if (self.timerscroll&&self.timerscroll.bh) return self.timerscroll.bh.getNow();
}
return self.doc.translate.x;
};
if (document.createEvent) {
this.notifyScrollEvent = function(el) {
var e = document.createEvent("UIEvents");
e.initUIEvent("scroll", false, true, window, 1);
el.dispatchEvent(e);
};
}
else if (document.fireEvent) {
this.notifyScrollEvent = function(el) {
var e = document.createEventObject();
el.fireEvent("onscroll");
e.cancelBubble = true; 
};
}
else {
this.notifyScrollEvent = function(el,add) {}; //NOPE
}
var cxscrollleft = -1; //(this.isrtlmode) ? 1 : -1;
if (cap.hastranslate3d&&self.opt.enabletranslate3d) {
this.setScrollTop = function(val,silent) {
self.doc.translate.y = val;
self.doc.translate.ty = (val*-1)+"px";
self.doc.css(cap.trstyle,"translate3d("+self.doc.translate.tx+","+self.doc.translate.ty+",0px)");          
if (!silent) self.notifyScrollEvent(self.win[0]);
};
this.setScrollLeft = function(val,silent) {          
self.doc.translate.x = val;
self.doc.translate.tx = (val*cxscrollleft)+"px";
self.doc.css(cap.trstyle,"translate3d("+self.doc.translate.tx+","+self.doc.translate.ty+",0px)");          
if (!silent) self.notifyScrollEvent(self.win[0]);
};
} else {
this.setScrollTop = function(val,silent) {
self.doc.translate.y = val;
self.doc.translate.ty = (val*-1)+"px";
self.doc.css(cap.trstyle,"translate("+self.doc.translate.tx+","+self.doc.translate.ty+")");
if (!silent) self.notifyScrollEvent(self.win[0]);          
};
this.setScrollLeft = function(val,silent) {        
self.doc.translate.x = val;
self.doc.translate.tx = (val*cxscrollleft)+"px";
self.doc.css(cap.trstyle,"translate("+self.doc.translate.tx+","+self.doc.translate.ty+")");
if (!silent) self.notifyScrollEvent(self.win[0]);
};
}
} else {
this.getScrollTop = function() {
return self.docscroll.scrollTop();
};
this.setScrollTop = function(val) {        
return self.docscroll.scrollTop(val);
};
this.getScrollLeft = function() {
return self.docscroll.scrollLeft();
};
this.setScrollLeft = function(val) {
return self.docscroll.scrollLeft(val);
};
}
this.getTarget = function(e) {
if (!e) return false;
if (e.target) return e.target;
if (e.srcElement) return e.srcElement;
return false;
};
this.hasParent = function(e,id) {
if (!e) return false;
var el = e.target||e.srcElement||e||false;
while (el && el.id != id) {
el = el.parentNode||false;
}
return (el!==false);
};
function getZIndex() {
var dom = self.win;
if ("zIndex" in dom) return dom.zIndex();  // use jQuery UI method when available
while (dom.length>0) {        
if (dom[0].nodeType==9) return false;
var zi = dom.css('zIndex');        
if (!isNaN(zi)&&zi!=0) return parseInt(zi);
dom = dom.parent();
}
return false;
};
var _convertBorderWidth = {"thin":1,"medium":3,"thick":5};
function getWidthToPixel(dom,prop,chkheight) {
var wd = dom.css(prop);
var px = parseFloat(wd);
if (isNaN(px)) {
px = _convertBorderWidth[wd]||0;
var brd = (px==3) ? ((chkheight)?(self.win.outerHeight() - self.win.innerHeight()):(self.win.outerWidth() - self.win.innerWidth())) : 1; //DON'T TRUST CSS
if (self.isie8&&px) px+=1;
return (brd) ? px : 0; 
}
return px;
};
this.getOffset = function() {
if (self.isfixed) return {top:parseFloat(self.win.css('top')),left:parseFloat(self.win.css('left'))};
if (!self.viewport) return self.win.offset();
var ww = self.win.offset();
var vp = self.viewport.offset();
return {top:ww.top-vp.top+self.viewport.scrollTop(),left:ww.left-vp.left+self.viewport.scrollLeft()};
};
this.updateScrollBar = function(len) {
var boxoffsetv = self.opt.railmargin['top']+self.opt.railmargin['bottom'];
var boxoffseth = self.opt.railhmargin['left']+self.opt.railhmargin['right'];
if (self.ishwscroll) {
self.rail.css({height:self.win.innerHeight()-boxoffsetv});
if (self.railh) self.railh.css({width:self.win.innerWidth()-boxoffseth});
} else {
var wpos = self.getOffset();
var pos = {top:wpos.top,left:wpos.left};
pos.top+= getWidthToPixel(self.win,'border-top-width',true);
var brd = (self.win.outerWidth() - self.win.innerWidth())/2;
pos.left+= (self.rail.align) ? self.win.outerWidth() - getWidthToPixel(self.win,'border-right-width') - self.rail.width : getWidthToPixel(self.win,'border-left-width');
var off = self.opt.railoffset;
if (off) {
if (off.top) pos.top+=off.top;
if (self.rail.align&&off.left) pos.left+=off.left;
}
if (!self.locked) self.rail.css({top:pos.top,left:pos.left,height:(len)?len.h-boxoffsetv:self.win.innerHeight()-boxoffsetv});
if (self.zoom) {          
self.zoom.css({top:pos.top+1,left:(self.rail.align==1) ? pos.left-20 : pos.left+self.rail.width+4});
}
if (self.railh&&!self.locked) {
var pos = {top:wpos.top,left:wpos.left};
var y = (self.railh.align) ? pos.top + getWidthToPixel(self.win,'border-top-width',true) + self.win.innerHeight() - self.railh.height : pos.top + getWidthToPixel(self.win,'border-top-width',true);
var x = pos.left + getWidthToPixel(self.win,'border-left-width') + self.opt.railhmargin['left'];
self.railh.css({top:y-self.opt.railhmargin['top'],left:x,width:self.railh.width-boxoffseth});
}
}
};
this.doRailClick = function(e,dbl,hr) {
var fn,pg,cur,pos;
if (self.locked) return;
self.cancelEvent(e);
if (dbl) {
fn = (hr) ? self.doScrollLeft : self.doScrollTop;
cur = (hr) ? ((e.pageX - self.railh.offset().left - (self.cursorwidth/2)) * self.scrollratio.x) : ((e.pageY - self.rail.offset().top - (self.cursorheight/2)) * self.scrollratio.y);
fn(cur);
} else {
fn = (hr) ? self.doScrollLeftBy : self.doScrollBy;
cur = (hr) ? self.scroll.x : self.scroll.y;
pos = (hr) ? e.pageX - self.railh.offset().left : e.pageY - self.rail.offset().top;
pg = (hr) ? self.view.w : self.view.h;        
(cur>=pos) ? fn(pg) : fn(-pg);
}
};
self.hasanimationframe = (setAnimationFrame);
self.hascancelanimationframe = (clearAnimationFrame);
if (!self.hasanimationframe) {
setAnimationFrame=function(fn){return setTimeout(fn,15-Math.floor((+new Date)/1000)%16)}; // 1000/60)};
clearAnimationFrame=clearInterval;
} 
else if (!self.hascancelanimationframe) clearAnimationFrame=function(){self.cancelAnimationFrame=true};
this.init = function() {
self.saved.css = [];
if (cap.isie7mobile) return true; // SORRY, DO NOT WORK!
if (cap.isoperamini) return true; // SORRY, DO NOT WORK!
if (cap.hasmstouch) self.css((self.ispage)?$("html"):self.win,{'-ms-touch-action':'none'});
self.zindex = "auto";
if (!self.ispage&&self.opt.zindex=="auto") {
self.zindex = getZIndex()||"auto";
} else {
self.zindex = self.opt.zindex;
}
if (!self.ispage&&self.zindex!="auto") {
if (self.zindex>globalmaxzindex) globalmaxzindex=self.zindex;
}
if (self.isie&&self.zindex==0&&self.opt.zindex=="auto") {  // fix IE auto == 0
self.zindex="auto";
}
/*      
self.ispage = true;
self.haswrapper = true;
self.docscroll = $("body");
*/
if (!self.ispage || (!cap.cantouch && !cap.isieold && !cap.isie9mobile)) {
var cont = self.docscroll;
if (self.ispage) cont = (self.haswrapper)?self.win:self.doc;
if (!cap.isie9mobile) self.css(cont,{'overflow-y':'hidden'});      
if (self.ispage&&cap.isie7) {
if (self.doc[0].nodeName=='BODY') self.css($("html"),{'overflow-y':'hidden'});  //IE7 double scrollbar issue
else if (self.doc[0].nodeName=='HTML') self.css($("body"),{'overflow-y':'hidden'});  //IE7 double scrollbar issue
}
if (cap.isios&&!self.ispage&&!self.haswrapper) self.css($("body"),{"-webkit-overflow-scrolling":"touch"});  //force hw acceleration
var cursor = $(document.createElement('div'));
cursor.css({
position:"relative",top:0,"float":"right",width:self.opt.cursorwidth,height:"0px",
'background-color':self.opt.cursorcolor,
border:self.opt.cursorborder,
'background-clip':'padding-box',
'-webkit-border-radius':self.opt.cursorborderradius,
'-moz-border-radius':self.opt.cursorborderradius,
'border-radius':self.opt.cursorborderradius
});   
cursor.hborder = parseFloat(cursor.outerHeight() - cursor.innerHeight());        
self.cursor = cursor;        
var rail = $(document.createElement('div'));
rail.attr('id',self.id);
rail.addClass('nicescroll-rails');
var v,a,kp = ["left","right","top","bottom"];
for(var n in kp) {
a=kp[n];
v = self.opt.railpadding[a];
(v) ? rail.css("padding-"+a,v+"px") : self.opt.railpadding[a] = 0;
v2 = self.opt.railmargin[a];
(v2) ? rail.css("margin-"+a,v2+"px") : self.opt.railmargin[a] = 0;
}
rail.append(cursor);
rail.width = Math.max(parseFloat(self.opt.cursorwidth),cursor.outerWidth()) + self.opt.railpadding['left'] + self.opt.railpadding['right'];
rail.css({width:rail.width+"px",'zIndex':self.zindex,"background":self.opt.background,cursor:"default"});        
rail.visibility = true;
rail.scrollable = true;
rail.align = (self.opt.railalign=="left") ? 0 : 1;
self.rail = rail;
self.rail.drag = false;
var zoom = false;
if (self.opt.boxzoom&&!self.ispage&&!cap.isieold) {
zoom = document.createElement('div');          
self.bind(zoom,"click",self.doZoom);
self.zoom = $(zoom);
self.zoom.css({"cursor":"pointer",'z-index':self.zindex,'backgroundImage':'url('+self.opt.scriptpath+'zoomico.png)','height':18,'width':18,'backgroundPosition':'0px 0px'});
if (self.opt.dblclickzoom) self.bind(self.win,"dblclick",self.doZoom);
if (cap.cantouch&&self.opt.gesturezoom) {
self.ongesturezoom = function(e) {
if (e.scale>1.5) self.doZoomIn(e);
if (e.scale<0.8) self.doZoomOut(e);
return self.cancelEvent(e);
};
self.bind(self.win,"gestureend",self.ongesturezoom);             
}
}
self.railh = false;
if (self.opt.horizrailenabled) {
self.css(cont,{'overflow-x':'hidden'});
var cursor = $(document.createElement('div'));
cursor.css({
position:"relative",top:0,height:self.opt.cursorwidth,width:"0px",
'background-color':self.opt.cursorcolor,
border:self.opt.cursorborder,
'background-clip':'padding-box',
'-webkit-border-radius':self.opt.cursorborderradius,
'-moz-border-radius':self.opt.cursorborderradius,
'border-radius':self.opt.cursorborderradius
});   
cursor.wborder = parseFloat(cursor.outerWidth() - cursor.innerWidth());
self.cursorh = cursor;
var railh = $(document.createElement('div'));
railh.attr('id',self.id+'-hr');
railh.addClass('nicescroll-rails');
railh.height = Math.max(parseFloat(self.opt.cursorwidth),cursor.outerHeight());
railh.css({height:railh.height+"px",'zIndex':self.zindex,"background":self.opt.background});
var v,v2,a,kp = ["left","right","top","bottom"]; 
for(var n in kp) {
a=kp[n];
v = self.opt.railhpadding[a];
(v) ? railh.css("padding-"+a,v+"px") : self.opt.railhpadding[a] = 0;
v2 = self.opt.railhmargin[a]; 
(v2) ? railh.css("margin-"+a,v2+"px") : self.opt.railhmargin[a] = 0;
}
railh.append(cursor);
railh.visibility = true;
railh.scrollable = true;
railh.align = (self.opt.railvalign=="top") ? 0 : 1;
self.railh = railh;
self.railh.drag = false;
}
if (self.ispage) {
rail.css({position:"fixed",top:"0px",height:self.win.height()-self.opt.railpadding['top']-self.opt.railpadding['bottom']-self.opt.railmargin['top']-self.opt.railmargin['bottom']});
(rail.align) ? rail.css({right:"0px"}) : rail.css({left:"0px"});
self.body.append(rail);
if (self.railh) {
railh.css({position:"fixed",left:"0px",width:self.win.width()-self.opt.railhpadding['left']-self.opt.railhpadding['right']-self.opt.railhmargin['left']-self.opt.railhmargin['right']});
(railh.align) ? railh.css({bottom:"0px"}) : railh.css({top:"0px"});
self.body.append(railh);
}
} else {          
if (self.ishwscroll) {
if (self.win.css('position')=='static') self.css(self.win,{'position':'relative'});
var bd = (self.win[0].nodeName == 'HTML') ? self.body : self.win;
if (self.zoom) {
self.zoom.css({position:"absolute",top:1,right:0,"margin-right":rail.width+4});
bd.append(self.zoom);
}
rail.css({position:"absolute",top:0});
(rail.align) ? rail.css({right:0}) : rail.css({left:0});
bd.append(rail);
if (railh) {
railh.css({position:"absolute",left:0,bottom:0});
(railh.align) ? railh.css({bottom:0}) : railh.css({top:0});
bd.append(railh);
}
} else {
self.isfixed = (self.win.css("position")=="fixed");
var rlpos = (self.isfixed) ? "fixed" : "absolute";
if (!self.isfixed) self.viewport = self.getViewport(self.win[0]);
if (self.viewport) {
self.body = self.viewport;              
if ((/fixed|relative|absolute/.test(self.viewport.css("position")))==false) self.css(self.viewport,{"position":"relative"});
}            
rail.css({position:rlpos});
if (self.zoom) self.zoom.css({position:rlpos});
self.updateScrollBar();
self.body.append(rail);
if (self.zoom) self.body.append(self.zoom);
if (self.railh) {
railh.css({position:rlpos});
self.body.append(railh);           
}
}
if (cap.isios) self.css(self.win,{'-webkit-tap-highlight-color':'rgba(0,0,0,0)','-webkit-touch-callout':'none'});  // prevent grey layer on click
if (cap.isie&&self.opt.disableoutline) self.win.attr("hideFocus","true");  // IE, prevent dotted rectangle on focused div
if (cap.iswebkit&&self.opt.disableoutline) self.win.css({"outline":"none"});
}
if (self.opt.autohidemode===false) {
self.autohidedom = false;
self.rail.css({opacity:self.opt.cursoropacitymax});          
if (self.railh) self.railh.css({opacity:self.opt.cursoropacitymax});
}
else if ((self.opt.autohidemode===true)||(self.opt.autohidemode==="leave")) {
self.autohidedom = $().add(self.rail);          
if (cap.isie8) self.autohidedom=self.autohidedom.add(self.cursor);
if (self.railh) self.autohidedom=self.autohidedom.add(self.railh);
if (self.railh&&cap.isie8) self.autohidedom=self.autohidedom.add(self.cursorh);
}
else if (self.opt.autohidemode=="scroll") {
self.autohidedom = $().add(self.rail);
if (self.railh) self.autohidedom=self.autohidedom.add(self.railh);
}
else if (self.opt.autohidemode=="cursor") {
self.autohidedom = $().add(self.cursor);
if (self.railh) self.autohidedom=self.autohidedom.add(self.cursorh);
}
else if (self.opt.autohidemode=="hidden") {
self.autohidedom = false;
self.hide();
self.locked = false;
}
if (cap.isie9mobile) {
self.scrollmom = new ScrollMomentumClass2D(self);        
/*
var trace = function(msg) {
var db = $("#debug");
if (isNaN(msg)&&(typeof msg != "string")) {
var x = [];
for(var a in msg) {
x.push(a+":"+msg[a]);
}
msg ="{"+x.join(",")+"}";
}
if (db.children().length>0) {
db.children().eq(0).before("<div>"+msg+"</div>");
} else {
db.append("<div>"+msg+"</div>");
}
}
window.onerror = function(msg,url,ln) {
trace("ERR: "+msg+" at "+ln);
}
*/          
self.onmangotouch = function(e) {
var py = self.getScrollTop();
var px = self.getScrollLeft();
if ((py == self.scrollmom.lastscrolly)&&(px == self.scrollmom.lastscrollx)) return true;
var dfy = py-self.mangotouch.sy;
var dfx = px-self.mangotouch.sx;            
var df = Math.round(Math.sqrt(Math.pow(dfx,2)+Math.pow(dfy,2)));            
if (df==0) return;
var dry = (dfy<0)?-1:1;
var drx = (dfx<0)?-1:1;
var tm = +new Date();
if (self.mangotouch.lazy) clearTimeout(self.mangotouch.lazy);
if (((tm-self.mangotouch.tm)>80)||(self.mangotouch.dry!=dry)||(self.mangotouch.drx!=drx)) {
self.scrollmom.stop();
self.scrollmom.reset(px,py);
self.mangotouch.sy = py;
self.mangotouch.ly = py;
self.mangotouch.sx = px;
self.mangotouch.lx = px;
self.mangotouch.dry = dry;
self.mangotouch.drx = drx;
self.mangotouch.tm = tm;
} else {
self.scrollmom.stop();
self.scrollmom.update(self.mangotouch.sx-dfx,self.mangotouch.sy-dfy);
var gap = tm - self.mangotouch.tm;              
self.mangotouch.tm = tm;
var ds = Math.max(Math.abs(self.mangotouch.ly-py),Math.abs(self.mangotouch.lx-px));
self.mangotouch.ly = py;
self.mangotouch.lx = px;
if (ds>2) {
self.mangotouch.lazy = setTimeout(function(){
self.mangotouch.lazy = false;
self.mangotouch.dry = 0;
self.mangotouch.drx = 0;
self.mangotouch.tm = 0;                  
self.scrollmom.doMomentum(30);
},100);
}
}
};
var top = self.getScrollTop();
var lef = self.getScrollLeft();
self.mangotouch = {sy:top,ly:top,dry:0,sx:lef,lx:lef,drx:0,lazy:false,tm:0};
self.bind(self.docscroll,"scroll",self.onmangotouch);
} else {
if (cap.cantouch||self.istouchcapable||self.opt.touchbehavior||cap.hasmstouch) {
self.scrollmom = new ScrollMomentumClass2D(self);
self.ontouchstart = function(e) {
if (e.pointerType&&e.pointerType!=2) return false;
self.hasmoving = false;
if (!self.locked) {
if (cap.hasmstouch) {
var tg = (e.target) ? e.target : false;
while (tg) {
var nc = $(tg).getNiceScroll();
if ((nc.length>0)&&(nc[0].me == self.me)) break;
if (nc.length>0) return false;
if ((tg.nodeName=='DIV')&&(tg.id==self.id)) break;
tg = (tg.parentNode) ? tg.parentNode : false;
}
}
self.cancelScroll();
var tg = self.getTarget(e);
if (tg) {
var skp = (/INPUT/i.test(tg.nodeName))&&(/range/i.test(tg.type));
if (skp) return self.stopPropagation(e);
}
if (!("clientX" in e) && ("changedTouches" in e)) {
e.clientX = e.changedTouches[0].clientX;
e.clientY = e.changedTouches[0].clientY;
}
if (self.forcescreen) {
var le = e;
var e = {"original":(e.original)?e.original:e};
e.clientX = le.screenX;
e.clientY = le.screenY;    
}
self.rail.drag = {x:e.clientX,y:e.clientY,sx:self.scroll.x,sy:self.scroll.y,st:self.getScrollTop(),sl:self.getScrollLeft(),pt:2,dl:false};
if (self.ispage||!self.opt.directionlockdeadzone) {
self.rail.drag.dl = "f";
} else {
var view = {
w:$(window).width(),
h:$(window).height()
};
var page = {
w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),
h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)
};
var maxh = Math.max(0,page.h - view.h);
var maxw = Math.max(0,page.w - view.w);                
if (!self.rail.scrollable&&self.railh.scrollable) self.rail.drag.ck = (maxh>0) ? "v" : false;
else if (self.rail.scrollable&&!self.railh.scrollable) self.rail.drag.ck = (maxw>0) ? "h" : false;
else self.rail.drag.ck = false;
if (!self.rail.drag.ck) self.rail.drag.dl = "f";
}
if (self.opt.touchbehavior&&self.isiframe&&cap.isie) {
var wp = self.win.position();
self.rail.drag.x+=wp.left;
self.rail.drag.y+=wp.top;
}
self.hasmoving = false;
self.lastmouseup = false;
self.scrollmom.reset(e.clientX,e.clientY);
if (!cap.cantouch&&!this.istouchcapable&&!cap.hasmstouch) {
var ip = (tg)?/INPUT|SELECT|TEXTAREA/i.test(tg.nodeName):false;
if (!ip) {
if (!self.ispage&&cap.hasmousecapture) tg.setCapture();                   
if (self.opt.touchbehavior) {                   
if (tg.onclick&&!(tg._onclick||false)) {  // intercept DOM0 onclick event
tg._onclick = tg.onclick;
tg.onclick = function(e){
if (self.hasmoving) return false;
tg._onclick.call(this,e);
}
}
return self.cancelEvent(e);
}
return self.stopPropagation(e);
}
if (/SUBMIT|CANCEL|BUTTON/i.test($(tg).attr('type'))) {
pc = {"tg":tg,"click":false};
self.preventclick = pc;
}
}
}
};
self.ontouchend = function(e) {
if (e.pointerType&&e.pointerType!=2) return false;
if (self.rail.drag&&(self.rail.drag.pt==2)) {
self.scrollmom.doMomentum();
self.rail.drag = false;
if (self.hasmoving) {                  
self.lastmouseup = true;
self.hideCursor();
if (cap.hasmousecapture) document.releaseCapture();
if (!cap.cantouch) return self.cancelEvent(e);
}                            
}                        
};
var moveneedoffset = (self.opt.touchbehavior&&self.isiframe&&!cap.hasmousecapture);
self.ontouchmove = function(e,byiframe) {
if (e.pointerType&&e.pointerType!=2) return false;
if (self.rail.drag&&(self.rail.drag.pt==2)) {
if (cap.cantouch&&(typeof e.original == "undefined")) return true;  // prevent ios "ghost" events by clickable elements
self.hasmoving = true;
if (self.preventclick&&!self.preventclick.click) {
self.preventclick.click = self.preventclick.tg.onclick||false;                
self.preventclick.tg.onclick = self.onpreventclick;
}
var ev = $.extend({"original":e},e);
e = ev;
if (("changedTouches" in e)) {
e.clientX = e.changedTouches[0].clientX;
e.clientY = e.changedTouches[0].clientY;
}                
if (self.forcescreen) {
var le = e;
var e = {"original":(e.original)?e.original:e};
e.clientX = le.screenX;
e.clientY = le.screenY;      
}
var ofx = ofy = 0;
if (moveneedoffset&&!byiframe) {
var wp = self.win.position();
ofx=-wp.left;
ofy=-wp.top;
}                
var fy = e.clientY + ofy;
var my = (fy-self.rail.drag.y);
var fx = e.clientX + ofx;
var mx = (fx-self.rail.drag.x);
var ny = self.rail.drag.st-my;
if (self.ishwscroll&&self.opt.bouncescroll) {
if (ny<0) {
ny = Math.round(ny/2);
}
else if (ny>self.page.maxh) {
ny = self.page.maxh+Math.round((ny-self.page.maxh)/2);
}
} else {
if (ny<0) {ny=0;fy=0}
if (ny>self.page.maxh) {ny=self.page.maxh;fy=0}
}
if (self.railh&&self.railh.scrollable) {
var nx = self.rail.drag.sl-mx;; //(self.isrtlmode) ? mx-self.rail.drag.sl : self.rail.drag.sl-mx;
if (self.ishwscroll&&self.opt.bouncescroll) {                  
if (nx<0) {
nx = Math.round(nx/2);
}
else if (nx>self.page.maxw) {
nx = self.page.maxw+Math.round((nx-self.page.maxw)/2);
}
} else {
if (nx<0) {nx=0;fx=0}
if (nx>self.page.maxw) {nx=self.page.maxw;fx=0}
}
}
var grabbed = false;
if (self.rail.drag.dl) {
grabbed = true;
if (self.rail.drag.dl=="v") nx = self.rail.drag.sl;
else if (self.rail.drag.dl=="h") ny = self.rail.drag.st;                  
} else {
var ay = Math.abs(my);
var ax = Math.abs(mx);
var dz = self.opt.directionlockdeadzone;
if (self.rail.drag.ck=="v") {    
if (ay>dz&&(ax<=(ay*0.3))) {
self.rail.drag = false;                      
return true;
}
else if (ax>dz) {
self.rail.drag.dl="f";                      
$("body").scrollTop($("body").scrollTop());  // stop iOS native scrolling (when active javascript has blocked)
}
}
else if (self.rail.drag.ck=="h") {
if (ax>dz&&(ay<=(ax*0.3))) {
self.rail.drag = false;                      
return true;
}
else if (ay>dz) {                      
self.rail.drag.dl="f";
$("body").scrollLeft($("body").scrollLeft());  // stop iOS native scrolling (when active javascript has blocked)
}
}  
}
self.synched("touchmove",function(){
if (self.rail.drag&&(self.rail.drag.pt==2)) {
if (self.prepareTransition) self.prepareTransition(0);
if (self.rail.scrollable) self.setScrollTop(ny);
self.scrollmom.update(fx,fy);
if (self.railh&&self.railh.scrollable) {
self.setScrollLeft(nx);
self.showCursor(ny,nx);
} else {
self.showCursor(ny);
}
if (cap.isie10) document.selection.clear();
}
});
if (cap.ischrome&&self.istouchcapable) grabbed=false;  //chrome touch emulation doesn't like!
if (grabbed) return self.cancelEvent(e);
}
};
}
self.onmousedown = function(e,hronly) {    
if (self.rail.drag&&self.rail.drag.pt!=1) return;
if (self.locked) return self.cancelEvent(e);            
self.cancelScroll();              
self.rail.drag = {x:e.clientX,y:e.clientY,sx:self.scroll.x,sy:self.scroll.y,pt:1,hr:(!!hronly)};
var tg = self.getTarget(e);
if (!self.ispage&&cap.hasmousecapture) tg.setCapture();
if (self.isiframe&&!cap.hasmousecapture) {
self.saved["csspointerevents"] = self.doc.css("pointer-events");
self.css(self.doc,{"pointer-events":"none"});
}
self.hasmoving=false;
return self.cancelEvent(e);
};
self.onmouseup = function(e) {
if (self.rail.drag) {
if (cap.hasmousecapture) document.releaseCapture();
if (self.isiframe&&!cap.hasmousecapture) self.doc.css("pointer-events",self.saved["csspointerevents"]);
if(self.rail.drag.pt!=1)return;
self.rail.drag = false;
if (self.hasmoving) self.triggerScrollEnd();  // TODO - check &&!self.scrollrunning
return self.cancelEvent(e);
}
};        
self.onmousemove = function(e) {
if (self.rail.drag) {
if(self.rail.drag.pt!=1)return;
if (cap.ischrome&&e.which==0) return self.onmouseup(e);
self.cursorfreezed = true;
self.hasmoving = true;
if (self.rail.drag.hr) {
self.scroll.x = self.rail.drag.sx + (e.clientX-self.rail.drag.x);
if (self.scroll.x<0) self.scroll.x=0;
var mw = self.scrollvaluemaxw;
if (self.scroll.x>mw) self.scroll.x=mw;
} else {                
self.scroll.y = self.rail.drag.sy + (e.clientY-self.rail.drag.y);
if (self.scroll.y<0) self.scroll.y=0;
var my = self.scrollvaluemax;
if (self.scroll.y>my) self.scroll.y=my;
}
self.synched('mousemove',function(){
if (self.rail.drag&&(self.rail.drag.pt==1)) {
self.showCursor();
if (self.rail.drag.hr) self.doScrollLeft(Math.round(self.scroll.x*self.scrollratio.x),self.opt.cursordragspeed);
else self.doScrollTop(Math.round(self.scroll.y*self.scrollratio.y),self.opt.cursordragspeed);
}
});
return self.cancelEvent(e);
} 
/*              
else {
self.checkarea = true;
}
*/              
};          
if (cap.cantouch||self.opt.touchbehavior) {
self.onpreventclick = function(e) {
if (self.preventclick) {
self.preventclick.tg.onclick = self.preventclick.click;
self.preventclick = false;            
return self.cancelEvent(e);
}
}
self.bind(self.win,"mousedown",self.ontouchstart);  // control content dragging
self.onclick = (cap.isios) ? false : function(e) { 
if (self.lastmouseup) {
self.lastmouseup = false;
return self.cancelEvent(e);
} else {
return true;
}
}; 
if (self.opt.grabcursorenabled&&cap.cursorgrabvalue) {
self.css((self.ispage)?self.doc:self.win,{'cursor':cap.cursorgrabvalue});            
self.css(self.rail,{'cursor':cap.cursorgrabvalue});
}
} else {
function checkSelectionScroll(e) {
if (!self.selectiondrag) return;
if (e) {
var ww = self.win.outerHeight();
var df = (e.pageY - self.selectiondrag.top);
if (df>0&&df<ww) df=0;
if (df>=ww) df-=ww;
self.selectiondrag.df = df;                
}
if (self.selectiondrag.df==0) return;
var rt = -Math.floor(self.selectiondrag.df/6)*2;              
self.doScrollBy(rt);
self.debounced("doselectionscroll",function(){checkSelectionScroll()},50);
};
if ("getSelection" in document) {  // A grade - Major browsers
self.hasTextSelected = function() {  
return (document.getSelection().rangeCount>0);
};
} 
else if ("selection" in document) {  //IE9-
self.hasTextSelected = function() {
return (document.selection.type != "None");
};
} 
else {
self.hasTextSelected = function() {  // no support
return false;
};
}            
self.onselectionstart = function(e) {
if (self.ispage) return;
self.selectiondrag = self.win.offset();
};
self.onselectionend = function(e) {
self.selectiondrag = false;
};
self.onselectiondrag = function(e) {              
if (!self.selectiondrag) return;
if (self.hasTextSelected()) self.debounced("selectionscroll",function(){checkSelectionScroll(e)},250);
};
}
if (cap.hasmstouch) {
self.css(self.rail,{'-ms-touch-action':'none'});
self.css(self.cursor,{'-ms-touch-action':'none'});
self.bind(self.win,"MSPointerDown",self.ontouchstart);
self.bind(document,"MSPointerUp",self.ontouchend);
self.bind(document,"MSPointerMove",self.ontouchmove);
self.bind(self.cursor,"MSGestureHold",function(e){e.preventDefault()});
self.bind(self.cursor,"contextmenu",function(e){e.preventDefault()});
}
if (this.istouchcapable) {  //desktop with screen touch enabled
self.bind(self.win,"touchstart",self.ontouchstart);
self.bind(document,"touchend",self.ontouchend);
self.bind(document,"touchcancel",self.ontouchend);
self.bind(document,"touchmove",self.ontouchmove);            
}
self.bind(self.cursor,"mousedown",self.onmousedown);
self.bind(self.cursor,"mouseup",self.onmouseup);
if (self.railh) {
self.bind(self.cursorh,"mousedown",function(e){self.onmousedown(e,true)});
self.bind(self.cursorh,"mouseup",self.onmouseup);
/*            
self.bind(self.cursorh,"mouseup",function(e){
if (self.rail.drag&&self.rail.drag.pt==2) return;
self.rail.drag = false;
self.hasmoving = false;
self.hideCursor();
if (cap.hasmousecapture) document.releaseCapture();
return self.cancelEvent(e);
});
*/
}
if (self.opt.cursordragontouch||!cap.cantouch&&!self.opt.touchbehavior) {
self.rail.css({"cursor":"default"});
self.railh&&self.railh.css({"cursor":"default"});          
self.jqbind(self.rail,"mouseenter",function() {
if (!self.win.is(":visible")) return false;
if (self.canshowonmouseevent) self.showCursor();
self.rail.active = true;
});
self.jqbind(self.rail,"mouseleave",function() { 
self.rail.active = false;
if (!self.rail.drag) self.hideCursor();
});
if (self.opt.sensitiverail) {
self.bind(self.rail,"click",function(e){self.doRailClick(e,false,false)});
self.bind(self.rail,"dblclick",function(e){self.doRailClick(e,true,false)});
self.bind(self.cursor,"click",function(e){self.cancelEvent(e)});
self.bind(self.cursor,"dblclick",function(e){self.cancelEvent(e)});
}
if (self.railh) {
self.jqbind(self.railh,"mouseenter",function() {
if (!self.win.is(":visible")) return false;
if (self.canshowonmouseevent) self.showCursor();
self.rail.active = true;
});          
self.jqbind(self.railh,"mouseleave",function() { 
self.rail.active = false;
if (!self.rail.drag) self.hideCursor();
});
if (self.opt.sensitiverail) {
self.bind(self.railh, "click", function(e){self.doRailClick(e,false,true)});
self.bind(self.railh, "dblclick", function(e){self.doRailClick(e, true, true) });
self.bind(self.cursorh, "click", function (e) { self.cancelEvent(e) });
self.bind(self.cursorh, "dblclick", function (e) { self.cancelEvent(e) });
}
}
}
if (!cap.cantouch&&!self.opt.touchbehavior) {
self.bind((cap.hasmousecapture)?self.win:document,"mouseup",self.onmouseup);            
self.bind(document,"mousemove",self.onmousemove);
if (self.onclick) self.bind(document,"click",self.onclick);
if (!self.ispage&&self.opt.enablescrollonselection) {
self.bind(self.win[0],"mousedown",self.onselectionstart);
self.bind(document,"mouseup",self.onselectionend);
self.bind(self.cursor,"mouseup",self.onselectionend);
if (self.cursorh) self.bind(self.cursorh,"mouseup",self.onselectionend);
self.bind(document,"mousemove",self.onselectiondrag);
}
if (self.zoom) {
self.jqbind(self.zoom,"mouseenter",function() {
if (self.canshowonmouseevent) self.showCursor();
self.rail.active = true;
});          
self.jqbind(self.zoom,"mouseleave",function() { 
self.rail.active = false;
if (!self.rail.drag) self.hideCursor();
});
}
} else {
self.bind((cap.hasmousecapture)?self.win:document,"mouseup",self.ontouchend);
self.bind(document,"mousemove",self.ontouchmove);
if (self.onclick) self.bind(document,"click",self.onclick);
if (self.opt.cursordragontouch) {
self.bind(self.cursor,"mousedown",self.onmousedown);
self.bind(self.cursor,"mousemove",self.onmousemove);
self.cursorh&&self.bind(self.cursorh,"mousedown",function(e){self.onmousedown(e,true)});
self.cursorh&&self.bind(self.cursorh,"mousemove",self.onmousemove);
}
}
if (self.opt.enablemousewheel) {
if (!self.isiframe) self.bind((cap.isie&&self.ispage) ? document : self.win /*self.docscroll*/ ,"mousewheel",self.onmousewheel);
self.bind(self.rail,"mousewheel",self.onmousewheel);
if (self.railh) self.bind(self.railh,"mousewheel",self.onmousewheelhr);
}           
if (!self.ispage&&!cap.cantouch&&!(/HTML|^BODY/.test(self.win[0].nodeName))) {
if (!self.win.attr("tabindex")) self.win.attr({"tabindex":tabindexcounter++});
self.jqbind(self.win,"focus",function(e) {
domfocus = (self.getTarget(e)).id||true;
self.hasfocus = true;
if (self.canshowonmouseevent) self.noticeCursor();
});
self.jqbind(self.win,"blur",function(e) {
domfocus = false;
self.hasfocus = false;
});
self.jqbind(self.win,"mouseenter",function(e) {
mousefocus = (self.getTarget(e)).id||true;
self.hasmousefocus = true;
if (self.canshowonmouseevent) self.noticeCursor();
});
self.jqbind(self.win,"mouseleave",function() {
mousefocus = false;
self.hasmousefocus = false;
if (!self.rail.drag) self.hideCursor();
});
};
}  // !ie9mobile
self.onkeypress = function(e) {
if (self.locked&&self.page.maxh==0) return true;
e = (e) ? e : window.e;
var tg = self.getTarget(e);
if (tg&&/INPUT|TEXTAREA|SELECT|OPTION/.test(tg.nodeName)) {
var tp = tg.getAttribute('type')||tg.type||false;            
if ((!tp)||!(/submit|button|cancel/i.tp)) return true;
}
if ($(tg).attr('contenteditable')) return true;
if (self.hasfocus||(self.hasmousefocus&&!domfocus)||(self.ispage&&!domfocus&&!mousefocus)) {
var key = e.keyCode;
if (self.locked&&key!=27) return self.cancelEvent(e);
var ctrl = e.ctrlKey||false;
var shift = e.shiftKey || false;
var ret = false;
switch (key) {
case 38:
case 63233: //safari
self.doScrollBy(24*3);
ret = true;
break;
case 40:
case 63235: //safari
self.doScrollBy(-24*3);
ret = true;
break;
case 37:
case 63232: //safari
if (self.railh) {
(ctrl) ? self.doScrollLeft(0) : self.doScrollLeftBy(24*3);
ret = true;
}
break;
case 39:
case 63234: //safari
if (self.railh) {
(ctrl) ? self.doScrollLeft(self.page.maxw) : self.doScrollLeftBy(-24*3);
ret = true;
}
break;
case 33:
case 63276: // safari
self.doScrollBy(self.view.h);
ret = true;
break;
case 34:
case 63277: // safari
self.doScrollBy(-self.view.h);
ret = true;
break;
case 36:
case 63273: // safari                
(self.railh&&ctrl) ? self.doScrollPos(0,0) : self.doScrollTo(0);
ret = true;
break;
case 35:
case 63275: // safari
(self.railh&&ctrl) ? self.doScrollPos(self.page.maxw,self.page.maxh) : self.doScrollTo(self.page.maxh);
ret = true;
break;
case 32:
if (self.opt.spacebarenabled) {
(shift) ? self.doScrollBy(self.view.h) : self.doScrollBy(-self.view.h);
ret = true;
}
break;
case 27: // ESC
if (self.zoomactive) {
self.doZoom();
ret = true;
}
break;
}
if (ret) return self.cancelEvent(e);
}
};
if (self.opt.enablekeyboard) self.bind(document,(cap.isopera&&!cap.isopera12)?"keypress":"keydown",self.onkeypress);
self.bind(document,"keydown",function(e){
var ctrl = e.ctrlKey||false;
if (ctrl) self.wheelprevented = true;
});
self.bind(document,"keyup",function(e){
var ctrl = e.ctrlKey||false;
if (!ctrl) self.wheelprevented = false;
});
self.bind(window,'resize',self.lazyResize);
self.bind(window,'orientationchange',self.lazyResize);
self.bind(window,"load",self.lazyResize);
if (cap.ischrome&&!self.ispage&&!self.haswrapper) { //chrome void scrollbar bug - it persists in version 26
var tmp=self.win.attr("style");
var ww = parseFloat(self.win.css("width"))+1;
self.win.css('width',ww);
self.synched("chromefix",function(){self.win.attr("style",tmp)});
}
self.onAttributeChange = function(e) {
self.lazyResize(250);
};
if (!self.ispage&&!self.haswrapper) {
if (clsMutationObserver !== false) {
self.observer = new clsMutationObserver(function(mutations) {            
mutations.forEach(self.onAttributeChange);
});
self.observer.observe(self.win[0],{childList: true, characterData: false, attributes: true, subtree: false});
self.observerremover = new clsMutationObserver(function(mutations) {
mutations.forEach(function(mo){
if (mo.removedNodes.length>0) {
for (var dd in mo.removedNodes) {
if (mo.removedNodes[dd]==self.win[0]) return self.remove();
}
}
});
});
self.observerremover.observe(self.win[0].parentNode,{childList: true, characterData: false, attributes: false, subtree: false});
} else {        
self.bind(self.win,(cap.isie&&!cap.isie9)?"propertychange":"DOMAttrModified",self.onAttributeChange);            
if (cap.isie9) self.win[0].attachEvent("onpropertychange",self.onAttributeChange); //IE9 DOMAttrModified bug
self.bind(self.win,"DOMNodeRemoved",function(e){
if (e.target==self.win[0]) self.remove();
});
}
}
if (!self.ispage&&self.opt.boxzoom) self.bind(window,"resize",self.resizeZoom);
if (self.istextarea) self.bind(self.win,"mouseup",self.lazyResize);
self.lazyResize(30);
}
if (this.doc[0].nodeName == 'IFRAME') {
function oniframeload(e) {
self.iframexd = false;
try {
var doc = 'contentDocument' in this ? this.contentDocument : this.contentWindow.document;
var a = doc.domain;            
} catch(e){self.iframexd = true;doc=false};
if (self.iframexd) {
if ("console" in window) console.log('NiceScroll error: policy restriced iframe');
return true;  //cross-domain - I can't manage this        
}
self.forcescreen = true;
if (self.isiframe) {            
self.iframe = {
"doc":$(doc),
"html":self.doc.contents().find('html')[0],
"body":self.doc.contents().find('body')[0]
};
self.getContentSize = function(){
return {
w:Math.max(self.iframe.html.scrollWidth,self.iframe.body.scrollWidth),
h:Math.max(self.iframe.html.scrollHeight,self.iframe.body.scrollHeight)
};
};            
self.docscroll = $(self.iframe.body);//$(this.contentWindow);
}
if (!cap.isios&&self.opt.iframeautoresize&&!self.isiframe) {
self.win.scrollTop(0); // reset position
self.doc.height("");  //reset height to fix browser bug
var hh=Math.max(doc.getElementsByTagName('html')[0].scrollHeight,doc.body.scrollHeight);
self.doc.height(hh);          
}
self.lazyResize(30);
if (cap.isie7) self.css($(self.iframe.html),{'overflow-y':'hidden'});
self.css($(self.iframe.body),{'overflow-y':'hidden'});
if (cap.isios&&self.haswrapper) {
self.css($(doc.body),{'-webkit-transform':'translate3d(0,0,0)'});  // avoid iFrame content clipping - thanks to http://blog.derraab.com/2012/04/02/avoid-iframe-content-clipping-with-css-transform-on-ios/
}
if ('contentWindow' in this) {
self.bind(this.contentWindow,"scroll",self.onscroll);  //IE8 & minor
} else {          
self.bind(doc,"scroll",self.onscroll);
}                    
if (self.opt.enablemousewheel) {
self.bind(doc,"mousewheel",self.onmousewheel);
}
if (self.opt.enablekeyboard) self.bind(doc,(cap.isopera)?"keypress":"keydown",self.onkeypress);
if (cap.cantouch||self.opt.touchbehavior) {
self.bind(doc,"mousedown",self.ontouchstart);
self.bind(doc,"mousemove",function(e){self.ontouchmove(e,true)});
if (self.opt.grabcursorenabled&&cap.cursorgrabvalue) self.css($(doc.body),{'cursor':cap.cursorgrabvalue});
}
self.bind(doc,"mouseup",self.ontouchend);
if (self.zoom) {
if (self.opt.dblclickzoom) self.bind(doc,'dblclick',self.doZoom);
if (self.ongesturezoom) self.bind(doc,"gestureend",self.ongesturezoom);             
}
};
if (this.doc[0].readyState&&this.doc[0].readyState=="complete"){
setTimeout(function(){oniframeload.call(self.doc[0],false)},500);
}
self.bind(this.doc,"load",oniframeload);
}
};
this.showCursor = function(py,px) {
if (self.cursortimeout) {
clearTimeout(self.cursortimeout);
self.cursortimeout = 0;
}
if (!self.rail) return;
if (self.autohidedom) {
self.autohidedom.stop().css({opacity:self.opt.cursoropacitymax});
self.cursoractive = true;
}
if (!self.rail.drag||self.rail.drag.pt!=1) {      
if ((typeof py != "undefined")&&(py!==false)) {
self.scroll.y = Math.round(py * 1/self.scrollratio.y);
}
if (typeof px != "undefined") {
self.scroll.x = Math.round(px * 1/self.scrollratio.x);  //-cxscrollleft * Math.round(px * 1/self.scrollratio.x);
}
}
self.cursor.css({height:self.cursorheight,top:self.scroll.y}); 
if (self.cursorh) {
(!self.rail.align&&self.rail.visibility) ? self.cursorh.css({width:self.cursorwidth,left:self.scroll.x+self.rail.width}) : self.cursorh.css({width:self.cursorwidth,left:self.scroll.x});
self.cursoractive = true;
}
if (self.zoom) self.zoom.stop().css({opacity:self.opt.cursoropacitymax});      
};
this.hideCursor = function(tm) {
if (self.cursortimeout) return;
if (!self.rail) return;
if (!self.autohidedom) return;
if (self.hasmousefocus&&self.opt.autohidemode=="leave") return;
self.cursortimeout = setTimeout(function() {
if (!self.rail.active||!self.showonmouseevent) {          
self.autohidedom.stop().animate({opacity:self.opt.cursoropacitymin});
if (self.zoom) self.zoom.stop().animate({opacity:self.opt.cursoropacitymin});
self.cursoractive = false;
}
self.cursortimeout = 0;
},tm||self.opt.hidecursordelay);
};
this.noticeCursor = function(tm,py,px) {
self.showCursor(py,px);
if (!self.rail.active) self.hideCursor(tm);
};
this.getContentSize = 
(self.ispage) ?
function(){
return {
w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),
h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)
}
}
: (self.haswrapper) ?
function(){
return {
w:self.doc.outerWidth()+parseInt(self.win.css('paddingLeft'))+parseInt(self.win.css('paddingRight')),
h:self.doc.outerHeight()+parseInt(self.win.css('paddingTop'))+parseInt(self.win.css('paddingBottom'))
}
}
: function() {        
return {
w:self.docscroll[0].scrollWidth,
h:self.docscroll[0].scrollHeight
}
};
this.onResize = function(e,page) {
if (!self||!self.win) return false;
if (!self.haswrapper&&!self.ispage) {
if (self.win.css('display')=='none') {
if (self.visibility) self.hideRail().hideRailHr();
return false;
} else {          
if (!self.hidden&&!self.visibility) self.showRail().showRailHr();
}        
}
var premaxh = self.page.maxh;
var premaxw = self.page.maxw;
var preview = {h:self.view.h,w:self.view.w};   
self.view = {
w:(self.ispage) ? self.win.width() : parseInt(self.win[0].clientWidth),
h:(self.ispage) ? self.win.height() : parseInt(self.win[0].clientHeight)
};
self.page = (page) ? page : self.getContentSize();
self.page.maxh = Math.max(0,self.page.h - self.view.h);
self.page.maxw = Math.max(0,self.page.w - self.view.w);
if ((self.page.maxh==premaxh)&&(self.page.maxw==premaxw)&&(self.view.w==preview.w)) {
if (!self.ispage) {
var pos = self.win.offset();
if (self.lastposition) {
var lst = self.lastposition;
if ((lst.top==pos.top)&&(lst.left==pos.left)) return self; //nothing to do            
}
self.lastposition = pos;
} else {
return self; //nothing to do
}
}
if (self.page.maxh==0) {
self.hideRail();        
self.scrollvaluemax = 0;
self.scroll.y = 0;
self.scrollratio.y = 0;
self.cursorheight = 0;
self.setScrollTop(0);
self.rail.scrollable = false;
} else {       
self.rail.scrollable = true;
}
if (self.page.maxw==0) {
self.hideRailHr();
self.scrollvaluemaxw = 0;
self.scroll.x = 0;
self.scrollratio.x = 0;
self.cursorwidth = 0;
self.setScrollLeft(0);
self.railh.scrollable = false;
} else {        
self.railh.scrollable = true;
}
self.locked = (self.page.maxh==0)&&(self.page.maxw==0);
if (self.locked) {
if (!self.ispage) self.updateScrollBar(self.view);
return false;
}
if (!self.hidden&&!self.visibility) {
self.showRail().showRailHr();
}      
else if (!self.hidden&&!self.railh.visibility) self.showRailHr();
if (self.istextarea&&self.win.css('resize')&&self.win.css('resize')!='none') self.view.h-=20;      
self.cursorheight = Math.min(self.view.h,Math.round(self.view.h * (self.view.h / self.page.h)));
self.cursorheight = (self.opt.cursorfixedheight) ? self.opt.cursorfixedheight : Math.max(self.opt.cursorminheight,self.cursorheight);
self.cursorwidth = Math.min(self.view.w,Math.round(self.view.w * (self.view.w / self.page.w)));
self.cursorwidth = (self.opt.cursorfixedheight) ? self.opt.cursorfixedheight : Math.max(self.opt.cursorminheight,self.cursorwidth-self.opt.railhpadding['left']-self.opt.railhpadding['right']);
self.scrollvaluemax = self.view.h-self.cursorheight-self.cursor.hborder-self.opt.railpadding['top']-self.opt.railpadding['bottom']-self.opt.railmargin['top']-self.opt.railmargin['bottom'];
if (self.railh) {
self.railh.width = (self.page.maxh>0) ? (self.view.w-self.rail.width) : self.view.w;
self.scrollvaluemaxw = self.railh.width-self.cursorwidth-self.cursorh.wborder-self.opt.railhpadding['left']-self.opt.railhpadding['right']-self.opt.railhmargin['left']-self.opt.railhmargin['right'];
}
/*      
if (self.checkrtlmode&&self.railh) {
self.checkrtlmode = false;
if (self.opt.rtlmode&&self.scroll.x==0) self.setScrollLeft(self.page.maxw);
}
*/      
if (!self.ispage) self.updateScrollBar(self.view);
self.scrollratio = {
x:(self.page.maxw/self.scrollvaluemaxw),
y:(self.page.maxh/self.scrollvaluemax)
};
var sy = self.getScrollTop();
if (sy>Math.abs(self.page.maxh)) {
self.doScrollTop(self.page.maxh);
} else {     
self.scroll.y = Math.round(self.getScrollTop() * (1/self.scrollratio.y));
self.scroll.x = Math.round(self.getScrollLeft() * (1/self.scrollratio.x));
if (self.cursoractive) self.noticeCursor();     
}      
if (self.scroll.y&&(self.getScrollTop()==0)) self.doScrollTo(Math.floor(self.scroll.y*self.scrollratio.y));
return self;
};
this.resize = self.onResize;
this.lazyResize = function(tm) {   // event debounce
tm = (isNaN(tm)) ? 30 : tm;
self.delayed('resize',self.resize,tm);
return self;
};
function _modernWheelEvent(dom,name,fn,bubble) {      
self._bind(dom,name,function(e){
var  e = (e) ? e : window.event;
var event = {
original: e,
target: e.target || e.srcElement,
type: "wheel",
deltaMode: e.type == "MozMousePixelScroll" ? 0 : 1,
deltaX: 0,
deltaZ: 0,
preventDefault: function() {
e.preventDefault ? e.preventDefault() : e.returnValue = false;
return false;
},
stopImmediatePropagation: function() {
(e.stopImmediatePropagation) ? e.stopImmediatePropagation() : e.cancelBubble = true;
}
};
if (name=="mousewheel") {
event.deltaY = - 1/40 * e.wheelDelta;
e.wheelDeltaX && (event.deltaX = - 1/40 * e.wheelDeltaX);
} else {
event.deltaY = e.detail;
}
return fn.call(dom,event);      
},bubble);
};     
this._bind = function(el,name,fn,bubble) {  // primitive bind
self.events.push({e:el,n:name,f:fn,b:bubble,q:false});
if (el.addEventListener) {
el.addEventListener(name,fn,bubble||false);
}
else if (el.attachEvent) {
el.attachEvent("on"+name,fn);
}
else {
el["on"+name] = fn;        
}        
};
this.jqbind = function(dom,name,fn) {  // use jquery bind for non-native events (mouseenter/mouseleave)
self.events.push({e:dom,n:name,f:fn,q:true});
$(dom).bind(name,fn);
};
this.bind = function(dom,name,fn,bubble) {  // touch-oriented & fixing jquery bind
var el = ("jquery" in dom) ? dom[0] : dom;
if (name=='mousewheel') {
if ("onwheel" in self.win) {            
self._bind(el,"wheel",fn,bubble||false);
} else {            
var wname = (typeof document.onmousewheel != "undefined") ? "mousewheel" : "DOMMouseScroll";  // older IE/Firefox
_modernWheelEvent(el,wname,fn,bubble||false);
if (wname=="DOMMouseScroll") _modernWheelEvent(el,"MozMousePixelScroll",fn,bubble||false);  // Firefox legacy
}
} 
else if (el.addEventListener) {
if (cap.cantouch && /mouseup|mousedown|mousemove/.test(name)) {  // touch device support
var tt=(name=='mousedown')?'touchstart':(name=='mouseup')?'touchend':'touchmove';
self._bind(el,tt,function(e){
if (e.touches) {
if (e.touches.length<2) {var ev=(e.touches.length)?e.touches[0]:e;ev.original=e;fn.call(this,ev);}
} 
else if (e.changedTouches) {var ev=e.changedTouches[0];ev.original=e;fn.call(this,ev);}  //blackberry
},bubble||false);
}
self._bind(el,name,fn,bubble||false);
if (cap.cantouch && name=="mouseup") self._bind(el,"touchcancel",fn,bubble||false);
}
else {
self._bind(el,name,function(e) {
e = e||window.event||false;
if (e) {
if (e.srcElement) e.target=e.srcElement;
}
if (!("pageY" in e)) {
e.pageX = e.clientX + document.documentElement.scrollLeft;
e.pageY = e.clientY + document.documentElement.scrollTop; 
}
return ((fn.call(el,e)===false)||bubble===false) ? self.cancelEvent(e) : true;
});
} 
};
this._unbind = function(el,name,fn,bub) {  // primitive unbind
if (el.removeEventListener) {
el.removeEventListener(name,fn,bub);
}
else if (el.detachEvent) {
el.detachEvent('on'+name,fn);
} else {
el['on'+name] = false;
}
};
this.unbindAll = function() {
for(var a=0;a<self.events.length;a++) {
var r = self.events[a];        
(r.q) ? r.e.unbind(r.n,r.f) : self._unbind(r.e,r.n,r.f,r.b);
}
};
this.cancelEvent = function(e) {
var e = (e.original) ? e.original : (e) ? e : window.event||false;
if (!e) return false;      
if(e.preventDefault) e.preventDefault();
if(e.stopPropagation) e.stopPropagation();
if(e.preventManipulation) e.preventManipulation();  //IE10
e.cancelBubble = true;
e.cancel = true;
e.returnValue = false;
return false;
};
this.stopPropagation = function(e) {
var e = (e.original) ? e.original : (e) ? e : window.event||false;
if (!e) return false;
if (e.stopPropagation) return e.stopPropagation();
if (e.cancelBubble) e.cancelBubble=true;
return false;
};
this.showRail = function() {
if ((self.page.maxh!=0)&&(self.ispage||self.win.css('display')!='none')) {
self.visibility = true;
self.rail.visibility = true;
self.rail.css('display','block');
}
return self;
};
this.showRailHr = function() {
if (!self.railh) return self;
if ((self.page.maxw!=0)&&(self.ispage||self.win.css('display')!='none')) {
self.railh.visibility = true;
self.railh.css('display','block');
}
return self;
};
this.hideRail = function() {
self.visibility = false;
self.rail.visibility = false;
self.rail.css('display','none');
return self;
};
this.hideRailHr = function() {
if (!self.railh) return self;
self.railh.visibility = false;
self.railh.css('display','none');
return self;
};
this.show = function() {
self.hidden = false;
self.locked = false;
return self.showRail().showRailHr();
};
this.hide = function() {
self.hidden = true;
self.locked = true;
return self.hideRail().hideRailHr();
};
this.toggle = function() {
return (self.hidden) ? self.show() : self.hide();
};
this.remove = function() {
self.stop();
if (self.cursortimeout) clearTimeout(self.cursortimeout);
self.doZoomOut();
self.unbindAll();     
if (cap.isie9) self.win[0].detachEvent("onpropertychange",self.onAttributeChange); //IE9 DOMAttrModified bug
if (self.observer !== false) self.observer.disconnect();
if (self.observerremover !== false) self.observerremover.disconnect();      
self.events = null;
if (self.cursor) {
self.cursor.remove();
}
if (self.cursorh) {
self.cursorh.remove();
}
if (self.rail) {
self.rail.remove();
}
if (self.railh) {
self.railh.remove();
}
if (self.zoom) {
self.zoom.remove();
}
for(var a=0;a<self.saved.css.length;a++) {
var d=self.saved.css[a];
d[0].css(d[1],(typeof d[2]=="undefined") ? '' : d[2]);
}
self.saved = false;      
self.me.data('__nicescroll',''); //erase all traces
var lst = $.nicescroll;
lst.each(function(i){
if (!this) return;
if(this.id === self.id) {
delete lst[i];          
for(var b=++i;b<lst.length;b++,i++) lst[i]=lst[b];
lst.length--;
if (lst.length) delete lst[lst.length];
}
});      
for (var i in self) {
self[i] = null;
delete self[i];
}
self = null;
};
this.scrollstart = function(fn) {
this.onscrollstart = fn;
return self;
};
this.scrollend = function(fn) {
this.onscrollend = fn;
return self;
};
this.scrollcancel = function(fn) {
this.onscrollcancel = fn;
return self;
};
this.zoomin = function(fn) {
this.onzoomin = fn;
return self;
};
this.zoomout = function(fn) {
this.onzoomout = fn;
return self;
};
this.isScrollable = function(e) {      
var dom = (e.target) ? e.target : e;
if (dom.nodeName == 'OPTION') return true;
while (dom&&(dom.nodeType==1)&&!(/^BODY|HTML/.test(dom.nodeName))) {
var dd = $(dom);
var ov = dd.css('overflowY')||dd.css('overflowX')||dd.css('overflow')||'';
if (/scroll|auto/.test(ov)) return (dom.clientHeight!=dom.scrollHeight);
dom = (dom.parentNode) ? dom.parentNode : false;        
}
return false;
};
this.getViewport = function(me) {      
var dom = (me&&me.parentNode) ? me.parentNode : false;
while (dom&&(dom.nodeType==1)&&!(/^BODY|HTML/.test(dom.nodeName))) {
var dd = $(dom);
if (/fixed|absolute/.test(dd.css("position"))) return dd;        
var ov = dd.css('overflowY')||dd.css('overflowX')||dd.css('overflow')||'';
if ((/scroll|auto/.test(ov))&&(dom.clientHeight!=dom.scrollHeight)) return dd;
if (dd.getNiceScroll().length>0) return dd;
dom = (dom.parentNode) ? dom.parentNode : false;
}
return (dom) ? $(dom) : false;
};
this.triggerScrollEnd = function() {
if (!self.onscrollend) return;
var px = self.getScrollLeft();
var py = self.getScrollTop();
var info = {"type":"scrollend","current":{"x":px,"y":py},"end":{"x":px,"y":py}};
self.onscrollend.call(self,info);   
}
function execScrollWheel(e,hr,chkscroll) {
var px,py;
var rt = 1;
if (e.deltaMode==0) {  // PIXEL
px = -Math.floor(e.deltaX*(self.opt.mousescrollstep/(18*3)));
py = -Math.floor(e.deltaY*(self.opt.mousescrollstep/(18*3)));
}
else if (e.deltaMode==1) {  // LINE
px = -Math.floor(e.deltaX*self.opt.mousescrollstep);
py = -Math.floor(e.deltaY*self.opt.mousescrollstep);
}
if (hr&&self.opt.oneaxismousemode&&(px==0)&&py) {  // classic vertical-only mousewheel + browser with x/y support 
px = py;
py = 0;
}
if (px) {
if (self.scrollmom) {self.scrollmom.stop()}
self.lastdeltax+=px;
self.debounced("mousewheelx",function(){var dt=self.lastdeltax;self.lastdeltax=0;if(!self.rail.drag){self.doScrollLeftBy(dt)}},15);
}
if (py) {
if (self.opt.nativeparentscrolling&&chkscroll&&!self.ispage&&!self.zoomactive) {
if (py<0) {
if (self.getScrollTop()>=self.page.maxh) return true;
} else {
if (self.getScrollTop()<=0) return true;
}
}
if (self.scrollmom) {self.scrollmom.stop()}
self.lastdeltay+=py;
self.debounced("mousewheely",function(){var dt=self.lastdeltay;self.lastdeltay=0;if(!self.rail.drag){self.doScrollBy(dt)}},15);
}
e.stopImmediatePropagation();
return e.preventDefault();
};
this.onmousewheel = function(e) {          
if (self.wheelprevented) return;
if (self.locked) {
self.debounced("checkunlock",self.resize,250);
return true;
}
if (self.rail.drag) return self.cancelEvent(e);
if (self.opt.oneaxismousemode=="auto"&&e.deltaX!=0) self.opt.oneaxismousemode = false;  // check two-axis mouse support (not very elegant)
if (self.opt.oneaxismousemode&&e.deltaX==0) {
if (!self.rail.scrollable) {
if (self.railh&&self.railh.scrollable) {
return self.onmousewheelhr(e);
} else {          
return true;
}
}
}
var nw = +(new Date());
var chk = false;
if (self.opt.preservenativescrolling&&((self.checkarea+600)<nw)) {
self.nativescrollingarea = self.isScrollable(e);
chk = true;
}
self.checkarea = nw;
if (self.nativescrollingarea) return true; // this isn't my business
var ret = execScrollWheel(e,false,chk);
if (ret) self.checkarea = 0;
return ret;
};
this.onmousewheelhr = function(e) {
if (self.wheelprevented) return;
if (self.locked||!self.railh.scrollable) return true;
if (self.rail.drag) return self.cancelEvent(e);
var nw = +(new Date());
var chk = false;
if (self.opt.preservenativescrolling&&((self.checkarea+600)<nw)) {
self.nativescrollingarea = self.isScrollable(e); 
chk = true;
}
self.checkarea = nw;
if (self.nativescrollingarea) return true; // this isn't my business
if (self.locked) return self.cancelEvent(e);
return execScrollWheel(e,true,chk);
};
this.stop = function() {
self.cancelScroll();
if (self.scrollmon) self.scrollmon.stop();
self.cursorfreezed = false;
self.scroll.y = Math.round(self.getScrollTop() * (1/self.scrollratio.y));      
self.noticeCursor();
return self;
};
this.getTransitionSpeed = function(dif) {
var sp = Math.round(self.opt.scrollspeed*10);
var ex = Math.min(sp,Math.round((dif / 20) * self.opt.scrollspeed));
return (ex>20) ? ex : 0;
};
if (!self.opt.smoothscroll) {
this.doScrollLeft = function(x,spd) {  //direct
var y = self.getScrollTop();
self.doScrollPos(x,y,spd);
};      
this.doScrollTop = function(y,spd) {   //direct
var x = self.getScrollLeft();
self.doScrollPos(x,y,spd);
};
this.doScrollPos = function(x,y,spd) {  //direct
var nx = (x>self.page.maxw) ? self.page.maxw : x;
if (nx<0) nx=0;
var ny = (y>self.page.maxh) ? self.page.maxh : y;
if (ny<0) ny=0;
self.synched('scroll',function(){
self.setScrollTop(ny);
self.setScrollLeft(nx);
});
};
this.cancelScroll = function() {}; // direct
} 
else if (self.ishwscroll&&cap.hastransition&&self.opt.usetransition) {
this.prepareTransition = function(dif,istime) {
var ex = (istime) ? ((dif>20)?dif:0) : self.getTransitionSpeed(dif);        
var trans = (ex) ? cap.prefixstyle+'transform '+ex+'ms ease-out' : '';
if (!self.lasttransitionstyle||self.lasttransitionstyle!=trans) {
self.lasttransitionstyle = trans;
self.doc.css(cap.transitionstyle,trans);
}
return ex;
};
this.doScrollLeft = function(x,spd) {  //trans
var y = (self.scrollrunning) ? self.newscrolly : self.getScrollTop();
self.doScrollPos(x,y,spd);
};      
this.doScrollTop = function(y,spd) {   //trans
var x = (self.scrollrunning) ? self.newscrollx : self.getScrollLeft();
self.doScrollPos(x,y,spd);
};
this.doScrollPos = function(x,y,spd) {  //trans
var py = self.getScrollTop();
var px = self.getScrollLeft();        
if (((self.newscrolly-py)*(y-py)<0)||((self.newscrollx-px)*(x-px)<0)) self.cancelScroll();  //inverted movement detection      
if (self.opt.bouncescroll==false) {
if (y<0) y=0;
else if (y>self.page.maxh) y=self.page.maxh;
if (x<0) x=0;
else if (x>self.page.maxw) x=self.page.maxw;
}
if (self.scrollrunning&&x==self.newscrollx&&y==self.newscrolly) return false;
self.newscrolly = y;
self.newscrollx = x;
self.newscrollspeed = spd||false;
if (self.timer) return false;
self.timer = setTimeout(function(){
var top = self.getScrollTop();
var lft = self.getScrollLeft();
var dst = {};
dst.x = x-lft;
dst.y = y-top;
dst.px = lft;
dst.py = top;
var dd = Math.round(Math.sqrt(Math.pow(dst.x,2)+Math.pow(dst.y,2)));          
var ms = (self.newscrollspeed && self.newscrollspeed>1) ? self.newscrollspeed : self.getTransitionSpeed(dd);
if (self.newscrollspeed&&self.newscrollspeed<=1) ms*=self.newscrollspeed;
self.prepareTransition(ms,true);
if (self.timerscroll&&self.timerscroll.tm) clearInterval(self.timerscroll.tm);    
if (ms>0) {
if (!self.scrollrunning&&self.onscrollstart) {
var info = {"type":"scrollstart","current":{"x":lft,"y":top},"request":{"x":x,"y":y},"end":{"x":self.newscrollx,"y":self.newscrolly},"speed":ms};
self.onscrollstart.call(self,info);
}
if (cap.transitionend) {
if (!self.scrollendtrapped) {
self.scrollendtrapped = true;
self.bind(self.doc,cap.transitionend,self.onScrollTransitionEnd,false); //I have got to do something usefull!!
}
} else {              
if (self.scrollendtrapped) clearTimeout(self.scrollendtrapped);
self.scrollendtrapped = setTimeout(self.onScrollTransitionEnd,ms);  // simulate transitionend event
}
var py = top;
var px = lft;
self.timerscroll = {
bz: new BezierClass(py,self.newscrolly,ms,0,0,0.58,1),
bh: new BezierClass(px,self.newscrollx,ms,0,0,0.58,1)
};            
if (!self.cursorfreezed) self.timerscroll.tm=setInterval(function(){self.showCursor(self.getScrollTop(),self.getScrollLeft())},60);
}
self.synched("doScroll-set",function(){
self.timer = 0;
if (self.scrollendtrapped) self.scrollrunning = true;
self.setScrollTop(self.newscrolly);
self.setScrollLeft(self.newscrollx);
if (!self.scrollendtrapped) self.onScrollTransitionEnd();
});
},50);
};
this.cancelScroll = function() {
if (!self.scrollendtrapped) return true;        
var py = self.getScrollTop();
var px = self.getScrollLeft();
self.scrollrunning = false;
if (!cap.transitionend) clearTimeout(cap.transitionend);
self.scrollendtrapped = false;
self._unbind(self.doc,cap.transitionend,self.onScrollTransitionEnd);     
self.prepareTransition(0);
self.setScrollTop(py); // fire event onscroll
if (self.railh) self.setScrollLeft(px);
if (self.timerscroll&&self.timerscroll.tm) clearInterval(self.timerscroll.tm);
self.timerscroll = false;
self.cursorfreezed = false;
self.showCursor(py,px);
return self;
};
this.onScrollTransitionEnd = function() {                
if (self.scrollendtrapped) self._unbind(self.doc,cap.transitionend,self.onScrollTransitionEnd);
self.scrollendtrapped = false;        
self.prepareTransition(0);
if (self.timerscroll&&self.timerscroll.tm) clearInterval(self.timerscroll.tm);
self.timerscroll = false;        
var py = self.getScrollTop();
var px = self.getScrollLeft();
self.setScrollTop(py);  // fire event onscroll        
if (self.railh) self.setScrollLeft(px);  // fire event onscroll left
self.noticeCursor(false,py,px);     
self.cursorfreezed = false;
if (py<0) py=0
else if (py>self.page.maxh) py=self.page.maxh;
if (px<0) px=0
else if (px>self.page.maxw) px=self.page.maxw;
if((py!=self.newscrolly)||(px!=self.newscrollx)) return self.doScrollPos(px,py,self.opt.snapbackspeed);
if (self.onscrollend&&self.scrollrunning) {
self.triggerScrollEnd();
} 
self.scrollrunning = false;
};
} else {
this.doScrollLeft = function(x,spd) {  //no-trans
var y = (self.scrollrunning) ? self.newscrolly : self.getScrollTop();
self.doScrollPos(x,y,spd);
};
this.doScrollTop = function(y,spd) {  //no-trans
var x = (self.scrollrunning) ? self.newscrollx : self.getScrollLeft();
self.doScrollPos(x,y,spd);
};
this.doScrollPos = function(x,y,spd) {  //no-trans
var y = ((typeof y == "undefined")||(y===false)) ? self.getScrollTop(true) : y;
if  ((self.timer)&&(self.newscrolly==y)&&(self.newscrollx==x)) return true;
if (self.timer) clearAnimationFrame(self.timer);
self.timer = 0;      
var py = self.getScrollTop();
var px = self.getScrollLeft();
if (((self.newscrolly-py)*(y-py)<0)||((self.newscrollx-px)*(x-px)<0)) self.cancelScroll();  //inverted movement detection
self.newscrolly = y;
self.newscrollx = x;
if (!self.bouncescroll||!self.rail.visibility) {
if (self.newscrolly<0) {
self.newscrolly = 0;
}
else if (self.newscrolly>self.page.maxh) {
self.newscrolly = self.page.maxh;
}
}
if (!self.bouncescroll||!self.railh.visibility) {
if (self.newscrollx<0) {
self.newscrollx = 0;
}
else if (self.newscrollx>self.page.maxw) {
self.newscrollx = self.page.maxw;
}
}
self.dst = {};
self.dst.x = x-px;
self.dst.y = y-py;
self.dst.px = px;
self.dst.py = py;
var dst = Math.round(Math.sqrt(Math.pow(self.dst.x,2)+Math.pow(self.dst.y,2)));
self.dst.ax = self.dst.x / dst;
self.dst.ay = self.dst.y / dst;
var pa = 0;
var pe = dst;
if (self.dst.x==0) {
pa = py;
pe = y;
self.dst.ay = 1;
self.dst.py = 0;
} else if (self.dst.y==0) {
pa = px;
pe = x;
self.dst.ax = 1;
self.dst.px = 0;
}
var ms = self.getTransitionSpeed(dst);
if (spd&&spd<=1) ms*=spd;
if (ms>0) {
self.bzscroll = (self.bzscroll) ? self.bzscroll.update(pe,ms) : new BezierClass(pa,pe,ms,0,1,0,1);
} else {
self.bzscroll = false;
}
if (self.timer) return;
if ((py==self.page.maxh&&y>=self.page.maxh)||(px==self.page.maxw&&x>=self.page.maxw)) self.checkContentSize();
var sync = 1;
function scrolling() {          
if (self.cancelAnimationFrame) return true;
self.scrollrunning = true;
sync = 1-sync;
if (sync) return (self.timer = setAnimationFrame(scrolling)||1);
var done = 0;
var sc = sy = self.getScrollTop();
if (self.dst.ay) {            
sc = (self.bzscroll) ? self.dst.py + (self.bzscroll.getNow()*self.dst.ay) : self.newscrolly;
var dr=sc-sy;          
if ((dr<0&&sc<self.newscrolly)||(dr>0&&sc>self.newscrolly)) sc = self.newscrolly;
self.setScrollTop(sc);
if (sc == self.newscrolly) done=1;
} else {
done=1;
}
var scx = sx = self.getScrollLeft();
if (self.dst.ax) {            
scx = (self.bzscroll) ? self.dst.px + (self.bzscroll.getNow()*self.dst.ax) : self.newscrollx;            
var dr=scx-sx;
if ((dr<0&&scx<self.newscrollx)||(dr>0&&scx>self.newscrollx)) scx = self.newscrollx;
self.setScrollLeft(scx);
if (scx == self.newscrollx) done+=1;
} else {
done+=1;
}
if (done==2) {
self.timer = 0;
self.cursorfreezed = false;
self.bzscroll = false;
self.scrollrunning = false;
if (sc<0) sc=0;
else if (sc>self.page.maxh) sc=self.page.maxh;
if (scx<0) scx=0;
else if (scx>self.page.maxw) scx=self.page.maxw;
if ((scx!=self.newscrollx)||(sc!=self.newscrolly)) self.doScrollPos(scx,sc);
else {
if (self.onscrollend) {
/*              
var info = {"type":"scrollend","current":{"x":sx,"y":sy},"end":{"x":self.newscrollx,"y":self.newscrolly}};
self.onscrollend.call(self,info);
*/
self.triggerScrollEnd();
}             
} 
} else {
self.timer = setAnimationFrame(scrolling)||1;
}
};
self.cancelAnimationFrame=false;
self.timer = 1;
if (self.onscrollstart&&!self.scrollrunning) {
var info = {"type":"scrollstart","current":{"x":px,"y":py},"request":{"x":x,"y":y},"end":{"x":self.newscrollx,"y":self.newscrolly},"speed":ms};
self.onscrollstart.call(self,info);
}        
scrolling();
if ((py==self.page.maxh&&y>=py)||(px==self.page.maxw&&x>=px)) self.checkContentSize();
self.noticeCursor();
};
this.cancelScroll = function() {        
if (self.timer) clearAnimationFrame(self.timer);
self.timer = 0;
self.bzscroll = false;
self.scrollrunning = false;
return self;
};
}
this.doScrollBy = function(stp,relative) {
var ny = 0;
if (relative) {
ny = Math.floor((self.scroll.y-stp)*self.scrollratio.y)
} else {        
var sy = (self.timer) ? self.newscrolly : self.getScrollTop(true);
ny = sy-stp;
}
if (self.bouncescroll) {
var haf = Math.round(self.view.h/2);
if (ny<-haf) ny=-haf
else if (ny>(self.page.maxh+haf)) ny = (self.page.maxh+haf);
}
self.cursorfreezed = false;      
py = self.getScrollTop(true);
if (ny<0&&py<=0) return self.noticeCursor();      
else if (ny>self.page.maxh&&py>=self.page.maxh) {
self.checkContentSize();
return self.noticeCursor();
}
self.doScrollTop(ny);
};
this.doScrollLeftBy = function(stp,relative) {
var nx = 0;
if (relative) {
nx = Math.floor((self.scroll.x-stp)*self.scrollratio.x)
} else {
var sx = (self.timer) ? self.newscrollx : self.getScrollLeft(true);
nx = sx-stp;
}
if (self.bouncescroll) {
var haf = Math.round(self.view.w/2);
if (nx<-haf) nx=-haf;
else if (nx>(self.page.maxw+haf)) nx = (self.page.maxw+haf);
}
self.cursorfreezed = false;    
px = self.getScrollLeft(true);
if (nx<0&&px<=0) return self.noticeCursor();      
else if (nx>self.page.maxw&&px>=self.page.maxw) return self.noticeCursor();
self.doScrollLeft(nx);
};
this.doScrollTo = function(pos,relative) {
var ny = (relative) ? Math.round(pos*self.scrollratio.y) : pos;
if (ny<0) ny=0;
else if (ny>self.page.maxh) ny = self.page.maxh;
self.cursorfreezed = false;
self.doScrollTop(pos);
};
this.checkContentSize = function() {      
var pg = self.getContentSize();
if ((pg.h!=self.page.h)||(pg.w!=self.page.w)) self.resize(false,pg);
};
self.onscroll = function(e) {    
if (self.rail.drag) return;
if (!self.cursorfreezed) {
self.synched('scroll',function(){
self.scroll.y = Math.round(self.getScrollTop() * (1/self.scrollratio.y));
if (self.railh) self.scroll.x = Math.round(self.getScrollLeft() * (1/self.scrollratio.x));
self.noticeCursor();
});
}
};
self.bind(self.docscroll,"scroll",self.onscroll);
this.doZoomIn = function(e) {
if (self.zoomactive) return;
self.zoomactive = true;
self.zoomrestore = {
style:{}
};
var lst = ['position','top','left','zIndex','backgroundColor','marginTop','marginBottom','marginLeft','marginRight'];
var win = self.win[0].style;
for(var a in lst) {
var pp = lst[a];
self.zoomrestore.style[pp] = (typeof win[pp] != "undefined") ? win[pp] : '';        
}
self.zoomrestore.style.width = self.win.css('width');
self.zoomrestore.style.height = self.win.css('height');
self.zoomrestore.padding = {
w:self.win.outerWidth()-self.win.width(),
h:self.win.outerHeight()-self.win.height()
};
if (cap.isios4) {
self.zoomrestore.scrollTop = $(window).scrollTop();
$(window).scrollTop(0);
}
self.win.css({
"position":(cap.isios4)?"absolute":"fixed",
"top":0,
"left":0,
"z-index":globalmaxzindex+100,
"margin":"0px"
});
var bkg = self.win.css("backgroundColor");      
if (bkg==""||/transparent|rgba\(0, 0, 0, 0\)|rgba\(0,0,0,0\)/.test(bkg)) self.win.css("backgroundColor","#fff");
self.rail.css({"z-index":globalmaxzindex+101});
self.zoom.css({"z-index":globalmaxzindex+102});      
self.zoom.css('backgroundPosition','0px -18px');
self.resizeZoom();
if (self.onzoomin) self.onzoomin.call(self);
return self.cancelEvent(e);
};
this.doZoomOut = function(e) {
if (!self.zoomactive) return;
self.zoomactive = false;
self.win.css("margin","");
self.win.css(self.zoomrestore.style);
if (cap.isios4) {
$(window).scrollTop(self.zoomrestore.scrollTop);
}
self.rail.css({"z-index":self.zindex});
self.zoom.css({"z-index":self.zindex});
self.zoomrestore = false;
self.zoom.css('backgroundPosition','0px 0px');
self.onResize();
if (self.onzoomout) self.onzoomout.call(self);
return self.cancelEvent(e);
};
this.doZoom = function(e) {
return (self.zoomactive) ? self.doZoomOut(e) : self.doZoomIn(e);
};
this.resizeZoom = function() {
if (!self.zoomactive) return;
var py = self.getScrollTop(); //preserve scrolling position
self.win.css({
width:$(window).width()-self.zoomrestore.padding.w+"px",
height:$(window).height()-self.zoomrestore.padding.h+"px"
});
self.onResize();
self.setScrollTop(Math.min(self.page.maxh,py));
};
this.init();
$.nicescroll.push(this);
};
var ScrollMomentumClass2D = function(nc) {
var self = this;
this.nc = nc;
this.lastx = 0;
this.lasty = 0;
this.speedx = 0;
this.speedy = 0;
this.lasttime = 0;
this.steptime = 0;
this.snapx = false;
this.snapy = false;
this.demulx = 0;
this.demuly = 0;
this.lastscrollx = -1;
this.lastscrolly = -1;
this.chkx = 0;
this.chky = 0;
this.timer = 0;
this.time = function() {
return +new Date();//beautifull hack
};
this.reset = function(px,py) {
self.stop();
var now = self.time();
self.steptime = 0;
self.lasttime = now;
self.speedx = 0;
self.speedy = 0;
self.lastx = px;
self.lasty = py;
self.lastscrollx = -1;
self.lastscrolly = -1;
};
this.update = function(px,py) {
var now = self.time();
self.steptime = now - self.lasttime;
self.lasttime = now;      
var dy = py - self.lasty;
var dx = px - self.lastx;
var sy = self.nc.getScrollTop();
var sx = self.nc.getScrollLeft();
var newy = sy + dy;
var newx = sx + dx;
self.snapx = (newx<0)||(newx>self.nc.page.maxw);
self.snapy = (newy<0)||(newy>self.nc.page.maxh);
self.speedx = dx;
self.speedy = dy;
self.lastx = px;
self.lasty = py;
};
this.stop = function() {
self.nc.unsynched("domomentum2d");
if (self.timer) clearTimeout(self.timer);
self.timer = 0;
self.lastscrollx = -1;
self.lastscrolly = -1;
};
this.doSnapy = function(nx,ny) {
var snap = false;
if (ny<0) {
ny=0;
snap=true;        
} 
else if (ny>self.nc.page.maxh) {
ny=self.nc.page.maxh;
snap=true;
}
if (nx<0) {
nx=0;
snap=true;        
} 
else if (nx>self.nc.page.maxw) {
nx=self.nc.page.maxw;
snap=true;
}
(snap) ? self.nc.doScrollPos(nx,ny,self.nc.opt.snapbackspeed) : self.nc.triggerScrollEnd();
};
this.doMomentum = function(gp) {
var t = self.time();
var l = (gp) ? t+gp : self.lasttime;
var sl = self.nc.getScrollLeft();
var st = self.nc.getScrollTop();
var pageh = self.nc.page.maxh;
var pagew = self.nc.page.maxw;
self.speedx = (pagew>0) ? Math.min(60,self.speedx) : 0;
self.speedy = (pageh>0) ? Math.min(60,self.speedy) : 0;
var chk = l && (t - l) <= 60;
if ((st<0)||(st>pageh)||(sl<0)||(sl>pagew)) chk = false;
var sy = (self.speedy && chk) ? self.speedy : false;
var sx = (self.speedx && chk) ? self.speedx : false;
if (sy||sx) {
var tm = Math.max(16,self.steptime); //timeout granularity
if (tm>50) {  // do smooth
var xm = tm/50;
self.speedx*=xm;
self.speedy*=xm;
tm = 50;
}
self.demulxy = 0;
self.lastscrollx = self.nc.getScrollLeft();
self.chkx = self.lastscrollx;
self.lastscrolly = self.nc.getScrollTop();
self.chky = self.lastscrolly;
var nx = self.lastscrollx;
var ny = self.lastscrolly;
var onscroll = function(){
var df = ((self.time()-t)>600) ? 0.04 : 0.02;
if (self.speedx) {
nx = Math.floor(self.lastscrollx - (self.speedx*(1-self.demulxy)));
self.lastscrollx = nx;
if ((nx<0)||(nx>pagew)) df=0.10;
}
if (self.speedy) {
ny = Math.floor(self.lastscrolly - (self.speedy*(1-self.demulxy)));
self.lastscrolly = ny;
if ((ny<0)||(ny>pageh)) df=0.10;
}
self.demulxy = Math.min(1,self.demulxy+df);
self.nc.synched("domomentum2d",function(){
if (self.speedx) {
var scx = self.nc.getScrollLeft();
if (scx!=self.chkx) self.stop();
self.chkx=nx;
self.nc.setScrollLeft(nx);
}
if (self.speedy) {
var scy = self.nc.getScrollTop();
if (scy!=self.chky) self.stop();          
self.chky=ny;
self.nc.setScrollTop(ny);
}
if(!self.timer) {
self.nc.hideCursor();
self.doSnapy(nx,ny);
}
});
if (self.demulxy<1) {            
self.timer = setTimeout(onscroll,tm);
} else {
self.stop();
self.nc.hideCursor();
self.doSnapy(nx,ny);
}
};
onscroll();
} else {
self.doSnapy(self.nc.getScrollLeft(),self.nc.getScrollTop());
}      
}
};
var _scrollTop = jQuery.fn.scrollTop; // preserve original function
jQuery.cssHooks["pageYOffset"] = {
get: function(elem,computed,extra) {      
var nice = $.data(elem,'__nicescroll')||false;
return (nice&&nice.ishwscroll) ? nice.getScrollTop() : _scrollTop.call(elem);
},
set: function(elem,value) {
var nice = $.data(elem,'__nicescroll')||false;    
(nice&&nice.ishwscroll) ? nice.setScrollTop(parseInt(value)) : _scrollTop.call(elem,value);
return this;
}
};
/*  
$.fx.step["scrollTop"] = function(fx){    
$.cssHooks["scrollTop"].set( fx.elem, fx.now + fx.unit );
};
*/  
jQuery.fn.scrollTop = function(value) {    
if (typeof value == "undefined") {
var nice = (this[0]) ? $.data(this[0],'__nicescroll')||false : false;
return (nice&&nice.ishwscroll) ? nice.getScrollTop() : _scrollTop.call(this);
} else {      
return this.each(function() {
var nice = $.data(this,'__nicescroll')||false;
(nice&&nice.ishwscroll) ? nice.setScrollTop(parseInt(value)) : _scrollTop.call($(this),value);
});
}
};
var _scrollLeft = jQuery.fn.scrollLeft; // preserve original function
$.cssHooks.pageXOffset = {
get: function(elem,computed,extra) {
var nice = $.data(elem,'__nicescroll')||false;
return (nice&&nice.ishwscroll) ? nice.getScrollLeft() : _scrollLeft.call(elem);
},
set: function(elem,value) {
var nice = $.data(elem,'__nicescroll')||false;    
(nice&&nice.ishwscroll) ? nice.setScrollLeft(parseInt(value)) : _scrollLeft.call(elem,value);
return this;
}
};
/*  
$.fx.step["scrollLeft"] = function(fx){
$.cssHooks["scrollLeft"].set( fx.elem, fx.now + fx.unit );
};  
*/  
jQuery.fn.scrollLeft = function(value) {    
if (typeof value == "undefined") {
var nice = (this[0]) ? $.data(this[0],'__nicescroll')||false : false;
return (nice&&nice.ishwscroll) ? nice.getScrollLeft() : _scrollLeft.call(this);
} else {
return this.each(function() {     
var nice = $.data(this,'__nicescroll')||false;
(nice&&nice.ishwscroll) ? nice.setScrollLeft(parseInt(value)) : _scrollLeft.call($(this),value);
});
}
};
var NiceScrollArray = function(doms) {
var self = this;
this.length = 0;
this.name = "nicescrollarray";
this.each = function(fn) {
for(var a=0,i=0;a<self.length;a++) fn.call(self[a],i++);
return self;
};
this.push = function(nice) {
self[self.length]=nice;
self.length++;
};
this.eq = function(idx) {
return self[idx];
};
if (doms) {
for(var a=0;a<doms.length;a++) {
var nice = $.data(doms[a],'__nicescroll')||false;
if (nice) {
this[this.length]=nice;
this.length++;
}
};
}
return this;
};
function mplex(el,lst,fn) {
for(var a=0;a<lst.length;a++) fn(el,lst[a]);
};  
mplex(
NiceScrollArray.prototype,
['show','hide','toggle','onResize','resize','remove','stop','doScrollPos'],
function(e,n) {
e[n] = function(){
var args = arguments;
return this.each(function(){          
this[n].apply(this,args);
});
};
}
);  
jQuery.fn.getNiceScroll = function(index) {
if (typeof index == "undefined") {
return new NiceScrollArray(this);
} else {      
var nice = this[index]&&$.data(this[index],'__nicescroll')||false;
return nice;
}
};
jQuery.extend(jQuery.expr[':'], {
nicescroll: function(a) {
return ($.data(a,'__nicescroll'))?true:false;
}
});  
$.fn.niceScroll = function(wrapper,opt) {        
if (typeof opt=="undefined") {
if ((typeof wrapper=="object")&&!("jquery" in wrapper)) {
opt = wrapper;
wrapper = false;        
}
}
var ret = new NiceScrollArray();
if (typeof opt=="undefined") opt = {};
if (wrapper||false) {      
opt.doc = $(wrapper);
opt.win = $(this);
}    
var docundef = !("doc" in opt);   
if (!docundef&&!("win" in opt)) opt.win = $(this);    
this.each(function() {
var nice = $(this).data('__nicescroll')||false;
if (!nice) {
opt.doc = (docundef) ? $(this) : opt.doc;
nice = new NiceScrollClass(opt,$(this));        
$(this).data('__nicescroll',nice);
}
ret.push(nice);
});
return (ret.length==1) ? ret[0] : ret;
};
window.NiceScroll = {
getjQuery:function(){return jQuery}
};
if (!$.nicescroll) {
$.nicescroll = new NiceScrollArray();
$.nicescroll.options = _globaloptions;
}
}));
;
;
/*! intlTelInput.custom.min.js */ 
;
;
(function(){"use strict";(function(t,n,r,i){function a(e,n){this.element=e;this.options=t.extend({},u,n);this._defaults=u;this.id=o++;this._name=s;this.init()}var s="intlTelInput",o=1,u={preferredCountries:["us","gb"],americaMode:false,onlyCountries:[],defaultStyling:true,autoHideDialCode:true,defaultCountry:""};a.prototype={init:function(){var i=this;if(this.options.onlyCountries.length>0){var s=[],o={};t.each(this.options.onlyCountries,function(e,t){var n=i._getCountryData(t,true);if(n){s.push(n);var r=n["calling-code"];if(o[r]){o[r].push(t)}else{o[r]=[t]}}});n.intlData={countries:s,countryCodes:o}}else{n.intlData=e}var u=[];t.each(this.options.preferredCountries,function(e,t){var n=i._getCountryData(t,false);if(n){u.push(n)}});if(this.options.defaultCountry){this.defaultCountry=this._getCountryData(this.options.defaultCountry,false)}else{this.defaultCountry=u.length?u[0]:intlData.countries[0]}this.telInput=t(this.element);if(!this.options.autoHideDialCode&&this.telInput.val()===""){this._resetToDialCode(this.defaultCountry["calling-code"])}var a="intl-tel-input";if(this.options.defaultStyling){a+=" pretty"}this.telInput.wrap(t("<div>",{"class":a}));var f=t("<div>",{"class":"flag-dropdown f16"}).insertBefore(this.telInput);var l=t("<div>",{"class":"selected-flag"}).appendTo(f);var c=this.defaultCountry.cca2;this.selectedFlagInner=t("<div>",{"class":"flag "+c}).appendTo(l);t("<div>",{"class":"down-arrow"}).appendTo(this.selectedFlagInner);this.countryList=t("<ul>",{"class":"country-list hide"}).appendTo(f);if(u.length){this._appendListItems(u,"preferred");t("<li>",{"class":"divider"}).appendTo(this.countryList)}this._appendListItems(intlData.countries,"");this.countryListItems=this.countryList.children(".country");this.countryListItems.first().addClass("active");if(this.options.autoHideDialCode){this.telInput.focusin(function(){var e=t.trim(i.telInput.val());if(e.length===0){var n=i.selectedFlagInner.attr("class").split(" ")[1];var r=i._getCountryData(n,false);i._resetToDialCode(r["calling-code"])}});this.telInput.focusout(function(){var e=t.trim(i.telInput.val());if(e.length>0){var n=i._getDialCode(e);if("+"+n==e){i.telInput.val("")}}})}this.telInput.keyup(function(){i._updateFlagFromInputVal()});i._updateFlagFromInputVal();l.click(function(e){if(i.countryList.hasClass("hide")){var n=i.countryList.children(".active");i._highlightListItem(n);i.countryList.removeClass("hide");i._scrollTo(n);var s=true;t("html").bind("click.intlTelInput"+i.id,function(e){if(!s){i._closeDropdown()}s=false});t(r).bind("keydown.intlTelInput"+i.id,function(e){if(e.which==38||e.which==40){e.preventDefault();var n=i.countryList.children(".highlight").first();var r=e.which==38?n.prev():n.next();if(r.length){if(r.hasClass("divider")){r=e.which==38?r.prev():r.next()}i._highlightListItem(r);i._scrollTo(r)}}else if(e.which==13){var s=i.countryList.children(".highlight").first();if(s.length){i._selectListItem(s)}}else if(e.which==9||e.which==27){i._closeDropdown()}else if(e.which>=97&&e.which<=122||e.which>=65&&e.which<=90){var o=String.fromCharCode(e.which);var u=i.countryListItems.filter(function(){return t(this).text().charAt(0)==o&&!t(this).hasClass("preferred")});if(u.length){var a=u.filter(".highlight").first();var f;if(a&&a.next()&&a.next().text().charAt(0)==o){f=a.next()}else{f=u.first()}i._highlightListItem(f);i._scrollTo(f)}}})}});this.countryListItems.mouseover(function(){i._highlightListItem(t(this))});this.countryListItems.click(function(e){var n=t(e.currentTarget);i._selectListItem(n)})},_updateFlagFromInputVal:function(){var e=this;var n,r=false;var i=this._getDialCode(this.telInput.val());if(i){var s=intlData.countryCodes[i];t.each(s,function(t,n){if(e.selectedFlagInner.hasClass(n)){r=true}});n=s[0]}else{n=this.defaultCountry.cca2}if(!r){this._selectFlag(n)}},_resetToDialCode:function(e){var t=e=="1"&&this.options.americaMode?"":"+"+e+" ";this.telInput.val(t)},_highlightListItem:function(e){this.countryListItems.removeClass("highlight");e.addClass("highlight")},_getCountryData:function(t,n){var r=n?e.countries:intlData.countries;for(var i=0;i<r.length;i++){if(r[i].cca2==t){return r[i]}}},_selectFlag:function(e){this.selectedFlagInner.attr("class","flag "+e);var t=this.countryListItems.children(".flag."+e).parent();this.countryListItems.removeClass("active");t.addClass("active")},_selectListItem:function(e){var t=e.attr("data-country-code");this._selectFlag(t);var n=this._updateNumber(e.attr("data-dial-code"));this.telInput.val(n);this.telInput.focus()},_closeDropdown:function(){this.countryList.addClass("hide");t(r).unbind("keydown.intlTelInput"+this.id);t("html").unbind("click.intlTelInput"+this.id)},_scrollTo:function(e){var t=this.countryList;var n=t.height();var r=t.offset().top;var i=r+n;var s=e.outerHeight();var o=e.offset().top;var u=o+s;var a=o-r+t.scrollTop();if(o<r){t.scrollTop(a)}else if(u>i){var f=n-s;t.scrollTop(a-f)}},_updateNumber:function(e){var n=this.telInput.val();var r="+"+this._getDialCode(n);var i="+"+e;var s;if(r.length>1){s=n.replace(r,i);if(n==r){s+=" "}}else if(n.length&&n.substr(0,1)!="+"){s=i+" "+t.trim(n)}else{s=i+" "}if(this.options.americaMode&&s.substring(0,3)=="+1 "){s=s.substring(3)}return s},_getDialCode:function(e){var n=t.trim(e).split(" ")[0];if(n.substring(0,1)=="+"){var r=n.replace(/\D/g,"").substring(0,4);for(var i=r.length;i>0;i--){r=r.substring(0,i);if(intlData.countryCodes[r]){return r}}}return""},_appendListItems:function(e,n){var r="";t.each(e,function(e,t){r+="<li class='country "+n+"' data-dial-code='"+t["calling-code"]+"' data-country-code='"+t.cca2+"'>";r+="<div class='flag "+t.cca2+"'></div>";r+="<span class='country-name'>"+t.name+"</span>";r+="<span class='dial-code'>+"+t["calling-code"]+"</span>";r+="</li>"});this.countryList.append(r)},setNumber:function(e){this.telInput.val(e);this._updateFlagFromInputVal()},selectCountry:function(e){if(!this.selectedFlagInner.hasClass(e)){this._selectFlag(e);if(!this.options.autoHideDialCode){var t=this._getCountryData(e,false);this._resetToDialCode(t["calling-code"])}}}};t.fn[s]=function(e){var n=arguments;if(e===i||typeof e==="object"){return this.each(function(){if(!t.data(this,"plugin_"+s)){t.data(this,"plugin_"+s,new a(this,e))}})}else if(typeof e==="string"&&e[0]!=="_"&&e!=="init"){var r;this.each(function(){var i=t.data(this,"plugin_"+s);if(i instanceof a&&typeof i[e]==="function"){r=i[e].apply(i,Array.prototype.slice.call(n,1))}});return r!==i?r:this}};t.fn[s].getCountryData=function(){return e};t.fn[s].setCountryData=function(t){e=t}})(jQuery,window,document);var e={countries:[{name:"Afghanistan",cca2:"af","calling-code":"93"},{name:"Albania",cca2:"al","calling-code":"355"},{name:"Algeria",cca2:"dz","calling-code":"213"},{name:"American Samoa",cca2:"as","calling-code":"1684"},{name:"Andorra",cca2:"ad","calling-code":"376"},{name:"Angola",cca2:"ao","calling-code":"244"},{name:"Anguilla",cca2:"ai","calling-code":"1264"},{name:"Antigua and Barbuda",cca2:"ag","calling-code":"1268"},{name:"Argentina",cca2:"ar","calling-code":"54"},{name:"Armenia",cca2:"am","calling-code":"374"},{name:"Aruba",cca2:"aw","calling-code":"297"},{name:"Australia",cca2:"au","calling-code":"61"},{name:"Austria",cca2:"at","calling-code":"43"},{name:"Azerbaijan",cca2:"az","calling-code":"994"},{name:"Bahamas",cca2:"bs","calling-code":"1242"},{name:"Bahrain",cca2:"bh","calling-code":"973"},{name:"Bangladesh",cca2:"bd","calling-code":"880"},{name:"Barbados",cca2:"bb","calling-code":"1246"},{name:"Belarus",cca2:"by","calling-code":"375"},{name:"Belgium",cca2:"be","calling-code":"32"},{name:"Belize",cca2:"bz","calling-code":"501"},{name:"Benin",cca2:"bj","calling-code":"229"},{name:"Bermuda",cca2:"bm","calling-code":"1441"},{name:"Bhutan",cca2:"bt","calling-code":"975"},{name:"Bolivia",cca2:"bo","calling-code":"591"},{name:"Bosnia and Herzegovina",cca2:"ba","calling-code":"387"},{name:"Botswana",cca2:"bw","calling-code":"267"},{name:"Brazil",cca2:"br","calling-code":"55"},{name:"Brunei",cca2:"bn","calling-code":"673"},{name:"Bulgaria",cca2:"bg","calling-code":"359"},{name:"Burkina Faso",cca2:"bf","calling-code":"226"},{name:"Burundi",cca2:"bi","calling-code":"257"},{name:"Cambodia",cca2:"kh","calling-code":"855"},{name:"Cameroon",cca2:"cm","calling-code":"237"},{name:"Canada",cca2:"ca","calling-code":"1"},{name:"Cape Verde",cca2:"cv","calling-code":"238"},{name:"Cayman Islands",cca2:"ky","calling-code":"1345"},{name:"Central African Republic",cca2:"cf","calling-code":"236"},{name:"Chad",cca2:"td","calling-code":"235"},{name:"Chile",cca2:"cl","calling-code":"56"},{name:"China",cca2:"cn","calling-code":"86"},{name:"Colombia",cca2:"co","calling-code":"57"},{name:"Comoros",cca2:"km","calling-code":"269"},{name:"Congo [DRC]",cca2:"cd","calling-code":"243"},{name:"Congo [Republic]",cca2:"cg","calling-code":"242"},{name:"Cook Islands",cca2:"ck","calling-code":"682"},{name:"Costa Rica",cca2:"cr","calling-code":"506"},{name:"Cote d'Ivoire",cca2:"ci","calling-code":"225"},{name:"Croatia",cca2:"hr","calling-code":"385"},{name:"Cuba",cca2:"cu","calling-code":"53"},{name:"Cyprus",cca2:"cy","calling-code":"357"},{name:"Czech Republic",cca2:"cz","calling-code":"420"},{name:"Denmark",cca2:"dk","calling-code":"45"},{name:"Djibouti",cca2:"dj","calling-code":"253"},{name:"Dominica",cca2:"dm","calling-code":"1767"},{name:"Dominican Republic",cca2:"do","calling-code":"1809"},{name:"Ecuador",cca2:"ec","calling-code":"593"},{name:"Egypt",cca2:"eg","calling-code":"20"},{name:"El Salvador",cca2:"sv","calling-code":"503"},{name:"Equatorial Guinea",cca2:"gq","calling-code":"240"},{name:"Eritrea",cca2:"er","calling-code":"291"},{name:"Estonia",cca2:"ee","calling-code":"372"},{name:"Ethiopia",cca2:"et","calling-code":"251"},{name:"Faroe Islands",cca2:"fo","calling-code":"298"},{name:"Fiji",cca2:"fj","calling-code":"679"},{name:"Finland",cca2:"fi","calling-code":"358"},{name:"France",cca2:"fr","calling-code":"33"},{name:"French Polynesia",cca2:"pf","calling-code":"689"},{name:"Gabon",cca2:"ga","calling-code":"241"},{name:"Gambia",cca2:"gm","calling-code":"220"},{name:"Georgia",cca2:"ge","calling-code":"995"},{name:"Germany",cca2:"de","calling-code":"49"},{name:"Ghana",cca2:"gh","calling-code":"233"},{name:"Gibraltar",cca2:"gi","calling-code":"350"},{name:"Greece",cca2:"gr","calling-code":"30"},{name:"Greenland",cca2:"gl","calling-code":"299"},{name:"Grenada",cca2:"gd","calling-code":"1473"},{name:"Guadeloupe",cca2:"gp","calling-code":"590"},{name:"Guam",cca2:"gu","calling-code":"1671"},{name:"Guatemala",cca2:"gt","calling-code":"502"},{name:"Guernsey",cca2:"gg","calling-code":"44"},{name:"Guinea",cca2:"gn","calling-code":"224"},{name:"Guinea-Bissau",cca2:"gw","calling-code":"245"},{name:"Guyana",cca2:"gy","calling-code":"592"},{name:"Haiti",cca2:"ht","calling-code":"509"},{name:"Honduras",cca2:"hn","calling-code":"504"},{name:"Hong Kong",cca2:"hk","calling-code":"852"},{name:"Hungary",cca2:"hu","calling-code":"36"},{name:"Iceland",cca2:"is","calling-code":"354"},{name:"India",cca2:"in","calling-code":"91"},{name:"Indonesia",cca2:"id","calling-code":"62"},{name:"Iran",cca2:"ir","calling-code":"98"},{name:"Iraq",cca2:"iq","calling-code":"964"},{name:"Ireland",cca2:"ie","calling-code":"353"},{name:"Isle of Man",cca2:"im","calling-code":"44"},{name:"Israel",cca2:"il","calling-code":"972"},{name:"Italy",cca2:"it","calling-code":"39"},{name:"Jamaica",cca2:"jm","calling-code":"1876"},{name:"Japan",cca2:"jp","calling-code":"81"},{name:"Jersey",cca2:"je","calling-code":"44"},{name:"Jordan",cca2:"jo","calling-code":"962"},{name:"Kazakhstan",cca2:"kz","calling-code":"7"},{name:"Kenya",cca2:"ke","calling-code":"254"},{name:"Kiribati",cca2:"ki","calling-code":"686"},{name:"Kuwait",cca2:"kw","calling-code":"965"},{name:"Kyrgyzstan",cca2:"kg","calling-code":"996"},{name:"Laos",cca2:"la","calling-code":"856"},{name:"Latvia",cca2:"lv","calling-code":"371"},{name:"Lebanon",cca2:"lb","calling-code":"961"},{name:"Lesotho",cca2:"ls","calling-code":"266"},{name:"Liberia",cca2:"lr","calling-code":"231"},{name:"Libya",cca2:"ly","calling-code":"218"},{name:"Liechtenstein",cca2:"li","calling-code":"423"},{name:"Lithuania",cca2:"lt","calling-code":"370"},{name:"Luxembourg",cca2:"lu","calling-code":"352"},{name:"Macau",cca2:"mo","calling-code":"853"},{name:"Macedonia [FYROM]",cca2:"mk","calling-code":"389"},{name:"Madagascar",cca2:"mg","calling-code":"261"},{name:"Malawi",cca2:"mw","calling-code":"265"},{name:"Malaysia",cca2:"my","calling-code":"60"},{name:"Maldives",cca2:"mv","calling-code":"960"},{name:"Mali",cca2:"ml","calling-code":"223"},{name:"Malta",cca2:"mt","calling-code":"356"},{name:"Marshall Islands",cca2:"mh","calling-code":"692"},{name:"Martinique",cca2:"mq","calling-code":"596"},{name:"Mauritania",cca2:"mr","calling-code":"222"},{name:"Mauritius",cca2:"mu","calling-code":"230"},{name:"Mexico",cca2:"mx","calling-code":"52"},{name:"Micronesia",cca2:"fm","calling-code":"691"},{name:"Moldova",cca2:"md","calling-code":"373"},{name:"Monaco",cca2:"mc","calling-code":"377"},{name:"Mongolia",cca2:"mn","calling-code":"976"},{name:"Montenegro",cca2:"me","calling-code":"382"},{name:"Montserrat",cca2:"ms","calling-code":"1664"},{name:"Morocco",cca2:"ma","calling-code":"212"},{name:"Mozambique",cca2:"mz","calling-code":"258"},{name:"Myanmar [Burma]",cca2:"mm","calling-code":"95"},{name:"Namibia",cca2:"na","calling-code":"264"},{name:"Nauru",cca2:"nr","calling-code":"674"},{name:"Nepal",cca2:"np","calling-code":"977"},{name:"Netherlands",cca2:"nl","calling-code":"31"},{name:"New Caledonia",cca2:"nc","calling-code":"687"},{name:"New Zealand",cca2:"nz","calling-code":"64"},{name:"Nicaragua",cca2:"ni","calling-code":"505"},{name:"Niger",cca2:"ne","calling-code":"227"},{name:"Nigeria",cca2:"ng","calling-code":"234"},{name:"North Korea",cca2:"kp","calling-code":"850"},{name:"Norway",cca2:"no","calling-code":"47"},{name:"Oman",cca2:"om","calling-code":"968"},{name:"Pakistan",cca2:"pk","calling-code":"92"},{name:"Palau",cca2:"pw","calling-code":"680"},{name:"Palestine",cca2:"ps","calling-code":"970"},{name:"Panama",cca2:"pa","calling-code":"507"},{name:"Papua New Guinea",cca2:"pg","calling-code":"675"},{name:"Paraguay",cca2:"py","calling-code":"595"},{name:"Peru",cca2:"pe","calling-code":"51"},{name:"Philippines",cca2:"ph","calling-code":"63"},{name:"Poland",cca2:"pl","calling-code":"48"},{name:"Portugal",cca2:"pt","calling-code":"351"},{name:"Puerto Rico",cca2:"pr","calling-code":"1787"},{name:"Qatar",cca2:"qa","calling-code":"974"},{name:"Reunion",cca2:"re","calling-code":"262"},{name:"Romania",cca2:"ro","calling-code":"40"},{name:"Russia",cca2:"ru","calling-code":"7"},{name:"Rwanda",cca2:"rw","calling-code":"250"},{name:"Saint Kitts and Nevis",cca2:"kn","calling-code":"1869"},{name:"Saint Lucia",cca2:"lc","calling-code":"1758"},{name:"Saint Vincent and the Grenadines",cca2:"vc","calling-code":"1784"},{name:"Samoa",cca2:"ws","calling-code":"685"},{name:"San Marino",cca2:"sm","calling-code":"378"},{name:"Sao Tome and Principe",cca2:"st","calling-code":"239"},{name:"Saudi Arabia",cca2:"sa","calling-code":"966"},{name:"Senegal",cca2:"sn","calling-code":"221"},{name:"Serbia",cca2:"rs","calling-code":"381"},{name:"Seychelles",cca2:"sc","calling-code":"248"},{name:"Sierra Leone",cca2:"sl","calling-code":"232"},{name:"Singapore",cca2:"sg","calling-code":"65"},{name:"Slovakia",cca2:"sk","calling-code":"421"},{name:"Slovenia",cca2:"si","calling-code":"386"},{name:"Solomon Islands",cca2:"sb","calling-code":"677"},{name:"Somalia",cca2:"so","calling-code":"252"},{name:"South Africa",cca2:"za","calling-code":"27"},{name:"South Korea",cca2:"kr","calling-code":"82"},{name:"Spain",cca2:"es","calling-code":"34"},{name:"Sri Lanka",cca2:"lk","calling-code":"94"},{name:"Sudan",cca2:"sd","calling-code":"249"},{name:"Suriname",cca2:"sr","calling-code":"597"},{name:"Swaziland",cca2:"sz","calling-code":"268"},{name:"Sweden",cca2:"se","calling-code":"46"},{name:"Switzerland",cca2:"ch","calling-code":"41"},{name:"Syria",cca2:"sy","calling-code":"963"},{name:"Taiwan",cca2:"tw","calling-code":"886"},{name:"Tajikistan",cca2:"tj","calling-code":"992"},{name:"Tanzania",cca2:"tz","calling-code":"255"},{name:"Thailand",cca2:"th","calling-code":"66"},{name:"Timor-Leste",cca2:"tl","calling-code":"670"},{name:"Togo",cca2:"tg","calling-code":"228"},{name:"Tonga",cca2:"to","calling-code":"676"},{name:"Trinidad and Tobago",cca2:"tt","calling-code":"1868"},{name:"Tunisia",cca2:"tn","calling-code":"216"},{name:"Turkey",cca2:"tr","calling-code":"90"},{name:"Turkmenistan",cca2:"tm","calling-code":"993"},{name:"Turks and Caicos Islands",cca2:"tc","calling-code":"1649"},{name:"Tuvalu",cca2:"tv","calling-code":"688"},{name:"Uganda",cca2:"ug","calling-code":"256"},{name:"Ukraine",cca2:"ua","calling-code":"380"},{name:"United Arab Emirates",cca2:"ae","calling-code":"971"},{name:"United Kingdom",cca2:"gb","calling-code":"44"},{name:"United States",cca2:"us","calling-code":"1"},{name:"Uruguay",cca2:"uy","calling-code":"598"},{name:"Uzbekistan",cca2:"uz","calling-code":"998"},{name:"Vanuatu",cca2:"vu","calling-code":"678"},{name:"Vatican City",cca2:"va","calling-code":"379"},{name:"Venezuela",cca2:"ve","calling-code":"58"},{name:"Vietnam",cca2:"vn","calling-code":"84"},{name:"British Virgin Islands",cca2:"vg","calling-code":"1284"},{name:"U.S. Virgin Islands",cca2:"vi","calling-code":"1340"},{name:"Western Sahara",cca2:"eh","calling-code":"212"},{name:"Yemen",cca2:"ye","calling-code":"967"},{name:"Zambia",cca2:"zm","calling-code":"260"},{name:"Zimbabwe",cca2:"zw","calling-code":"263"}],countryCodes:{1:["us","ca"],7:["ru","kz"],20:["eg"],27:["za"],30:["gr"],31:["nl"],32:["be"],33:["fr"],34:["es"],36:["hu"],39:["it"],40:["ro"],41:["ch"],43:["at"],44:["gb","gg","im","je"],45:["dk"],46:["se"],47:["no","sj"],48:["pl"],49:["de"],51:["pe"],52:["mx"],53:["cu"],54:["ar"],55:["br"],56:["cl"],57:["co"],58:["ve"],60:["my"],61:["au","cc","cx"],62:["id"],63:["ph"],64:["nz"],65:["sg"],66:["th"],81:["jp"],82:["kr"],84:["vn"],86:["cn"],90:["tr"],91:["in"],92:["pk"],93:["af"],94:["lk"],95:["mm"],98:["ir"],211:["ss"],212:["ma","eh"],213:["dz"],216:["tn"],218:["ly"],220:["gm"],221:["sn"],222:["mr"],223:["ml"],224:["gn"],225:["ci"],226:["bf"],227:["ne"],228:["tg"],229:["bj"],230:["mu"],231:["lr"],232:["sl"],233:["gh"],234:["ng"],235:["td"],236:["cf"],237:["cm"],238:["cv"],239:["st"],240:["gq"],241:["ga"],242:["cg"],243:["cd"],244:["ao"],245:["gw"],246:["io"],247:["ac"],248:["sc"],249:["sd"],250:["rw"],251:["et"],252:["so"],253:["dj"],254:["ke"],255:["tz"],256:["ug"],257:["bi"],258:["mz"],260:["zm"],261:["mg"],262:["re","yt"],263:["zw"],264:["na"],265:["mw"],266:["ls"],267:["bw"],268:["sz"],269:["km"],290:["sh"],291:["er"],297:["aw"],298:["fo"],299:["gl"],350:["gi"],351:["pt"],352:["lu"],353:["ie"],354:["is"],355:["al"],356:["mt"],357:["cy"],358:["fi","ax"],359:["bg"],370:["lt"],371:["lv"],372:["ee"],373:["md"],374:["am"],375:["by"],376:["ad"],377:["mc"],378:["sm"],379:["va"],380:["ua"],381:["rs"],382:["me"],385:["hr"],386:["si"],387:["ba"],389:["mk"],420:["cz"],421:["sk"],423:["li"],500:["fk"],501:["bz"],502:["gt"],503:["sv"],504:["hn"],505:["ni"],506:["cr"],507:["pa"],508:["pm"],509:["ht"],590:["gp","bl","mf"],591:["bo"],592:["gy"],593:["ec"],594:["gf"],595:["py"],596:["mq"],597:["sr"],598:["uy"],599:["cw","bq"],670:["tl"],672:["nf"],673:["bn"],674:["nr"],675:["pg"],676:["to"],677:["sb"],678:["vu"],679:["fj"],680:["pw"],681:["wf"],682:["ck"],683:["nu"],685:["ws"],686:["ki"],687:["nc"],688:["tv"],689:["pf"],690:["tk"],691:["fm"],692:["mh"],850:["kp"],852:["hk"],853:["mo"],855:["kh"],856:["la"],880:["bd"],886:["tw"],960:["mv"],961:["lb"],962:["jo"],963:["sy"],964:["iq"],965:["kw"],966:["sa"],967:["ye"],968:["om"],970:["ps"],971:["ae"],972:["il"],973:["bh"],974:["qa"],975:["bt"],976:["mn"],977:["np"],992:["tj"],993:["tm"],994:["az"],995:["ge"],996:["kg"],998:["uz"],1242:["bs"],1246:["bb"],1264:["ai"],1268:["ag"],1284:["vg"],1340:["vi"],1345:["ky"],1441:["bm"],1473:["gd"],1649:["tc"],1664:["ms"],1671:["gu"],1684:["as"],1758:["lc"],1767:["dm"],1784:["vc"],1787:["pr"],1809:["do"],1868:["tt"],1869:["kn"],1876:["jm"]}}})()
;
;
/*! jquery.animate-shadow-min.js */ 
;
;
/*
Shadow animation 1.11
http://www.bitstorm.org/jquery/shadow-animation/
Copyright 2011, 2013 Edwin Martin <edwin@bitstorm.org>
Contributors: Mark Carver, Xavier Lepretre and Jason Redding
Released under the MIT and GPL licenses.
*/
'use strict';jQuery(function(h){function r(b,m,d){var l=[];h.each(b,function(f){var g=[],e=b[f];f=m[f];e.b&&g.push("inset");"undefined"!==typeof f.left&&g.push(parseFloat(e.left+d*(f.left-e.left))+"px "+parseFloat(e.top+d*(f.top-e.top))+"px");"undefined"!==typeof f.blur&&g.push(parseFloat(e.blur+d*(f.blur-e.blur))+"px");"undefined"!==typeof f.a&&g.push(parseFloat(e.a+d*(f.a-e.a))+"px");if("undefined"!==typeof f.color){var p="rgb"+(h.support.rgba?"a":"")+"("+parseInt(e.color[0]+d*(f.color[0]-e.color[0]),
10)+","+parseInt(e.color[1]+d*(f.color[1]-e.color[1]),10)+","+parseInt(e.color[2]+d*(f.color[2]-e.color[2]),10);h.support.rgba&&(p+=","+parseFloat(e.color[3]+d*(f.color[3]-e.color[3])));g.push(p+")")}l.push(g.join(" "))});return l.join(", ")}function q(b){function m(){var a=/^inset\b/.exec(b.substring(c));return null!==a&&0<a.length?(k.b=!0,c+=a[0].length,!0):!1}function d(){var a=/^(-?[0-9\.]+)(?:px)?\s+(-?[0-9\.]+)(?:px)?(?:\s+(-?[0-9\.]+)(?:px)?)?(?:\s+(-?[0-9\.]+)(?:px)?)?/.exec(b.substring(c));
return null!==a&&0<a.length?(k.left=parseInt(a[1],10),k.top=parseInt(a[2],10),k.blur=a[3]?parseInt(a[3],10):0,k.a=a[4]?parseInt(a[4],10):0,c+=a[0].length,!0):!1}function l(){var a=/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/.exec(b.substring(c));if(null!==a&&0<a.length)return k.color=[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),1],c+=a[0].length,!0;a=/^#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])/.exec(b.substring(c));if(null!==a&&0<a.length)return k.color=[17*parseInt(a[1],16),17*parseInt(a[2],
16),17*parseInt(a[3],16),1],c+=a[0].length,!0;a=/^rgb\(\s*([0-9\.]+)\s*,\s*([0-9\.]+)\s*,\s*([0-9\.]+)\s*\)/.exec(b.substring(c));if(null!==a&&0<a.length)return k.color=[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10),1],c+=a[0].length,!0;a=/^rgba\(\s*([0-9\.]+)\s*,\s*([0-9\.]+)\s*,\s*([0-9\.]+)\s*,\s*([0-9\.]+)\s*\)/.exec(b.substring(c));return null!==a&&0<a.length?(k.color=[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10),parseFloat(a[4])],c+=a[0].length,!0):!1}function f(){var a=/^\s+/.exec(b.substring(c));
null!==a&&0<a.length&&(c+=a[0].length)}function g(){var a=/^\s*,\s*/.exec(b.substring(c));return null!==a&&0<a.length?(c+=a[0].length,!0):!1}function e(a){if(h.isPlainObject(a)){var b,e,c=0,d=[];h.isArray(a.color)&&(e=a.color,c=e.length);for(b=0;4>b;b++)b<c?d.push(e[b]):3===b?d.push(1):d.push(0)}return h.extend({left:0,top:0,blur:0,spread:0},a)}for(var p=[],c=0,n=b.length,k=e();c<n;)if(m())f();else if(d())f();else if(l())f();else if(g())p.push(e(k)),k={};else break;p.push(e(k));return p}h.extend(!0,
h,{support:{rgba:function(){var b=h("script:first"),m=b.css("color"),d=!1;if(/^rgba/.test(m))d=!0;else try{d=m!==b.css("color","rgba(0, 0, 0, 0.5)").css("color"),b.css("color",m)}catch(l){}b.removeAttr("style");return d}()}});var s=h("html").prop("style"),n;h.each(["boxShadow","MozBoxShadow","WebkitBoxShadow"],function(b,h){if("undefined"!==typeof s[h])return n=h,!1});n&&(h.Tween.propHooks.boxShadow={get:function(b){return h(b.elem).css(n)},set:function(b){var m=b.elem.style,d=q(h(b.elem)[0].style[n]||
h(b.elem).css(n)),l=q(b.end),f=Math.max(d.length,l.length),g;for(g=0;g<f;g++)l[g]=h.extend({},d[g],l[g]),d[g]?"color"in d[g]&&!1!==h.isArray(d[g].color)||(d[g].color=l[g].color||[0,0,0,0]):d[g]=q("0 0 0 0 rgba(0,0,0,0)")[0];b.run=function(b){b=r(d,l,b);m[n]=b}}})});
;
;
/*! stacktrace-0.6.4.min.js */ 
;
;
(function(global,factory){if(typeof exports==="object"){module.exports=factory()}else if(typeof define==="function"&&define.amd){define(factory)}else{global.printStackTrace=factory()}})(this,function(){function printStackTrace(options){options=options||{guess:true};var ex=options.e||null,guess=!!options.guess,mode=options.mode||null;var p=new printStackTrace.implementation,result=p.run(ex,mode);return guess?p.guessAnonymousFunctions(result):result}printStackTrace.implementation=function(){};printStackTrace.implementation.prototype={run:function(ex,mode){ex=ex||this.createException();mode=mode||this.mode(ex);if(mode==="other"){return this.other(arguments.callee)}else{return this[mode](ex)}},createException:function(){try{this.undef()}catch(e){return e}},mode:function(e){if(typeof window!=="undefined"&&window.navigator.userAgent.indexOf("PhantomJS")>-1){return"phantomjs"}if(e["arguments"]&&e.stack){return"chrome"}if(e.stack&&e.sourceURL){return"safari"}if(e.stack&&e.number){return"ie"}if(e.stack&&e.fileName){return"firefox"}if(e.message&&e["opera#sourceloc"]){if(!e.stacktrace){return"opera9"}if(e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length){return"opera9"}return"opera10a"}if(e.message&&e.stack&&e.stacktrace){if(e.stacktrace.indexOf("called from line")<0){return"opera10b"}return"opera11"}if(e.stack&&!e.fileName){return"chrome"}return"other"},instrumentFunction:function(context,functionName,callback){context=context||window;var original=context[functionName];context[functionName]=function instrumented(){callback.call(this,printStackTrace().slice(4));return context[functionName]._instrumented.apply(this,arguments)};context[functionName]._instrumented=original},deinstrumentFunction:function(context,functionName){if(context[functionName].constructor===Function&&context[functionName]._instrumented&&context[functionName]._instrumented.constructor===Function){context[functionName]=context[functionName]._instrumented}},chrome:function(e){return(e.stack+"\n").replace(/^[\s\S]+?\s+at\s+/," at ").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}() ($1)$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}() ($1)").replace(/^(.+) \((.+)\)$/gm,"$1@$2").split("\n").slice(0,-1)},safari:function(e){return e.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},ie:function(e){return e.stack.replace(/^\s*at\s+(.*)$/gm,"$1").replace(/^Anonymous function\s+/gm,"{anonymous}() ").replace(/^(.+)\s+\((.+)\)$/gm,"$1@$2").split("\n").slice(1)},firefox:function(e){return e.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^(?:\((\S*)\))?@/gm,"{anonymous}($1)@").split("\n")},opera11:function(e){var ANON="{anonymous}",lineRE=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/;var lines=e.stacktrace.split("\n"),result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){var location=match[4]+":"+match[1]+":"+match[2];var fnName=match[3]||"global code";fnName=fnName.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,ANON);result.push(fnName+"@"+location+" -- "+lines[i+1].replace(/^\s+/,""))}}return result},opera10b:function(e){var lineRE=/^(.*)@(.+):(\d+)$/;var lines=e.stacktrace.split("\n"),result=[];for(var i=0,len=lines.length;i<len;i++){var match=lineRE.exec(lines[i]);if(match){var fnName=match[1]?match[1]+"()":"global code";result.push(fnName+"@"+match[2]+":"+match[3])}}return result},opera10a:function(e){var ANON="{anonymous}",lineRE=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;var lines=e.stacktrace.split("\n"),result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){var fnName=match[3]||ANON;result.push(fnName+"()@"+match[2]+":"+match[1]+" -- "+lines[i+1].replace(/^\s+/,""))}}return result},opera9:function(e){var ANON="{anonymous}",lineRE=/Line (\d+).*script (?:in )?(\S+)/i;var lines=e.message.split("\n"),result=[];for(var i=2,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){result.push(ANON+"()@"+match[2]+":"+match[1]+" -- "+lines[i+1].replace(/^\s+/,""))}}return result},phantomjs:function(e){var ANON="{anonymous}",lineRE=/(\S+) \((\S+)\)/i;var lines=e.stack.split("\n"),result=[];for(var i=1,len=lines.length;i<len;i++){lines[i]=lines[i].replace(/^\s+at\s+/gm,"");var match=lineRE.exec(lines[i]);if(match){result.push(match[1]+"()@"+match[2])}else{result.push(ANON+"()@"+lines[i])}}return result},other:function(curr){var ANON="{anonymous}",fnRE=/function(?:\s+([\w$]+))?\s*\(/,stack=[],fn,args,maxStackSize=10;var slice=Array.prototype.slice;while(curr&&stack.length<maxStackSize){fn=fnRE.test(curr.toString())?RegExp.$1||ANON:ANON;try{args=slice.call(curr["arguments"]||[])}catch(e){args=["Cannot access arguments: "+e]}stack[stack.length]=fn+"("+this.stringifyArguments(args)+")";try{curr=curr.caller}catch(e){stack[stack.length]="Cannot access caller: "+e;break}}return stack},stringifyArguments:function(args){var result=[];var slice=Array.prototype.slice;for(var i=0;i<args.length;++i){var arg=args[i];if(arg===undefined){result[i]="undefined"}else if(arg===null){result[i]="null"}else if(arg.constructor){if(arg.constructor===Array){if(arg.length<3){result[i]="["+this.stringifyArguments(arg)+"]"}else{result[i]="["+this.stringifyArguments(slice.call(arg,0,1))+"..."+this.stringifyArguments(slice.call(arg,-1))+"]"}}else if(arg.constructor===Object){result[i]="#object"}else if(arg.constructor===Function){result[i]="#function"}else if(arg.constructor===String){result[i]='"'+arg+'"'}else if(arg.constructor===Number){result[i]=arg}else{result[i]="?"}}}return result.join(",")},sourceCache:{},ajax:function(url){var req=this.createXMLHTTPObject();if(req){try{req.open("GET",url,false);req.send(null);return req.responseText}catch(e){}}return""},createXMLHTTPObject:function(){var xmlhttp,XMLHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];for(var i=0;i<XMLHttpFactories.length;i++){try{xmlhttp=XMLHttpFactories[i]();this.createXMLHTTPObject=XMLHttpFactories[i];return xmlhttp}catch(e){}}},isSameDomain:function(url){return typeof location!=="undefined"&&url.indexOf(location.hostname)!==-1},getSource:function(url){if(!(url in this.sourceCache)){this.sourceCache[url]=this.ajax(url).split("\n")}return this.sourceCache[url]},guessAnonymousFunctions:function(stack){for(var i=0;i<stack.length;++i){var reStack=/\{anonymous\}\(.*\)@(.*)/,reRef=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,frame=stack[i],ref=reStack.exec(frame);if(ref){var m=reRef.exec(ref[1]);if(m){var file=m[1],lineno=m[2],charno=m[3]||0;if(file&&this.isSameDomain(file)&&lineno){var functionName=this.guessAnonymousFunction(file,lineno,charno);stack[i]=frame.replace("{anonymous}",functionName)}}}}return stack},guessAnonymousFunction:function(url,lineNo,charNo){var ret;try{ret=this.findFunctionName(this.getSource(url),lineNo)}catch(e){ret="getSource failed with url: "+url+", exception: "+e.toString()}return ret},findFunctionName:function(source,lineNo){var reFunctionDeclaration=/function\s+([^(]*?)\s*\(([^)]*)\)/;var reFunctionExpression=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/;var reFunctionEvaluation=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/;var code="",line,maxLines=Math.min(lineNo,20),m,commentPos;for(var i=0;i<maxLines;++i){line=source[lineNo-i-1];commentPos=line.indexOf("//");if(commentPos>=0){line=line.substr(0,commentPos)}if(line){code=line+code;m=reFunctionExpression.exec(code);if(m&&m[1]){return m[1]}m=reFunctionDeclaration.exec(code);if(m&&m[1]){return m[1]}m=reFunctionEvaluation.exec(code);if(m&&m[1]){return m[1]}}}return"(?)"}};return printStackTrace});

;
;
/*! pusher-2.2.4.min.js */ 
;
;
/*!
* Pusher JavaScript Library v2.2.4
* http://pusher.com/
*
* Copyright 2014, Pusher
* Released under the MIT licence.
*/
(function(){function b(a,d){(null===a||void 0===a)&&b.warn("Warning","You must pass your app key when you instantiate Pusher.");d=d||{};var c=this;this.key=a;this.config=b.Util.extend(b.getGlobalConfig(),d.cluster?b.getClusterConfig(d.cluster):{},d);this.channels=new b.Channels;this.global_emitter=new b.EventsDispatcher;this.sessionID=Math.floor(1E9*Math.random());this.timeline=new b.Timeline(this.key,this.sessionID,{cluster:this.config.cluster,features:b.Util.getClientFeatures(),params:this.config.timelineParams||
{},limit:50,level:b.Timeline.INFO,version:b.VERSION});this.config.disableStats||(this.timelineSender=new b.TimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/jsonp"}));this.connection=new b.ConnectionManager(this.key,b.Util.extend({getStrategy:function(a){a=b.Util.extend({},c.config,a);return b.StrategyBuilder.build(b.getDefaultStrategy(a),a)},timeline:this.timeline,activityTimeout:this.config.activity_timeout,pongTimeout:this.config.pong_timeout,unavailableTimeout:this.config.unavailable_timeout},
this.config,{encrypted:this.isEncrypted()}));this.connection.bind("connected",function(){c.subscribeAll();c.timelineSender&&c.timelineSender.send(c.connection.isEncrypted())});this.connection.bind("message",function(a){var d=0===a.event.indexOf("pusher_internal:");if(a.channel){var b=c.channel(a.channel);b&&b.handleEvent(a.event,a.data)}d||c.global_emitter.emit(a.event,a.data)});this.connection.bind("disconnected",function(){c.channels.disconnect()});this.connection.bind("error",function(a){b.warn("Error",
a)});b.instances.push(this);this.timeline.info({instances:b.instances.length});b.isReady&&c.connect()}var c=b.prototype;b.instances=[];b.isReady=!1;b.debug=function(){b.log&&b.log(b.Util.stringify.apply(this,arguments))};b.warn=function(){var a=b.Util.stringify.apply(this,arguments);window.console&&(window.console.warn?window.console.warn(a):window.console.log&&window.console.log(a));b.log&&b.log(a)};b.ready=function(){b.isReady=!0;for(var a=0,d=b.instances.length;a<d;a++)b.instances[a].connect()};
c.channel=function(a){return this.channels.find(a)};c.allChannels=function(){return this.channels.all()};c.connect=function(){this.connection.connect();if(this.timelineSender&&!this.timelineSenderTimer){var a=this.connection.isEncrypted(),d=this.timelineSender;this.timelineSenderTimer=new b.PeriodicTimer(6E4,function(){d.send(a)})}};c.disconnect=function(){this.connection.disconnect();this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)};c.bind=function(a,
d){this.global_emitter.bind(a,d);return this};c.bind_all=function(a){this.global_emitter.bind_all(a);return this};c.subscribeAll=function(){for(var a in this.channels.channels)this.channels.channels.hasOwnProperty(a)&&this.subscribe(a)};c.subscribe=function(a){a=this.channels.add(a,this);"connected"===this.connection.state&&a.subscribe();return a};c.unsubscribe=function(a){a=this.channels.remove(a);"connected"===this.connection.state&&a.unsubscribe()};c.send_event=function(a,d,b){return this.connection.send_event(a,
d,b)};c.isEncrypted=function(){return"https:"===b.Util.getDocument().location.protocol?!0:Boolean(this.config.encrypted)};b.HTTP={};this.Pusher=b}).call(this);
(function(){function b(a){window.clearTimeout(a)}function c(a){window.clearInterval(a)}function a(a,d,b,c){var k=this;this.clear=d;this.timer=a(function(){null!==k.timer&&(k.timer=c(k.timer))},b)}var d=a.prototype;d.isRunning=function(){return null!==this.timer};d.ensureAborted=function(){this.timer&&(this.clear(this.timer),this.timer=null)};Pusher.Timer=function(d,c){return new a(setTimeout,b,d,function(a){c();return null})};Pusher.PeriodicTimer=function(d,b){return new a(setInterval,c,d,function(a){b();
return a})}}).call(this);
(function(){Pusher.Util={now:function(){return Date.now?Date.now():(new Date).valueOf()},defer:function(b){return new Pusher.Timer(0,b)},extend:function(b){for(var c=1;c<arguments.length;c++){var a=arguments[c],d;for(d in a)b[d]=a[d]&&a[d].constructor&&a[d].constructor===Object?Pusher.Util.extend(b[d]||{},a[d]):a[d]}return b},stringify:function(){for(var b=["Pusher"],c=0;c<arguments.length;c++)"string"===typeof arguments[c]?b.push(arguments[c]):void 0===window.JSON?b.push(arguments[c].toString()):b.push(JSON.stringify(arguments[c]));
return b.join(" : ")},arrayIndexOf:function(b,c){var a=Array.prototype.indexOf;if(null===b)return-1;if(a&&b.indexOf===a)return b.indexOf(c);for(var a=0,d=b.length;a<d;a++)if(b[a]===c)return a;return-1},objectApply:function(b,c){for(var a in b)Object.prototype.hasOwnProperty.call(b,a)&&c(b[a],a,b)},keys:function(b){var c=[];Pusher.Util.objectApply(b,function(a,d){c.push(d)});return c},values:function(b){var c=[];Pusher.Util.objectApply(b,function(a){c.push(a)});return c},apply:function(b,c,a){for(var d=
0;d<b.length;d++)c.call(a||window,b[d],d,b)},map:function(b,c){for(var a=[],d=0;d<b.length;d++)a.push(c(b[d],d,b,a));return a},mapObject:function(b,c){var a={};Pusher.Util.objectApply(b,function(d,b){a[b]=c(d)});return a},filter:function(b,c){c=c||function(a){return!!a};for(var a=[],d=0;d<b.length;d++)c(b[d],d,b,a)&&a.push(b[d]);return a},filterObject:function(b,c){var a={};Pusher.Util.objectApply(b,function(d,h){if(c&&c(d,h,b,a)||Boolean(d))a[h]=d});return a},flatten:function(b){var c=[];Pusher.Util.objectApply(b,
function(a,d){c.push([d,a])});return c},any:function(b,c){for(var a=0;a<b.length;a++)if(c(b[a],a,b))return!0;return!1},all:function(b,c){for(var a=0;a<b.length;a++)if(!c(b[a],a,b))return!1;return!0},method:function(b){var c=Array.prototype.slice.call(arguments,1);return function(a){return a[b].apply(a,c.concat(arguments))}},getWindow:function(){return window},getDocument:function(){return document},getNavigator:function(){return navigator},getLocalStorage:function(){try{return window.localStorage}catch(b){}},
getClientFeatures:function(){return Pusher.Util.keys(Pusher.Util.filterObject({ws:Pusher.WSTransport,flash:Pusher.FlashTransport},function(b){return b.isSupported({})}))},addWindowListener:function(b,c){var a=Pusher.Util.getWindow();void 0!==a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},removeWindowListener:function(b,c){var a=Pusher.Util.getWindow();void 0!==a.addEventListener?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,c)},isXHRSupported:function(){var b=window.XMLHttpRequest;
return Boolean(b)&&void 0!==(new b).withCredentials},isXDRSupported:function(b){b=b?"https:":"http:";var c=Pusher.Util.getDocument().location.protocol;return Boolean(window.XDomainRequest)&&c===b}}}).call(this);
(function(){Pusher.VERSION="2.2.4";Pusher.PROTOCOL=7;Pusher.host="ws.pusherapp.com";Pusher.ws_port=80;Pusher.wss_port=443;Pusher.sockjs_host="sockjs.pusher.com";Pusher.sockjs_http_port=80;Pusher.sockjs_https_port=443;Pusher.sockjs_path="/pusher";Pusher.stats_host="stats.pusher.com";Pusher.channel_auth_endpoint="/pusher/auth";Pusher.channel_auth_transport="ajax";Pusher.activity_timeout=12E4;Pusher.pong_timeout=3E4;Pusher.unavailable_timeout=1E4;Pusher.cdn_http="http://js.pusher.com/";Pusher.cdn_https=
"https://js.pusher.com/";Pusher.dependency_suffix=".min";Pusher.getDefaultStrategy=function(b){return[[":def","ws_options",{hostUnencrypted:b.wsHost+":"+b.wsPort,hostEncrypted:b.wsHost+":"+b.wssPort}],[":def","wss_options",[":extend",":ws_options",{encrypted:!0}]],[":def","sockjs_options",{hostUnencrypted:b.httpHost+":"+b.httpPort,hostEncrypted:b.httpHost+":"+b.httpsPort,httpPath:b.httpPath}],[":def","timeouts",{loop:!0,timeout:15E3,timeoutLimit:6E4}],[":def","ws_manager",[":transport_manager",{lives:2,
minPingDelay:1E4,maxPingDelay:b.activity_timeout}]],[":def","streaming_manager",[":transport_manager",{lives:2,minPingDelay:1E4,maxPingDelay:b.activity_timeout}]],[":def_transport","ws","ws",3,":ws_options",":ws_manager"],[":def_transport","wss","ws",3,":wss_options",":ws_manager"],[":def_transport","flash","flash",2,":ws_options",":ws_manager"],[":def_transport","sockjs","sockjs",1,":sockjs_options"],[":def_transport","xhr_streaming","xhr_streaming",1,":sockjs_options",":streaming_manager"],[":def_transport",
"xdr_streaming","xdr_streaming",1,":sockjs_options",":streaming_manager"],[":def_transport","xhr_polling","xhr_polling",1,":sockjs_options"],[":def_transport","xdr_polling","xdr_polling",1,":sockjs_options"],[":def","ws_loop",[":sequential",":timeouts",":ws"]],[":def","wss_loop",[":sequential",":timeouts",":wss"]],[":def","flash_loop",[":sequential",":timeouts",":flash"]],[":def","sockjs_loop",[":sequential",":timeouts",":sockjs"]],[":def","streaming_loop",[":sequential",":timeouts",[":if",[":is_supported",
":xhr_streaming"],":xhr_streaming",":xdr_streaming"]]],[":def","polling_loop",[":sequential",":timeouts",[":if",[":is_supported",":xhr_polling"],":xhr_polling",":xdr_polling"]]],[":def","http_loop",[":if",[":is_supported",":streaming_loop"],[":best_connected_ever",":streaming_loop",[":delayed",4E3,[":polling_loop"]]],[":polling_loop"]]],[":def","http_fallback_loop",[":if",[":is_supported",":http_loop"],[":http_loop"],[":sockjs_loop"]]],[":def","strategy",[":cached",18E5,[":first_connected",[":if",
[":is_supported",":ws"],b.encrypted?[":best_connected_ever",":ws_loop",[":delayed",2E3,[":http_fallback_loop"]]]:[":best_connected_ever",":ws_loop",[":delayed",2E3,[":wss_loop"]],[":delayed",5E3,[":http_fallback_loop"]]],[":if",[":is_supported",":flash"],[":best_connected_ever",":flash_loop",[":delayed",2E3,[":http_fallback_loop"]]],[":http_fallback_loop"]]]]]]]}}).call(this);
(function(){Pusher.getGlobalConfig=function(){return{wsHost:Pusher.host,wsPort:Pusher.ws_port,wssPort:Pusher.wss_port,httpHost:Pusher.sockjs_host,httpPort:Pusher.sockjs_http_port,httpsPort:Pusher.sockjs_https_port,httpPath:Pusher.sockjs_path,statsHost:Pusher.stats_host,authEndpoint:Pusher.channel_auth_endpoint,authTransport:Pusher.channel_auth_transport,activity_timeout:Pusher.activity_timeout,pong_timeout:Pusher.pong_timeout,unavailable_timeout:Pusher.unavailable_timeout}};Pusher.getClusterConfig=
function(b){return{wsHost:"ws-"+b+".pusher.com",httpHost:"sockjs-"+b+".pusher.com"}}}).call(this);(function(){function b(b){var a=function(a){Error.call(this,a);this.name=b};Pusher.Util.extend(a.prototype,Error.prototype);return a}Pusher.Errors={BadEventName:b("BadEventName"),RequestTimedOut:b("RequestTimedOut"),TransportPriorityTooLow:b("TransportPriorityTooLow"),TransportClosed:b("TransportClosed"),UnsupportedTransport:b("UnsupportedTransport"),UnsupportedStrategy:b("UnsupportedStrategy")}}).call(this);
(function(){function b(a){this.callbacks=new c;this.global_callbacks=[];this.failThrough=a}function c(){this._callbacks={}}var a=b.prototype;a.bind=function(a,b,c){this.callbacks.add(a,b,c);return this};a.bind_all=function(a){this.global_callbacks.push(a);return this};a.unbind=function(a,b,c){this.callbacks.remove(a,b,c);return this};a.unbind_all=function(a,b){this.callbacks.remove(a,b);return this};a.emit=function(a,b){var c;for(c=0;c<this.global_callbacks.length;c++)this.global_callbacks[c](a,b);
var e=this.callbacks.get(a);if(e&&0<e.length)for(c=0;c<e.length;c++)e[c].fn.call(e[c].context||window,b);else this.failThrough&&this.failThrough(a,b);return this};c.prototype.get=function(a){return this._callbacks["_"+a]};c.prototype.add=function(a,b,c){a="_"+a;this._callbacks[a]=this._callbacks[a]||[];this._callbacks[a].push({fn:b,context:c})};c.prototype.remove=function(a,b,c){!a&&!b&&!c?this._callbacks={}:(a=a?["_"+a]:Pusher.Util.keys(this._callbacks),b||c?Pusher.Util.apply(a,function(a){this._callbacks[a]=
Pusher.Util.filter(this._callbacks[a]||[],function(a){return b&&b!==a.fn||c&&c!==a.context});0===this._callbacks[a].length&&delete this._callbacks[a]},this):Pusher.Util.apply(a,function(a){delete this._callbacks[a]},this))};Pusher.EventsDispatcher=b}).call(this);
(function(){function b(a,d){this.lastId=0;this.prefix=a;this.name=d}var c=b.prototype;c.create=function(a){this.lastId++;var d=this.lastId,b=this.prefix+d,c=this.name+"["+d+"]",e=!1,f=function(){e||(a.apply(null,arguments),e=!0)};this[d]=f;return{number:d,id:b,name:c,callback:f}};c.remove=function(a){delete this[a.number]};Pusher.ScriptReceiverFactory=b;Pusher.ScriptReceivers=new b("_pusher_script_","Pusher.ScriptReceivers")}).call(this);
(function(){function b(a){this.src=a}var c=b.prototype;c.send=function(a){var d=this,b="Error loading "+d.src;d.script=document.createElement("script");d.script.id=a.id;d.script.src=d.src;d.script.type="text/javascript";d.script.charset="UTF-8";d.script.addEventListener?(d.script.onerror=function(){a.callback(b)},d.script.onload=function(){a.callback(null)}):d.script.onreadystatechange=function(){("loaded"===d.script.readyState||"complete"===d.script.readyState)&&a.callback(null)};void 0===d.script.async&&
document.attachEvent&&/opera/i.test(navigator.userAgent)?(d.errorScript=document.createElement("script"),d.errorScript.id=a.id+"_error",d.errorScript.text=a.name+"('"+b+"');",d.script.async=d.errorScript.async=!1):d.script.async=!0;var c=document.getElementsByTagName("head")[0];c.insertBefore(d.script,c.firstChild);d.errorScript&&c.insertBefore(d.errorScript,d.script.nextSibling)};c.cleanup=function(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null);this.script&&
this.script.parentNode&&this.script.parentNode.removeChild(this.script);this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript);this.errorScript=this.script=null};Pusher.ScriptRequest=b}).call(this);
(function(){function b(a){this.options=a;this.receivers=a.receivers||Pusher.ScriptReceivers;this.loading={}}var c=b.prototype;c.load=function(a,d,b){var c=this;if(c.loading[a]&&0<c.loading[a].length)c.loading[a].push(b);else{c.loading[a]=[b];var e=new Pusher.ScriptRequest(c.getPath(a,d)),f=c.receivers.create(function(d){c.receivers.remove(f);if(c.loading[a]){var b=c.loading[a];delete c.loading[a];for(var h=function(a){a||e.cleanup()},m=0;m<b.length;m++)b[m](d,h)}});e.send(f)}};c.getRoot=function(a){var d=
Pusher.Util.getDocument().location.protocol;return(a&&a.encrypted||"https:"===d?this.options.cdn_https:this.options.cdn_http).replace(/\/*$/,"")+"/"+this.options.version};c.getPath=function(a,d){return this.getRoot(d)+"/"+a+this.options.suffix+".js"};Pusher.DependencyLoader=b}).call(this);
(function(){function b(){Pusher.ready()}function c(a){document.body?a():setTimeout(function(){c(a)},0)}function a(){c(b)}Pusher.DependenciesReceivers=new Pusher.ScriptReceiverFactory("_pusher_dependencies","Pusher.DependenciesReceivers");Pusher.Dependencies=new Pusher.DependencyLoader({cdn_http:Pusher.cdn_http,cdn_https:Pusher.cdn_https,version:Pusher.VERSION,suffix:Pusher.dependency_suffix,receivers:Pusher.DependenciesReceivers});window.JSON?a():Pusher.Dependencies.load("json2",{},a)})();
(function(){for(var b=String.fromCharCode,c=0;64>c;c++)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(c);var a=function(a){var d=a.charCodeAt(0);return 128>d?a:2048>d?b(192|d>>>6)+b(128|d&63):b(224|d>>>12&15)+b(128|d>>>6&63)+b(128|d&63)},d=function(a){var d=[0,2,1][a.length%3];a=a.charCodeAt(0)<<16|(1<a.length?a.charCodeAt(1):0)<<8|(2<a.length?a.charCodeAt(2):0);return["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>18),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>
12&63),2<=d?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>6&63),1<=d?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a&63)].join("")},h=window.btoa||function(a){return a.replace(/[\s\S]{1,3}/g,d)};Pusher.Base64={encode:function(d){return h(d.replace(/[^\x00-\x7F]/g,a))}}}).call(this);
(function(){function b(a,b){this.url=a;this.data=b}function c(a){return Pusher.Util.mapObject(a,function(a){"object"===typeof a&&(a=JSON.stringify(a));return encodeURIComponent(Pusher.Base64.encode(a.toString()))})}var a=b.prototype;a.send=function(a){if(!this.request){var b=Pusher.Util.filterObject(this.data,function(a){return void 0!==a}),b=Pusher.Util.map(Pusher.Util.flatten(c(b)),Pusher.Util.method("join","=")).join("&");this.request=new Pusher.ScriptRequest(this.url+"/"+a.number+"?"+b);this.request.send(a)}};
a.cleanup=function(){this.request&&this.request.cleanup()};Pusher.JSONPRequest=b}).call(this);
(function(){function b(a,d,b){this.key=a;this.session=d;this.events=[];this.options=b||{};this.uniqueID=this.sent=0}var c=b.prototype;b.ERROR=3;b.INFO=6;b.DEBUG=7;c.log=function(a,d){a<=this.options.level&&(this.events.push(Pusher.Util.extend({},d,{timestamp:Pusher.Util.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())};c.error=function(a){this.log(b.ERROR,a)};c.info=function(a){this.log(b.INFO,a)};c.debug=function(a){this.log(b.DEBUG,a)};c.isEmpty=function(){return 0===
this.events.length};c.send=function(a,d){var b=this,c=Pusher.Util.extend({session:b.session,bundle:b.sent+1,key:b.key,lib:"js",version:b.options.version,cluster:b.options.cluster,features:b.options.features,timeline:b.events},b.options.params);b.events=[];a(c,function(a,c){a||b.sent++;d&&d(a,c)});return!0};c.generateUniqueID=function(){this.uniqueID++;return this.uniqueID};Pusher.Timeline=b}).call(this);
(function(){function b(b,a){this.timeline=b;this.options=a||{}}b.prototype.send=function(b,a){var d=this;d.timeline.isEmpty()||d.timeline.send(function(a,g){var e=new Pusher.JSONPRequest("http"+(b?"s":"")+"://"+(d.host||d.options.host)+d.options.path,a),f=Pusher.ScriptReceivers.create(function(a,b){Pusher.ScriptReceivers.remove(f);e.cleanup();b&&b.host&&(d.host=b.host);g&&g(a,b)});e.send(f)},a)};Pusher.TimelineSender=b}).call(this);
(function(){function b(a){this.strategies=a}function c(a,b,c){var h=Pusher.Util.map(a,function(a,d,h,g){return a.connect(b,c(d,g))});return{abort:function(){Pusher.Util.apply(h,d)},forceMinPriority:function(a){Pusher.Util.apply(h,function(b){b.forceMinPriority(a)})}}}function a(a){return Pusher.Util.all(a,function(a){return Boolean(a.error)})}function d(a){!a.error&&!a.aborted&&(a.abort(),a.aborted=!0)}var h=b.prototype;h.isSupported=function(){return Pusher.Util.any(this.strategies,Pusher.Util.method("isSupported"))};
h.connect=function(b,d){return c(this.strategies,b,function(b,c){return function(h,g){(c[b].error=h)?a(c)&&d(!0):(Pusher.Util.apply(c,function(a){a.forceMinPriority(g.transport.priority)}),d(null,g))}})};Pusher.BestConnectedEverStrategy=b}).call(this);
(function(){function b(a,b,d){this.strategy=a;this.transports=b;this.ttl=d.ttl||18E5;this.encrypted=d.encrypted;this.timeline=d.timeline}function c(a){return"pusherTransport"+(a?"Encrypted":"Unencrypted")}function a(a){var b=Pusher.Util.getLocalStorage();if(b)try{var h=b[c(a)];if(h)return JSON.parse(h)}catch(k){d(a)}return null}function d(a){var b=Pusher.Util.getLocalStorage();if(b)try{delete b[c(a)]}catch(d){}}var h=b.prototype;h.isSupported=function(){return this.strategy.isSupported()};h.connect=
function(b,h){var f=this.encrypted,k=a(f),l=[this.strategy];if(k&&k.timestamp+this.ttl>=Pusher.Util.now()){var n=this.transports[k.transport];n&&(this.timeline.info({cached:!0,transport:k.transport,latency:k.latency}),l.push(new Pusher.SequentialStrategy([n],{timeout:2*k.latency+1E3,failFast:!0})))}var m=Pusher.Util.now(),p=l.pop().connect(b,function s(a,k){if(a)d(f),0<l.length?(m=Pusher.Util.now(),p=l.pop().connect(b,s)):h(a);else{var n=k.transport.name,t=Pusher.Util.now()-m,r=Pusher.Util.getLocalStorage();
if(r)try{r[c(f)]=JSON.stringify({timestamp:Pusher.Util.now(),transport:n,latency:t})}catch(u){}h(null,k)}});return{abort:function(){p.abort()},forceMinPriority:function(a){b=a;p&&p.forceMinPriority(a)}}};Pusher.CachedStrategy=b}).call(this);
(function(){function b(a,b){this.strategy=a;this.options={delay:b.delay}}var c=b.prototype;c.isSupported=function(){return this.strategy.isSupported()};c.connect=function(a,b){var c=this.strategy,g,e=new Pusher.Timer(this.options.delay,function(){g=c.connect(a,b)});return{abort:function(){e.ensureAborted();g&&g.abort()},forceMinPriority:function(b){a=b;g&&g.forceMinPriority(b)}}};Pusher.DelayedStrategy=b}).call(this);
(function(){function b(a){this.strategy=a}var c=b.prototype;c.isSupported=function(){return this.strategy.isSupported()};c.connect=function(a,b){var c=this.strategy.connect(a,function(a,e){e&&c.abort();b(a,e)});return c};Pusher.FirstConnectedStrategy=b}).call(this);
(function(){function b(a,b,c){this.test=a;this.trueBranch=b;this.falseBranch=c}var c=b.prototype;c.isSupported=function(){return(this.test()?this.trueBranch:this.falseBranch).isSupported()};c.connect=function(a,b){return(this.test()?this.trueBranch:this.falseBranch).connect(a,b)};Pusher.IfStrategy=b}).call(this);
(function(){function b(a,b){this.strategies=a;this.loop=Boolean(b.loop);this.failFast=Boolean(b.failFast);this.timeout=b.timeout;this.timeoutLimit=b.timeoutLimit}var c=b.prototype;c.isSupported=function(){return Pusher.Util.any(this.strategies,Pusher.Util.method("isSupported"))};c.connect=function(a,b){var c=this,g=this.strategies,e=0,f=this.timeout,k=null,l=function(n,m){m?b(null,m):(e+=1,c.loop&&(e%=g.length),e<g.length?(f&&(f*=2,c.timeoutLimit&&(f=Math.min(f,c.timeoutLimit))),k=c.tryStrategy(g[e],
a,{timeout:f,failFast:c.failFast},l)):b(!0))},k=this.tryStrategy(g[e],a,{timeout:f,failFast:this.failFast},l);return{abort:function(){k.abort()},forceMinPriority:function(b){a=b;k&&k.forceMinPriority(b)}}};c.tryStrategy=function(a,b,c,g){var e=null,f=null;0<c.timeout&&(e=new Pusher.Timer(c.timeout,function(){f.abort();g(!0)}));f=a.connect(b,function(a,b){if(!a||!e||!e.isRunning()||c.failFast)e&&e.ensureAborted(),g(a,b)});return{abort:function(){e&&e.ensureAborted();f.abort()},forceMinPriority:function(a){f.forceMinPriority(a)}}};
Pusher.SequentialStrategy=b}).call(this);
(function(){function b(a,b,c,e){this.name=a;this.priority=b;this.transport=c;this.options=e||{}}function c(a,b){Pusher.Util.defer(function(){b(a)});return{abort:function(){},forceMinPriority:function(){}}}var a=b.prototype;a.isSupported=function(){return this.transport.isSupported({encrypted:this.options.encrypted})};a.connect=function(a,b){if(this.isSupported()){if(this.priority<a)return c(new Pusher.Errors.TransportPriorityTooLow,b)}else return c(new Pusher.Errors.UnsupportedStrategy,b);var g=this,
e=!1,f=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),k=null,l=function(){f.unbind("initialized",l);f.connect()},n=function(){k=new Pusher.Handshake(f,function(a){e=!0;q();b(null,a)})},m=function(a){q();b(a)},p=function(){q();b(new Pusher.Errors.TransportClosed(f))},q=function(){f.unbind("initialized",l);f.unbind("open",n);f.unbind("error",m);f.unbind("closed",p)};f.bind("initialized",l);f.bind("open",n);f.bind("error",m);f.bind("closed",p);f.initialize();return{abort:function(){e||
(q(),k?k.close():f.close())},forceMinPriority:function(a){e||g.priority<a&&(k?k.close():f.close())}}};Pusher.TransportStrategy=b}).call(this);
(function(){function b(a,b,c){return a+(b.encrypted?"s":"")+"://"+(b.encrypted?b.hostEncrypted:b.hostUnencrypted)+c}function c(a,b){return"/app/"+a+("?protocol="+Pusher.PROTOCOL+"&client=js&version="+Pusher.VERSION+(b?"&"+b:""))}Pusher.URLSchemes={ws:{getInitial:function(a,d){return b("ws",d,c(a,"flash=false"))}},flash:{getInitial:function(a,d){return b("ws",d,c(a,"flash=true"))}},sockjs:{getInitial:function(a,c){return b("http",c,c.httpPath||"/pusher","")},getPath:function(a,b){return c(a)}},http:{getInitial:function(a,
d){var h=(d.httpPath||"/pusher")+c(a);return b("http",d,h)}}}}).call(this);
(function(){function b(a,b,c,g,e){Pusher.EventsDispatcher.call(this);this.hooks=a;this.name=b;this.priority=c;this.key=g;this.options=e;this.state="new";this.timeline=e.timeline;this.activityTimeout=e.activityTimeout;this.id=this.timeline.generateUniqueID()}var c=b.prototype;Pusher.Util.extend(c,Pusher.EventsDispatcher.prototype);c.handlesActivityChecks=function(){return Boolean(this.hooks.handlesActivityChecks)};c.supportsPing=function(){return Boolean(this.hooks.supportsPing)};c.initialize=function(){var a=
this;a.timeline.info(a.buildTimelineMessage({transport:a.name+(a.options.encrypted?"s":"")}));a.hooks.beforeInitialize&&a.hooks.beforeInitialize.call(a);if(a.hooks.isInitialized())a.changeState("initialized");else if(a.hooks.file)a.changeState("initializing"),Pusher.Dependencies.load(a.hooks.file,{encrypted:a.options.encrypted},function(b,c){if(a.hooks.isInitialized())a.changeState("initialized"),c(!0);else{if(b)a.onError(b);a.onClose();c(!1)}});else a.onClose()};c.connect=function(){var a=this;if(a.socket||
"initialized"!==a.state)return!1;var b=a.hooks.urls.getInitial(a.key,a.options);try{a.socket=a.hooks.getSocket(b,a.options)}catch(c){return Pusher.Util.defer(function(){a.onError(c);a.changeState("closed")}),!1}a.bindListeners();Pusher.debug("Connecting",{transport:a.name,url:b});a.changeState("connecting");return!0};c.close=function(){return this.socket?(this.socket.close(),!0):!1};c.send=function(a){var b=this;return"open"===b.state?(Pusher.Util.defer(function(){b.socket&&b.socket.send(a)}),!0):
!1};c.ping=function(){"open"===this.state&&this.supportsPing()&&this.socket.ping()};c.onOpen=function(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options));this.changeState("open");this.socket.onopen=void 0};c.onError=function(a){this.emit("error",{type:"WebSocketError",error:a});this.timeline.error(this.buildTimelineMessage({error:a.toString()}))};c.onClose=function(a){a?this.changeState("closed",{code:a.code,reason:a.reason,wasClean:a.wasClean}):
this.changeState("closed");this.unbindListeners();this.socket=void 0};c.onMessage=function(a){this.emit("message",a)};c.onActivity=function(){this.emit("activity")};c.bindListeners=function(){var a=this;a.socket.onopen=function(){a.onOpen()};a.socket.onerror=function(b){a.onError(b)};a.socket.onclose=function(b){a.onClose(b)};a.socket.onmessage=function(b){a.onMessage(b)};a.supportsPing()&&(a.socket.onactivity=function(){a.onActivity()})};c.unbindListeners=function(){this.socket&&(this.socket.onopen=
void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))};c.changeState=function(a,b){this.state=a;this.timeline.info(this.buildTimelineMessage({state:a,params:b}));this.emit(a,b)};c.buildTimelineMessage=function(a){return Pusher.Util.extend({cid:this.id},a)};Pusher.TransportConnection=b}).call(this);
(function(){function b(a){this.hooks=a}var c=b.prototype;c.isSupported=function(a){return this.hooks.isSupported(a)};c.createConnection=function(a,b,c,g){return new Pusher.TransportConnection(this.hooks,a,b,c,g)};Pusher.Transport=b}).call(this);
(function(){Pusher.WSTransport=new Pusher.Transport({urls:Pusher.URLSchemes.ws,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return Boolean(window.WebSocket||window.MozWebSocket)},isSupported:function(){return Boolean(window.WebSocket||window.MozWebSocket)},getSocket:function(a){return new (window.WebSocket||window.MozWebSocket)(a)}});Pusher.FlashTransport=new Pusher.Transport({file:"flashfallback",urls:Pusher.URLSchemes.flash,handlesActivityChecks:!1,supportsPing:!1,isSupported:function(){try{return Boolean(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(a){try{var b=
Pusher.Util.getNavigator();return Boolean(b&&b.mimeTypes&&void 0!==b.mimeTypes["application/x-shockwave-flash"])}catch(c){return!1}}},beforeInitialize:function(){void 0===window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR&&(window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR=!0);window.WEB_SOCKET_SWF_LOCATION=Pusher.Dependencies.getRoot({encrypted:this.options.encrypted})+"/WebSocketMain.swf"},isInitialized:function(){return void 0!==window.FlashWebSocket},getSocket:function(a){return new FlashWebSocket(a)}});
Pusher.SockJSTransport=new Pusher.Transport({file:"sockjs",urls:Pusher.URLSchemes.sockjs,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return void 0!==window.SockJS},getSocket:function(a,b){return new SockJS(a,null,{js_path:Pusher.Dependencies.getPath("sockjs",{encrypted:b.encrypted}),ignore_null_origin:b.ignoreNullOrigin})},beforeOpen:function(a,b){a.send(JSON.stringify({path:b}))}});var b={urls:Pusher.URLSchemes.http,handlesActivityChecks:!1,
supportsPing:!0,isInitialized:function(){return Boolean(Pusher.HTTP.Socket)}},c=Pusher.Util.extend({getSocket:function(a){return Pusher.HTTP.getStreamingSocket(a)}},b),b=Pusher.Util.extend({getSocket:function(a){return Pusher.HTTP.getPollingSocket(a)}},b),a={file:"xhr",isSupported:Pusher.Util.isXHRSupported},d={file:"xdr",isSupported:function(a){return Pusher.Util.isXDRSupported(a.encrypted)}};Pusher.XHRStreamingTransport=new Pusher.Transport(Pusher.Util.extend({},c,a));Pusher.XDRStreamingTransport=
new Pusher.Transport(Pusher.Util.extend({},c,d));Pusher.XHRPollingTransport=new Pusher.Transport(Pusher.Util.extend({},b,a));Pusher.XDRPollingTransport=new Pusher.Transport(Pusher.Util.extend({},b,d))}).call(this);
(function(){function b(a,b,c){this.manager=a;this.transport=b;this.minPingDelay=c.minPingDelay;this.maxPingDelay=c.maxPingDelay;this.pingDelay=void 0}var c=b.prototype;c.createConnection=function(a,b,c,g){var e=this;g=Pusher.Util.extend({},g,{activityTimeout:e.pingDelay});var f=e.transport.createConnection(a,b,c,g),k=null,l=function(){f.unbind("open",l);f.bind("closed",n);k=Pusher.Util.now()},n=function(a){f.unbind("closed",n);1002===a.code||1003===a.code?e.manager.reportDeath():!a.wasClean&&k&&(a=
Pusher.Util.now()-k,a<2*e.maxPingDelay&&(e.manager.reportDeath(),e.pingDelay=Math.max(a/2,e.minPingDelay)))};f.bind("open",l);return f};c.isSupported=function(a){return this.manager.isAlive()&&this.transport.isSupported(a)};Pusher.AssistantToTheTransportManager=b}).call(this);
(function(){function b(a){this.options=a||{};this.livesLeft=this.options.lives||Infinity}var c=b.prototype;c.getAssistant=function(a){return new Pusher.AssistantToTheTransportManager(this,a,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})};c.isAlive=function(){return 0<this.livesLeft};c.reportDeath=function(){this.livesLeft-=1};Pusher.TransportManager=b}).call(this);
(function(){function b(a){return function(b){return[a.apply(this,arguments),b]}}function c(a,b){if(0===a.length)return[[],b];var h=d(a[0],b),e=c(a.slice(1),h[1]);return[[h[0]].concat(e[0]),e[1]]}function a(a,b){if("string"===typeof a[0]&&":"===a[0].charAt(0)){var h=b[a[0].slice(1)];if(1<a.length){if("function"!==typeof h)throw"Calling non-function "+a[0];var e=[Pusher.Util.extend({},b)].concat(Pusher.Util.map(a.slice(1),function(a){return d(a,Pusher.Util.extend({},b))[0]}));return h.apply(this,e)}return[h,
b]}return c(a,b)}function d(b,c){if("string"===typeof b){var d;if("string"===typeof b&&":"===b.charAt(0)){d=c[b.slice(1)];if(void 0===d)throw"Undefined symbol "+b;d=[d,c]}else d=[b,c];return d}return"object"===typeof b&&b instanceof Array&&0<b.length?a(b,c):[b,c]}var h={ws:Pusher.WSTransport,flash:Pusher.FlashTransport,sockjs:Pusher.SockJSTransport,xhr_streaming:Pusher.XHRStreamingTransport,xdr_streaming:Pusher.XDRStreamingTransport,xhr_polling:Pusher.XHRPollingTransport,xdr_polling:Pusher.XDRPollingTransport},
g={isSupported:function(){return!1},connect:function(a,b){var c=Pusher.Util.defer(function(){b(new Pusher.Errors.UnsupportedStrategy)});return{abort:function(){c.ensureAborted()},forceMinPriority:function(){}}}},e={extend:function(a,b,c){return[Pusher.Util.extend({},b,c),a]},def:function(a,b,c){if(void 0!==a[b])throw"Redefining symbol "+b;a[b]=c;return[void 0,a]},def_transport:function(a,b,c,d,e,p){var q=h[c];if(!q)throw new Pusher.Errors.UnsupportedTransport(c);c=(!a.enabledTransports||-1!==Pusher.Util.arrayIndexOf(a.enabledTransports,
b))&&(!a.disabledTransports||-1===Pusher.Util.arrayIndexOf(a.disabledTransports,b))&&("flash"!==b||!0!==a.disableFlash)?new Pusher.TransportStrategy(b,d,p?p.getAssistant(q):q,Pusher.Util.extend({key:a.key,encrypted:a.encrypted,timeline:a.timeline,ignoreNullOrigin:a.ignoreNullOrigin},e)):g;d=a.def(a,b,c)[1];d.transports=a.transports||{};d.transports[b]=c;return[void 0,d]},transport_manager:b(function(a,b){return new Pusher.TransportManager(b)}),sequential:b(function(a,b){var c=Array.prototype.slice.call(arguments,
2);return new Pusher.SequentialStrategy(c,b)}),cached:b(function(a,b,c){return new Pusher.CachedStrategy(c,a.transports,{ttl:b,timeline:a.timeline,encrypted:a.encrypted})}),first_connected:b(function(a,b){return new Pusher.FirstConnectedStrategy(b)}),best_connected_ever:b(function(){var a=Array.prototype.slice.call(arguments,1);return new Pusher.BestConnectedEverStrategy(a)}),delayed:b(function(a,b,c){return new Pusher.DelayedStrategy(c,{delay:b})}),"if":b(function(a,b,c,d){return new Pusher.IfStrategy(b,
c,d)}),is_supported:b(function(a,b){return function(){return b.isSupported()}})};Pusher.StrategyBuilder={build:function(a,b){var c=Pusher.Util.extend({},e,b);return d(a,c)[1].strategy}}}).call(this);
(function(){Pusher.Protocol={decodeMessage:function(b){try{var c=JSON.parse(b.data);if("string"===typeof c.data)try{c.data=JSON.parse(c.data)}catch(a){if(!(a instanceof SyntaxError))throw a;}return c}catch(d){throw{type:"MessageParseError",error:d,data:b.data};}},encodeMessage:function(b){return JSON.stringify(b)},processHandshake:function(b){b=this.decodeMessage(b);if("pusher:connection_established"===b.event){if(!b.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",
id:b.data.socket_id,activityTimeout:1E3*b.data.activity_timeout}}if("pusher:error"===b.event)return{action:this.getCloseAction(b.data),error:this.getCloseError(b.data)};throw"Invalid handshake";},getCloseAction:function(b){return 4E3>b.code?1002<=b.code&&1004>=b.code?"backoff":null:4E3===b.code?"ssl_only":4100>b.code?"refused":4200>b.code?"backoff":4300>b.code?"retry":"refused"},getCloseError:function(b){return 1E3!==b.code&&1001!==b.code?{type:"PusherError",data:{code:b.code,message:b.reason||b.message}}:
null}}}).call(this);
(function(){function b(a,b){Pusher.EventsDispatcher.call(this);this.id=a;this.transport=b;this.activityTimeout=b.activityTimeout;this.bindListeners()}var c=b.prototype;Pusher.Util.extend(c,Pusher.EventsDispatcher.prototype);c.handlesActivityChecks=function(){return this.transport.handlesActivityChecks()};c.send=function(a){return this.transport.send(a)};c.send_event=function(a,b,c){a={event:a,data:b};c&&(a.channel=c);Pusher.debug("Event sent",a);return this.send(Pusher.Protocol.encodeMessage(a))};c.ping=
function(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})};c.close=function(){this.transport.close()};c.bindListeners=function(){var a=this,b={message:function(b){var c;try{c=Pusher.Protocol.decodeMessage(b)}catch(d){a.emit("error",{type:"MessageParseError",error:d,data:b.data})}if(void 0!==c){Pusher.debug("Event recd",c);switch(c.event){case "pusher:error":a.emit("error",{type:"PusherError",data:c.data});break;case "pusher:ping":a.emit("ping");break;case "pusher:pong":a.emit("pong")}a.emit("message",
c)}},activity:function(){a.emit("activity")},error:function(b){a.emit("error",{type:"WebSocketError",error:b})},closed:function(b){c();b&&b.code&&a.handleCloseEvent(b);a.transport=null;a.emit("closed")}},c=function(){Pusher.Util.objectApply(b,function(b,c){a.transport.unbind(c,b)})};Pusher.Util.objectApply(b,function(b,c){a.transport.bind(c,b)})};c.handleCloseEvent=function(a){var b=Pusher.Protocol.getCloseAction(a);(a=Pusher.Protocol.getCloseError(a))&&this.emit("error",a);b&&this.emit(b)};Pusher.Connection=
b}).call(this);
(function(){function b(a,b){this.transport=a;this.callback=b;this.bindListeners()}var c=b.prototype;c.close=function(){this.unbindListeners();this.transport.close()};c.bindListeners=function(){var a=this;a.onMessage=function(b){a.unbindListeners();try{var c=Pusher.Protocol.processHandshake(b);"connected"===c.action?a.finish("connected",{connection:new Pusher.Connection(c.id,a.transport),activityTimeout:c.activityTimeout}):(a.finish(c.action,{error:c.error}),a.transport.close())}catch(g){a.finish("error",{error:g}),
a.transport.close()}};a.onClosed=function(b){a.unbindListeners();var c=Pusher.Protocol.getCloseAction(b)||"backoff";b=Pusher.Protocol.getCloseError(b);a.finish(c,{error:b})};a.transport.bind("message",a.onMessage);a.transport.bind("closed",a.onClosed)};c.unbindListeners=function(){this.transport.unbind("message",this.onMessage);this.transport.unbind("closed",this.onClosed)};c.finish=function(a,b){this.callback(Pusher.Util.extend({transport:this.transport,action:a},b))};Pusher.Handshake=b}).call(this);
(function(){function b(a,b){Pusher.EventsDispatcher.call(this);this.key=a;this.options=b||{};this.state="initialized";this.connection=null;this.encrypted=!!b.encrypted;this.timeline=this.options.timeline;this.connectionCallbacks=this.buildConnectionCallbacks();this.errorCallbacks=this.buildErrorCallbacks();this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var c=this;Pusher.Network.bind("online",function(){c.timeline.info({netinfo:"online"});("connecting"===c.state||"unavailable"===
c.state)&&c.retryIn(0)});Pusher.Network.bind("offline",function(){c.timeline.info({netinfo:"offline"});c.connection&&c.sendActivityCheck()});this.updateStrategy()}var c=b.prototype;Pusher.Util.extend(c,Pusher.EventsDispatcher.prototype);c.connect=function(){!this.connection&&!this.runner&&(this.strategy.isSupported()?(this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()):this.updateState("failed"))};c.send=function(a){return this.connection?this.connection.send(a):!1};
c.send_event=function(a,b,c){return this.connection?this.connection.send_event(a,b,c):!1};c.disconnect=function(){this.disconnectInternally();this.updateState("disconnected")};c.isEncrypted=function(){return this.encrypted};c.startConnecting=function(){var a=this,b=function(c,g){c?a.runner=a.strategy.connect(0,b):"error"===g.action?(a.emit("error",{type:"HandshakeError",error:g.error}),a.timeline.error({handshakeError:g.error})):(a.abortConnecting(),a.handshakeCallbacks[g.action](g))};a.runner=a.strategy.connect(0,
b)};c.abortConnecting=function(){this.runner&&(this.runner.abort(),this.runner=null)};c.disconnectInternally=function(){this.abortConnecting();this.clearRetryTimer();this.clearUnavailableTimer();this.connection&&this.abandonConnection().close()};c.updateStrategy=function(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,encrypted:this.encrypted})};c.retryIn=function(a){var b=this;b.timeline.info({action:"retry",delay:a});0<a&&b.emit("connecting_in",Math.round(a/1E3));b.retryTimer=
new Pusher.Timer(a||0,function(){b.disconnectInternally();b.connect()})};c.clearRetryTimer=function(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)};c.setUnavailableTimer=function(){var a=this;a.unavailableTimer=new Pusher.Timer(a.options.unavailableTimeout,function(){a.updateState("unavailable")})};c.clearUnavailableTimer=function(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()};c.sendActivityCheck=function(){var a=this;a.stopActivityCheck();a.connection.ping();
a.activityTimer=new Pusher.Timer(a.options.pongTimeout,function(){a.timeline.error({pong_timed_out:a.options.pongTimeout});a.retryIn(0)})};c.resetActivityCheck=function(){var a=this;a.stopActivityCheck();a.connection.handlesActivityChecks()||(a.activityTimer=new Pusher.Timer(a.activityTimeout,function(){a.sendActivityCheck()}))};c.stopActivityCheck=function(){this.activityTimer&&this.activityTimer.ensureAborted()};c.buildConnectionCallbacks=function(){var a=this;return{message:function(b){a.resetActivityCheck();
a.emit("message",b)},ping:function(){a.send_event("pusher:pong",{})},activity:function(){a.resetActivityCheck()},error:function(b){a.emit("error",{type:"WebSocketError",error:b})},closed:function(){a.abandonConnection();a.shouldRetry()&&a.retryIn(1E3)}}};c.buildHandshakeCallbacks=function(a){var b=this;return Pusher.Util.extend({},a,{connected:function(a){b.activityTimeout=Math.min(b.options.activityTimeout,a.activityTimeout,a.connection.activityTimeout||Infinity);b.clearUnavailableTimer();b.setConnection(a.connection);
b.socket_id=b.connection.id;b.updateState("connected",{socket_id:b.socket_id})}})};c.buildErrorCallbacks=function(){function a(a){return function(c){c.error&&b.emit("error",{type:"WebSocketError",error:c.error});a(c)}}var b=this;return{ssl_only:a(function(){b.encrypted=!0;b.updateStrategy();b.retryIn(0)}),refused:a(function(){b.disconnect()}),backoff:a(function(){b.retryIn(1E3)}),retry:a(function(){b.retryIn(0)})}};c.setConnection=function(a){this.connection=a;for(var b in this.connectionCallbacks)this.connection.bind(b,
this.connectionCallbacks[b]);this.resetActivityCheck()};c.abandonConnection=function(){if(this.connection){this.stopActivityCheck();for(var a in this.connectionCallbacks)this.connection.unbind(a,this.connectionCallbacks[a]);a=this.connection;this.connection=null;return a}};c.updateState=function(a,b){var c=this.state;this.state=a;c!==a&&(Pusher.debug("State changed",c+" -> "+a),this.timeline.info({state:a,params:b}),this.emit("state_change",{previous:c,current:a}),this.emit(a,b))};c.shouldRetry=function(){return"connecting"===
this.state||"connected"===this.state};Pusher.ConnectionManager=b}).call(this);
(function(){function b(){Pusher.EventsDispatcher.call(this);var b=this;void 0!==window.addEventListener&&(window.addEventListener("online",function(){b.emit("online")},!1),window.addEventListener("offline",function(){b.emit("offline")},!1))}Pusher.Util.extend(b.prototype,Pusher.EventsDispatcher.prototype);b.prototype.isOnline=function(){return void 0===window.navigator.onLine?!0:window.navigator.onLine};Pusher.NetInfo=b;Pusher.Network=new b}).call(this);
(function(){function b(){this.reset()}var c=b.prototype;c.get=function(a){return Object.prototype.hasOwnProperty.call(this.members,a)?{id:a,info:this.members[a]}:null};c.each=function(a){var b=this;Pusher.Util.objectApply(b.members,function(c,g){a(b.get(g))})};c.setMyID=function(a){this.myID=a};c.onSubscription=function(a){this.members=a.presence.hash;this.count=a.presence.count;this.me=this.get(this.myID)};c.addMember=function(a){null===this.get(a.user_id)&&this.count++;this.members[a.user_id]=a.user_info;
return this.get(a.user_id)};c.removeMember=function(a){var b=this.get(a.user_id);b&&(delete this.members[a.user_id],this.count--);return b};c.reset=function(){this.members={};this.count=0;this.me=this.myID=null};Pusher.Members=b}).call(this);
(function(){function b(a,b){Pusher.EventsDispatcher.call(this,function(b,c){Pusher.debug("No callbacks on "+a+" for "+b)});this.name=a;this.pusher=b;this.subscribed=!1}var c=b.prototype;Pusher.Util.extend(c,Pusher.EventsDispatcher.prototype);c.authorize=function(a,b){return b(!1,{})};c.trigger=function(a,b){if(0!==a.indexOf("client-"))throw new Pusher.Errors.BadEventName("Event '"+a+"' does not start with 'client-'");return this.pusher.send_event(a,b,this.name)};c.disconnect=function(){this.subscribed=
!1};c.handleEvent=function(a,b){0===a.indexOf("pusher_internal:")?"pusher_internal:subscription_succeeded"===a&&(this.subscribed=!0,this.emit("pusher:subscription_succeeded",b)):this.emit(a,b)};c.subscribe=function(){var a=this;a.authorize(a.pusher.connection.socket_id,function(b,c){b?a.handleEvent("pusher:subscription_error",c):a.pusher.send_event("pusher:subscribe",{auth:c.auth,channel_data:c.channel_data,channel:a.name})})};c.unsubscribe=function(){this.pusher.send_event("pusher:unsubscribe",{channel:this.name})};
Pusher.Channel=b}).call(this);(function(){function b(a,b){Pusher.Channel.call(this,a,b)}var c=b.prototype;Pusher.Util.extend(c,Pusher.Channel.prototype);c.authorize=function(a,b){return(new Pusher.Channel.Authorizer(this,this.pusher.config)).authorize(a,b)};Pusher.PrivateChannel=b}).call(this);
(function(){function b(a,b){Pusher.PrivateChannel.call(this,a,b);this.members=new Pusher.Members}var c=b.prototype;Pusher.Util.extend(c,Pusher.PrivateChannel.prototype);c.authorize=function(a,b){var c=this;Pusher.PrivateChannel.prototype.authorize.call(c,a,function(a,e){if(!a){if(void 0===e.channel_data){Pusher.warn("Invalid auth response for channel '"+c.name+"', expected 'channel_data' field");b("Invalid auth response");return}var f=JSON.parse(e.channel_data);c.members.setMyID(f.user_id)}b(a,e)})};
c.handleEvent=function(a,b){switch(a){case "pusher_internal:subscription_succeeded":this.members.onSubscription(b);this.subscribed=!0;this.emit("pusher:subscription_succeeded",this.members);break;case "pusher_internal:member_added":var c=this.members.addMember(b);this.emit("pusher:member_added",c);break;case "pusher_internal:member_removed":(c=this.members.removeMember(b))&&this.emit("pusher:member_removed",c);break;default:Pusher.PrivateChannel.prototype.handleEvent.call(this,a,b)}};c.disconnect=
function(){this.members.reset();Pusher.PrivateChannel.prototype.disconnect.call(this)};Pusher.PresenceChannel=b}).call(this);
(function(){function b(){this.channels={}}var c=b.prototype;c.add=function(a,b){if(!this.channels[a]){var c=this.channels,g;g=0===a.indexOf("private-")?new Pusher.PrivateChannel(a,b):0===a.indexOf("presence-")?new Pusher.PresenceChannel(a,b):new Pusher.Channel(a,b);c[a]=g}return this.channels[a]};c.all=function(a){return Pusher.Util.values(this.channels)};c.find=function(a){return this.channels[a]};c.remove=function(a){var b=this.channels[a];delete this.channels[a];return b};c.disconnect=function(){Pusher.Util.objectApply(this.channels,
function(a){a.disconnect()})};Pusher.Channels=b}).call(this);
(function(){Pusher.Channel.Authorizer=function(b,a){this.channel=b;this.type=a.authTransport;this.options=a;this.authOptions=(a||{}).auth||{}};Pusher.Channel.Authorizer.prototype={composeQuery:function(b){b="socket_id="+encodeURIComponent(b)+"&channel_name="+encodeURIComponent(this.channel.name);for(var a in this.authOptions.params)b+="&"+encodeURIComponent(a)+"="+encodeURIComponent(this.authOptions.params[a]);return b},authorize:function(b,a){return Pusher.authorizers[this.type].call(this,b,a)}};
var b=1;Pusher.auth_callbacks={};Pusher.authorizers={ajax:function(b,a){var d;d=Pusher.XHR?new Pusher.XHR:window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");d.open("POST",this.options.authEndpoint,!0);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var h in this.authOptions.headers)d.setRequestHeader(h,this.authOptions.headers[h]);d.onreadystatechange=function(){if(4===d.readyState)if(200===d.status){var b,c=!1;try{b=JSON.parse(d.responseText),
c=!0}catch(f){a(!0,"JSON returned from webapp was invalid, yet status code was 200. Data was: "+d.responseText)}c&&a(!1,b)}else Pusher.warn("Couldn't get auth info from your webapp",d.status),a(!0,d.status)};d.send(this.composeQuery(b));return d},jsonp:function(c,a){void 0!==this.authOptions.headers&&Pusher.warn("Warn","To send headers with the auth request, you must use AJAX, rather than JSONP.");var d=b.toString();b++;var h=Pusher.Util.getDocument(),g=h.createElement("script");Pusher.auth_callbacks[d]=
function(b){a(!1,b)};g.src=this.options.authEndpoint+"?callback="+encodeURIComponent("Pusher.auth_callbacks['"+d+"']")+"&"+this.composeQuery(c);d=h.getElementsByTagName("head")[0]||h.documentElement;d.insertBefore(g,d.firstChild)}}}).call(this);
;
;
/*! nprogress.js */ 
;
;
/*! NProgress (c) 2013, Rico Sta. Cruz
*  http://ricostacruz.com/nprogress */
;(function(factory) {
if (typeof module === 'function') {
module.exports = factory(this.jQuery || require('jquery'));
} else {
this.NProgress = factory(this.jQuery);
}
})(function($) {
var NProgress = {};
NProgress.version = '0.1.2';
var Settings = NProgress.settings = {
minimum: 0.08,
easing: 'ease',
positionUsing: '',
speed: 200,
trickle: true,
trickleRate: 0.02,
trickleSpeed: 800,
showSpinner: true,
template: '<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'
};
/**
* Updates configuration.
*
*     NProgress.configure({
*       minimum: 0.1
*     });
*/
NProgress.configure = function(options) {
$.extend(Settings, options);
return this;
};
/**
* Last number.
*/
NProgress.status = null;
/**
* Sets the progress bar status, where `n` is a number from `0.0` to `1.0`.
*
*     NProgress.set(0.4);
*     NProgress.set(1.0);
*/
NProgress.set = function(n) {
var started = NProgress.isStarted();
n = clamp(n, Settings.minimum, 1);
NProgress.status = (n === 1 ? null : n);
var $progress = NProgress.render(!started),
$bar      = $progress.find('[role="bar"]'),
speed     = Settings.speed,
ease      = Settings.easing;
$progress[0].offsetWidth; /* Repaint */
$progress.queue(function(next) {
if (Settings.positionUsing === '') Settings.positionUsing = NProgress.getPositioningCSS();
$bar.css(barPositionCSS(n, speed, ease));
if (n === 1) {
$progress.css({ transition: 'none', opacity: 1 });
$progress[0].offsetWidth; /* Repaint */
setTimeout(function() {
$progress.css({ transition: 'all '+speed+'ms linear', opacity: 0 });
setTimeout(function() {
NProgress.remove();
next();
}, speed);
}, speed);
} else {
setTimeout(next, speed * 0.9);
}
});
return this;
};
NProgress.isStarted = function() {
return typeof NProgress.status === 'number';
};
/**
* Shows the progress bar.
* This is the same as setting the status to 0%, except that it doesn't go backwards.
*
*     NProgress.start();
*
*/
NProgress.start = function() {
if (!NProgress.status) NProgress.set(0);
var work = function() {
setTimeout(function() {
if (!NProgress.status) return;
NProgress.trickle();
work();
}, Settings.trickleSpeed);
};
if (Settings.trickle) work();
return this;
};
/**
* Hides the progress bar.
* This is the *sort of* the same as setting the status to 100%, with the
* difference being `done()` makes some placebo effect of some realistic motion.
*
*     NProgress.done();
*
* If `true` is passed, it will show the progress bar even if its hidden.
*
*     NProgress.done(true);
*/
NProgress.done = function(force) {
if (!force && !NProgress.status) return this;
var started = NProgress.isStarted();
var $progress = NProgress.render(!started);
$progress.clearQueue();
return NProgress.inc(0.3 + 0.5 * Math.random()).set(1);
};
/**
* Increments by a random amount.
*/
NProgress.inc = function(amount) {
var n = NProgress.status;
if (!n) {
return NProgress.start();
} else {
if (typeof amount !== 'number') {
amount = (1 - n) * clamp(Math.random() * n, 0.1, 0.95);
}
n = clamp(n + amount, 0, 0.994);
return NProgress.set(n);
}
};
NProgress.trickle = function() {
return NProgress.inc(Math.random() * Settings.trickleRate);
};
/**
* (Internal) renders the progress bar markup based on the `template`
* setting.
*/
NProgress.render = function(fromStart) {
if (NProgress.isRendered()) return $("#nprogress");
$('html').addClass('nprogress-busy');
var $el = $("<div id='nprogress'>")
.html(Settings.template);
var perc = fromStart ? '-100' : toBarPerc(NProgress.status || 0);
$el.find('[role="bar"]').css({
transition: 'all 0 linear',
transform: 'translate3d('+perc+'%,0,0)'
});
if (!Settings.showSpinner)
$el.find('[role="spinner"]').remove();
$el.appendTo(document.body);
return $el;
};
/**
* Removes the element. Opposite of render().
*/
NProgress.remove = function() {
$('html').removeClass('nprogress-busy');
$('#nprogress').remove();
};
/**
* Checks if the progress bar is rendered.
*/
NProgress.isRendered = function() {
return ($("#nprogress").length > 0);
};
/**
* Determine which positioning CSS rule to use.
*/
NProgress.getPositioningCSS = function() {
var bodyStyle = document.body.style;
var vendorPrefix = ('WebkitTransform' in bodyStyle) ? 'Webkit' :
('MozTransform' in bodyStyle) ? 'Moz' :
('msTransform' in bodyStyle) ? 'ms' :
('OTransform' in bodyStyle) ? 'O' : '';
if (vendorPrefix + 'Perspective' in bodyStyle) {
return 'translate3d';
} else if (vendorPrefix + 'Transform' in bodyStyle) {
return 'translate';
} else {
return 'margin';
}
};
/**
* Helpers
*/
function clamp(n, min, max) {
if (n < min) return min;
if (n > max) return max;
return n;
}
/**
* (Internal) converts a percentage (`0..1`) to a bar translateX
* percentage (`-100%..0%`).
*/
function toBarPerc(n) {
return (-1 + n) * 100;
}
/**
* (Internal) returns the correct CSS for changing the bar's
* position given an n percentage, and speed and ease from Settings
*/
function barPositionCSS(n, speed, ease) {
var barCSS;
if (Settings.positionUsing === 'translate3d') {
barCSS = { transform: 'translate3d('+toBarPerc(n)+'%,0,0)' };
} else if (Settings.positionUsing === 'translate') {
barCSS = { transform: 'translate('+toBarPerc(n)+'%,0)' };
} else {
barCSS = { 'margin-left': toBarPerc(n)+'%' };
}
barCSS.transition = 'all '+speed+'ms '+ease;
return barCSS;
}
return NProgress;
});
;
;
/*! filesize.min.js */ 
;
;
/*
2013 Jason Mulligan
@license BSD-3 <https://raw.github.com/avoidwork/filesize.js/master/LICENSE>
@link http://filesizejs.com
@module filesize
@version 2.0.0
*/
(function(r){function f(f,c){var b="",g=!1,l=6,a,h,q,d,m,n,p,e,k;if(isNaN(f))throw Error("Invalid arguments");c=c||{};h=!0===c.bits;e=!0===c.unix;a=void 0!==c.base?c.base:e?2:10;m=void 0!==c.round?c.round:e?1:2;k=void 0!==c.spacer?c.spacer:e?"":" ";d=Number(f);(q=0>d)&&(d=-d);if(0===d)b=e?"0":"0"+k+"B";else for(p=s[a][h?"bits":"bytes"];l--;)if(n=p[l][1],a=p[l][0],d>=n){t.test(a)&&(g=!0,m=0);b=(d/n).toFixed(m);!g&&e?(h&&u.test(a)&&(a=a.toLowerCase()),a=a.charAt(0),g=v.exec(b),h||"k"!==a||(a="K"),null!==
g&&void 0!==g[1]&&w.test(g[1])&&(b=parseInt(b,x)),b+=k+a):e||(b+=k+a);break}q&&(b="-"+b);return b}var u=/b$/,t=/^B$/,x=10,v=/\.(.*)/,w=/^0$/,s={2:{bits:[["B",1],["kb",128],["Mb",131072],["Gb",134217728],["Tb",137438953472],["Pb",0x800000000000]],bytes:[["B",1],["kB",1024],["MB",1048576],["GB",1073741824],["TB",1099511627776],["PB",0x4000000000000]]},10:{bits:[["B",1],["kb",125],["Mb",125E3],["Gb",125E6],["Tb",125E9],["Pb",125E12]],bytes:[["B",1],["kB",1E3],["MB",1E6],["GB",1E9],["TB",1E12],["PB",
1E15]]}};"undefined"!==typeof exports?module.exports=f:"function"===typeof define?define(function(){return f}):r.filesize=f})(this);

;
;
/*! jquery.mousewheel.js */ 
;
;
/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)
* Licensed under the MIT License (LICENSE.txt).
*
* Version: 3.1.6
*
* Requires: jQuery 1.2.2+
*/
(function (factory) {
if ( typeof define === 'function' && define.amd ) {
define(['jquery'], factory);
} else if (typeof exports === 'object') {
module.exports = factory;
} else {
factory(jQuery);
}
}(function ($) {
var toFix  = ['wheel', 'mousewheel', 'DOMMouseScroll', 'MozMousePixelScroll'],
toBind = ( 'onwheel' in document || document.documentMode >= 9 ) ?
['wheel'] : ['mousewheel', 'DomMouseScroll', 'MozMousePixelScroll'],
slice  = Array.prototype.slice,
nullLowestDeltaTimeout, lowestDelta;
if ( $.event.fixHooks ) {
for ( var i = toFix.length; i; ) {
$.event.fixHooks[ toFix[--i] ] = $.event.mouseHooks;
}
}
$.event.special.mousewheel = {
version: '3.1.6',
setup: function() {
if ( this.addEventListener ) {
for ( var i = toBind.length; i; ) {
this.addEventListener( toBind[--i], handler, false );
}
} else {
this.onmousewheel = handler;
}
},
teardown: function() {
if ( this.removeEventListener ) {
for ( var i = toBind.length; i; ) {
this.removeEventListener( toBind[--i], handler, false );
}
} else {
this.onmousewheel = null;
}
}
};
$.fn.extend({
mousewheel: function(fn) {
return fn ? this.bind('mousewheel', fn) : this.trigger('mousewheel');
},
unmousewheel: function(fn) {
return this.unbind('mousewheel', fn);
}
});
function handler(event) {
var orgEvent   = event || window.event,
args       = slice.call(arguments, 1),
delta      = 0,
deltaX     = 0,
deltaY     = 0,
absDelta   = 0;
event = $.event.fix(orgEvent);
event.type = 'mousewheel';
if ( 'detail'      in orgEvent ) { deltaY = orgEvent.detail * -1;      }
if ( 'wheelDelta'  in orgEvent ) { deltaY = orgEvent.wheelDelta;       }
if ( 'wheelDeltaY' in orgEvent ) { deltaY = orgEvent.wheelDeltaY;      }
if ( 'wheelDeltaX' in orgEvent ) { deltaX = orgEvent.wheelDeltaX * -1; }
if ( 'axis' in orgEvent && orgEvent.axis === orgEvent.HORIZONTAL_AXIS ) {
deltaX = deltaY * -1;
deltaY = 0;
}
delta = deltaY === 0 ? deltaX : deltaY;
if ( 'deltaY' in orgEvent ) {
deltaY = orgEvent.deltaY * -1;
delta  = deltaY;
}
if ( 'deltaX' in orgEvent ) {
deltaX = orgEvent.deltaX;
if ( deltaY === 0 ) { delta  = deltaX * -1; }
}
if ( deltaY === 0 && deltaX === 0 ) { return; }
absDelta = Math.max( Math.abs(deltaY), Math.abs(deltaX) );
if ( !lowestDelta || absDelta < lowestDelta ) {
lowestDelta = absDelta;
}
delta  = Math[ delta  >= 1 ? 'floor' : 'ceil' ](delta  / lowestDelta);
deltaX = Math[ deltaX >= 1 ? 'floor' : 'ceil' ](deltaX / lowestDelta);
deltaY = Math[ deltaY >= 1 ? 'floor' : 'ceil' ](deltaY / lowestDelta);
event.deltaX = deltaX;
event.deltaY = deltaY;
event.deltaFactor = lowestDelta;
args.unshift(event, delta, deltaX, deltaY);
if (nullLowestDeltaTimeout) { clearTimeout(nullLowestDeltaTimeout); }
nullLowestDeltaTimeout = setTimeout(nullLowestDelta, 200);
return ($.event.dispatch || $.event.handle).apply(this, args);
}
function nullLowestDelta() {
lowestDelta = null;
}
}));
;
;
/*! jquery.specialscroll.js */ 
;
;
/*
James Padolsey
Special scroll events for jQuery
Found here: http://james.padolsey.com/javascript/special-scroll-events-for-jquery/
*/
(function(){
var special = jQuery.event.special,
uid1 = 'D' + (+new Date()),
uid2 = 'D' + (+new Date() + 1);
special.scrollstart = {
setup: function() {
var timer,
handler =  function(evt) {
var _self = this,
_args = arguments;
if (timer) {
clearTimeout(timer);
} else {
evt.type = 'scrollstart';
jQuery.event.handle.apply(_self, _args);
}
timer = setTimeout( function(){
timer = null;
}, special.scrollstop.latency);
};
jQuery(this).bind('scroll', handler).data(uid1, handler);
},
teardown: function(){
jQuery(this).unbind( 'scroll', jQuery(this).data(uid1) );
}
};
special.scrollstop = {
latency: 300,
setup: function() {
var timer,
handler = function(evt) {
var _self = this,
_args = arguments;
if (timer) {
clearTimeout(timer);
}
timer = setTimeout( function(){
timer = null;
evt.type = 'scrollstop';
jQuery.event.handle.apply(_self, _args);
}, special.scrollstop.latency);
};
jQuery(this).bind('scroll', handler).data(uid2, handler);
},
teardown: function() {
jQuery(this).unbind( 'scroll', jQuery(this).data(uid2) );
}
};
})();
;
;
/*! jquery.cookie.js */ 
;
;
/*!
* jQuery Cookie Plugin v1.4.0
* https://github.com/carhartl/jquery-cookie
*
* Copyright 2013 Klaus Hartl
* Released under the MIT license
*/
(function (factory) {
if (typeof define === 'function' && define.amd) {
define(['jquery'], factory);
} else {
factory(jQuery);
}
}(function ($) {
var pluses = /\+/g;
function encode(s) {
return config.raw ? s : encodeURIComponent(s);
}
function decode(s) {
return config.raw ? s : decodeURIComponent(s);
}
function stringifyCookieValue(value) {
return encode(config.json ? JSON.stringify(value) : String(value));
}
function parseCookieValue(s) {
if (s.indexOf('"') === 0) {
s = s.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, '\\');
}
try {
s = decodeURIComponent(s.replace(pluses, ' '));
return config.json ? JSON.parse(s) : s;
} catch(e) {}
}
function read(s, converter) {
var value = config.raw ? s : parseCookieValue(s);
return $.isFunction(converter) ? converter(value) : value;
}
var config = $.cookie = function (key, value, options) {
if (value !== undefined && !$.isFunction(value)) {
options = $.extend({}, config.defaults, options);
if (typeof options.expires === 'number') {
var days = options.expires, t = options.expires = new Date();
t.setTime(+t + days * 864e+5);
}
return (document.cookie = [
encode(key), '=', stringifyCookieValue(value),
options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
options.path    ? '; path=' + options.path : '',
options.domain  ? '; domain=' + options.domain : '',
options.secure  ? '; secure' : ''
].join(''));
}
var result = key ? undefined : {};
var cookies = document.cookie ? document.cookie.split('; ') : [];
for (var i = 0, l = cookies.length; i < l; i++) {
var parts = cookies[i].split('=');
var name = decode(parts.shift());
var cookie = parts.join('=');
if (key && key === name) {
result = read(cookie, value);
break;
}
if (!key && (cookie = read(cookie)) !== undefined) {
result[name] = cookie;
}
}
return result;
};
config.defaults = {};
$.removeCookie = function (key, options) {
if ($.cookie(key) === undefined) {
return false;
}
$.cookie(key, '', $.extend({}, options, { expires: -1 }));
return !$.cookie(key);
};
}));
;
;
/*! TweenLite.min.js */ 
;
;
/*!
* VERSION: 1.16.1
* DATE: 2015-03-13
* UPDATES AND DOCS AT: http://greensock.com
*
* @license Copyright (c) 2008-2015, GreenSock. All rights reserved.
* This work is subject to the terms at http://greensock.com/standard-license or for
* Club GreenSock members, the software agreement that was issued with your membership.
* 
* @author: Jack Doyle, jack@greensock.com
*/
(function(t,e){"use strict";var i=t.GreenSockGlobals=t.GreenSockGlobals||t;if(!i.TweenLite){var s,r,n,a,o,l=function(t){var e,s=t.split("."),r=i;for(e=0;s.length>e;e++)r[s[e]]=r=r[s[e]]||{};return r},h=l("com.greensock"),_=1e-10,u=function(t){var e,i=[],s=t.length;for(e=0;e!==s;i.push(t[e++]));return i},m=function(){},f=function(){var t=Object.prototype.toString,e=t.call([]);return function(i){return null!=i&&(i instanceof Array||"object"==typeof i&&!!i.push&&t.call(i)===e)}}(),c={},p=function(s,r,n,a){this.sc=c[s]?c[s].sc:[],c[s]=this,this.gsClass=null,this.func=n;var o=[];this.check=function(h){for(var _,u,m,f,d=r.length,v=d;--d>-1;)(_=c[r[d]]||new p(r[d],[])).gsClass?(o[d]=_.gsClass,v--):h&&_.sc.push(this);if(0===v&&n)for(u=("com.greensock."+s).split("."),m=u.pop(),f=l(u.join("."))[m]=this.gsClass=n.apply(n,o),a&&(i[m]=f,"function"==typeof define&&define.amd?define((t.GreenSockAMDPath?t.GreenSockAMDPath+"/":"")+s.split(".").pop(),[],function(){return f}):s===e&&"undefined"!=typeof module&&module.exports&&(module.exports=f)),d=0;this.sc.length>d;d++)this.sc[d].check()},this.check(!0)},d=t._gsDefine=function(t,e,i,s){return new p(t,e,i,s)},v=h._class=function(t,e,i){return e=e||function(){},d(t,[],function(){return e},i),e};d.globals=i;var g=[0,0,1,1],T=[],y=v("easing.Ease",function(t,e,i,s){this._func=t,this._type=i||0,this._power=s||0,this._params=e?g.concat(e):g},!0),w=y.map={},P=y.register=function(t,e,i,s){for(var r,n,a,o,l=e.split(","),_=l.length,u=(i||"easeIn,easeOut,easeInOut").split(",");--_>-1;)for(n=l[_],r=s?v("easing."+n,null,!0):h.easing[n]||{},a=u.length;--a>-1;)o=u[a],w[n+"."+o]=w[o+n]=r[o]=t.getRatio?t:t[o]||new t};for(n=y.prototype,n._calcEnd=!1,n.getRatio=function(t){if(this._func)return this._params[0]=t,this._func.apply(null,this._params);var e=this._type,i=this._power,s=1===e?1-t:2===e?t:.5>t?2*t:2*(1-t);return 1===i?s*=s:2===i?s*=s*s:3===i?s*=s*s*s:4===i&&(s*=s*s*s*s),1===e?1-s:2===e?s:.5>t?s/2:1-s/2},s=["Linear","Quad","Cubic","Quart","Quint,Strong"],r=s.length;--r>-1;)n=s[r]+",Power"+r,P(new y(null,null,1,r),n,"easeOut",!0),P(new y(null,null,2,r),n,"easeIn"+(0===r?",easeNone":"")),P(new y(null,null,3,r),n,"easeInOut");w.linear=h.easing.Linear.easeIn,w.swing=h.easing.Quad.easeInOut;var b=v("events.EventDispatcher",function(t){this._listeners={},this._eventTarget=t||this});n=b.prototype,n.addEventListener=function(t,e,i,s,r){r=r||0;var n,l,h=this._listeners[t],_=0;for(null==h&&(this._listeners[t]=h=[]),l=h.length;--l>-1;)n=h[l],n.c===e&&n.s===i?h.splice(l,1):0===_&&r>n.pr&&(_=l+1);h.splice(_,0,{c:e,s:i,up:s,pr:r}),this!==a||o||a.wake()},n.removeEventListener=function(t,e){var i,s=this._listeners[t];if(s)for(i=s.length;--i>-1;)if(s[i].c===e)return s.splice(i,1),void 0},n.dispatchEvent=function(t){var e,i,s,r=this._listeners[t];if(r)for(e=r.length,i=this._eventTarget;--e>-1;)s=r[e],s&&(s.up?s.c.call(s.s||i,{type:t,target:i}):s.c.call(s.s||i))};var k=t.requestAnimationFrame,S=t.cancelAnimationFrame,A=Date.now||function(){return(new Date).getTime()},x=A();for(s=["ms","moz","webkit","o"],r=s.length;--r>-1&&!k;)k=t[s[r]+"RequestAnimationFrame"],S=t[s[r]+"CancelAnimationFrame"]||t[s[r]+"CancelRequestAnimationFrame"];v("Ticker",function(t,e){var i,s,r,n,l,h=this,u=A(),f=e!==!1&&k,c=500,p=33,d="tick",v=function(t){var e,a,o=A()-x;o>c&&(u+=o-p),x+=o,h.time=(x-u)/1e3,e=h.time-l,(!i||e>0||t===!0)&&(h.frame++,l+=e+(e>=n?.004:n-e),a=!0),t!==!0&&(r=s(v)),a&&h.dispatchEvent(d)};b.call(h),h.time=h.frame=0,h.tick=function(){v(!0)},h.lagSmoothing=function(t,e){c=t||1/_,p=Math.min(e,c,0)},h.sleep=function(){null!=r&&(f&&S?S(r):clearTimeout(r),s=m,r=null,h===a&&(o=!1))},h.wake=function(){null!==r?h.sleep():h.frame>10&&(x=A()-c+5),s=0===i?m:f&&k?k:function(t){return setTimeout(t,0|1e3*(l-h.time)+1)},h===a&&(o=!0),v(2)},h.fps=function(t){return arguments.length?(i=t,n=1/(i||60),l=this.time+n,h.wake(),void 0):i},h.useRAF=function(t){return arguments.length?(h.sleep(),f=t,h.fps(i),void 0):f},h.fps(t),setTimeout(function(){f&&5>h.frame&&h.useRAF(!1)},1500)}),n=h.Ticker.prototype=new h.events.EventDispatcher,n.constructor=h.Ticker;var R=v("core.Animation",function(t,e){if(this.vars=e=e||{},this._duration=this._totalDuration=t||0,this._delay=Number(e.delay)||0,this._timeScale=1,this._active=e.immediateRender===!0,this.data=e.data,this._reversed=e.reversed===!0,B){o||a.wake();var i=this.vars.useFrames?q:B;i.add(this,i._time),this.vars.paused&&this.paused(!0)}});a=R.ticker=new h.Ticker,n=R.prototype,n._dirty=n._gc=n._initted=n._paused=!1,n._totalTime=n._time=0,n._rawPrevTime=-1,n._next=n._last=n._onUpdate=n._timeline=n.timeline=null,n._paused=!1;var C=function(){o&&A()-x>2e3&&a.wake(),setTimeout(C,2e3)};C(),n.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},n.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},n.resume=function(t,e){return null!=t&&this.seek(t,e),this.paused(!1)},n.seek=function(t,e){return this.totalTime(Number(t),e!==!1)},n.restart=function(t,e){return this.reversed(!1).paused(!1).totalTime(t?-this._delay:0,e!==!1,!0)},n.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},n.render=function(){},n.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,(this._gc||!this.timeline)&&this._enabled(!0),this},n.isActive=function(){var t,e=this._timeline,i=this._startTime;return!e||!this._gc&&!this._paused&&e.isActive()&&(t=e.rawTime())>=i&&i+this.totalDuration()/this._timeScale>t},n._enabled=function(t,e){return o||a.wake(),this._gc=!t,this._active=this.isActive(),e!==!0&&(t&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!t&&this.timeline&&this._timeline._remove(this,!0)),!1},n._kill=function(){return this._enabled(!1,!1)},n.kill=function(t,e){return this._kill(t,e),this},n._uncache=function(t){for(var e=t?this:this.timeline;e;)e._dirty=!0,e=e.timeline;return this},n._swapSelfInParams=function(t){for(var e=t.length,i=t.concat();--e>-1;)"{self}"===t[e]&&(i[e]=this);return i},n.eventCallback=function(t,e,i,s){if("on"===(t||"").substr(0,2)){var r=this.vars;if(1===arguments.length)return r[t];null==e?delete r[t]:(r[t]=e,r[t+"Params"]=f(i)&&-1!==i.join("").indexOf("{self}")?this._swapSelfInParams(i):i,r[t+"Scope"]=s),"onUpdate"===t&&(this._onUpdate=e)}return this},n.delay=function(t){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+t-this._delay),this._delay=t,this):this._delay},n.duration=function(t){return arguments.length?(this._duration=this._totalDuration=t,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==t&&this.totalTime(this._totalTime*(t/this._duration),!0),this):(this._dirty=!1,this._duration)},n.totalDuration=function(t){return this._dirty=!1,arguments.length?this.duration(t):this._totalDuration},n.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(t>this._duration?this._duration:t,e)):this._time},n.totalTime=function(t,e,i){if(o||a.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>t&&!i&&(t+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var s=this._totalDuration,r=this._timeline;if(t>s&&!i&&(t=s),this._startTime=(this._paused?this._pauseTime:r._time)-(this._reversed?s-t:t)/this._timeScale,r._dirty||this._uncache(!1),r._timeline)for(;r._timeline;)r._timeline._time!==(r._startTime+r._totalTime)/r._timeScale&&r.totalTime(r._totalTime,!0),r=r._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==t||0===this._duration)&&(this.render(t,e,!1),z.length&&$())}return this},n.progress=n.totalProgress=function(t,e){return arguments.length?this.totalTime(this.duration()*t,e):this._time/this.duration()},n.startTime=function(t){return arguments.length?(t!==this._startTime&&(this._startTime=t,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,t-this._delay)),this):this._startTime},n.endTime=function(t){return this._startTime+(0!=t?this.totalDuration():this.duration())/this._timeScale},n.timeScale=function(t){if(!arguments.length)return this._timeScale;if(t=t||_,this._timeline&&this._timeline.smoothChildTiming){var e=this._pauseTime,i=e||0===e?e:this._timeline.totalTime();this._startTime=i-(i-this._startTime)*this._timeScale/t}return this._timeScale=t,this._uncache(!1)},n.reversed=function(t){return arguments.length?(t!=this._reversed&&(this._reversed=t,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},n.paused=function(t){if(!arguments.length)return this._paused;var e,i,s=this._timeline;return t!=this._paused&&s&&(o||t||a.wake(),e=s.rawTime(),i=e-this._pauseTime,!t&&s.smoothChildTiming&&(this._startTime+=i,this._uncache(!1)),this._pauseTime=t?e:null,this._paused=t,this._active=this.isActive(),!t&&0!==i&&this._initted&&this.duration()&&this.render(s.smoothChildTiming?this._totalTime:(e-this._startTime)/this._timeScale,!0,!0)),this._gc&&!t&&this._enabled(!0,!1),this};var D=v("core.SimpleTimeline",function(t){R.call(this,0,t),this.autoRemoveChildren=this.smoothChildTiming=!0});n=D.prototype=new R,n.constructor=D,n.kill()._gc=!1,n._first=n._last=n._recent=null,n._sortChildren=!1,n.add=n.insert=function(t,e){var i,s;if(t._startTime=Number(e||0)+t._delay,t._paused&&this!==t._timeline&&(t._pauseTime=t._startTime+(this.rawTime()-t._startTime)/t._timeScale),t.timeline&&t.timeline._remove(t,!0),t.timeline=t._timeline=this,t._gc&&t._enabled(!0,!0),i=this._last,this._sortChildren)for(s=t._startTime;i&&i._startTime>s;)i=i._prev;return i?(t._next=i._next,i._next=t):(t._next=this._first,this._first=t),t._next?t._next._prev=t:this._last=t,t._prev=i,this._recent=t,this._timeline&&this._uncache(!0),this},n._remove=function(t,e){return t.timeline===this&&(e||t._enabled(!1,!0),t._prev?t._prev._next=t._next:this._first===t&&(this._first=t._next),t._next?t._next._prev=t._prev:this._last===t&&(this._last=t._prev),t._next=t._prev=t.timeline=null,t===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},n.render=function(t,e,i){var s,r=this._first;for(this._totalTime=this._time=this._rawPrevTime=t;r;)s=r._next,(r._active||t>=r._startTime&&!r._paused)&&(r._reversed?r.render((r._dirty?r.totalDuration():r._totalDuration)-(t-r._startTime)*r._timeScale,e,i):r.render((t-r._startTime)*r._timeScale,e,i)),r=s},n.rawTime=function(){return o||a.wake(),this._totalTime};var I=v("TweenLite",function(e,i,s){if(R.call(this,i,s),this.render=I.prototype.render,null==e)throw"Cannot tween a null target.";this.target=e="string"!=typeof e?e:I.selector(e)||e;var r,n,a,o=e.jquery||e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType),l=this.vars.overwrite;if(this._overwrite=l=null==l?Q[I.defaultOverwrite]:"number"==typeof l?l>>0:Q[l],(o||e instanceof Array||e.push&&f(e))&&"number"!=typeof e[0])for(this._targets=a=u(e),this._propLookup=[],this._siblings=[],r=0;a.length>r;r++)n=a[r],n?"string"!=typeof n?n.length&&n!==t&&n[0]&&(n[0]===t||n[0].nodeType&&n[0].style&&!n.nodeType)?(a.splice(r--,1),this._targets=a=a.concat(u(n))):(this._siblings[r]=K(n,this,!1),1===l&&this._siblings[r].length>1&&J(n,this,null,1,this._siblings[r])):(n=a[r--]=I.selector(n),"string"==typeof n&&a.splice(r+1,1)):a.splice(r--,1);else this._propLookup={},this._siblings=K(e,this,!1),1===l&&this._siblings.length>1&&J(e,this,null,1,this._siblings);(this.vars.immediateRender||0===i&&0===this._delay&&this.vars.immediateRender!==!1)&&(this._time=-_,this.render(-this._delay))},!0),E=function(e){return e&&e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType)},O=function(t,e){var i,s={};for(i in t)G[i]||i in e&&"transform"!==i&&"x"!==i&&"y"!==i&&"width"!==i&&"height"!==i&&"className"!==i&&"border"!==i||!(!U[i]||U[i]&&U[i]._autoCSS)||(s[i]=t[i],delete t[i]);t.css=s};n=I.prototype=new R,n.constructor=I,n.kill()._gc=!1,n.ratio=0,n._firstPT=n._targets=n._overwrittenProps=n._startAt=null,n._notifyPluginsOfEnabled=n._lazy=!1,I.version="1.16.1",I.defaultEase=n._ease=new y(null,null,1,1),I.defaultOverwrite="auto",I.ticker=a,I.autoSleep=120,I.lagSmoothing=function(t,e){a.lagSmoothing(t,e)},I.selector=t.$||t.jQuery||function(e){var i=t.$||t.jQuery;return i?(I.selector=i,i(e)):"undefined"==typeof document?e:document.querySelectorAll?document.querySelectorAll(e):document.getElementById("#"===e.charAt(0)?e.substr(1):e)};var z=[],L={},N=I._internals={isArray:f,isSelector:E,lazyTweens:z},U=I._plugins={},F=N.tweenLookup={},j=0,G=N.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1},Q={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},q=R._rootFramesTimeline=new D,B=R._rootTimeline=new D,M=30,$=N.lazyRender=function(){var t,e=z.length;for(L={};--e>-1;)t=z[e],t&&t._lazy!==!1&&(t.render(t._lazy[0],t._lazy[1],!0),t._lazy=!1);z.length=0};B._startTime=a.time,q._startTime=a.frame,B._active=q._active=!0,setTimeout($,1),R._updateRoot=I.render=function(){var t,e,i;if(z.length&&$(),B.render((a.time-B._startTime)*B._timeScale,!1,!1),q.render((a.frame-q._startTime)*q._timeScale,!1,!1),z.length&&$(),a.frame>=M){M=a.frame+(parseInt(I.autoSleep,10)||120);for(i in F){for(e=F[i].tweens,t=e.length;--t>-1;)e[t]._gc&&e.splice(t,1);0===e.length&&delete F[i]}if(i=B._first,(!i||i._paused)&&I.autoSleep&&!q._first&&1===a._listeners.tick.length){for(;i&&i._paused;)i=i._next;i||a.sleep()}}},a.addEventListener("tick",R._updateRoot);var K=function(t,e,i){var s,r,n=t._gsTweenID;if(F[n||(t._gsTweenID=n="t"+j++)]||(F[n]={target:t,tweens:[]}),e&&(s=F[n].tweens,s[r=s.length]=e,i))for(;--r>-1;)s[r]===e&&s.splice(r,1);return F[n].tweens},H=function(t,e,i,s){var r,n,a=t.vars.onOverwrite;return a&&(r=a(t,e,i,s)),a=I.onOverwrite,a&&(n=a(t,e,i,s)),r!==!1&&n!==!1},J=function(t,e,i,s,r){var n,a,o,l;if(1===s||s>=4){for(l=r.length,n=0;l>n;n++)if((o=r[n])!==e)o._gc||H(o,e)&&o._enabled(!1,!1)&&(a=!0);else if(5===s)break;return a}var h,u=e._startTime+_,m=[],f=0,c=0===e._duration;for(n=r.length;--n>-1;)(o=r[n])===e||o._gc||o._paused||(o._timeline!==e._timeline?(h=h||V(e,0,c),0===V(o,h,c)&&(m[f++]=o)):u>=o._startTime&&o._startTime+o.totalDuration()/o._timeScale>u&&((c||!o._initted)&&2e-10>=u-o._startTime||(m[f++]=o)));for(n=f;--n>-1;)if(o=m[n],2===s&&o._kill(i,t,e)&&(a=!0),2!==s||!o._firstPT&&o._initted){if(2!==s&&!H(o,e))continue;o._enabled(!1,!1)&&(a=!0)}return a},V=function(t,e,i){for(var s=t._timeline,r=s._timeScale,n=t._startTime;s._timeline;){if(n+=s._startTime,r*=s._timeScale,s._paused)return-100;s=s._timeline}return n/=r,n>e?n-e:i&&n===e||!t._initted&&2*_>n-e?_:(n+=t.totalDuration()/t._timeScale/r)>e+_?0:n-e-_};n._init=function(){var t,e,i,s,r,n=this.vars,a=this._overwrittenProps,o=this._duration,l=!!n.immediateRender,h=n.ease;if(n.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),r={};for(s in n.startAt)r[s]=n.startAt[s];if(r.overwrite=!1,r.immediateRender=!0,r.lazy=l&&n.lazy!==!1,r.startAt=r.delay=null,this._startAt=I.to(this.target,0,r),l)if(this._time>0)this._startAt=null;else if(0!==o)return}else if(n.runBackwards&&0!==o)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{0!==this._time&&(l=!1),i={};for(s in n)G[s]&&"autoCSS"!==s||(i[s]=n[s]);if(i.overwrite=0,i.data="isFromStart",i.lazy=l&&n.lazy!==!1,i.immediateRender=l,this._startAt=I.to(this.target,0,i),l){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=h=h?h instanceof y?h:"function"==typeof h?new y(h,n.easeParams):w[h]||I.defaultEase:I.defaultEase,n.easeParams instanceof Array&&h.config&&(this._ease=h.config.apply(h,n.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(t=this._targets.length;--t>-1;)this._initProps(this._targets[t],this._propLookup[t]={},this._siblings[t],a?a[t]:null)&&(e=!0);else e=this._initProps(this.target,this._propLookup,this._siblings,a);if(e&&I._onPluginEvent("_onInitAllProps",this),a&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),n.runBackwards)for(i=this._firstPT;i;)i.s+=i.c,i.c=-i.c,i=i._next;this._onUpdate=n.onUpdate,this._initted=!0},n._initProps=function(e,i,s,r){var n,a,o,l,h,_;if(null==e)return!1;L[e._gsTweenID]&&$(),this.vars.css||e.style&&e!==t&&e.nodeType&&U.css&&this.vars.autoCSS!==!1&&O(this.vars,e);for(n in this.vars){if(_=this.vars[n],G[n])_&&(_ instanceof Array||_.push&&f(_))&&-1!==_.join("").indexOf("{self}")&&(this.vars[n]=_=this._swapSelfInParams(_,this));else if(U[n]&&(l=new U[n])._onInitTween(e,this.vars[n],this)){for(this._firstPT=h={_next:this._firstPT,t:l,p:"setRatio",s:0,c:1,f:!0,n:n,pg:!0,pr:l._priority},a=l._overwriteProps.length;--a>-1;)i[l._overwriteProps[a]]=this._firstPT;(l._priority||l._onInitAllProps)&&(o=!0),(l._onDisable||l._onEnable)&&(this._notifyPluginsOfEnabled=!0)}else this._firstPT=i[n]=h={_next:this._firstPT,t:e,p:n,f:"function"==typeof e[n],n:n,pg:!1,pr:0},h.s=h.f?e[n.indexOf("set")||"function"!=typeof e["get"+n.substr(3)]?n:"get"+n.substr(3)]():parseFloat(e[n]),h.c="string"==typeof _&&"="===_.charAt(1)?parseInt(_.charAt(0)+"1",10)*Number(_.substr(2)):Number(_)-h.s||0;h&&h._next&&(h._next._prev=h)}return r&&this._kill(r,e)?this._initProps(e,i,s,r):this._overwrite>1&&this._firstPT&&s.length>1&&J(e,this,i,this._overwrite,s)?(this._kill(i,e),this._initProps(e,i,s,r)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(L[e._gsTweenID]=!0),o)},n.render=function(t,e,i){var s,r,n,a,o=this._time,l=this._duration,h=this._rawPrevTime;if(t>=l)this._totalTime=this._time=l,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(s=!0,r="onComplete",i=i||this._timeline.autoRemoveChildren),0===l&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(t=0),(0===t||0>h||h===_&&"isPause"!==this.data)&&h!==t&&(i=!0,h>_&&(r="onReverseComplete")),this._rawPrevTime=a=!e||t||h===t?t:_);else if(1e-7>t)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==o||0===l&&h>0)&&(r="onReverseComplete",s=this._reversed),0>t&&(this._active=!1,0===l&&(this._initted||!this.vars.lazy||i)&&(h>=0&&(h!==_||"isPause"!==this.data)&&(i=!0),this._rawPrevTime=a=!e||t||h===t?t:_)),this._initted||(i=!0);else if(this._totalTime=this._time=t,this._easeType){var u=t/l,m=this._easeType,f=this._easePower;(1===m||3===m&&u>=.5)&&(u=1-u),3===m&&(u*=2),1===f?u*=u:2===f?u*=u*u:3===f?u*=u*u*u:4===f&&(u*=u*u*u*u),this.ratio=1===m?1-u:2===m?u:.5>t/l?u/2:1-u/2}else this.ratio=this._ease.getRatio(t/l);if(this._time!==o||i){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=o,this._rawPrevTime=h,z.push(this),this._lazy=[t,e],void 0;this._time&&!s?this.ratio=this._ease.getRatio(this._time/l):s&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==o&&t>=0&&(this._active=!0),0===o&&(this._startAt&&(t>=0?this._startAt.render(t,e,i):r||(r="_dummyGS")),this.vars.onStart&&(0!==this._time||0===l)&&(e||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||T))),n=this._firstPT;n;)n.f?n.t[n.p](n.c*this.ratio+n.s):n.t[n.p]=n.c*this.ratio+n.s,n=n._next;this._onUpdate&&(0>t&&this._startAt&&t!==-1e-4&&this._startAt.render(t,e,i),e||(this._time!==o||s)&&this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||T)),r&&(!this._gc||i)&&(0>t&&this._startAt&&!this._onUpdate&&t!==-1e-4&&this._startAt.render(t,e,i),s&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[r]&&this.vars[r].apply(this.vars[r+"Scope"]||this,this.vars[r+"Params"]||T),0===l&&this._rawPrevTime===_&&a!==_&&(this._rawPrevTime=0))}},n._kill=function(t,e,i){if("all"===t&&(t=null),null==t&&(null==e||e===this.target))return this._lazy=!1,this._enabled(!1,!1);e="string"!=typeof e?e||this._targets||this.target:I.selector(e)||e;var s,r,n,a,o,l,h,_,u;if((f(e)||E(e))&&"number"!=typeof e[0])for(s=e.length;--s>-1;)this._kill(t,e[s])&&(l=!0);else{if(this._targets){for(s=this._targets.length;--s>-1;)if(e===this._targets[s]){o=this._propLookup[s]||{},this._overwrittenProps=this._overwrittenProps||[],r=this._overwrittenProps[s]=t?this._overwrittenProps[s]||{}:"all";break}}else{if(e!==this.target)return!1;o=this._propLookup,r=this._overwrittenProps=t?this._overwrittenProps||{}:"all"}if(o){if(h=t||o,_=t!==r&&"all"!==r&&t!==o&&("object"!=typeof t||!t._tempKill),i&&(I.onOverwrite||this.vars.onOverwrite)){for(n in h)o[n]&&(u||(u=[]),u.push(n));if(!H(this,i,e,u))return!1}for(n in h)(a=o[n])&&(a.pg&&a.t._kill(h)&&(l=!0),a.pg&&0!==a.t._overwriteProps.length||(a._prev?a._prev._next=a._next:a===this._firstPT&&(this._firstPT=a._next),a._next&&(a._next._prev=a._prev),a._next=a._prev=null),delete o[n]),_&&(r[n]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return l},n.invalidate=function(){return this._notifyPluginsOfEnabled&&I._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],R.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-_,this.render(-this._delay)),this},n._enabled=function(t,e){if(o||a.wake(),t&&this._gc){var i,s=this._targets;if(s)for(i=s.length;--i>-1;)this._siblings[i]=K(s[i],this,!0);else this._siblings=K(this.target,this,!0)}return R.prototype._enabled.call(this,t,e),this._notifyPluginsOfEnabled&&this._firstPT?I._onPluginEvent(t?"_onEnable":"_onDisable",this):!1},I.to=function(t,e,i){return new I(t,e,i)},I.from=function(t,e,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new I(t,e,i)},I.fromTo=function(t,e,i,s){return s.startAt=i,s.immediateRender=0!=s.immediateRender&&0!=i.immediateRender,new I(t,e,s)},I.delayedCall=function(t,e,i,s,r){return new I(e,0,{delay:t,onComplete:e,onCompleteParams:i,onCompleteScope:s,onReverseComplete:e,onReverseCompleteParams:i,onReverseCompleteScope:s,immediateRender:!1,lazy:!1,useFrames:r,overwrite:0})},I.set=function(t,e){return new I(t,0,e)},I.getTweensOf=function(t,e){if(null==t)return[];t="string"!=typeof t?t:I.selector(t)||t;var i,s,r,n;if((f(t)||E(t))&&"number"!=typeof t[0]){for(i=t.length,s=[];--i>-1;)s=s.concat(I.getTweensOf(t[i],e));for(i=s.length;--i>-1;)for(n=s[i],r=i;--r>-1;)n===s[r]&&s.splice(i,1)}else for(s=K(t).concat(),i=s.length;--i>-1;)(s[i]._gc||e&&!s[i].isActive())&&s.splice(i,1);return s},I.killTweensOf=I.killDelayedCallsTo=function(t,e,i){"object"==typeof e&&(i=e,e=!1);for(var s=I.getTweensOf(t,e),r=s.length;--r>-1;)s[r]._kill(i,t)};var W=v("plugins.TweenPlugin",function(t,e){this._overwriteProps=(t||"").split(","),this._propName=this._overwriteProps[0],this._priority=e||0,this._super=W.prototype},!0);if(n=W.prototype,W.version="1.10.1",W.API=2,n._firstPT=null,n._addTween=function(t,e,i,s,r,n){var a,o;return null!=s&&(a="number"==typeof s||"="!==s.charAt(1)?Number(s)-i:parseInt(s.charAt(0)+"1",10)*Number(s.substr(2)))?(this._firstPT=o={_next:this._firstPT,t:t,p:e,s:i,c:a,f:"function"==typeof t[e],n:r||e,r:n},o._next&&(o._next._prev=o),o):void 0},n.setRatio=function(t){for(var e,i=this._firstPT,s=1e-6;i;)e=i.c*t+i.s,i.r?e=Math.round(e):s>e&&e>-s&&(e=0),i.f?i.t[i.p](e):i.t[i.p]=e,i=i._next},n._kill=function(t){var e,i=this._overwriteProps,s=this._firstPT;if(null!=t[this._propName])this._overwriteProps=[];else for(e=i.length;--e>-1;)null!=t[i[e]]&&i.splice(e,1);for(;s;)null!=t[s.n]&&(s._next&&(s._next._prev=s._prev),s._prev?(s._prev._next=s._next,s._prev=null):this._firstPT===s&&(this._firstPT=s._next)),s=s._next;return!1},n._roundProps=function(t,e){for(var i=this._firstPT;i;)(t[this._propName]||null!=i.n&&t[i.n.split(this._propName+"_").join("")])&&(i.r=e),i=i._next},I._onPluginEvent=function(t,e){var i,s,r,n,a,o=e._firstPT;if("_onInitAllProps"===t){for(;o;){for(a=o._next,s=r;s&&s.pr>o.pr;)s=s._next;(o._prev=s?s._prev:n)?o._prev._next=o:r=o,(o._next=s)?s._prev=o:n=o,o=a}o=e._firstPT=r}for(;o;)o.pg&&"function"==typeof o.t[t]&&o.t[t]()&&(i=!0),o=o._next;return i},W.activate=function(t){for(var e=t.length;--e>-1;)t[e].API===W.API&&(U[(new t[e])._propName]=t[e]);return!0},d.plugin=function(t){if(!(t&&t.propName&&t.init&&t.API))throw"illegal plugin definition.";var e,i=t.propName,s=t.priority||0,r=t.overwriteProps,n={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_roundProps",initAll:"_onInitAllProps"},a=v("plugins."+i.charAt(0).toUpperCase()+i.substr(1)+"Plugin",function(){W.call(this,i,s),this._overwriteProps=r||[]},t.global===!0),o=a.prototype=new W(i);o.constructor=a,a.API=t.API;for(e in n)"function"==typeof t[e]&&(o[n[e]]=t[e]);return a.version=t.version,W.activate([a]),a},s=t._gsQueue){for(r=0;s.length>r;r++)s[r]();for(n in c)c[n].func||t.console.log("GSAP encountered missing dependency: com.greensock."+n)}o=!1}})("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenLite");
;
;
/*! TimelineLite.min.js */ 
;
;
/*!
* VERSION: 1.16.1
* DATE: 2015-03-13
* UPDATES AND DOCS AT: http://greensock.com
*
* @license Copyright (c) 2008-2015, GreenSock. All rights reserved.
* This work is subject to the terms at http://greensock.com/standard-license or for
* Club GreenSock members, the software agreement that was issued with your membership.
* 
* @author: Jack Doyle, jack@greensock.com
*/
var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(t,e,i){var s=function(t){e.call(this,t),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var i,s,r=this.vars;for(s in r)i=r[s],h(i)&&-1!==i.join("").indexOf("{self}")&&(r[s]=this._swapSelfInParams(i));h(r.tweens)&&this.add(r.tweens,0,r.align,r.stagger)},r=1e-10,n=i._internals,a=s._internals={},o=n.isSelector,h=n.isArray,l=n.lazyTweens,_=n.lazyRender,u=[],p=_gsScope._gsDefine.globals,f=function(t){var e,i={};for(e in t)i[e]=t[e];return i},c=a.pauseCallback=function(t,e,i,s){var n,a=t._timeline,o=a._totalTime,h=t._startTime,l=0>t._rawPrevTime||0===t._rawPrevTime&&a._reversed,_=l?0:r,p=l?r:0;if(e||!this._forcingPlayhead){for(a.pause(h),n=t._prev;n&&n._startTime===h;)n._rawPrevTime=p,n=n._prev;for(n=t._next;n&&n._startTime===h;)n._rawPrevTime=_,n=n._next;e&&e.apply(s||a,i||u),(this._forcingPlayhead||!a._paused)&&a.seek(o)}},m=function(t){var e,i=[],s=t.length;for(e=0;e!==s;i.push(t[e++]));return i},d=s.prototype=new e;return s.version="1.16.1",d.constructor=s,d.kill()._gc=d._forcingPlayhead=!1,d.to=function(t,e,s,r){var n=s.repeat&&p.TweenMax||i;return e?this.add(new n(t,e,s),r):this.set(t,s,r)},d.from=function(t,e,s,r){return this.add((s.repeat&&p.TweenMax||i).from(t,e,s),r)},d.fromTo=function(t,e,s,r,n){var a=r.repeat&&p.TweenMax||i;return e?this.add(a.fromTo(t,e,s,r),n):this.set(t,r,n)},d.staggerTo=function(t,e,r,n,a,h,l,_){var u,p=new s({onComplete:h,onCompleteParams:l,onCompleteScope:_,smoothChildTiming:this.smoothChildTiming});for("string"==typeof t&&(t=i.selector(t)||t),t=t||[],o(t)&&(t=m(t)),n=n||0,0>n&&(t=m(t),t.reverse(),n*=-1),u=0;t.length>u;u++)r.startAt&&(r.startAt=f(r.startAt)),p.to(t[u],e,f(r),u*n);return this.add(p,a)},d.staggerFrom=function(t,e,i,s,r,n,a,o){return i.immediateRender=0!=i.immediateRender,i.runBackwards=!0,this.staggerTo(t,e,i,s,r,n,a,o)},d.staggerFromTo=function(t,e,i,s,r,n,a,o,h){return s.startAt=i,s.immediateRender=0!=s.immediateRender&&0!=i.immediateRender,this.staggerTo(t,e,s,r,n,a,o,h)},d.call=function(t,e,s,r){return this.add(i.delayedCall(0,t,e,s),r)},d.set=function(t,e,s){return s=this._parseTimeOrLabel(s,0,!0),null==e.immediateRender&&(e.immediateRender=s===this._time&&!this._paused),this.add(new i(t,0,e),s)},s.exportRoot=function(t,e){t=t||{},null==t.smoothChildTiming&&(t.smoothChildTiming=!0);var r,n,a=new s(t),o=a._timeline;for(null==e&&(e=!0),o._remove(a,!0),a._startTime=0,a._rawPrevTime=a._time=a._totalTime=o._time,r=o._first;r;)n=r._next,e&&r instanceof i&&r.target===r.vars.onComplete||a.add(r,r._startTime-r._delay),r=n;return o.add(a,0),a},d.add=function(r,n,a,o){var l,_,u,p,f,c;if("number"!=typeof n&&(n=this._parseTimeOrLabel(n,0,!0,r)),!(r instanceof t)){if(r instanceof Array||r&&r.push&&h(r)){for(a=a||"normal",o=o||0,l=n,_=r.length,u=0;_>u;u++)h(p=r[u])&&(p=new s({tweens:p})),this.add(p,l),"string"!=typeof p&&"function"!=typeof p&&("sequence"===a?l=p._startTime+p.totalDuration()/p._timeScale:"start"===a&&(p._startTime-=p.delay())),l+=o;return this._uncache(!0)}if("string"==typeof r)return this.addLabel(r,n);if("function"!=typeof r)throw"Cannot add "+r+" into the timeline; it is not a tween, timeline, function, or string.";r=i.delayedCall(0,r)}if(e.prototype.add.call(this,r,n),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(f=this,c=f.rawTime()>r._startTime;f._timeline;)c&&f._timeline.smoothChildTiming?f.totalTime(f._totalTime,!0):f._gc&&f._enabled(!0,!1),f=f._timeline;return this},d.remove=function(e){if(e instanceof t)return this._remove(e,!1);if(e instanceof Array||e&&e.push&&h(e)){for(var i=e.length;--i>-1;)this.remove(e[i]);return this}return"string"==typeof e?this.removeLabel(e):this.kill(null,e)},d._remove=function(t,i){e.prototype._remove.call(this,t,i);var s=this._last;return s?this._time>s._startTime+s._totalDuration/s._timeScale&&(this._time=this.duration(),this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},d.append=function(t,e){return this.add(t,this._parseTimeOrLabel(null,e,!0,t))},d.insert=d.insertMultiple=function(t,e,i,s){return this.add(t,e||0,i,s)},d.appendMultiple=function(t,e,i,s){return this.add(t,this._parseTimeOrLabel(null,e,!0,t),i,s)},d.addLabel=function(t,e){return this._labels[t]=this._parseTimeOrLabel(e),this},d.addPause=function(t,e,s,r){var n=i.delayedCall(0,c,["{self}",e,s,r],this);return n.data="isPause",this.add(n,t)},d.removeLabel=function(t){return delete this._labels[t],this},d.getLabelTime=function(t){return null!=this._labels[t]?this._labels[t]:-1},d._parseTimeOrLabel=function(e,i,s,r){var n;if(r instanceof t&&r.timeline===this)this.remove(r);else if(r&&(r instanceof Array||r.push&&h(r)))for(n=r.length;--n>-1;)r[n]instanceof t&&r[n].timeline===this&&this.remove(r[n]);if("string"==typeof i)return this._parseTimeOrLabel(i,s&&"number"==typeof e&&null==this._labels[i]?e-this.duration():0,s);if(i=i||0,"string"!=typeof e||!isNaN(e)&&null==this._labels[e])null==e&&(e=this.duration());else{if(n=e.indexOf("="),-1===n)return null==this._labels[e]?s?this._labels[e]=this.duration()+i:i:this._labels[e]+i;i=parseInt(e.charAt(n-1)+"1",10)*Number(e.substr(n+1)),e=n>1?this._parseTimeOrLabel(e.substr(0,n-1),0,s):this.duration()}return Number(e)+i},d.seek=function(t,e){return this.totalTime("number"==typeof t?t:this._parseTimeOrLabel(t),e!==!1)},d.stop=function(){return this.paused(!0)},d.gotoAndPlay=function(t,e){return this.play(t,e)},d.gotoAndStop=function(t,e){return this.pause(t,e)},d.render=function(t,e,i){this._gc&&this._enabled(!0,!1);var s,n,a,o,h,p=this._dirty?this.totalDuration():this._totalDuration,f=this._time,c=this._startTime,m=this._timeScale,d=this._paused;if(t>=p)this._totalTime=this._time=p,this._reversed||this._hasPausedChild()||(n=!0,o="onComplete",h=!!this._timeline.autoRemoveChildren,0===this._duration&&(0===t||0>this._rawPrevTime||this._rawPrevTime===r)&&this._rawPrevTime!==t&&this._first&&(h=!0,this._rawPrevTime>r&&(o="onReverseComplete"))),this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:r,t=p+1e-4;else if(1e-7>t)if(this._totalTime=this._time=0,(0!==f||0===this._duration&&this._rawPrevTime!==r&&(this._rawPrevTime>0||0>t&&this._rawPrevTime>=0))&&(o="onReverseComplete",n=this._reversed),0>t)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(h=n=!0,o="onReverseComplete"):this._rawPrevTime>=0&&this._first&&(h=!0),this._rawPrevTime=t;else{if(this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:r,0===t&&n)for(s=this._first;s&&0===s._startTime;)s._duration||(n=!1),s=s._next;t=0,this._initted||(h=!0)}else this._totalTime=this._time=this._rawPrevTime=t;if(this._time!==f&&this._first||i||h){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==f&&t>0&&(this._active=!0),0===f&&this.vars.onStart&&0!==this._time&&(e||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||u)),this._time>=f)for(s=this._first;s&&(a=s._next,!this._paused||d);)(s._active||s._startTime<=this._time&&!s._paused&&!s._gc)&&(s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(t-s._startTime)*s._timeScale,e,i):s.render((t-s._startTime)*s._timeScale,e,i)),s=a;else for(s=this._last;s&&(a=s._prev,!this._paused||d);)(s._active||f>=s._startTime&&!s._paused&&!s._gc)&&(s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(t-s._startTime)*s._timeScale,e,i):s.render((t-s._startTime)*s._timeScale,e,i)),s=a;this._onUpdate&&(e||(l.length&&_(),this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||u))),o&&(this._gc||(c===this._startTime||m!==this._timeScale)&&(0===this._time||p>=this.totalDuration())&&(n&&(l.length&&_(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[o]&&this.vars[o].apply(this.vars[o+"Scope"]||this,this.vars[o+"Params"]||u)))}},d._hasPausedChild=function(){for(var t=this._first;t;){if(t._paused||t instanceof s&&t._hasPausedChild())return!0;t=t._next}return!1},d.getChildren=function(t,e,s,r){r=r||-9999999999;for(var n=[],a=this._first,o=0;a;)r>a._startTime||(a instanceof i?e!==!1&&(n[o++]=a):(s!==!1&&(n[o++]=a),t!==!1&&(n=n.concat(a.getChildren(!0,e,s)),o=n.length))),a=a._next;return n},d.getTweensOf=function(t,e){var s,r,n=this._gc,a=[],o=0;for(n&&this._enabled(!0,!0),s=i.getTweensOf(t),r=s.length;--r>-1;)(s[r].timeline===this||e&&this._contains(s[r]))&&(a[o++]=s[r]);return n&&this._enabled(!1,!0),a},d.recent=function(){return this._recent},d._contains=function(t){for(var e=t.timeline;e;){if(e===this)return!0;e=e.timeline}return!1},d.shiftChildren=function(t,e,i){i=i||0;for(var s,r=this._first,n=this._labels;r;)r._startTime>=i&&(r._startTime+=t),r=r._next;if(e)for(s in n)n[s]>=i&&(n[s]+=t);return this._uncache(!0)},d._kill=function(t,e){if(!t&&!e)return this._enabled(!1,!1);for(var i=e?this.getTweensOf(e):this.getChildren(!0,!0,!1),s=i.length,r=!1;--s>-1;)i[s]._kill(t,e)&&(r=!0);return r},d.clear=function(t){var e=this.getChildren(!1,!0,!0),i=e.length;for(this._time=this._totalTime=0;--i>-1;)e[i]._enabled(!1,!1);return t!==!1&&(this._labels={}),this._uncache(!0)},d.invalidate=function(){for(var e=this._first;e;)e.invalidate(),e=e._next;return t.prototype.invalidate.call(this)},d._enabled=function(t,i){if(t===this._gc)for(var s=this._first;s;)s._enabled(t,!0),s=s._next;return e.prototype._enabled.call(this,t,i)},d.totalTime=function(){this._forcingPlayhead=!0;var e=t.prototype.totalTime.apply(this,arguments);return this._forcingPlayhead=!1,e},d.duration=function(t){return arguments.length?(0!==this.duration()&&0!==t&&this.timeScale(this._duration/t),this):(this._dirty&&this.totalDuration(),this._duration)},d.totalDuration=function(t){if(!arguments.length){if(this._dirty){for(var e,i,s=0,r=this._last,n=999999999999;r;)e=r._prev,r._dirty&&r.totalDuration(),r._startTime>n&&this._sortChildren&&!r._paused?this.add(r,r._startTime-r._delay):n=r._startTime,0>r._startTime&&!r._paused&&(s-=r._startTime,this._timeline.smoothChildTiming&&(this._startTime+=r._startTime/this._timeScale),this.shiftChildren(-r._startTime,!1,-9999999999),n=0),i=r._startTime+r._totalDuration/r._timeScale,i>s&&(s=i),r=e;this._duration=this._totalDuration=s,this._dirty=!1}return this._totalDuration}return 0!==this.totalDuration()&&0!==t&&this.timeScale(this._totalDuration/t),this},d.paused=function(e){if(!e)for(var i=this._first,s=this._time;i;)i._startTime===s&&"isPause"===i.data&&(i._rawPrevTime=0),i=i._next;return t.prototype.paused.apply(this,arguments)},d.usesFrames=function(){for(var e=this._timeline;e._timeline;)e=e._timeline;return e===t._rootFramesTimeline},d.rawTime=function(){return this._paused?this._totalTime:(this._timeline.rawTime()-this._startTime)*this._timeScale},s},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(t){"use strict";var e=function(){return(_gsScope.GreenSockGlobals||_gsScope)[t]};"function"==typeof define&&define.amd?define(["TweenLite"],e):"undefined"!=typeof module&&module.exports&&(require("./TweenLite.js"),module.exports=e())}("TimelineLite");
;
;
/*! EasePack.min.js */ 
;
;
/*!
* VERSION: beta 1.15.2
* DATE: 2015-01-27
* UPDATES AND DOCS AT: http://greensock.com
*
* @license Copyright (c) 2008-2015, GreenSock. All rights reserved.
* This work is subject to the terms at http://greensock.com/standard-license or for
* Club GreenSock members, the software agreement that was issued with your membership.
* 
* @author: Jack Doyle, jack@greensock.com
**/
var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("easing.Back",["easing.Ease"],function(t){var e,i,s,r=_gsScope.GreenSockGlobals||_gsScope,n=r.com.greensock,a=2*Math.PI,o=Math.PI/2,h=n._class,l=function(e,i){var s=h("easing."+e,function(){},!0),r=s.prototype=new t;return r.constructor=s,r.getRatio=i,s},_=t.register||function(){},u=function(t,e,i,s){var r=h("easing."+t,{easeOut:new e,easeIn:new i,easeInOut:new s},!0);return _(r,t),r},c=function(t,e,i){this.t=t,this.v=e,i&&(this.next=i,i.prev=this,this.c=i.v-e,this.gap=i.t-t)},p=function(e,i){var s=h("easing."+e,function(t){this._p1=t||0===t?t:1.70158,this._p2=1.525*this._p1},!0),r=s.prototype=new t;return r.constructor=s,r.getRatio=i,r.config=function(t){return new s(t)},s},f=u("Back",p("BackOut",function(t){return(t-=1)*t*((this._p1+1)*t+this._p1)+1}),p("BackIn",function(t){return t*t*((this._p1+1)*t-this._p1)}),p("BackInOut",function(t){return 1>(t*=2)?.5*t*t*((this._p2+1)*t-this._p2):.5*((t-=2)*t*((this._p2+1)*t+this._p2)+2)})),m=h("easing.SlowMo",function(t,e,i){e=e||0===e?e:.7,null==t?t=.7:t>1&&(t=1),this._p=1!==t?e:0,this._p1=(1-t)/2,this._p2=t,this._p3=this._p1+this._p2,this._calcEnd=i===!0},!0),d=m.prototype=new t;return d.constructor=m,d.getRatio=function(t){var e=t+(.5-t)*this._p;return this._p1>t?this._calcEnd?1-(t=1-t/this._p1)*t:e-(t=1-t/this._p1)*t*t*t*e:t>this._p3?this._calcEnd?1-(t=(t-this._p3)/this._p1)*t:e+(t-e)*(t=(t-this._p3)/this._p1)*t*t*t:this._calcEnd?1:e},m.ease=new m(.7,.7),d.config=m.config=function(t,e,i){return new m(t,e,i)},e=h("easing.SteppedEase",function(t){t=t||1,this._p1=1/t,this._p2=t+1},!0),d=e.prototype=new t,d.constructor=e,d.getRatio=function(t){return 0>t?t=0:t>=1&&(t=.999999999),(this._p2*t>>0)*this._p1},d.config=e.config=function(t){return new e(t)},i=h("easing.RoughEase",function(e){e=e||{};for(var i,s,r,n,a,o,h=e.taper||"none",l=[],_=0,u=0|(e.points||20),p=u,f=e.randomize!==!1,m=e.clamp===!0,d=e.template instanceof t?e.template:null,g="number"==typeof e.strength?.4*e.strength:.4;--p>-1;)i=f?Math.random():1/u*p,s=d?d.getRatio(i):i,"none"===h?r=g:"out"===h?(n=1-i,r=n*n*g):"in"===h?r=i*i*g:.5>i?(n=2*i,r=.5*n*n*g):(n=2*(1-i),r=.5*n*n*g),f?s+=Math.random()*r-.5*r:p%2?s+=.5*r:s-=.5*r,m&&(s>1?s=1:0>s&&(s=0)),l[_++]={x:i,y:s};for(l.sort(function(t,e){return t.x-e.x}),o=new c(1,1,null),p=u;--p>-1;)a=l[p],o=new c(a.x,a.y,o);this._prev=new c(0,0,0!==o.t?o:o.next)},!0),d=i.prototype=new t,d.constructor=i,d.getRatio=function(t){var e=this._prev;if(t>e.t){for(;e.next&&t>=e.t;)e=e.next;e=e.prev}else for(;e.prev&&e.t>=t;)e=e.prev;return this._prev=e,e.v+(t-e.t)/e.gap*e.c},d.config=function(t){return new i(t)},i.ease=new i,u("Bounce",l("BounceOut",function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}),l("BounceIn",function(t){return 1/2.75>(t=1-t)?1-7.5625*t*t:2/2.75>t?1-(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}),l("BounceInOut",function(t){var e=.5>t;return t=e?1-2*t:2*t-1,t=1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5})),u("Circ",l("CircOut",function(t){return Math.sqrt(1-(t-=1)*t)}),l("CircIn",function(t){return-(Math.sqrt(1-t*t)-1)}),l("CircInOut",function(t){return 1>(t*=2)?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)})),s=function(e,i,s){var r=h("easing."+e,function(t,e){this._p1=t>=1?t:1,this._p2=(e||s)/(1>t?t:1),this._p3=this._p2/a*(Math.asin(1/this._p1)||0),this._p2=a/this._p2},!0),n=r.prototype=new t;return n.constructor=r,n.getRatio=i,n.config=function(t,e){return new r(t,e)},r},u("Elastic",s("ElasticOut",function(t){return this._p1*Math.pow(2,-10*t)*Math.sin((t-this._p3)*this._p2)+1},.3),s("ElasticIn",function(t){return-(this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*this._p2))},.3),s("ElasticInOut",function(t){return 1>(t*=2)?-.5*this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*this._p2):.5*this._p1*Math.pow(2,-10*(t-=1))*Math.sin((t-this._p3)*this._p2)+1},.45)),u("Expo",l("ExpoOut",function(t){return 1-Math.pow(2,-10*t)}),l("ExpoIn",function(t){return Math.pow(2,10*(t-1))-.001}),l("ExpoInOut",function(t){return 1>(t*=2)?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))})),u("Sine",l("SineOut",function(t){return Math.sin(t*o)}),l("SineIn",function(t){return-Math.cos(t*o)+1}),l("SineInOut",function(t){return-.5*(Math.cos(Math.PI*t)-1)})),h("easing.EaseLookup",{find:function(e){return t.map[e]}},!0),_(r.SlowMo,"SlowMo","ease,"),_(i,"RoughEase","ease,"),_(e,"SteppedEase","ease,"),f},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()();
;
;
/*! CSSPlugin.min.js */ 
;
;
/*!
* VERSION: 1.16.1
* DATE: 2015-03-13
* UPDATES AND DOCS AT: http://www.greensock.com
*
* @license Copyright (c) 2008-2015, GreenSock. All rights reserved.
* This work is subject to the terms at http://greensock.com/standard-license or for
* Club GreenSock members, the software agreement that was issued with your membership.
* 
* @author: Jack Doyle, jack@greensock.com
*/
var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(t,e){var i,r,s,n,a=function(){t.call(this,"css"),this._overwriteProps.length=0,this.setRatio=a.prototype.setRatio},o=_gsScope._gsDefine.globals,l={},h=a.prototype=new t("css");h.constructor=a,a.version="1.16.1",a.API=2,a.defaultTransformPerspective=0,a.defaultSkewType="compensated",h="px",a.suffixMap={top:h,right:h,bottom:h,left:h,width:h,height:h,fontSize:h,padding:h,margin:h,perspective:h,lineHeight:""};var u,f,p,c,_,d,m=/(?:\d|\-\d|\.\d|\-\.\d)+/g,g=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,v=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,y=/(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,x=/(?:\d|\-|\+|=|#|\.)*/g,T=/opacity *= *([^)]*)/i,w=/opacity:([^;]*)/i,b=/alpha\(opacity *=.+?\)/i,P=/^(rgb|hsl)/,S=/([A-Z])/g,C=/-([a-z])/gi,O=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,k=function(t,e){return e.toUpperCase()},R=/(?:Left|Right|Width)/i,A=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,M=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,D=/,(?=[^\)]*(?:\(|$))/gi,N=Math.PI/180,L=180/Math.PI,X={},z=document,E=function(t){return z.createElementNS?z.createElementNS("http://www.w3.org/1999/xhtml",t):z.createElement(t)},F=E("div"),I=E("img"),Y=a._internals={_specialProps:l},B=navigator.userAgent,U=function(){var t=B.indexOf("Android"),e=E("a");return p=-1!==B.indexOf("Safari")&&-1===B.indexOf("Chrome")&&(-1===t||Number(B.substr(t+8,1))>3),_=p&&6>Number(B.substr(B.indexOf("Version/")+8,1)),c=-1!==B.indexOf("Firefox"),(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(B)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(B))&&(d=parseFloat(RegExp.$1)),e?(e.style.cssText="top:1px;opacity:.55;",/^0.55/.test(e.style.opacity)):!1}(),j=function(t){return T.test("string"==typeof t?t:(t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?parseFloat(RegExp.$1)/100:1},V=function(t){window.console&&console.log(t)},W="",q="",G=function(t,e){e=e||F;var i,r,s=e.style;if(void 0!==s[t])return t;for(t=t.charAt(0).toUpperCase()+t.substr(1),i=["O","Moz","ms","Ms","Webkit"],r=5;--r>-1&&void 0===s[i[r]+t];);return r>=0?(q=3===r?"ms":i[r],W="-"+q.toLowerCase()+"-",q+t):null},H=z.defaultView?z.defaultView.getComputedStyle:function(){},Q=a.getStyle=function(t,e,i,r,s){var n;return U||"opacity"!==e?(!r&&t.style[e]?n=t.style[e]:(i=i||H(t))?n=i[e]||i.getPropertyValue(e)||i.getPropertyValue(e.replace(S,"-$1").toLowerCase()):t.currentStyle&&(n=t.currentStyle[e]),null==s||n&&"none"!==n&&"auto"!==n&&"auto auto"!==n?n:s):j(t)},Z=Y.convertToPixels=function(t,i,r,s,n){if("px"===s||!s)return r;if("auto"===s||!r)return 0;var o,l,h,u=R.test(i),f=t,p=F.style,c=0>r;if(c&&(r=-r),"%"===s&&-1!==i.indexOf("border"))o=r/100*(u?t.clientWidth:t.clientHeight);else{if(p.cssText="border:0 solid red;position:"+Q(t,"position")+";line-height:0;","%"!==s&&f.appendChild)p[u?"borderLeftWidth":"borderTopWidth"]=r+s;else{if(f=t.parentNode||z.body,l=f._gsCache,h=e.ticker.frame,l&&u&&l.time===h)return l.width*r/100;p[u?"width":"height"]=r+s}f.appendChild(F),o=parseFloat(F[u?"offsetWidth":"offsetHeight"]),f.removeChild(F),u&&"%"===s&&a.cacheWidths!==!1&&(l=f._gsCache=f._gsCache||{},l.time=h,l.width=100*(o/r)),0!==o||n||(o=Z(t,i,r,s,!0))}return c?-o:o},$=Y.calculateOffset=function(t,e,i){if("absolute"!==Q(t,"position",i))return 0;var r="left"===e?"Left":"Top",s=Q(t,"margin"+r,i);return t["offset"+r]-(Z(t,e,parseFloat(s),s.replace(x,""))||0)},K=function(t,e){var i,r,s,n={};if(e=e||H(t,null))if(i=e.length)for(;--i>-1;)s=e[i],(-1===s.indexOf("-transform")||be===s)&&(n[s.replace(C,k)]=e.getPropertyValue(s));else for(i in e)(-1===i.indexOf("Transform")||we===i)&&(n[i]=e[i]);else if(e=t.currentStyle||t.style)for(i in e)"string"==typeof i&&void 0===n[i]&&(n[i.replace(C,k)]=e[i]);return U||(n.opacity=j(t)),r=De(t,e,!1),n.rotation=r.rotation,n.skewX=r.skewX,n.scaleX=r.scaleX,n.scaleY=r.scaleY,n.x=r.x,n.y=r.y,Se&&(n.z=r.z,n.rotationX=r.rotationX,n.rotationY=r.rotationY,n.scaleZ=r.scaleZ),n.filters&&delete n.filters,n},J=function(t,e,i,r,s){var n,a,o,l={},h=t.style;for(a in i)"cssText"!==a&&"length"!==a&&isNaN(a)&&(e[a]!==(n=i[a])||s&&s[a])&&-1===a.indexOf("Origin")&&("number"==typeof n||"string"==typeof n)&&(l[a]="auto"!==n||"left"!==a&&"top"!==a?""!==n&&"auto"!==n&&"none"!==n||"string"!=typeof e[a]||""===e[a].replace(y,"")?n:0:$(t,a),void 0!==h[a]&&(o=new ce(h,a,h[a],o)));if(r)for(a in r)"className"!==a&&(l[a]=r[a]);return{difs:l,firstMPT:o}},te={width:["Left","Right"],height:["Top","Bottom"]},ee=["marginLeft","marginRight","marginTop","marginBottom"],ie=function(t,e,i){var r=parseFloat("width"===e?t.offsetWidth:t.offsetHeight),s=te[e],n=s.length;for(i=i||H(t,null);--n>-1;)r-=parseFloat(Q(t,"padding"+s[n],i,!0))||0,r-=parseFloat(Q(t,"border"+s[n]+"Width",i,!0))||0;return r},re=function(t,e){(null==t||""===t||"auto"===t||"auto auto"===t)&&(t="0 0");var i=t.split(" "),r=-1!==t.indexOf("left")?"0%":-1!==t.indexOf("right")?"100%":i[0],s=-1!==t.indexOf("top")?"0%":-1!==t.indexOf("bottom")?"100%":i[1];return null==s?s="center"===r?"50%":"0":"center"===s&&(s="50%"),("center"===r||isNaN(parseFloat(r))&&-1===(r+"").indexOf("="))&&(r="50%"),t=r+" "+s+(i.length>2?" "+i[2]:""),e&&(e.oxp=-1!==r.indexOf("%"),e.oyp=-1!==s.indexOf("%"),e.oxr="="===r.charAt(1),e.oyr="="===s.charAt(1),e.ox=parseFloat(r.replace(y,"")),e.oy=parseFloat(s.replace(y,"")),e.v=t),e||t},se=function(t,e){return"string"==typeof t&&"="===t.charAt(1)?parseInt(t.charAt(0)+"1",10)*parseFloat(t.substr(2)):parseFloat(t)-parseFloat(e)},ne=function(t,e){return null==t?e:"string"==typeof t&&"="===t.charAt(1)?parseInt(t.charAt(0)+"1",10)*parseFloat(t.substr(2))+e:parseFloat(t)},ae=function(t,e,i,r){var s,n,a,o,l,h=1e-6;return null==t?o=e:"number"==typeof t?o=t:(s=360,n=t.split("_"),l="="===t.charAt(1),a=(l?parseInt(t.charAt(0)+"1",10)*parseFloat(n[0].substr(2)):parseFloat(n[0]))*(-1===t.indexOf("rad")?1:L)-(l?0:e),n.length&&(r&&(r[i]=e+a),-1!==t.indexOf("short")&&(a%=s,a!==a%(s/2)&&(a=0>a?a+s:a-s)),-1!==t.indexOf("_cw")&&0>a?a=(a+9999999999*s)%s-(0|a/s)*s:-1!==t.indexOf("ccw")&&a>0&&(a=(a-9999999999*s)%s-(0|a/s)*s)),o=e+a),h>o&&o>-h&&(o=0),o},oe={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},le=function(t,e,i){return t=0>t?t+1:t>1?t-1:t,0|255*(1>6*t?e+6*(i-e)*t:.5>t?i:2>3*t?e+6*(i-e)*(2/3-t):e)+.5},he=a.parseColor=function(t){var e,i,r,s,n,a;return t&&""!==t?"number"==typeof t?[t>>16,255&t>>8,255&t]:(","===t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),oe[t]?oe[t]:"#"===t.charAt(0)?(4===t.length&&(e=t.charAt(1),i=t.charAt(2),r=t.charAt(3),t="#"+e+e+i+i+r+r),t=parseInt(t.substr(1),16),[t>>16,255&t>>8,255&t]):"hsl"===t.substr(0,3)?(t=t.match(m),s=Number(t[0])%360/360,n=Number(t[1])/100,a=Number(t[2])/100,i=.5>=a?a*(n+1):a+n-a*n,e=2*a-i,t.length>3&&(t[3]=Number(t[3])),t[0]=le(s+1/3,e,i),t[1]=le(s,e,i),t[2]=le(s-1/3,e,i),t):(t=t.match(m)||oe.transparent,t[0]=Number(t[0]),t[1]=Number(t[1]),t[2]=Number(t[2]),t.length>3&&(t[3]=Number(t[3])),t)):oe.black},ue="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#.+?\\b";for(h in oe)ue+="|"+h+"\\b";ue=RegExp(ue+")","gi");var fe=function(t,e,i,r){if(null==t)return function(t){return t};var s,n=e?(t.match(ue)||[""])[0]:"",a=t.split(n).join("").match(v)||[],o=t.substr(0,t.indexOf(a[0])),l=")"===t.charAt(t.length-1)?")":"",h=-1!==t.indexOf(" ")?" ":",",u=a.length,f=u>0?a[0].replace(m,""):"";return u?s=e?function(t){var e,p,c,_;if("number"==typeof t)t+=f;else if(r&&D.test(t)){for(_=t.replace(D,"|").split("|"),c=0;_.length>c;c++)_[c]=s(_[c]);return _.join(",")}if(e=(t.match(ue)||[n])[0],p=t.split(e).join("").match(v)||[],c=p.length,u>c--)for(;u>++c;)p[c]=i?p[0|(c-1)/2]:a[c];return o+p.join(h)+h+e+l+(-1!==t.indexOf("inset")?" inset":"")}:function(t){var e,n,p;if("number"==typeof t)t+=f;else if(r&&D.test(t)){for(n=t.replace(D,"|").split("|"),p=0;n.length>p;p++)n[p]=s(n[p]);return n.join(",")}if(e=t.match(v)||[],p=e.length,u>p--)for(;u>++p;)e[p]=i?e[0|(p-1)/2]:a[p];return o+e.join(h)+l}:function(t){return t}},pe=function(t){return t=t.split(","),function(e,i,r,s,n,a,o){var l,h=(i+"").split(" ");for(o={},l=0;4>l;l++)o[t[l]]=h[l]=h[l]||h[(l-1)/2>>0];return s.parse(e,o,n,a)}},ce=(Y._setPluginRatio=function(t){this.plugin.setRatio(t);for(var e,i,r,s,n=this.data,a=n.proxy,o=n.firstMPT,l=1e-6;o;)e=a[o.v],o.r?e=Math.round(e):l>e&&e>-l&&(e=0),o.t[o.p]=e,o=o._next;if(n.autoRotate&&(n.autoRotate.rotation=a.rotation),1===t)for(o=n.firstMPT;o;){if(i=o.t,i.type){if(1===i.type){for(s=i.xs0+i.s+i.xs1,r=1;i.l>r;r++)s+=i["xn"+r]+i["xs"+(r+1)];i.e=s}}else i.e=i.s+i.xs0;o=o._next}},function(t,e,i,r,s){this.t=t,this.p=e,this.v=i,this.r=s,r&&(r._prev=this,this._next=r)}),_e=(Y._parseToProxy=function(t,e,i,r,s,n){var a,o,l,h,u,f=r,p={},c={},_=i._transform,d=X;for(i._transform=null,X=e,r=u=i.parse(t,e,r,s),X=d,n&&(i._transform=_,f&&(f._prev=null,f._prev&&(f._prev._next=null)));r&&r!==f;){if(1>=r.type&&(o=r.p,c[o]=r.s+r.c,p[o]=r.s,n||(h=new ce(r,"s",o,h,r.r),r.c=0),1===r.type))for(a=r.l;--a>0;)l="xn"+a,o=r.p+"_"+l,c[o]=r.data[l],p[o]=r[l],n||(h=new ce(r,l,o,h,r.rxp[l]));r=r._next}return{proxy:p,end:c,firstMPT:h,pt:u}},Y.CSSPropTween=function(t,e,r,s,a,o,l,h,u,f,p){this.t=t,this.p=e,this.s=r,this.c=s,this.n=l||e,t instanceof _e||n.push(this.n),this.r=h,this.type=o||0,u&&(this.pr=u,i=!0),this.b=void 0===f?r:f,this.e=void 0===p?r+s:p,a&&(this._next=a,a._prev=this)}),de=a.parseComplex=function(t,e,i,r,s,n,a,o,l,h){i=i||n||"",a=new _e(t,e,0,0,a,h?2:1,null,!1,o,i,r),r+="";var f,p,c,_,d,v,y,x,T,w,b,S,C=i.split(", ").join(",").split(" "),O=r.split(", ").join(",").split(" "),k=C.length,R=u!==!1;for((-1!==r.indexOf(",")||-1!==i.indexOf(","))&&(C=C.join(" ").replace(D,", ").split(" "),O=O.join(" ").replace(D,", ").split(" "),k=C.length),k!==O.length&&(C=(n||"").split(" "),k=C.length),a.plugin=l,a.setRatio=h,f=0;k>f;f++)if(_=C[f],d=O[f],x=parseFloat(_),x||0===x)a.appendXtra("",x,se(d,x),d.replace(g,""),R&&-1!==d.indexOf("px"),!0);else if(s&&("#"===_.charAt(0)||oe[_]||P.test(_)))S=","===d.charAt(d.length-1)?"),":")",_=he(_),d=he(d),T=_.length+d.length>6,T&&!U&&0===d[3]?(a["xs"+a.l]+=a.l?" transparent":"transparent",a.e=a.e.split(O[f]).join("transparent")):(U||(T=!1),a.appendXtra(T?"rgba(":"rgb(",_[0],d[0]-_[0],",",!0,!0).appendXtra("",_[1],d[1]-_[1],",",!0).appendXtra("",_[2],d[2]-_[2],T?",":S,!0),T&&(_=4>_.length?1:_[3],a.appendXtra("",_,(4>d.length?1:d[3])-_,S,!1)));else if(v=_.match(m)){if(y=d.match(g),!y||y.length!==v.length)return a;for(c=0,p=0;v.length>p;p++)b=v[p],w=_.indexOf(b,c),a.appendXtra(_.substr(c,w-c),Number(b),se(y[p],b),"",R&&"px"===_.substr(w+b.length,2),0===p),c=w+b.length;a["xs"+a.l]+=_.substr(c)}else a["xs"+a.l]+=a.l?" "+_:_;if(-1!==r.indexOf("=")&&a.data){for(S=a.xs0+a.data.s,f=1;a.l>f;f++)S+=a["xs"+f]+a.data["xn"+f];a.e=S+a["xs"+f]}return a.l||(a.type=-1,a.xs0=a.e),a.xfirst||a},me=9;for(h=_e.prototype,h.l=h.pr=0;--me>0;)h["xn"+me]=0,h["xs"+me]="";h.xs0="",h._next=h._prev=h.xfirst=h.data=h.plugin=h.setRatio=h.rxp=null,h.appendXtra=function(t,e,i,r,s,n){var a=this,o=a.l;return a["xs"+o]+=n&&o?" "+t:t||"",i||0===o||a.plugin?(a.l++,a.type=a.setRatio?2:1,a["xs"+a.l]=r||"",o>0?(a.data["xn"+o]=e+i,a.rxp["xn"+o]=s,a["xn"+o]=e,a.plugin||(a.xfirst=new _e(a,"xn"+o,e,i,a.xfirst||a,0,a.n,s,a.pr),a.xfirst.xs0=0),a):(a.data={s:e+i},a.rxp={},a.s=e,a.c=i,a.r=s,a)):(a["xs"+o]+=e+(r||""),a)};var ge=function(t,e){e=e||{},this.p=e.prefix?G(t)||t:t,l[t]=l[this.p]=this,this.format=e.formatter||fe(e.defaultValue,e.color,e.collapsible,e.multi),e.parser&&(this.parse=e.parser),this.clrs=e.color,this.multi=e.multi,this.keyword=e.keyword,this.dflt=e.defaultValue,this.pr=e.priority||0},ve=Y._registerComplexSpecialProp=function(t,e,i){"object"!=typeof e&&(e={parser:i});var r,s,n=t.split(","),a=e.defaultValue;for(i=i||[a],r=0;n.length>r;r++)e.prefix=0===r&&e.prefix,e.defaultValue=i[r]||a,s=new ge(n[r],e)},ye=function(t){if(!l[t]){var e=t.charAt(0).toUpperCase()+t.substr(1)+"Plugin";ve(t,{parser:function(t,i,r,s,n,a,h){var u=o.com.greensock.plugins[e];return u?(u._cssRegister(),l[r].parse(t,i,r,s,n,a,h)):(V("Error: "+e+" js file not loaded."),n)}})}};h=ge.prototype,h.parseComplex=function(t,e,i,r,s,n){var a,o,l,h,u,f,p=this.keyword;if(this.multi&&(D.test(i)||D.test(e)?(o=e.replace(D,"|").split("|"),l=i.replace(D,"|").split("|")):p&&(o=[e],l=[i])),l){for(h=l.length>o.length?l.length:o.length,a=0;h>a;a++)e=o[a]=o[a]||this.dflt,i=l[a]=l[a]||this.dflt,p&&(u=e.indexOf(p),f=i.indexOf(p),u!==f&&(-1===f?o[a]=o[a].split(p).join(""):-1===u&&(o[a]+=" "+p)));e=o.join(", "),i=l.join(", ")}return de(t,this.p,e,i,this.clrs,this.dflt,r,this.pr,s,n)},h.parse=function(t,e,i,r,n,a){return this.parseComplex(t.style,this.format(Q(t,this.p,s,!1,this.dflt)),this.format(e),n,a)},a.registerSpecialProp=function(t,e,i){ve(t,{parser:function(t,r,s,n,a,o){var l=new _e(t,s,0,0,a,2,s,!1,i);return l.plugin=o,l.setRatio=e(t,r,n._tween,s),l},priority:i})},a.useSVGTransformAttr=p;var xe,Te="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),we=G("transform"),be=W+"transform",Pe=G("transformOrigin"),Se=null!==G("perspective"),Ce=Y.Transform=function(){this.perspective=parseFloat(a.defaultTransformPerspective)||0,this.force3D=a.defaultForce3D!==!1&&Se?a.defaultForce3D||"auto":!1},Oe=window.SVGElement,ke=function(t,e,i){var r,s=z.createElementNS("http://www.w3.org/2000/svg",t),n=/([a-z])([A-Z])/g;for(r in i)s.setAttributeNS(null,r.replace(n,"$1-$2").toLowerCase(),i[r]);return e.appendChild(s),s},Re=z.documentElement,Ae=function(){var t,e,i,r=d||/Android/i.test(B)&&!window.chrome;return z.createElementNS&&!r&&(t=ke("svg",Re),e=ke("rect",t,{width:100,height:50,x:100}),i=e.getBoundingClientRect().width,e.style[Pe]="50% 50%",e.style[we]="scaleX(0.5)",r=i===e.getBoundingClientRect().width&&!(c&&Se),Re.removeChild(t)),r}(),Me=function(t,e,i,r){var s,n;r&&(n=r.split(" ")).length||(s=t.getBBox(),e=re(e).split(" "),n=[(-1!==e[0].indexOf("%")?parseFloat(e[0])/100*s.width:parseFloat(e[0]))+s.x,(-1!==e[1].indexOf("%")?parseFloat(e[1])/100*s.height:parseFloat(e[1]))+s.y]),i.xOrigin=parseFloat(n[0]),i.yOrigin=parseFloat(n[1]),t.setAttribute("data-svg-origin",n.join(" "))},De=Y.getTransform=function(t,e,i,r){if(t._gsTransform&&i&&!r)return t._gsTransform;var n,o,l,h,u,f,p,c,_,d,m=i?t._gsTransform||new Ce:new Ce,g=0>m.scaleX,v=2e-5,y=1e5,x=Se?parseFloat(Q(t,Pe,e,!1,"0 0 0").split(" ")[2])||m.zOrigin||0:0,T=parseFloat(a.defaultTransformPerspective)||0;if(we?o=Q(t,be,e,!0):t.currentStyle&&(o=t.currentStyle.filter.match(A),o=o&&4===o.length?[o[0].substr(4),Number(o[2].substr(4)),Number(o[1].substr(4)),o[3].substr(4),m.x||0,m.y||0].join(","):""),n=!o||"none"===o||"matrix(1, 0, 0, 1, 0, 0)"===o,m.svg=!!(Oe&&"function"==typeof t.getBBox&&t.getCTM&&(!t.parentNode||t.parentNode.getBBox&&t.parentNode.getCTM)),m.svg&&(n&&-1!==(t.style[we]+"").indexOf("matrix")&&(o=t.style[we],n=!1),Me(t,Q(t,Pe,s,!1,"50% 50%")+"",m,t.getAttribute("data-svg-origin")),xe=a.useSVGTransformAttr||Ae,l=t.getAttribute("transform"),n&&l&&-1!==l.indexOf("matrix")&&(o=l,n=0)),!n){for(l=(o||"").match(/(?:\-|\b)[\d\-\.e]+\b/gi)||[],h=l.length;--h>-1;)u=Number(l[h]),l[h]=(f=u-(u|=0))?(0|f*y+(0>f?-.5:.5))/y+u:u;if(16===l.length){var w,b,P,S,C,O=l[0],k=l[1],R=l[2],M=l[3],D=l[4],N=l[5],X=l[6],z=l[7],E=l[8],F=l[9],I=l[10],Y=l[12],B=l[13],U=l[14],j=l[11],V=Math.atan2(X,I);m.zOrigin&&(U=-m.zOrigin,Y=E*U-l[12],B=F*U-l[13],U=I*U+m.zOrigin-l[14]),m.rotationX=V*L,V&&(S=Math.cos(-V),C=Math.sin(-V),w=D*S+E*C,b=N*S+F*C,P=X*S+I*C,E=D*-C+E*S,F=N*-C+F*S,I=X*-C+I*S,j=z*-C+j*S,D=w,N=b,X=P),V=Math.atan2(E,I),m.rotationY=V*L,V&&(S=Math.cos(-V),C=Math.sin(-V),w=O*S-E*C,b=k*S-F*C,P=R*S-I*C,F=k*C+F*S,I=R*C+I*S,j=M*C+j*S,O=w,k=b,R=P),V=Math.atan2(k,O),m.rotation=V*L,V&&(S=Math.cos(-V),C=Math.sin(-V),O=O*S+D*C,b=k*S+N*C,N=k*-C+N*S,X=R*-C+X*S,k=b),m.rotationX&&Math.abs(m.rotationX)+Math.abs(m.rotation)>359.9&&(m.rotationX=m.rotation=0,m.rotationY+=180),m.scaleX=(0|Math.sqrt(O*O+k*k)*y+.5)/y,m.scaleY=(0|Math.sqrt(N*N+F*F)*y+.5)/y,m.scaleZ=(0|Math.sqrt(X*X+I*I)*y+.5)/y,m.skewX=0,m.perspective=j?1/(0>j?-j:j):0,m.x=Y,m.y=B,m.z=U,m.svg&&(m.x-=m.xOrigin-(m.xOrigin*O-m.yOrigin*D),m.y-=m.yOrigin-(m.yOrigin*k-m.xOrigin*N))}else if(!(Se&&!r&&l.length&&m.x===l[4]&&m.y===l[5]&&(m.rotationX||m.rotationY)||void 0!==m.x&&"none"===Q(t,"display",e))){var W=l.length>=6,q=W?l[0]:1,G=l[1]||0,H=l[2]||0,Z=W?l[3]:1;m.x=l[4]||0,m.y=l[5]||0,p=Math.sqrt(q*q+G*G),c=Math.sqrt(Z*Z+H*H),_=q||G?Math.atan2(G,q)*L:m.rotation||0,d=H||Z?Math.atan2(H,Z)*L+_:m.skewX||0,Math.abs(d)>90&&270>Math.abs(d)&&(g?(p*=-1,d+=0>=_?180:-180,_+=0>=_?180:-180):(c*=-1,d+=0>=d?180:-180)),m.scaleX=p,m.scaleY=c,m.rotation=_,m.skewX=d,Se&&(m.rotationX=m.rotationY=m.z=0,m.perspective=T,m.scaleZ=1),m.svg&&(m.x-=m.xOrigin-(m.xOrigin*q-m.yOrigin*G),m.y-=m.yOrigin-(m.yOrigin*Z-m.xOrigin*H))}m.zOrigin=x;for(h in m)v>m[h]&&m[h]>-v&&(m[h]=0)}return i&&(t._gsTransform=m,m.svg&&(xe&&t.style[we]?ze(t.style,we):!xe&&t.getAttribute("transform")&&t.removeAttribute("transform"))),m},Ne=function(t){var e,i,r=this.data,s=-r.rotation*N,n=s+r.skewX*N,a=1e5,o=(0|Math.cos(s)*r.scaleX*a)/a,l=(0|Math.sin(s)*r.scaleX*a)/a,h=(0|Math.sin(n)*-r.scaleY*a)/a,u=(0|Math.cos(n)*r.scaleY*a)/a,f=this.t.style,p=this.t.currentStyle;if(p){i=l,l=-h,h=-i,e=p.filter,f.filter="";var c,_,m=this.t.offsetWidth,g=this.t.offsetHeight,v="absolute"!==p.position,y="progid:DXImageTransform.Microsoft.Matrix(M11="+o+", M12="+l+", M21="+h+", M22="+u,w=r.x+m*r.xPercent/100,b=r.y+g*r.yPercent/100;if(null!=r.ox&&(c=(r.oxp?.01*m*r.ox:r.ox)-m/2,_=(r.oyp?.01*g*r.oy:r.oy)-g/2,w+=c-(c*o+_*l),b+=_-(c*h+_*u)),v?(c=m/2,_=g/2,y+=", Dx="+(c-(c*o+_*l)+w)+", Dy="+(_-(c*h+_*u)+b)+")"):y+=", sizingMethod='auto expand')",f.filter=-1!==e.indexOf("DXImageTransform.Microsoft.Matrix(")?e.replace(M,y):y+" "+e,(0===t||1===t)&&1===o&&0===l&&0===h&&1===u&&(v&&-1===y.indexOf("Dx=0, Dy=0")||T.test(e)&&100!==parseFloat(RegExp.$1)||-1===e.indexOf("gradient("&&e.indexOf("Alpha"))&&f.removeAttribute("filter")),!v){var P,S,C,O=8>d?1:-1;for(c=r.ieOffsetX||0,_=r.ieOffsetY||0,r.ieOffsetX=Math.round((m-((0>o?-o:o)*m+(0>l?-l:l)*g))/2+w),r.ieOffsetY=Math.round((g-((0>u?-u:u)*g+(0>h?-h:h)*m))/2+b),me=0;4>me;me++)S=ee[me],P=p[S],i=-1!==P.indexOf("px")?parseFloat(P):Z(this.t,S,parseFloat(P),P.replace(x,""))||0,C=i!==r[S]?2>me?-r.ieOffsetX:-r.ieOffsetY:2>me?c-r.ieOffsetX:_-r.ieOffsetY,f[S]=(r[S]=Math.round(i-C*(0===me||2===me?1:O)))+"px"}}},Le=Y.set3DTransformRatio=Y.setTransformRatio=function(t){var e,i,r,s,n,a,o,l,h,u,f,p,_,d,m,g,v,y,x,T,w,b,P,S=this.data,C=this.t.style,O=S.rotation,k=S.rotationX,R=S.rotationY,A=S.scaleX,M=S.scaleY,D=S.scaleZ,L=S.x,X=S.y,z=S.z,E=S.svg,F=S.perspective,I=S.force3D;if(!(((1!==t&&0!==t||"auto"!==I||this.tween._totalTime!==this.tween._totalDuration&&this.tween._totalTime)&&I||z||F||R||k)&&(!xe||!E)&&Se))return O||S.skewX||E?(O*=N,b=S.skewX*N,P=1e5,e=Math.cos(O)*A,s=Math.sin(O)*A,i=Math.sin(O-b)*-M,n=Math.cos(O-b)*M,b&&"simple"===S.skewType&&(v=Math.tan(b),v=Math.sqrt(1+v*v),i*=v,n*=v,S.skewY&&(e*=v,s*=v)),E&&(L+=S.xOrigin-(S.xOrigin*e+S.yOrigin*i),X+=S.yOrigin-(S.xOrigin*s+S.yOrigin*n),d=1e-6,d>L&&L>-d&&(L=0),d>X&&X>-d&&(X=0)),x=(0|e*P)/P+","+(0|s*P)/P+","+(0|i*P)/P+","+(0|n*P)/P+","+L+","+X+")",E&&xe?this.t.setAttribute("transform","matrix("+x):C[we]=(S.xPercent||S.yPercent?"translate("+S.xPercent+"%,"+S.yPercent+"%) matrix(":"matrix(")+x):C[we]=(S.xPercent||S.yPercent?"translate("+S.xPercent+"%,"+S.yPercent+"%) matrix(":"matrix(")+A+",0,0,"+M+","+L+","+X+")",void 0;if(c&&(d=1e-4,d>A&&A>-d&&(A=D=2e-5),d>M&&M>-d&&(M=D=2e-5),!F||S.z||S.rotationX||S.rotationY||(F=0)),O||S.skewX)O*=N,m=e=Math.cos(O),g=s=Math.sin(O),S.skewX&&(O-=S.skewX*N,m=Math.cos(O),g=Math.sin(O),"simple"===S.skewType&&(v=Math.tan(S.skewX*N),v=Math.sqrt(1+v*v),m*=v,g*=v,S.skewY&&(e*=v,s*=v))),i=-g,n=m;else{if(!(R||k||1!==D||F||E))return C[we]=(S.xPercent||S.yPercent?"translate("+S.xPercent+"%,"+S.yPercent+"%) translate3d(":"translate3d(")+L+"px,"+X+"px,"+z+"px)"+(1!==A||1!==M?" scale("+A+","+M+")":""),void 0;e=n=1,i=s=0}h=1,r=a=o=l=u=f=0,p=F?-1/F:0,_=S.zOrigin,d=1e-6,T=",",w="0",O=R*N,O&&(m=Math.cos(O),g=Math.sin(O),o=-g,u=p*-g,r=e*g,a=s*g,h=m,p*=m,e*=m,s*=m),O=k*N,O&&(m=Math.cos(O),g=Math.sin(O),v=i*m+r*g,y=n*m+a*g,l=h*g,f=p*g,r=i*-g+r*m,a=n*-g+a*m,h*=m,p*=m,i=v,n=y),1!==D&&(r*=D,a*=D,h*=D,p*=D),1!==M&&(i*=M,n*=M,l*=M,f*=M),1!==A&&(e*=A,s*=A,o*=A,u*=A),(_||E)&&(_&&(L+=r*-_,X+=a*-_,z+=h*-_+_),E&&(L+=S.xOrigin-(S.xOrigin*e+S.yOrigin*i),X+=S.yOrigin-(S.xOrigin*s+S.yOrigin*n)),d>L&&L>-d&&(L=w),d>X&&X>-d&&(X=w),d>z&&z>-d&&(z=0)),x=S.xPercent||S.yPercent?"translate("+S.xPercent+"%,"+S.yPercent+"%) matrix3d(":"matrix3d(",x+=(d>e&&e>-d?w:e)+T+(d>s&&s>-d?w:s)+T+(d>o&&o>-d?w:o),x+=T+(d>u&&u>-d?w:u)+T+(d>i&&i>-d?w:i)+T+(d>n&&n>-d?w:n),k||R?(x+=T+(d>l&&l>-d?w:l)+T+(d>f&&f>-d?w:f)+T+(d>r&&r>-d?w:r),x+=T+(d>a&&a>-d?w:a)+T+(d>h&&h>-d?w:h)+T+(d>p&&p>-d?w:p)+T):x+=",0,0,0,0,1,0,",x+=L+T+X+T+z+T+(F?1+-z/F:1)+")",C[we]=x};h=Ce.prototype,h.x=h.y=h.z=h.skewX=h.skewY=h.rotation=h.rotationX=h.rotationY=h.zOrigin=h.xPercent=h.yPercent=0,h.scaleX=h.scaleY=h.scaleZ=1,ve("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent",{parser:function(t,e,i,r,n,o,l){if(r._lastParsedTransform===l)return n;r._lastParsedTransform=l;var h,u,f,p,c,_,d,m=r._transform=De(t,s,!0,l.parseTransform),g=t.style,v=1e-6,y=Te.length,x=l,T={};if("string"==typeof x.transform&&we)f=F.style,f[we]=x.transform,f.display="block",f.position="absolute",z.body.appendChild(F),h=De(F,null,!1),z.body.removeChild(F);else if("object"==typeof x){if(h={scaleX:ne(null!=x.scaleX?x.scaleX:x.scale,m.scaleX),scaleY:ne(null!=x.scaleY?x.scaleY:x.scale,m.scaleY),scaleZ:ne(x.scaleZ,m.scaleZ),x:ne(x.x,m.x),y:ne(x.y,m.y),z:ne(x.z,m.z),xPercent:ne(x.xPercent,m.xPercent),yPercent:ne(x.yPercent,m.yPercent),perspective:ne(x.transformPerspective,m.perspective)},d=x.directionalRotation,null!=d)if("object"==typeof d)for(f in d)x[f]=d[f];else x.rotation=d;"string"==typeof x.x&&-1!==x.x.indexOf("%")&&(h.x=0,h.xPercent=ne(x.x,m.xPercent)),"string"==typeof x.y&&-1!==x.y.indexOf("%")&&(h.y=0,h.yPercent=ne(x.y,m.yPercent)),h.rotation=ae("rotation"in x?x.rotation:"shortRotation"in x?x.shortRotation+"_short":"rotationZ"in x?x.rotationZ:m.rotation,m.rotation,"rotation",T),Se&&(h.rotationX=ae("rotationX"in x?x.rotationX:"shortRotationX"in x?x.shortRotationX+"_short":m.rotationX||0,m.rotationX,"rotationX",T),h.rotationY=ae("rotationY"in x?x.rotationY:"shortRotationY"in x?x.shortRotationY+"_short":m.rotationY||0,m.rotationY,"rotationY",T)),h.skewX=null==x.skewX?m.skewX:ae(x.skewX,m.skewX),h.skewY=null==x.skewY?m.skewY:ae(x.skewY,m.skewY),(u=h.skewY-m.skewY)&&(h.skewX+=u,h.rotation+=u)}for(Se&&null!=x.force3D&&(m.force3D=x.force3D,_=!0),m.skewType=x.skewType||m.skewType||a.defaultSkewType,c=m.force3D||m.z||m.rotationX||m.rotationY||h.z||h.rotationX||h.rotationY||h.perspective,c||null==x.scale||(h.scaleZ=1);--y>-1;)i=Te[y],p=h[i]-m[i],(p>v||-v>p||null!=x[i]||null!=X[i])&&(_=!0,n=new _e(m,i,m[i],p,n),i in T&&(n.e=T[i]),n.xs0=0,n.plugin=o,r._overwriteProps.push(n.n));return p=x.transformOrigin,m.svg&&(p||x.svgOrigin)&&(Me(t,re(p),h,x.svgOrigin),n=new _e(m,"xOrigin",m.xOrigin,h.xOrigin-m.xOrigin,n,-1,"transformOrigin"),n.b=m.xOrigin,n.e=n.xs0=h.xOrigin,n=new _e(m,"yOrigin",m.yOrigin,h.yOrigin-m.yOrigin,n,-1,"transformOrigin"),n.b=m.yOrigin,n.e=n.xs0=h.yOrigin,p=xe?null:"0px 0px"),(p||Se&&c&&m.zOrigin)&&(we?(_=!0,i=Pe,p=(p||Q(t,i,s,!1,"50% 50%"))+"",n=new _e(g,i,0,0,n,-1,"transformOrigin"),n.b=g[i],n.plugin=o,Se?(f=m.zOrigin,p=p.split(" "),m.zOrigin=(p.length>2&&(0===f||"0px"!==p[2])?parseFloat(p[2]):f)||0,n.xs0=n.e=p[0]+" "+(p[1]||"50%")+" 0px",n=new _e(m,"zOrigin",0,0,n,-1,n.n),n.b=f,n.xs0=n.e=m.zOrigin):n.xs0=n.e=p):re(p+"",m)),_&&(r._transformType=m.svg&&xe||!c&&3!==this._transformType?2:3),n},prefix:!0}),ve("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),ve("borderRadius",{defaultValue:"0px",parser:function(t,e,i,n,a){e=this.format(e);var o,l,h,u,f,p,c,_,d,m,g,v,y,x,T,w,b=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],P=t.style;for(d=parseFloat(t.offsetWidth),m=parseFloat(t.offsetHeight),o=e.split(" "),l=0;b.length>l;l++)this.p.indexOf("border")&&(b[l]=G(b[l])),f=u=Q(t,b[l],s,!1,"0px"),-1!==f.indexOf(" ")&&(u=f.split(" "),f=u[0],u=u[1]),p=h=o[l],c=parseFloat(f),v=f.substr((c+"").length),y="="===p.charAt(1),y?(_=parseInt(p.charAt(0)+"1",10),p=p.substr(2),_*=parseFloat(p),g=p.substr((_+"").length-(0>_?1:0))||""):(_=parseFloat(p),g=p.substr((_+"").length)),""===g&&(g=r[i]||v),g!==v&&(x=Z(t,"borderLeft",c,v),T=Z(t,"borderTop",c,v),"%"===g?(f=100*(x/d)+"%",u=100*(T/m)+"%"):"em"===g?(w=Z(t,"borderLeft",1,"em"),f=x/w+"em",u=T/w+"em"):(f=x+"px",u=T+"px"),y&&(p=parseFloat(f)+_+g,h=parseFloat(u)+_+g)),a=de(P,b[l],f+" "+u,p+" "+h,!1,"0px",a);return a},prefix:!0,formatter:fe("0px 0px 0px 0px",!1,!0)}),ve("backgroundPosition",{defaultValue:"0 0",parser:function(t,e,i,r,n,a){var o,l,h,u,f,p,c="background-position",_=s||H(t,null),m=this.format((_?d?_.getPropertyValue(c+"-x")+" "+_.getPropertyValue(c+"-y"):_.getPropertyValue(c):t.currentStyle.backgroundPositionX+" "+t.currentStyle.backgroundPositionY)||"0 0"),g=this.format(e);if(-1!==m.indexOf("%")!=(-1!==g.indexOf("%"))&&(p=Q(t,"backgroundImage").replace(O,""),p&&"none"!==p)){for(o=m.split(" "),l=g.split(" "),I.setAttribute("src",p),h=2;--h>-1;)m=o[h],u=-1!==m.indexOf("%"),u!==(-1!==l[h].indexOf("%"))&&(f=0===h?t.offsetWidth-I.width:t.offsetHeight-I.height,o[h]=u?parseFloat(m)/100*f+"px":100*(parseFloat(m)/f)+"%");m=o.join(" ")}return this.parseComplex(t.style,m,g,n,a)},formatter:re}),ve("backgroundSize",{defaultValue:"0 0",formatter:re}),ve("perspective",{defaultValue:"0px",prefix:!0}),ve("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),ve("transformStyle",{prefix:!0}),ve("backfaceVisibility",{prefix:!0}),ve("userSelect",{prefix:!0}),ve("margin",{parser:pe("marginTop,marginRight,marginBottom,marginLeft")}),ve("padding",{parser:pe("paddingTop,paddingRight,paddingBottom,paddingLeft")}),ve("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(t,e,i,r,n,a){var o,l,h;return 9>d?(l=t.currentStyle,h=8>d?" ":",",o="rect("+l.clipTop+h+l.clipRight+h+l.clipBottom+h+l.clipLeft+")",e=this.format(e).split(",").join(h)):(o=this.format(Q(t,this.p,s,!1,this.dflt)),e=this.format(e)),this.parseComplex(t.style,o,e,n,a)}}),ve("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),ve("autoRound,strictUnits",{parser:function(t,e,i,r,s){return s}}),ve("border",{defaultValue:"0px solid #000",parser:function(t,e,i,r,n,a){return this.parseComplex(t.style,this.format(Q(t,"borderTopWidth",s,!1,"0px")+" "+Q(t,"borderTopStyle",s,!1,"solid")+" "+Q(t,"borderTopColor",s,!1,"#000")),this.format(e),n,a)},color:!0,formatter:function(t){var e=t.split(" ");return e[0]+" "+(e[1]||"solid")+" "+(t.match(ue)||["#000"])[0]}}),ve("borderWidth",{parser:pe("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),ve("float,cssFloat,styleFloat",{parser:function(t,e,i,r,s){var n=t.style,a="cssFloat"in n?"cssFloat":"styleFloat";return new _e(n,a,0,0,s,-1,i,!1,0,n[a],e)}});var Xe=function(t){var e,i=this.t,r=i.filter||Q(this.data,"filter")||"",s=0|this.s+this.c*t;100===s&&(-1===r.indexOf("atrix(")&&-1===r.indexOf("radient(")&&-1===r.indexOf("oader(")?(i.removeAttribute("filter"),e=!Q(this.data,"filter")):(i.filter=r.replace(b,""),e=!0)),e||(this.xn1&&(i.filter=r=r||"alpha(opacity="+s+")"),-1===r.indexOf("pacity")?0===s&&this.xn1||(i.filter=r+" alpha(opacity="+s+")"):i.filter=r.replace(T,"opacity="+s))};ve("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(t,e,i,r,n,a){var o=parseFloat(Q(t,"opacity",s,!1,"1")),l=t.style,h="autoAlpha"===i;return"string"==typeof e&&"="===e.charAt(1)&&(e=("-"===e.charAt(0)?-1:1)*parseFloat(e.substr(2))+o),h&&1===o&&"hidden"===Q(t,"visibility",s)&&0!==e&&(o=0),U?n=new _e(l,"opacity",o,e-o,n):(n=new _e(l,"opacity",100*o,100*(e-o),n),n.xn1=h?1:0,l.zoom=1,n.type=2,n.b="alpha(opacity="+n.s+")",n.e="alpha(opacity="+(n.s+n.c)+")",n.data=t,n.plugin=a,n.setRatio=Xe),h&&(n=new _e(l,"visibility",0,0,n,-1,null,!1,0,0!==o?"inherit":"hidden",0===e?"hidden":"inherit"),n.xs0="inherit",r._overwriteProps.push(n.n),r._overwriteProps.push(i)),n}});var ze=function(t,e){e&&(t.removeProperty?(("ms"===e.substr(0,2)||"webkit"===e.substr(0,6))&&(e="-"+e),t.removeProperty(e.replace(S,"-$1").toLowerCase())):t.removeAttribute(e))},Ee=function(t){if(this.t._gsClassPT=this,1===t||0===t){this.t.setAttribute("class",0===t?this.b:this.e);for(var e=this.data,i=this.t.style;e;)e.v?i[e.p]=e.v:ze(i,e.p),e=e._next;1===t&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};ve("className",{parser:function(t,e,r,n,a,o,l){var h,u,f,p,c,_=t.getAttribute("class")||"",d=t.style.cssText;if(a=n._classNamePT=new _e(t,r,0,0,a,2),a.setRatio=Ee,a.pr=-11,i=!0,a.b=_,u=K(t,s),f=t._gsClassPT){for(p={},c=f.data;c;)p[c.p]=1,c=c._next;f.setRatio(1)}return t._gsClassPT=a,a.e="="!==e.charAt(1)?e:_.replace(RegExp("\\s*\\b"+e.substr(2)+"\\b"),"")+("+"===e.charAt(0)?" "+e.substr(2):""),t.setAttribute("class",a.e),h=J(t,u,K(t),l,p),t.setAttribute("class",_),a.data=h.firstMPT,t.style.cssText=d,a=a.xfirst=n.parse(t,h.difs,a,o)}});var Fe=function(t){if((1===t||0===t)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var e,i,r,s,n,a=this.t.style,o=l.transform.parse;if("all"===this.e)a.cssText="",s=!0;else for(e=this.e.split(" ").join("").split(","),r=e.length;--r>-1;)i=e[r],l[i]&&(l[i].parse===o?s=!0:i="transformOrigin"===i?Pe:l[i].p),ze(a,i);s&&(ze(a,we),n=this.t._gsTransform,n&&(n.svg&&this.t.removeAttribute("data-svg-origin"),delete this.t._gsTransform))}};for(ve("clearProps",{parser:function(t,e,r,s,n){return n=new _e(t,r,0,0,n,2),n.setRatio=Fe,n.e=e,n.pr=-10,n.data=s._tween,i=!0,n}}),h="bezier,throwProps,physicsProps,physics2D".split(","),me=h.length;me--;)ye(h[me]);h=a.prototype,h._firstPT=h._lastParsedTransform=h._transform=null,h._onInitTween=function(t,e,o){if(!t.nodeType)return!1;this._target=t,this._tween=o,this._vars=e,u=e.autoRound,i=!1,r=e.suffixMap||a.suffixMap,s=H(t,""),n=this._overwriteProps;var h,c,d,m,g,v,y,x,T,b=t.style;if(f&&""===b.zIndex&&(h=Q(t,"zIndex",s),("auto"===h||""===h)&&this._addLazySet(b,"zIndex",0)),"string"==typeof e&&(m=b.cssText,h=K(t,s),b.cssText=m+";"+e,h=J(t,h,K(t)).difs,!U&&w.test(e)&&(h.opacity=parseFloat(RegExp.$1)),e=h,b.cssText=m),this._firstPT=c=e.className?l.className.parse(t,e.className,"className",this,null,null,e):this.parse(t,e,null),this._transformType){for(T=3===this._transformType,we?p&&(f=!0,""===b.zIndex&&(y=Q(t,"zIndex",s),("auto"===y||""===y)&&this._addLazySet(b,"zIndex",0)),_&&this._addLazySet(b,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(T?"visible":"hidden"))):b.zoom=1,d=c;d&&d._next;)d=d._next;x=new _e(t,"transform",0,0,null,2),this._linkCSSP(x,null,d),x.setRatio=we?Le:Ne,x.data=this._transform||De(t,s,!0),x.tween=o,x.pr=-1,n.pop()}if(i){for(;c;){for(v=c._next,d=m;d&&d.pr>c.pr;)d=d._next;(c._prev=d?d._prev:g)?c._prev._next=c:m=c,(c._next=d)?d._prev=c:g=c,c=v}this._firstPT=m}return!0},h.parse=function(t,e,i,n){var a,o,h,f,p,c,_,d,m,g,v=t.style;for(a in e)c=e[a],o=l[a],o?i=o.parse(t,c,a,this,i,n,e):(p=Q(t,a,s)+"",m="string"==typeof c,"color"===a||"fill"===a||"stroke"===a||-1!==a.indexOf("Color")||m&&P.test(c)?(m||(c=he(c),c=(c.length>3?"rgba(":"rgb(")+c.join(",")+")"),i=de(v,a,p,c,!0,"transparent",i,0,n)):!m||-1===c.indexOf(" ")&&-1===c.indexOf(",")?(h=parseFloat(p),_=h||0===h?p.substr((h+"").length):"",(""===p||"auto"===p)&&("width"===a||"height"===a?(h=ie(t,a,s),_="px"):"left"===a||"top"===a?(h=$(t,a,s),_="px"):(h="opacity"!==a?0:1,_="")),g=m&&"="===c.charAt(1),g?(f=parseInt(c.charAt(0)+"1",10),c=c.substr(2),f*=parseFloat(c),d=c.replace(x,"")):(f=parseFloat(c),d=m?c.replace(x,""):""),""===d&&(d=a in r?r[a]:_),c=f||0===f?(g?f+h:f)+d:e[a],_!==d&&""!==d&&(f||0===f)&&h&&(h=Z(t,a,h,_),"%"===d?(h/=Z(t,a,100,"%")/100,e.strictUnits!==!0&&(p=h+"%")):"em"===d?h/=Z(t,a,1,"em"):"px"!==d&&(f=Z(t,a,f,d),d="px"),g&&(f||0===f)&&(c=f+h+d)),g&&(f+=h),!h&&0!==h||!f&&0!==f?void 0!==v[a]&&(c||"NaN"!=c+""&&null!=c)?(i=new _e(v,a,f||h||0,0,i,-1,a,!1,0,p,c),i.xs0="none"!==c||"display"!==a&&-1===a.indexOf("Style")?c:p):V("invalid "+a+" tween value: "+e[a]):(i=new _e(v,a,h,f-h,i,0,a,u!==!1&&("px"===d||"zIndex"===a),0,p,c),i.xs0=d)):i=de(v,a,p,c,!0,null,i,0,n)),n&&i&&!i.plugin&&(i.plugin=n);
return i},h.setRatio=function(t){var e,i,r,s=this._firstPT,n=1e-6;if(1!==t||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(t||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;s;){if(e=s.c*t+s.s,s.r?e=Math.round(e):n>e&&e>-n&&(e=0),s.type)if(1===s.type)if(r=s.l,2===r)s.t[s.p]=s.xs0+e+s.xs1+s.xn1+s.xs2;else if(3===r)s.t[s.p]=s.xs0+e+s.xs1+s.xn1+s.xs2+s.xn2+s.xs3;else if(4===r)s.t[s.p]=s.xs0+e+s.xs1+s.xn1+s.xs2+s.xn2+s.xs3+s.xn3+s.xs4;else if(5===r)s.t[s.p]=s.xs0+e+s.xs1+s.xn1+s.xs2+s.xn2+s.xs3+s.xn3+s.xs4+s.xn4+s.xs5;else{for(i=s.xs0+e+s.xs1,r=1;s.l>r;r++)i+=s["xn"+r]+s["xs"+(r+1)];s.t[s.p]=i}else-1===s.type?s.t[s.p]=s.xs0:s.setRatio&&s.setRatio(t);else s.t[s.p]=e+s.xs0;s=s._next}else for(;s;)2!==s.type?s.t[s.p]=s.b:s.setRatio(t),s=s._next;else for(;s;)2!==s.type?s.t[s.p]=s.e:s.setRatio(t),s=s._next},h._enableTransforms=function(t){this._transform=this._transform||De(this._target,s,!0),this._transformType=this._transform.svg&&xe||!t&&3!==this._transformType?2:3};var Ie=function(){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};h._addLazySet=function(t,e,i){var r=this._firstPT=new _e(t,e,0,0,this._firstPT,2);r.e=i,r.setRatio=Ie,r.data=this},h._linkCSSP=function(t,e,i,r){return t&&(e&&(e._prev=t),t._next&&(t._next._prev=t._prev),t._prev?t._prev._next=t._next:this._firstPT===t&&(this._firstPT=t._next,r=!0),i?i._next=t:r||null!==this._firstPT||(this._firstPT=t),t._next=e,t._prev=i),t},h._kill=function(e){var i,r,s,n=e;if(e.autoAlpha||e.alpha){n={};for(r in e)n[r]=e[r];n.opacity=1,n.autoAlpha&&(n.visibility=1)}return e.className&&(i=this._classNamePT)&&(s=i.xfirst,s&&s._prev?this._linkCSSP(s._prev,i._next,s._prev._prev):s===this._firstPT&&(this._firstPT=i._next),i._next&&this._linkCSSP(i._next,i._next._next,s._prev),this._classNamePT=null),t.prototype._kill.call(this,n)};var Ye=function(t,e,i){var r,s,n,a;if(t.slice)for(s=t.length;--s>-1;)Ye(t[s],e,i);else for(r=t.childNodes,s=r.length;--s>-1;)n=r[s],a=n.type,n.style&&(e.push(K(n)),i&&i.push(n)),1!==a&&9!==a&&11!==a||!n.childNodes.length||Ye(n,e,i)};return a.cascadeTo=function(t,i,r){var s,n,a,o,l=e.to(t,i,r),h=[l],u=[],f=[],p=[],c=e._internals.reservedProps;for(t=l._targets||l.target,Ye(t,u,p),l.render(i,!0,!0),Ye(t,f),l.render(0,!0,!0),l._enabled(!0),s=p.length;--s>-1;)if(n=J(p[s],u[s],f[s]),n.firstMPT){n=n.difs;for(a in r)c[a]&&(n[a]=r[a]);o={};for(a in n)o[a]=u[s][a];h.push(e.fromTo(p[s],i,o,n))}return h},t.activate([a]),a},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(t){"use strict";var e=function(){return(_gsScope.GreenSockGlobals||_gsScope)[t]};"function"==typeof define&&define.amd?define(["TweenLite"],e):"undefined"!=typeof module&&module.exports&&(require("../TweenLite.js"),module.exports=e())}("CSSPlugin");
;
;
/*! RoundPropsPlugin.min.js */ 
;
;
/*!
* VERSION: beta 1.4.1
* DATE: 2014-07-17
* UPDATES AND DOCS AT: http://www.greensock.com
*
* @license Copyright (c) 2008-2015, GreenSock. All rights reserved.
* This work is subject to the terms at http://greensock.com/standard-license or for
* Club GreenSock members, the software agreement that was issued with your membership.
* 
* @author: Jack Doyle, jack@greensock.com
**/
var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";var t=_gsScope._gsDefine.plugin({propName:"roundProps",version:"1.4.1",priority:-1,API:2,init:function(t,e,i){return this._tween=i,!0}}),e=t.prototype;e._onInitAllProps=function(){for(var t,e,i,r=this._tween,s=r.vars.roundProps instanceof Array?r.vars.roundProps:r.vars.roundProps.split(","),n=s.length,a={},o=r._propLookup.roundProps;--n>-1;)a[s[n]]=1;for(n=s.length;--n>-1;)for(t=s[n],e=r._firstPT;e;)i=e._next,e.pg?e.t._roundProps(a,!0):e.n===t&&(this._add(e.t,t,e.s,e.c),i&&(i._prev=e._prev),e._prev?e._prev._next=i:r._firstPT===e&&(r._firstPT=i),e._next=e._prev=null,r._propLookup[t]=o),e=i;return!1},e._add=function(t,e,i,r){this._addTween(t,e,i,i+r,e,!0),this._overwriteProps.push(e)}}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()();
;
;
/*! offline.js */ 
;
;
var InVision = angular.module( "InVision", [ "ngResource", "ngRoute", "ngSanitize", "mention" ] );
(function( ng, app ) {
app.constant( "MAX_COMMENT_LIKES_DISPLAYED", 10 );
app.config(
function( $routeProvider, $provide ){
var routes = [
{
resource: "/screens",
action: "preview"
},
{
resource: "/screens/:screenID",
action: "preview"
}
];
angular.forEach(
routes,
function( route, index, collection ){
$routeProvider.when(
route.resource,
{
resource: route.resource,
action: route.action
}
);
}
);
$routeProvider.otherwise({
redirectTo: "/screens"
});
var browser = navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);
if (browser && parseInt(browser[2], 10) >= 45) {
$provide.decorator('$sniffer', ['$delegate', function($delegate) {
$delegate.history = false;
return $delegate;
}]);
}
}
);
})( angular, InVision );
;
;
/*! mention.controller.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention", [])
.controller( "mention.MentionController", mentionController );
function mentionController(
_,
appSettings,
candidatesPartial,
config,
mentionService,
mentionShortcutService,
mentionStorage,
$scope
) {
var vm = this;
var MAX_MATCHES = 250;
vm.searchPeople = searchPeople;
vm.selectPerson = selectPerson;
vm.addMention = addMention;
initialize();
function initialize() {
if (!$scope.hasMentions) {
return;
}
candidatesPartial.load();
}
/**
* Takes the existingMention data and extracts the human-readable
* term, returning it.
*
* @param {Object} existingMention - mention data from the getMentionedUser method
* @returns {String} the extracted, human-readable term
*/
function getTermFromExistingMention( existingMention ) {
if ( existingMention.email ) {
return existingMention.email;
}
return existingMention.name;
}
/**
* Replaces the existing, encoded mention text with a readable
* version of the mention, and returns that readable version
*
* @param {Object} existingMention - mention data from the getMentionedUser method
* @param {Object} mentionInfo - mention data from the getTriggerInfo method
* @returns {String} the extracted, human-readable term
*/
function handleExistingMention( existingMention, mentionInfo ) {
var startPos = mentionInfo.mentionPosition;
var endPos = startPos + mentionInfo.mentionText.length + 1;
var term = getTermFromExistingMention( existingMention );
mentionService.replaceInputText(
mentionInfo.mentionSelectedElement,
mentionInfo.mentionTriggerChar + term,
startPos,
endPos
);
return term;
}
/**
* Loops over the `people` array and returns a new array where
* the appropriate values (determined by triggerChar) match the
* specified term
*
* @param {String} triggerChar - determines which filter algorithm to use
* @param {String} currentTerm - the value that will be matched against
* @returns {Array} the filtered list of people
*/
function generatePeopleList( triggerChar, currentTerm ) {
var term = currentTerm || "";
var upperCaseTerm = term.toUpperCase();
var mentionShortcuts = buildShortcuts();
var handlers = {
"@": function handleMentions( item ) {
var name = item.name.replace( /\s*/g, "" ).toUpperCase();
return ~name.indexOf( upperCaseTerm );
},
"+": function handleEmailMentions( item ) {
var email = ( item.email || "" ).toUpperCase();
return ~email.indexOf( upperCaseTerm );
}
};
var handler = handlers[triggerChar] || function noop() {};
var matches = _.filter( mentionShortcuts.concat(candidatesPartial.data.candidates.candidates), handler );
if (matches.length > MAX_MATCHES) {
return {
isOverMax: true,
matches: []
};
}
return {
isOverMax: false,
matches: matches
};
}
function searchPeople( mentionInfo ) {
var term = mentionInfo.mentionText || "";
var triggerChar = mentionInfo.mentionTriggerChar;
var existingMention = mentionService.getMentionedUser( term );
if ( existingMention ) {
term = handleExistingMention( existingMention, mentionInfo );
}
var peopleList = generatePeopleList( triggerChar, term );
var peopleListIsPopulated = peopleList.matches.length > 0;
var termHasValue = term.length > 0;
var isMention = triggerChar === "@";
var isDefaultView = isMention && !termHasValue;
var noMatches = isMention && termHasValue && !peopleListIsPopulated && !peopleList.isOverMax;
var overMax = isMention && termHasValue && peopleList.isOverMax;
var isNewUser = isMention && term.length > 2 && !peopleListIsPopulated;
vm.view = "default";
if ( isDefaultView ) {
vm.view = "defaultNoTerm";
}
if ( noMatches ) {
vm.view = "noCandidates";
}
if ( overMax ) {
vm.view = "overMax";
}
if ( isNewUser ) {
vm.view = "newUser";
}
vm.people = peopleList.matches;
}
function selectPerson( person ) {
var triggerChar = "@";
var name = person.name.replace( /\s/g, "" );
var id = person.id;
var isShortcut = person.role === "shortcut";
if ( !id && !isShortcut ) {
triggerChar = "+";
id = mentionService.isEmailAddress( person.email ) ? person.email : null;
name = id;
}
if ( id || isShortcut ) {
return triggerChar + name;
}
return person.name;
}
function addMention( person, startPos ) {
mentionStorage.insert( person, startPos );
}
function buildShortcuts() {
var hasMentionShortcuts = appSettings.getSettings().features.mentionShortcut;
if (!hasMentionShortcuts) {
return [];
}
var shortcuts = mentionShortcutService.getShortcuts();
if(
config.featureFlags["prototypes-rain-690-sunset-conversation"] ||
config.featureFlags["boards-rain-687-sunset-conversation"]
) {
return [_.find(shortcuts, function(s) {
return s.name === "project";
})];
}
return shortcuts;
}
}
})( angular );
;
;
/*! empty.js */ 
;
;

;
;
/*! cmd-enter.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invCmdEnter", CmdEnterDirective );
function CmdEnterDirective() {
return({
link: link,
restrict: "A"
});
function link( scope, element, attributes ) {
element.on(
"keydown",
function handleKeyEvent( event ) {
if ( ( event.which === 13 ) && event.metaKey ) {
event.preventDefault();
scope.$apply(
function changeViewModel() {
scope.$eval(
attributes.invCmdEnter,
{
$event: event
}
);
}
);
}
}
);
}
}
})( angular, InVision );
;
;
/*! emit-repeat-finish.js */ 
;
;
/**
* Gives ng-repeats the ability to emit that it has finished its rendering ( can trigger multiple times )
* Usage: <div ng-repeat="item in items" on-repeat-finish="projectListRepeatComplete"></div>
*/
angular.module("InVision")
.directive("emitRepeatFinish", function($timeout) {
return {
restrict: "A",
link: function(scope, element, attr) {
if ( scope.$last ) {
$timeout(function () {
scope.$emit(attr.emitRepeatFinish ? attr.emitRepeatFinish : 'ngRepeatFinished');
});
}
}
};
});
;
;
/*! global-uploader.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invGlobalUploader", Directive );
var uploader;
var screenSourceIntroPref = {
isLoaded: false,
showScreenSourceModal: true
};
var retinaNotice = {
isActive: false,
beenSeen: false
};
var isMissingFileExtension = function( filename ) {
var extensionPattern = /\.[^.]+$/i;
return( ! extensionPattern.test( filename ) );
};
var isNotUploading = function() {
return( uploader.state === plupload.STOPPED );
};
var isPDF = function( name ) {
var pattern = /\.(pdf)$/i;
return(
pattern.test( name )
);
};
var isSourceFile = function( name ) {
var pattern = /\.(psd|ai|sketch)$/i;
return(
pattern.test( name )
);
};
var isLayerExtractionFile = function( name ) {
var pattern = /\.(psd|ai|sketch|pdf)$/i;
return(
pattern.test( name )
);
};
var isValidFilename = function( name ) {
var pattern = /\.(gif|jpe?g|png|pdf|psd|ai|sketch)$/i;
return(
pattern.test( name )
);
};
var isImage = function( name ) {
var pattern = /\.(gif|jpe?g|png)$/i;
return (
pattern.test( name )
);
};
var getFileExtension = function( name ) {
return name.split(".").pop();
}
/** @ngInject */
function Directive( $rootScope, $timeout, screenService, sessionService, userPreferenceService, modelEvents, _, errorLogService, boardService, utilityService, analyticsService, config, clientEvents ) {
var maxInBytes = 10485760;
var _projectID;
var _uploadType = "screen";
var _uploadSource = ""; // helps track where the image was being uploaded from within the app.
var _screenType = "";
var _boardID;
var _boardGroupID;
var addingFiles = false;
var _internalQueue = [];
var _skipQueueChangedEvent = false;
var link = function(scope, element){
$rootScope.globalUploadInfo = {
upload: {
files: [],
statusText: ''
},
sync: {
files: [],
processed: [],
statusText: ''
}
};
element.find('body').append('<button id="globalPluploadButton"></button>');
var uploadButton = $('#globalPluploadButton');
uploader = new plupload.Uploader({
runtimes: "html5",
url: "/api/screens",
multipart: false,
method: 'put',
max_retries: 3,
browse_button: "globalPluploadButton",
headers: {}
});
if ( config.featureFlags["encryption-at-rest"] ) {
uploader.settings.headers["x-amz-server-side-encryption"] = "AES256";
}
uploader.bind( "BeforeUpload", handleBeforeUpload );
uploader.bind( "QueueChanged", handleQueueChanged );
uploader.bind( "FilesAdded", handleFilesAdded );
uploader.bind( "FileUploaded", handleFileUploaded);
uploader.bind( "UploadComplete", handleUploadComplete);
uploader.bind( "Error", handleError );
uploader.bind( "UploadProgress", handleUploadProgress);
uploader.init();
scope.$on('globalUploadBrowse', function(e, projectID){
_uploadType = 'screen';
_projectID = projectID;
_screenType = '';
uploadButton.trigger('click');
});
scope.$on('globalUploadBoardsBrowse', function(e, boardID, boardGroupID) {
_uploadType = 'boardItem';
_boardID = boardID;
_boardGroupID = boardGroupID;
uploadButton.trigger('click');
});
scope.$on('globalUploadBoardHeaderBrowse', function(e, boardID) {
_uploadType = 'boardPhotoHeader';
_boardID = boardID;
uploadButton.trigger('click');
});
scope.$on('globalUploadLoadingScreen', function(e, projectID){
_uploadType = "screen";
_projectID = projectID;
_screenType = "LoadingScreen";
uploadButton.trigger("click");
});
scope.$on('globalUploadPlaceholderScreen', function(e, file, suggestedSort, dividerID, projectID, workflowStatusID){
_uploadType = "screen";
_projectID = projectID;
var filesToAdd = [];
var file = new plupload.File(new mOxie.File(null, file), file.name);
file.getSource().suggestedSort = suggestedSort;
file.getSource().dividerID = dividerID;
file.getSource().projectID = projectID;
file.getSource().isPlaceholder = 1;
file.getSource().workflowStatusID = workflowStatusID || 0;
file.getSource().forceCreate = 1;
filesToAdd.push( file );
setTimeout(function() {
uploader.trigger( "FilesAdded", filesToAdd );
}, 1);
});
scope.$on("globalUploadAddScreens", function(e, files, suggestedSort, dividerID, projectID) {
_uploadType = "screen";
_uploadSource = "screens_tab";
_projectID = projectID;
var filesToAdd = [];
for ( var i = ( files.length - 1 ) ; i >= 0 ; i-- ) {
var file = new plupload.File(new mOxie.File(null, files[i]), files[i].name);
file.getSource().suggestedSort = suggestedSort;
file.getSource().dividerID = dividerID;
file.getSource().projectID = projectID;
filesToAdd.push(file);
}
filesToAdd = _.sortOnPropertyUsingNaturalOrder( filesToAdd, "name" );
if(filesToAdd.length) {
setTimeout(function() {
uploader.trigger( "FilesAdded", filesToAdd );
}, 1);
}
});
scope.$on('globalUploadReplaceScreen', function(e, file, screenID, projectID, isPlaceholder){
_uploadType = 'screen';
_projectID = projectID;
var filesToAdd = [];
var file = new plupload.File(new mOxie.File(null, file));
file.getSource().screenID = screenID;
file.getSource().projectID = projectID;
file.getSource().isPlaceholder = isPlaceholder || 0;
filesToAdd.push( file );
setTimeout(function(){
uploader.trigger( 'FilesAdded', filesToAdd );
},1);
});
scope.$on('globalUploadAddBoardItems', function(e, files, suggestedSort, boardGroupID, boardID){
_uploadType = 'boardItem';
_boardID = boardID;
var filesToAdd = [];
for ( var i = ( files.length - 1 ) ; i >= 0 ; i-- ){
var file = new plupload.File(new mOxie.File(null, files[i]), files[i].name);
file.getSource().suggestedSort = suggestedSort + i;
file.getSource().boardGroupID = boardGroupID;
file.getSource().boardID = boardID;
filesToAdd.push(file);
}
filesToAdd = _.sortOnPropertyUsingNaturalOrder( filesToAdd, "name" );
if(filesToAdd.length){
setTimeout(function(){
uploader.trigger( 'FilesAdded', filesToAdd );
},1);
}
});
scope.$on('globalUploadAddBoardHeaderImage', function(e, files, boardID){
_uploadType = 'boardPhotoHeader';
_boardID = boardID;
var filesToAdd = [];
for ( var i = ( files.length - 1 ) ; i >= 0 ; i-- ){
var file = new plupload.File(new mOxie.File(null, files[i]));
file.getSource().boardID = boardID;
filesToAdd.push( file );
}
setTimeout(function(){
uploader.trigger( 'FilesAdded', filesToAdd );
},1);
});
$rootScope.globalUploadStatusText = function() {
return $rootScope.globalUploadInfo.upload.statusText + $rootScope.globalUploadInfo.sync.statusText;
};
function validateFiles( files ) {
var filesToAdd = [];
var fileExcludedBasedOnName = null;
var i;
var triggerExtractionWarning = false;
var failedFileExtensions = [];
for ( i = ( files.length - 1 ); i >= 0; i-- ){
var file = files[i];
if (_uploadType !== "boardItem" &&
_uploadType !== "boardPhotoHeader" &&
isSourceFile(file.name)
) {
failedFileExtensions.push(getFileExtension(file.name))
triggerExtractionWarning = true;
delete files[ i ];
} else if ( ! isValidFilename( file.name ) || utilityService.isHTML( file.name ) ) {
fileExcludedBasedOnName = file.name;
delete files[ i ];
} else if (file.size > maxInBytes && !isPDF(file.name) && !isSourceFile(file.name)) { // limit the max file size, unless it's a PDF or a screen source file
$timeout(function() {
scope.openModalWindow(
"imageFileTooLarge",
( "\"" + file.name + "\" is a little too big. Try uploading an image that's under 10 MB." )
);
});
delete files[ i ];
}else{
filesToAdd.unshift(file);
}
}
if( !! fileExcludedBasedOnName ) {
$timeout(function() {
scope.openModalWindow( "error", "The file, \"" + fileExcludedBasedOnName + ",\" was skipped since it doesn't appear to be an image file." );
});
}
if (triggerExtractionWarning) {
$timeout(function() {
scope.openModalWindow( "onboardingCraftFullScreen", { fileExtensions: failedFileExtensions } );
});
}
return filesToAdd;
}
function validateBoardFiles( files ) {
var filesToAdd = [];
var fileIsMissingExtension = null;
var i;
for ( i = ( files.length - 1 ); i >= 0; i-- ){
var file = files[i];
if ( isMissingFileExtension( file.name ) ) {
fileIsMissingExtension = file.name;
delete files[ i ];
}else if ( file.size > maxInBytes && isImage( file.name ) ) { // limit the max file size, unless it's a PDF or a screen source file
$timeout(function() {
scope.openModalWindow(
"imageFileTooLarge",
( "\"" + file.name + "\" is a little too big. Try uploading an image that's under 10 MB." )
);
});
delete files[ i ];
}else{
filesToAdd.unshift(file);
}
}
if( !! fileIsMissingExtension ) {
$timeout(function() {
scope.openModalWindow( "error", "The file, \"" + fileIsMissingExtension + ",\" was skipped since it doesn't appear to be a valid file." );
});
}
return filesToAdd;
}
function validateBoardHeaderFiles( files ) {
var filesToAdd = [];
var fileExcludedBasedOnName = null;
if( files.length > 1 ) {
scope.openModalWindow("error", "You can only use a single image as the header.");
} else {
for ( var i = ( files.length - 1 ) ; i >= 0 ; i-- ){
var file = files[i];
if( ! isImage( file.name ) ) {
$timeout(function() {
scope.openModalWindow("error", "Header images must have a .jpg, .png, or .gif extension.");
});
}else if (file.size > maxInBytes) { // limit the max file size, unless it's a PDF or a screen source file
$timeout(function() {
scope.openModalWindow(
"imageFileTooLarge",
( "\"" + file.name + "\" is a little too big. Try uploading an image that's under 10 MB." )
);
});
} else {
filesToAdd.push(file);
}
}
}
return filesToAdd;
}
function handleFilesAdded( up, files ){
if ( up.state === plupload.UPLOADING ) {
_internalQueue.push(files);
return;
}
if ( _uploadType === "boardItem" ) {
files = validateBoardFiles(files);
} else if ( _uploadType === "boardPhotoHeader" ) {
files = validateBoardHeaderFiles(files);
} else {
files = validateFiles(files);
}
_removeInvalidFiles(up, files);
if ( files.length === 0 ) {
return;
}
clientEvents.forNamespace("globalUploader")
.trigger("filesAdded", {
type: _uploadType,
source: _uploadSource
}
);
var user = sessionService.user;
scope.$apply(function(){
if(!$rootScope.globalUploadInfo.upload.files.length){
$rootScope.globalUploadInfo.upload.statusText = 'Initializing Upload...';
}
scope.$broadcast('hideUploadOverlay');
});
var requestFiles = [];
var tempFiles = [];
var tempScreens = [];
var maintainedSort = -1;
var boardID = 0;
if(_uploadType === "screen"){
var projectID = files[0].getSource().projectID || _projectID;
var isLoadingScreen = false;
if(_screenType === "LoadingScreen"){
if(files.length > 1){
scope.openModalWindow( "error", "You can only select one Loading Screen" );
return;
}else if(isLayerExtractionFile(files[0].name)){
scope.openModalWindow( "error", "You can't use a source file for a Loading Screen" );
return;
}else{
isLoadingScreen = true;
}
}
files.forEach(function(file, index){
tempFiles.push(file);
up.files.splice(_.findIndex(up.files, { id: file.id}), 1);
var dividerID = typeof file.getSource().dividerID === 'undefined' ? -1 : file.getSource().dividerID;
var suggestedSort = file.getSource().suggestedSort || -1;
var screenID = file.getSource().screenID || 0;
var screenTypeID = 1;
var requestFile = {
file: file.name,
uid: file.id,
isPlaceholder: file.getSource().isPlaceholder || 0,
workflowStatusID: file.getSource().workflowStatusID || 0,
forceCreate: file.getSource().forceCreate || 0
};
if(isLoadingScreen){
suggestedSort = 1;
dividerID = 0;
screenTypeID = 3;
requestFile.isLoadingScreen = true;
}
if( suggestedSort !== -1 ){
suggestedSort = suggestedSort + index;
}
if ( !isLayerExtractionFile(file.name) ){
tempScreens.push({
file: file,
user: user,
projectID: projectID,
dividerID: dividerID,
suggestedSort: suggestedSort,
screenID: screenID,
screenTypeID: screenTypeID
});
}
if(screenID){
requestFile.screenid = screenID;
}else{
requestFile.suggestedSort = suggestedSort;
requestFile.dividerID = dividerID;
}
requestFiles.push(requestFile);
});
InvScreens.actions.addTempScreens(tempScreens);
var screensToUpdate = [];
screenService.requestUpload(requestFiles, projectID).then(function(signedFiles){
signedFiles.forEach(function(signedFile, index){
var file = _.find(tempFiles, {id: signedFile.uid});
file.getSource().signedUrl = signedFile.signedurl;
file.getSource().projectID = projectID;
if( !file.getSource().screenID && !isLayerExtractionFile(file.name) ){
screensToUpdate.push({
file: file,
projectID: projectID,
id: signedFile.id,
name: signedFile.name,
sort: signedFile.sort
});
}
if(isLayerExtractionFile(file.name)){
var syncFile = {
name: file.name,
projectID: projectID,
groupID: projectID,
status: "uploading",
screens: 0,
assetID: 0
};
$rootScope.globalUploadInfo.sync.files.push(syncFile);
scope.$broadcast('setShowingUploadingFiles', true);
}
$rootScope.globalUploadInfo.upload.files.push({
projectID: projectID,
name: file.name,
id: signedFile.id || file.getSource().screenID || 0,
percent: 0,
uploaded: false
});
up.files.push(file);
});
InvScreens.actions.updateTempScreens(screensToUpdate);
$timeout(updateGlobalUploadInfo);
tempFiles = requestFiles = null;
up.start();
}, function(){
tempFiles = requestFiles = null;
});
}else if ( _uploadType === "boardItem" ){
var boardGroupID = files[0].getSource().boardGroupID || _boardGroupID;
boardID = files[0].getSource().boardID || _boardID;
if( !! files ) {
files.forEach(function(file, index){
tempFiles.push(file);
up.files.splice(_.findIndex(up.files, { id: file.id}), 1);
var boardItemID = file.getSource().boardItemID || 0;
if(
file.type.indexOf("image/") >= 0 &&
["psd", "sketch", "ai"].indexOf(file.name.split('.').pop().toLowerCase()) === -1
) {
var fileName = file.name;
fileName = fileName.replace(/\.[^/.]+$/, "");
fileName = fileName.replace(/[_-]/g, " ");
fileName = fileName.replace(/\w\S*/g, function( match ) {
return match.charAt(0).toUpperCase() + match.substr(1);
});
file.getSource().title = fileName;
} else {
file.getSource().title = file.name;
}
var title = file.getSource().title;
var sort = file.getSource().suggestedSort || -1;
var requestFile = {
file: file.name,
uid: file.id,
title: title,
sort: sort
};
InvBoards.actions.addTempItem(file, user, boardID, boardGroupID, title, sort);
requestFiles.push(requestFile);
});
}
boardService.requestUpload(requestFiles, boardGroupID).then(function(signedFiles){
signedFiles.forEach(function(signedFile, index){
var file = _.find(tempFiles, {id: signedFile.uid});
file.getSource().signedUrl = signedFile.signedurl;
file.getSource().boardID = boardID;
InvBoards.actions.updateTempItem(file, boardID, signedFile.id);
$rootScope.globalUploadInfo.upload.files.push({
boardID: boardID,
id: signedFile.id || file.getSource().boardItemID || 0,
percent: 0,
name: file.name,
uploaded: false
});
up.files.push(file);
});
$timeout(updateGlobalUploadInfo);
tempFiles = requestFiles = null;
up.start();
}, function(){
tempFiles = requestFiles = null;
});
}else if ( _uploadType === "boardPhotoHeader" ){
requestFiles = [];
tempFiles = [];
boardID = files[0].getSource().boardID || _boardID;
files.forEach(function(file, index){
file.getSource().boardID = boardID;
tempFiles.push(file);
up.files.splice(_.findIndex(up.files, { id: file.id}), 1);
var requestFile = {
file: file.name,
uid: file.id
};
InvBoards.actions.addTempHeader(boardID, file);
requestFiles.push(requestFile);
});
boardService.requestPhotoHeaderUpload(requestFiles[0], boardID).then(function(signedFiles){
signedFiles.forEach(function(signedFile, index){
var file = _.find(tempFiles, {id: signedFile.uid});
file.getSource().signedUrl = signedFile.signedurl;
file.getSource().boardID = boardID;
$rootScope.globalUploadInfo.upload.files.push({
boardID: boardID,
name: file.name,
percent: 0,
uploaded: false
});
up.files.push(file);
});
$timeout(updateGlobalUploadInfo);
tempFiles = requestFiles = null;
up.start();
}, function(){
tempFiles = requestFiles = null;
});
}
_screenType = "";
}
function _removeInvalidFiles(up, files) {
var filesToRemove = [];
up.files.forEach(function(file) {
var validFile = _.find(files, { id: file.id });
if (!validFile) {
filesToRemove.push(file);
};
});
_skipQueueChangedEvent = true;
filesToRemove.forEach(function(file) {
up.removeFile(file); // this will trigger "QueueChanged" event
});
_skipQueueChangedEvent = false;
}
function handleBeforeUpload(up, file ){
up.settings.url = file.getSource().signedUrl;
file.status = plupload.UPLOADING;
up.trigger( "UploadFile", file );
return false;
}
function findUploadingFile(file){
var info;
if(file.getSource().projectID){
info = _.find($rootScope.globalUploadInfo.upload.files,
{'name':file.name, 'projectID': file.getSource().projectID, 'uploaded': false});
}else if(file.getSource().boardID){
info = _.find($rootScope.globalUploadInfo.upload.files,
{'name':file.name, 'boardID': file.getSource().boardID, 'uploaded': false});
}
return info;
}
function handleFileUploaded(up, file){
trackUpload("Success", file);
if(file.getSource().hasOwnProperty('projectID')){
asyncRetinaModalNotificationCheck([file]);
}
$timeout(function(){
var uploadInfo = findUploadingFile(file);
var syncFile = _.find($rootScope.globalUploadInfo.sync.files,
{'name':file.name, 'groupID': file.getSource().projectID, 'status': 'uploading'});
if(uploadInfo){
uploadInfo.uploaded = true;
}
if(syncFile){
syncFile.status = "initializing";
}
updateGlobalUploadInfo();
});
}
function isRetinaImage(img) {
if (img.width >= 2000) {
return true;
}
return false;
}
function readUploadedFiles(files) {
return files.map(function(file) {
return new Promise(function(accept) {
var reader = new FileReader();
reader.onloadend = function() {
accept(reader.result);
};
reader.readAsDataURL(file.getNative());
});
});
}
function loadImageURLs(urls) {
var promises = urls.map(function(src) {
return new Promise(function(accept) {
var img = new Image();
img.onload = function() {
accept(img);
};
img.src = src;
});
});
return Promise.all(promises);
}
function extractDimensions(images) {
return images.some(function(img) {
return isRetinaImage(img);
});
}
function handleRetinaModalOpen(isRetinaScreen) {
if (isRetinaScreen && !retinaNotice.isActive) {
retinaNotice.isActive = true;
$timeout(_.noop)
.then(scope.openModalWindow.bind(this, 'retinaHelper'));
}
}
function asyncRetinaModalNotificationCheck(files) {
retinaNotice.beenSeen = sessionService.user.showretinahelpermodal === '1';
if (!retinaNotice.beenSeen && !retinaNotice.isActive) {
Promise.all(readUploadedFiles(files))
.then(loadImageURLs)
.then(extractDimensions)
.then(handleRetinaModalOpen);
}
}
function handleUploadComplete(){
$timeout(updateGlobalUploadInfo);
if (_internalQueue.length) {
var _files = _internalQueue.shift();
handleFilesAdded(uploader, _files);
}
}
function handleQueueChanged( up ) {
if ( _skipQueueChangedEvent ) {
return;
}
if ( up.files.length && up.state === plupload.STOPPED ) {
up.start();
}
}
function handleUploadProgress( up, file ){
$timeout(function(){
var uploadInfo = findUploadingFile(file);
if(uploadInfo){
uploadInfo.percent = file.percent;
}
});
}
function handleError( up, error ) {
if ( error.file ) {
scope.openModalWindow( "error", "Looks like some of your files did not finish uploading. Please re-upload any files that did not complete." );
}
error.toString = function() {
var data = {
type: "GlobalUploaderError",
code: error.code,
message: error.message,
response: ( error.response || "" ),
responseHeaders: ( error.responseHeaders || "" ),
status: ( error.status || "" )
};
if ( error.file ) {
data.file = {
id: error.file.id,
name: error.file.name,
percent: error.file.percent,
size: error.file.size,
status: error.file.status,
type: error.file.type
};
console.log("error file:", error.file);
trackUpload("Failure", error.file);
} else {
data.file = "Error is not file related.";
}
return( ng.toJson( data ) );
};
errorLogService.exceptionHandler( error );
}
function checkScreenSourceIntro(){
if( !screenSourceIntroPref.isLoaded ){
userPreferenceService.getPreferenceTypeByName( "showScreenSourceIntro", true, "boolean" ).then(
function( typeResponse ) {
userPreferenceService.getUserPreferenceById( typeResponse.data.id ).then(
function( valueResponse ) {
if( valueResponse.exists === "true" && valueResponse.data.value === "0" ){
screenSourceIntroPref.showScreenSourceModal = false;
} else {
screenSourceIntroPref.showScreenSourceModal = true;
}
screenSourceIntroPref.isLoaded = true;
typeResponse = null;
valueResponse = null;
}
);
}
);
}
}
var isListeningToUnload = false;
var unloadMessage = "Closing the window will cancel your current uploads.";
var showUnloadMessage = function (e) {
(e || window.event).returnValue = unloadMessage;
return unloadMessage;
};
function updateGlobalUploadInfo(){
var uploadInfo = $rootScope.globalUploadInfo;
var uploadedCount = _.filter(uploadInfo.upload.files, 'uploaded', true).length;
var syncCompleteCount = _.filter(uploadInfo.sync.files, {'status' : 'complete'}).length;
var syncFailCount = _.filter(uploadInfo.sync.files, {'status' : 'failed'}).length;
if( (syncCompleteCount+syncFailCount) === uploadInfo.sync.files.length){
uploadInfo.sync.statusText = '';
uploadInfo.sync.files = [];
}
if(uploadedCount === uploadInfo.upload.files.length){
uploadInfo.upload.statusText = '';
uploadInfo.upload.files = [];
}
if(uploadInfo.upload.files.length){
uploadInfo.upload.statusText = 'Uploading ' + uploadedCount + ' of  ' + (uploadInfo.upload.files.length).toString() + ' files';
}else if( uploadInfo.sync.files.length ){
uploadInfo.sync.statusText = 'Syncing ' + (syncCompleteCount+1).toString() + ' of  ' + (uploadInfo.sync.files.length).toString() + ' files';
}
if(!uploadInfo.upload.files.length && !uploadInfo.sync.files.length){
scope.$broadcast('setShowingUploadingFiles', false);
}
if (!uploadInfo.upload.files.length) {
window.removeEventListener("beforeunload", showUnloadMessage);
isListeningToUnload = false;
} else if( !isListeningToUnload ) {
window.addEventListener("beforeunload", showUnloadMessage);
isListeningToUnload = true;
}
}
function trackUpload(status, file) {
var fileType = file.name.split(".").pop();
switch ( fileType ) {
case "psd":
analyticsService.track("PSD " + status);
break;
case "sketch":
analyticsService.track("Sketch " + status);
break;
}
if ( _uploadSource === "screens_tab" ) {
analyticsService.track( "Screen.UploadedFrontend",
{
ScreenUploadedStatus: status,
FileType: fileType
}
);
}
}
modelEvents.on('showScreenSourceModalPreferenceUpdated.globalUploader', function(event, pref) {
if ( pref === 0 ){
screenSourceIntroPref.showScreenSourceModal = false;
}
});
modelEvents.on('selectiveSyncFilesUploading.globalUploader', function( event, files, groupID, groupType, props ) {
if ( groupType === "board" ) {
for ( var i=0, length=files.length; i<length; i++ ) {
var id = files[i].entityID;
var sort = -1;
var randomProgress = Math.random() * (64 - 20) + 20;
files[i].id = files[i].entityID;
InvBoards.actions.addTempItem(files[i], props.userID, groupID, props.boardGroupID, files[i].title, sort);
InvBoards.actions.updateTempItem(files[i], groupID, id);
$rootScope.globalUploadInfo.upload.files.push({
name: files[i].name,
uploaded: false,
id: id,
percent: randomProgress,
groupID: groupID,
groupType: groupType,
oauthApp: props.oauthApp
});
}
$timeout(updateGlobalUploadInfo);
} else if (groupType === "project") {
for ( var i=0, length=files.length; i<length; i++ ) {
var objID = files[i].screenID || files[i].entityID;
var id = isLayerExtractionFile(files[i].name) ? 0 : objID;
var randomProgress = Math.random() * (64 - 20) + 20;
$rootScope.globalUploadInfo.upload.files.push({
name: files[i].name,
uploaded: false,
id: id,
percent: randomProgress,
groupID: groupID,
groupType: groupType,
oauthApp: props.oauthApp
});
if(isLayerExtractionFile(files[i].name)){
var syncFile = {
name: files[i].name,
groupID: groupID,
status: "uploading",
screens: 0,
assetID: 0
};
$rootScope.globalUploadInfo.sync.files.push(syncFile);
scope.$broadcast('setShowingUploadingFiles', true);
}
}
$timeout(updateGlobalUploadInfo);
}
});
modelEvents.on( "selectiveSyncFileUploadComplete.globalUploader", function( event, groupID, fileName){
var uploadInfo = _.find($rootScope.globalUploadInfo.upload.files,
{'name': fileName, 'groupID': groupID, 'uploaded': false});
var syncFile = _.find($rootScope.globalUploadInfo.sync.files,
{'name': fileName, 'groupID': groupID, 'status': 'uploading'});
if (uploadInfo) {
uploadInfo.uploaded = true;
if (uploadInfo.groupType === "board" && !!uploadInfo.oauthApp) {
InvBoards.actions.syncBoardItemUploadComplete(uploadInfo.oauthApp);
}
}
if(syncFile){
syncFile.status = "initializing";
}
$timeout(updateGlobalUploadInfo);
});
modelEvents.on('screenSourceUploaded.globalUploader', function( event, screenSource ) {
var clientFilename = screenSource.asset.clientFilename;
var syncFile = _.find($rootScope.globalUploadInfo.sync.files, {'name': clientFilename, 'groupID': screenSource.asset.projectID, 'assetID': 0});
if(syncFile){
syncFile.status = 'processing';
syncFile.assetID = screenSource.asset.id;
syncFile.screens = screenSource.info.screens ? screenSource.info.screens.length : [];
}
$timeout(updateGlobalUploadInfo);
});
modelEvents.on('screenSourceSyncUpdated.globalUploader', function( event, assetID, status, projectID ) {
var uploadingFile = _.find($rootScope.globalUploadInfo.sync.files, {'assetID': assetID, 'groupID': projectID});
if(uploadingFile){
if( status === 'complete' && $rootScope.globalUploadInfo.sync.files.length ){
uploadingFile.status = 'complete';
} else if( status === "failed" || status === "inspected" || status === "cancelled" || status === "killed" ){
uploadingFile.status = 'failed';
}else if(uploadingFile){
uploadingFile.status = 'processing';
}
}
$timeout(updateGlobalUploadInfo);
});
scope.$on('$destroy', function() {
modelEvents.off('showScreenSourceModalPreferenceUpdated.globalUploader');
modelEvents.off('selectiveSyncFilesUploading.globalUploader');
modelEvents.off('screenSourceUploaded.globalUploader');
modelEvents.off('selectiveSyncFileUploadComplete.globalUploader');
modelEvents.off('screenSourceSyncUpdated.globalUploader');
});
checkScreenSourceIntro();
};
return({
link: link,
restrict: "A"
});
}
})( angular, InVision );
;
;
/*! lazier-src.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( 'invLazierContainer', function () {
return {
restrict: 'A',
controller: ['$scope', '$element', function ($scope, $element) {
$element.data('invLazierContainer', $element);
}]
};
});
app.directive( "invLazierSrc", Directive );
/** @ngInject */
function Directive( $window, $document ) {
var win = angular.element( $window );
var container = win;
var lazyLoader = (function() {
var images = [];
var renderTimer = null;
var renderDelay = 200;
var windowHeight = null;
var windowWidth = null;
var isWatchingWindow = false;
function addImage( image ) {
images.push( image );
if ( ! renderTimer ) {
startRenderTimer();
}
if ( ! isWatchingWindow ) {
startWatchingWindow();
}
startWatchingContainer();
}
function checkLayout() {
if ( ! renderTimer ) {
startRenderTimer();
}
if ( ! isWatchingWindow ) {
startWatchingWindow();
}
startWatchingContainer();
}
function removeImage( image ) {
for ( var i = 0, len = images.length ; i < len ; i++ ) {
if ( images[ i ] === image ) {
images.splice( i, 1 );
break;
}
}
if ( ! images.length ) {
clearRenderTimer();
stopWatchingWindow();
}
}
function checkImages() {
var visible = [];
var hidden = [];
if ( windowHeight === null ) {
windowHeight = win.height();
}
if ( windowWidth === null ) {
windowWidth = win.width();
}
var scrollTop = win.scrollTop();
var scrollLeft = win.scrollLeft();
var topFoldOffset = scrollTop;
var bottomFoldOffset = ( topFoldOffset + windowHeight );
var leftFoldOffset = scrollLeft;
var rightFoldOffset = ( leftFoldOffset + windowWidth );
for ( var i = 0 , len = images.length ; i < len ; i++ ) {
var image = images[ i ];
if ( image.isVisible( topFoldOffset, bottomFoldOffset, leftFoldOffset, rightFoldOffset ) ) {
visible.push( image );
} else {
hidden.push( image );
}
}
for ( var i = 0 ; i < visible.length ; i++ ) {
visible[ i ].render();
}
images = hidden;
clearRenderTimer();
if ( ! images.length ) {
stopWatchingWindow();
}
}
function clearRenderTimer() {
clearTimeout( renderTimer );
renderTimer = null;
}
function keyPressed() {
if ( ! renderTimer ) {
startRenderTimer();
}
}
function startRenderTimer() {
renderTimer = setTimeout( checkImages, renderDelay );
}
function startWatchingWindow() {
isWatchingWindow = true;
win.on( "resize.invLazierSrc", windowResized );
$document.on( "keyup.invLazierSrc", keyPressed );
}
function startWatchingContainer() {
if ( ! container.attr('inv-lazier-container-watched') ) {
container.data('invLazierContainerWatched', true);
container.on( "scroll.invLazierSrc", containerScrolled );
}
}
function stopWatchingWindow() {
isWatchingWindow = false;
win.off( "resize.invLazierSrc" );
container.off( "scroll.invLazierSrc" );
$document.off( "keyup.invLazierSrc" );
}
function windowResized() {
windowHeight = win.height();
windowWidth = win.width();
if ( ! renderTimer ) {
startRenderTimer();
}
}
function containerScrolled() {
if ( ! renderTimer ) {
startRenderTimer();
}
}
return({
addImage: addImage,
checkLayout: checkLayout,
removeImage: removeImage
});
})();
function LazyImage( element ) {
this.element = element;
this.offsetElement = this.element;
this.source = null;
this.rendered = false;
this.height = null;
this.width = null;
}
LazyImage.prototype = {
isVisible: function( topFoldOffset, bottomFoldOffset, leftFoldOffset, rightFoldOffset ) {
if ( ! this.offsetElement.is( ":visible" ) ) {
return( false );
}
if ( ! this.height ) {
while ( ! ( this.height = this.offsetElement.height() ) ) {
this.offsetElement = this.offsetElement.parent();
}
this.width = this.offsetElement.width();
}
var top = this.offsetElement.offset().top;
var bottom = ( top + this.height );
var left = this.offsetElement.offset().left;
var right = left + this.width;
return(
(
topFoldOffset 	  <= bottom &&
bottomFoldOffset  >= top    &&
leftFoldOffset	  <= right  &&
rightFoldOffset	  >= left
)
||
(
topFoldOffset 	  >= top 	&&
bottomFoldOffset  <= bottom &&
leftFoldOffset	  >= left  	&&
rightFoldOffset	  <= right
)
);
},
render: function() {
this.rendered = true;
this.renderSource();
},
renderSource: function() {
this.element[ 0 ].src = this.source;
},
setSource: function( newSource ) {
this.source = newSource;
if ( this.rendered ) {
this.renderSource();
}
}
};
function handleIndexChange( newValue, oldValue ) {
if ( newValue === oldValue ) {
return;
}
lazyLoader.checkLayout();
}
function link( $scope, element, attributes ) {
var scrollContainer = element.inheritedData( 'invLazierContainer' );
if ( scrollContainer ) {
container = angular.element( scrollContainer );
}
var lazyImage = new LazyImage( element );
lazyLoader.addImage( lazyImage );
attributes.$observe(
"invLazierSrc",
function( newSource ) {
lazyImage.setSource( newSource );
}
);
if ( "$index" in $scope ) {
$scope.$watch( "$index", handleIndexChange );
}
$scope.$on(
"$destroy",
function() {
lazyLoader.removeImage( lazyImage );
}
);
$scope.$on(
"checkLayout.invLazierSrc",
function() {
lazyLoader.checkLayout();
}
)
}
return({
link: link,
restrict: "A"
});
}
})( angular, InVision );
;
;
/*! lazy-src.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invLazySrc", Directive );
/** @ngInject */
function Directive() {
var pendingTimer = null;
var pending = [];
function dequeueHandler() {
for ( var i = 0, length = pending.length ; i < length ; i++ ) {
pending[ i ]();
}
pendingTimer = null;
pending = [];
}
function queueHandler( handler ) {
pending.push( handler );
if ( ! pendingTimer ) {
pendingTimer = setTimeout( dequeueHandler, 100 );
}
}
function isElementVisible( element ) {
if ( ! element.is( ":visible" ) ) {
return( false );
}
var bottomOfScreen = ( win.height() + win.scrollTop() );
return( element.offset().top < bottomOfScreen );
}
var win = $( window );
var doc = $( document );
var link = function( $scope, element, attributes ) {
function examineImage() {
if ( isElementVisible( element ) ) {
showImage();
stopMonitoring();
}
}
function handleWatchCallback( newValue, oldValue ) {
if ( newValue === oldValue ) {
return;
}
examineImage();
}
function setupMonitoring() {
if ( isElementVisible( element ) ) {
return( showImage() );
}
startMonitoring();
}
function showImage() {
element.prop( "src", src );
isVisible = true;
}
function startMonitoring() {
isMonitoring = true;
win.on( "resize", examineImage );
win.on( "scroll", examineImage );
watchDocumentHeight();
watchLazyExpression();					
}
function stopMonitoring() {
isMonitoring = false;
win.off( "resize", examineImage );
win.off( "scroll", examineImage );
unbindLazyWatch();
unbindDocumentWatch();
}
function watchDocumentHeight() {
unbindDocumentWatch = $scope.$watch(
function() {
return( doc.height() )
},
handleWatchCallback
);
}
function watchLazyExpression() {
if ( ! attributes.lazyWatch ) {
return;
}
unbindLazyWatch = $scope.$watch( attributes.lazyWatch, handleWatchCallback );
}
var src = null;
var isMonitoring = false;
var isVisible = false;
var unbindLazyWatch = ng.noop;
var unbindDocumentWatch = ng.noop;
attributes.$observe( 
"invLazySrc",
function( interpolatedSource ) {
src = interpolatedSource;
if ( isVisible ) {
return( showImage() );
}
if ( isMonitoring ) {
return;
}
queueHandler( setupMonitoring );
}
);
$scope.$on(
"$destroy",
function() {
win.off( "resize", examineImage );
win.off( "scroll", examineImage );
}
);
};
return({
link: link,
restrict: "A"
});
}
})( angular, InVision );
;
;
/*! loading.js */ 
;
;
/**
* Loading directive to display loading animation.
* Usage: <span loading="isLoading"></span>
*/
angular.module("InVision")
.directive("loading", function() {
var ua = window.navigator.userAgent;
var msie = ua.indexOf("MSIE ");
var template;
if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) {
template = "<div class=\"dots\"><div class=\"bounce1\"></div><div class=\"bounce2\"></div><div class=\"bounce3\"></div></div>";
} else {
template = "<div class=\"loader\"><svg class=\"circular\"><circle class=\"path\" cx=\"32\" cy=\"32\" r=\"30\" fill=\"none\" stroke-width=\"4\"></svg></div>";
}
return {
restrict: "AE",
replace: true,
template: "<div class=\"loading-directive\" ng-show=\"isLoading\">" + template + "</div>",
scope: {
isLoading: "=loading"
}
};
});
;
;
/*! mobile-transition-layer.js */ 
;
;
(function(ng, app) {
var _DEBUG_ = _DEBUG_ || false;
var _STANDALONE_ = window._STANDALONE_ || false;
app
.directive('invMobileTransitionLayer', Directive);
/** @ngInject */
function Directive($timeout, $log, _, transitionsService, config, screenService, autoImagePreloader) {
var vm = {};
return {
link:        linkFunction,
restrict:    'A',
templateUrl: '/assets/apps/common/views/directives' +
'/mobile-transition-layer.htm'
};
function linkFunction($scope, element) {
var
$element       = ng.element(element),
$wrapper       = $element.find('.inner2'),
$fixedElements = {
curr: [],
targ: []
},
$curr,
$targ;
var userAgent = window.navigator.userAgent.toLowerCase();
var transitionFeatureFlag = $scope.transitionFeatureFlag || false;
vm.initalised  = false;
vm.isPreparing = false;
vm.isPlaying   = false;
vm.isUpdating  = false;
vm.transitionTypes = {
2:  'slide-right',
3:  'slide-left',
4:  'slide-up',
5:  'slide-down',
6:  'flip-right',
7:  'flip-left',
8:  'dissolve',
9:  'flow',
10: 'pop',
11: 'push-right',
12: 'push-left',
13: 'slide-fade'
};
vm.specialTransitions = [2, 3, 11, 12];
$scope.Math = Math;
$scope.getBackgroundColor = getBackgroundColor;
$scope.screenInHotspot    = screenInHotspot;
$scope.transitionScreen   = screenService.getCurrentScreen();
$scope.transitionScreens  = [];
$scope.pushDownFixedHeader = $scope.isAndroid ? ( $scope.statusBarPushDown || 0 ) : 0;
if (isChrome46()) {
$scope.chromeClass = "mobile-hover-chrome";
}
$scope.addStatusBarHeight =
( ($scope.config && $scope.config.mobileStatusbarIsOpaque) || (config && config.project && config.project.mobileStatusbarIsOpaque) )
&& $scope.isInAppMode
&& !vm.isAndroid ? true : false;
$scope.$on('mobile:transition:prepare', prepareTransitions);
$scope.$on('mobile:transition:run', doTransition);
$scope.$on('mobile:transition:updateCurrent', updateCurrentScreen);
$scope.$on('mobile:transition:init', initTransitionScreens);
if (!$scope.isMobileShare) {
initTransitionScreens({}, true);
}
function updateCurrentScreen(event, cb) {
if (_DEBUG_) $log.info('invMobileTransitionLayer.updateCurrentScreen');
if (vm.isUpdating) return false;
vm.isUpdating = true;
$scope.transitionScreen = screenService.getScreenClickedOn();
if (cb) {
return $timeout(cb)
.then(function () {
vm.isUpdating = false;
});
}
vm.isUpdating = false;
return false;
}
function initTransitionScreens(event, update) {
if (_DEBUG_) $log.info('invMobileTransitionLayer.initTransitionScreens');
if (!transitionFeatureFlag) {
if (_.isFunction(screenService.getScreens)) {
$scope.transitionScreens = screenService.getScreens();
}
if ( $scope.screens && $scope.screens.length ) {
$scope.transitionScreens = $scope.screens;
} else if (!$scope.isMobileShare && !$scope.transitionScreens.length ) {
$scope.transitionScreens = augmentScreens($scope.screens);
}
$scope.transitionScreens = augmentScreens($scope.transitionScreens);
}
return $timeout(function () {
$scope.$emit('mobile:transition:ready');
if (update) {
updateCurrentScreen()
}
});
}
function screenInHotspot(id) {
return _.some($scope.transitionScreen.hotspots, {targetScreenID: id});
}
function getBackgroundColor(screen) {
if (_.isEmpty(screen)) return;
var color = screen.backgroundColor;
if (!color) {
color = screen.extended.fixedFooterBackground;
}
return color.length === 6 ? '#' + color : color;
}
function prepareTransitions() {
if (_DEBUG_) $log.info('invMobileTransitionLayer.prepareTransitions');
if (vm.isPreparing) return false;
vm.isPreparing = true;
var data              = $scope.transitionData;
var current           = data.currentScreen;
var target            = data.targetScreen;
var maintainScrollPos = data.maintainScrollPosition || false;
var transitionName    = vm.transitionTypes[data.transitionTypeID];
if (transitionFeatureFlag) {
$scope.$apply(function() {
$scope.currentScreen = current;
$scope.targetScreen = target;
});
$curr = element.find("#current-screen");
$targ = element.find("#next-screen");
} else {
$curr = element.find("#transition-picture-" + current.id);
$targ = element.find("#transition-picture-" + target.id);
}
$element.addClass('will-transition');
if ( current.fixedHeaderHeight
&& current.fixedHeaderHeight === target.fixedHeaderHeight
&& _.contains(vm.specialTransitions, data.transitionTypeID) ) {
$curr.addClass('equal-height-header');
$targ.addClass('equal-height-header');
ripOutFixedElements('.fixed-header');
}
if ( current.fixedFooterHeight
&& current.fixedFooterHeight === target.fixedFooterHeight
&& _.contains(vm.specialTransitions, data.transitionTypeID) ) {
$curr.addClass('equal-height-footer');
$targ.addClass('equal-height-footer');
ripOutFixedElements('.fixed-footer');
}
var scrollPos = -(data.scrollPosition);
$curr.find('img:first').css({
marginTop: scrollPos
});
$targ.find('img:first').css({
marginTop: maintainScrollPos ? scrollPos : 0
});
transitionsService.configure(
$curr,
$targ,
$wrapper,
$fixedElements
);
var mobileDeviceID = $scope.config ? $scope.config.mobileDeviceID : null;
var mobileTemplate = _.filter(config.mobileDevices, { mobileDeviceID: mobileDeviceID })[0];
if (mobileTemplate && mobileTemplate.mobileSkin === "iPhoneX") {
var mobileStatusbarIsOpaque =
($scope.config && $scope.config.mobileStatusbarIsOpaque) ||
(config && config.project && config.project.mobileStatusbarIsOpaque);
var mobileStatusbarIsVisible =
($scope.config && $scope.config.mobileStatusbarIsVisible) ||
(config && config.project && config.project.mobileStatusbarIsVisible);
var borderRadiusStyle =
mobileStatusbarIsOpaque && mobileStatusbarIsVisible
? "0 0 40px 40px"
: "40px";
$element.css("border-radius", borderRadiusStyle);
}
$element.addClass(transitionName);
transitionsService[transitionName]();
}
function doTransition() {
if (_DEBUG_) $log.info('invMobileTransitionLayer.doTransition');
if (vm.isPlaying) return false;
vm.isPlaying = true;
$element.addClass('is-transitioning');
transitionsService.play(animationOverCallback);
}
function ripOutFixedElements(elementClass) {
if (_DEBUG_) $log.info('ripOutFixedElements');
var $ripCurr = $curr.find(elementClass).clone();
var $ripTarg = $targ.find(elementClass).clone();
$ripCurr.addClass('current');
$ripTarg.addClass('target');
$element.append($ripCurr);
$element.append($ripTarg);
$fixedElements.curr.push($ripCurr);
$fixedElements.targ.push($ripTarg);
}
function animationOverCallback() {
if (_DEBUG_) $log.info('animationOverCallback');
var nodes;
var id            = $scope.transitionData.transitionTypeID;
var removeClasses = [
vm.transitionTypes[id],
'is-transitioning',
'will-transition'
].join(' ');
var cleanupClasses = [
'equal-height-header',
'equal-height-footer'
].join(' ');
$targ.removeClass(cleanupClasses);
$curr.removeClass(cleanupClasses);
$element.removeClass(removeClasses);
vm.isPreparing = false;
vm.isPlaying = false;
if (transitionFeatureFlag) {
$scope.$apply(function() {
$scope.currentScreen = null;
$scope.targetScreen = null;
});
}
if ($fixedElements.curr.length) {
nodes = $fixedElements.curr.concat($fixedElements.targ);
_.forEach(nodes, function(node) {
node.remove();
});
$fixedElements.curr = [];
$fixedElements.targ = [];
}
return $scope.setIsTransitioning(false);
}
function augmentScreens(screens) {
return _.map(screens, function addDisplayScale(screen) {
if ( !$scope.isMobileShare ) {
return screen;
}
if (screen.displayScale) {
return screen;
} else {
screen.displayScale = (+($scope.deviceTemplate.viewportWidth) / screen.width);
}
return screen;
});
}
function isChrome46() {
var version = navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);
var platform = navigator.platform;
return platform === "MacIntel" && !!version && parseInt(version[2], 10) === 46;
}
$scope.getImageUrl = function( url ) {
return autoImagePreloader.previous( url ) || url;
};
}
}
})(angular, InVision);
;
;
/*! modal.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invModal", Directive );
/** @ngInject */
function Directive( $timeout, $document, $window, modalWindowRequest, emojiService ) {
var linkFunction = function( $scope, $element, attributes ) {
var $win = $(window);
var isClosedByPlugin = true;
var modalType = ( attributes.invModalType || "top" );
var settings = {
keyboard: false,
backdrop: "static"
};
var isOpen = false;
var isTrueModal = ( attributes.invTrueModal || false );
var isDestroyed = false;
if ( modalWindowRequest.isSuppressFade() && $element.is( ".animate" ) ) {
$element.removeClass( "animate" );
$element.on(
"shown.invModal",
function() {
$timeout(function() {
$element.addClass( "animate" );
}, 150);
}
);
}
$element
.addClass("modal")
.modal(settings);
var $backdrop = $(".modal-backdrop");
$backdrop
.addClass("animate-in " + $element.attr("id") );
setModalPosition();
function forcePositive(number) {
return number < 0 ? 0 : number;
}
function setModalPosition() {
$timeout(function() {
if ( isDestroyed ) {
return;
}
var newCSS = {
top: $win.scrollTop(),
left: $win.scrollLeft(),
marginLeft: forcePositive( Math.round( ( $win.outerWidth() - $element.outerWidth() ) / 2 ) ),
marginTop: forcePositive( Math.round( ( $win.outerHeight() - $element.outerHeight() ) / 2 ) )
};
$element
.css(newCSS)
.attr( "tabindex", -1 )
.addClass("animate-in");
if (isOpen) {
$element.addClass("open");
$scope.$emit("modal.isWindowOpen", true);
if ( $window.InvScreens ) {
$window.InvScreens.screensStore.setIsModalOpen(true);
}
}
$('.invisible-modal-padding-fix').css('height', 1000);
isOpen = true;
});
}
$element.on(
"hidden.invModal",
function() {
$scope.$emit( "modalWindowHidden" );
$scope.$emit("modal.isWindowOpen", false);
if ( $window.InvScreens ) {
$window.InvScreens.screensStore.setIsModalOpen(false);
}
$('.invisible-modal-padding-fix').css('height', 0);
$timeout( ng.noop );
}
);
$element.on(
"shown.invModal",
function() {
if ( modalType !== "top" ) {
return;
}
setModalPosition();
}
);
$win.on("resize.invModal", setModalPosition);
$win.on("hashchange.invModal", function() {
if ( isTrueModal ) {
return;
}
$scope.closeModalWindow();
});
$document
.on("keyup.invModal", function( event ) {
if ( isTrueModal ) {
return;
}
var keyCode = event.which || event.keyCode;
if ( keyCode === 27 ) {
$scope.closeModalWindow();
}
});
$backdrop
.on("click.invModal", function(e) {
e.preventDefault();
if ( isTrueModal ) {
return;
}
$scope.closeModalWindow();
});
$scope.$on("resizeModal", setModalPosition);
$scope.$on(
"closeModalWindowWithoutFade",
function() {
$scope.closeModalWindow( true );
}
);
$scope.$on(
"$destroy",
function() {
isDestroyed = true;
$win.off("resize.invModal");
$win.off("hashchange.invModal");
$element.off( "hide.invModal" );
$element.off( "hidden.invModal" );
$element.off( "shown.invModal" );
$element.removeClass("animate-in");
$element.removeClass("animate-out");
$document.off("keyup.invModal");
$backdrop.off("click.invModal");
}
);
$scope.closeModalWindow = function( suppressFade ) {
if ( emojiService && emojiService.isPopoverActiveOnModal() ) {
emojiService.setPopoverOnModal( false );
return;
}
if ( emojiService && emojiService.isTypeaheadActiveOnModal() ) {
emojiService.setTypeaheadOnModal( false );
return;
}
isClosedByPlugin = false;
if ( suppressFade ) {
$(".modal-backdrop").removeClass("animate-in");
$element.modal("hide");
} else {
$element.addClass("animate-out");
$(".modal-backdrop").removeClass("animate-in");
$timeout(function closeModal() {
if ( ! isDestroyed ) {
$element.modal("hide");
}
}, 200);
}
};
};
return({
link: linkFunction,
restrict: "A"
});
}
})( angular, InVision );
;
;
/*! overlay-screen.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invOverlayScreen",
/** @ngInject */
function( $timeout, _ ) {
var linkFunction = function( $scope, element ) {
console.log("invOverlayScreen");
};
return({
link: linkFunction,
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! react-component.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invReactComponent", Directive );
/** @ngInject */
function Directive() {
var linkFunction = function( scope, element ) {
var remount = function(){
ReactDOM.unmountComponentAtNode(element[0]);
ReactDOM.render(
React.createFactory(scope.reactComponent)(scope.reactProps),
element[0],
function() {
if ( scope.reactRootRenderedMethod ) {
scope.reactRootRenderedMethod();
}
}
);
};
scope.$watch('reactRemount', function() {
remount();
});
scope.$on('$destroy', function() {
ReactDOM.unmountComponentAtNode(element[0]);
});
};
return({
restrict: 'E',
link: linkFunction,
scope: {
reactComponent: '=',
reactProps: '=',
reactRootRenderedMethod: '=',
reactRemount: '='
}
});
}
})( angular, InVision );
;
;
/*! tail-source.js */ 
;
;
(function( ng, app ) {
var CSS_ACTIVE_CLASS = 'connection-active';
"use strict";
app.directive( "invTailSource", Directive );
/** @ngInject */
function Directive( $, _, $parse ) {
var controllerFunction = function( $scope, $element, $attrs ) {
function invoke( action, args ) {
$scope.$eval( action, args );
}
var source = {
element : $element,
handler : { },
type : $.trim( $attrs.invTailSource ),
data : $parse( $attrs.invTailSourceData )( $scope )
};
_.assign( source.handler, {
handleSetConnection: function( event ) {
if ( event.side === source.connectedOnSide ) return;
source.connectedOnSide = event.side;
$element.removeClass('tail-connected tail-connected-left tail-connected-right tail-connected-top tail-connected-bottom');
if ( event.connected ) {
$element.addClass( 'tail-connected tail-connected-'+ event.side );
invoke( $attrs.invOnConnectionSet, { event: event, source: source });
}
else invoke( $attrs.invOnConnectionUnset, { event: event, source: source });
},
handleDeactivate : function( event ) {
$element.removeClass( CSS_ACTIVE_CLASS );
invoke( $attrs.invOnConnectionDeactivate, { event: event, source: source });
},
handleCancel : function( event ) {
invoke( $attrs.invOnConnectionCancel, { event: event, source: source });
},
handleConnect : function( event, targets ) {
invoke( $attrs.invOnConnection, { event: event, source: source, targets: targets });
},
handleFlash : function( event ) {
invoke( $attrs.invOnConnectionFlash, { event: event, source: source });
}
});
$scope.$on('tailConnector:activate:source', function( event, register ) {
$element.addClass( CSS_ACTIVE_CLASS );
register( source );
invoke( $attrs.invOnConnectionActivate, { event: event, source: source });
});
};
return({
link     : controllerFunction,
restrict : "A"
});
}
})( angular, InVision );
;
;
/*! tail-target.js */ 
;
;
(function( ng, app ) {
var CSS_ACTIVE_CLASS = 'connection-active'
, CSS_HOVER_CLASS = 'connection-hover';
"use strict";
app.directive( "invTailTarget", Directive );
/** @ngInject */
function Directive( $, _, $parse, $interpolate ) {
var controllerFunction = function( $scope, $element, $attrs ) {
function invoke( action, args ) {
$scope.$eval( action, args );
}
var target = {
context : $scope.$parent,
element : $element,
focusable : !$element.is('[inv-tail-no-focus]'),
handler : { },
is : { }
};
target.data = $parse( $attrs.invTailTargetData )( $scope );
var types = $interpolate( $attrs.invTailTarget || '' )( target.context ).split(',');
target.types = _( types ).map( $.trim ).filter().value();
_.each( target.types, function( type ) { 
target.is[ type ] = true;
});
_.assign( target.handler, {
handleSetConnection: function( event ) {
if ( event.side === target.connectedOnSide ) return;
target.connectedOnSide = event.side;
$element.removeClass('tail-connected tail-connected-left tail-connected-right tail-connected-top tail-connected-bottom');
if ( event.connected ) {
$element.addClass( 'tail-connected tail-connected-'+ event.side );
invoke( $attrs.invOnConnectionSet, event, target );
}
else invoke( $attrs.invOnConnectionUnset, event, target );
},
handleDeactivate: function( event ) {
$element.removeClass( CSS_ACTIVE_CLASS ).removeClass( CSS_HOVER_CLASS );
invoke( $attrs.invOnConnectionDeactivate, { event: event, target: target });
},
handleCancel: function( event ) {
invoke( $attrs.invOnConnectionCancel, { event: event, target: target });
},
handleConnect: function( event, source ) {
invoke( $attrs.invOnConnection, { event: event, source: source, target: target });
},
handleMouseEnter: function( event, source ) { 
invoke( $attrs.invOnConnectionEnter, { event: event, target: target, source: source });
if ( event.cancel !== true ) $element.addClass( CSS_HOVER_CLASS );
},
handleMouseLeave: function( event, source ) { 
invoke( $attrs.invOnConnectionLeave, { event: event, target: target, source: source });
if ( event.cancel !== true ) $element.removeClass( CSS_HOVER_CLASS );
}
});
$scope.$on('tailConnector:activate:target', function( event, register ) {
invoke( $attrs.invOnConnectionActivate, { event: event, target: target });
if ( event.cancel === true ) return;
$element.addClass( CSS_ACTIVE_CLASS );
register( target );
});
};
return({
controller : controllerFunction,
restrict   : "A"
});
}
})( angular, InVision );
;
;
/*! tooltip.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invTooltip", Directive );
/** @ngInject */
function Directive( $ ) {
function escapeHtml( str ){
var safeContent = String( str )
.replace( /&/g, "&amp;" )
.replace( /"/g, "&quot;" )
.replace( /'/g, "&apos;" )
.replace( /</g, "&lt;" )
.replace( />/g, "&gt;" )
;
safeContent = safeContent
.replace( /&lt;(br)\s*\/?&gt;/ig, "<$1 />" )
.replace( /&lt;(\/)?(strong|em)&gt;/ig, "<$1$2>" )
;
return( safeContent );
}
function handleMouseEnter( event ) {
$.data( this, "isShowing", true );
}
function handleMouseLeave( event ) {
$.data( this, "isShowing", false );
}
function link( $scope, element, attributes ) {
function tryToKillTooltip () {
if ( tooltipInstance ) {
tooltipInstance.show = ng.noop;
if ( tooltipInstance.$tip ) {
tooltipInstance.$tip.remove();
}
}
element.tooltip( "destroy" );
}
function getOptions() {
return {
placement: function() {
return( element.attr("placement") || "top" );
},
delay: 100,
title: function() {
return( escapeHtml( attributes.invTooltip ) );
},
template: '<div class="tooltip ' +
(attributes.tooltipWidth === 'content' ? 'content-width' : styleClass) +
'"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'
};
}
var tooltipInstance = null;
var styleClass = ( attributes.tooltipstyleclass || "" );
element
.on( "mouseenter", handleMouseEnter )
.on( "mouseleave", handleMouseLeave )
;
attributes.$observe(
"invTooltip",
function handleTooltipChange( newValue ) {
if ( element.data('isShowing') ) {
if ( newValue.length > 0 ) {
tooltipInstance.show();
} else {
tooltipInstance.hide();
}
}
}
);
attributes.$observe(
"dynamicclass",
function handleTooltipChange( newValue, oldValue ) {
if ( element.data('isShowing') ) {
if ( oldValue ) {
tooltipInstance.$tip.removeClass(oldValue);
}
tooltipInstance.$tip.addClass(newValue);
tooltipInstance.show();
}
}
);
attributes.$observe(
"tooltipDisabled",
function handleTooltipDisabledChange( newValue ) {
newValue = ( newValue || "false" );
var isEnabled = ( newValue === "false" );
if ( isEnabled ) {
var tooltipOptions = getOptions();
element.tooltip( tooltipOptions );
tooltipInstance = element.data( "tooltip" );
} else {
tryToKillTooltip();
}
}
);
$scope.$on(
"$destroy",
function handleDestroyEvent() {
tryToKillTooltip();
$scope = element = attributes = tooltipInstance = styleClass = null;
tryToKillTooltip = getOptions = null;
}
);
}
return({
link: link,
restrict: "A"
});
}
})( angular, InVision );
;
;
/*! analytics-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "analyticsService", Service );
/** @ngInject */
function Service(
$window,
$interval,
$q,
$timeout,
moment,
config,
cookieManager,
errorLogService,
_
) {
var amplitudeIdentifyGrowthQueue = [];
var amplitudeFinishedInit = false;
var brazeIdentifyGrowthQueue = [];
var brazeTrackQueue = [];
var brazeFinishedInit = false;
var segmentUserId = '';
var planName = false;
var vendorPrefixByDefault = config.serverType === "PREVIEW"; // RAIN-1403 - By default, everything on Preview should prefix by VendorID, to avoid all collision with MT
function activatePageExperiment(pageName, analyticsProp) {
var q = $q.defer();
try {
window.optimizely = window.optimizely || [];
window.optimizely.push({
type: "page",
pageName: pageName
});
var interval = 20;
var maxTime = 500;
var limit = Math.round(maxTime / interval);
var attempts = 0;
var checkForOptimizelyFlagLoop = $interval(function() {
if (!window.InvAnalytics || window.InvAnalytics[analyticsProp] === undefined) {
attempts++;
if (attempts >= limit) {
window.optimizely.push({
type: "page",
pageName: pageName,
isActive: false
});
$interval.cancel(checkForOptimizelyFlagLoop);
q.reject();
}
} else {
$interval.cancel(checkForOptimizelyFlagLoop);
q.resolve();
}
}, interval);
} catch (error) {
q.reject(error);
}
return q.promise;
}
function identifyUser( user, currentSubscription ) {
if ( !$window.analytics || !config || !user || !currentSubscription ) {
return;
}
var nameSplit = splitName( user.name );
var agent = navigator.userAgent||navigator.vendor||window.opera;
var ismobile = /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(agent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(agent.substr(0,4));
var traits = {
bucket: user.bucketID,
createdAt: moment(user.userCreatedAt).unix(),
name: user.name,
firstname: nameSplit.firstname,
lastname: nameSplit.lastname,
email: user.email,
referring_source: user.source,
plan_name: currentSubscription.name,
lifecyclestage: translateSubscriptionToLifecycleStage( currentSubscription ),
subscriptionexpiresat: currentSubscription.expiresAt,
lastKnownIPAddress: user.lastKnownIpAddress,
"feature_inspect-v-1": config.featureFlags["inspect-v-1"],
"feature_inspect-v-3": config.featureFlags["inspect-v3"],
"feature_inspect-v-3-enterprise": config.featureFlags["inspect-v3-enterprise"],
"feature_inspect-asset-manager": config.featureFlags["inspect-assetManager"],
isSingleTenant: config.singleTenantConfig.useSingleTenantAnalytics,
customer_status: config.isCustomer ? "Existing Customer" : "Potential Customer",
screenUploadedCount: user.screenUploadedCount,
invisionVersion: "6.0",
last_device_used: ismobile ? 'mobile' : 'desktop'
};
var momentDate = moment( currentSubscription.projectGracePeriodEndsAt );
if ( momentDate.isValid() ) {
traits.gracePeriodEndsAt = momentDate.toJSON();
}
if ( user.companyInfo && user.companyInfo.subdomain !== "" ) {
traits.usagedataid = user.companyInfo.subdomain;
}
if ( user.companyInfo && typeof user.companyInfo.sfdcAccountID !== "undefined" &&
user.companyInfo.sfdcAccountID !== "" &&
user.companyInfo.sfdcAccountID !== "#N/A"
){
traits.sfdcaccountid = user.companyInfo.sfdcAccountID;
}
if ( typeof user.companyMembership !== "undefined" &&
typeof user.companyMembership.roleName !== "undefined" &&
user.companyMembership.roleName !== ""
){
traits.enterprise_role = user.companyMembership.roleName;
}
if ( typeof user.companyMembership !== "undefined" &&
typeof user.companyMembership.companyID !== "undefined" &&
user.companyInfo.companyID > 0
){
if (
typeof user.companyInfo !== "undefined" &&
typeof user.companyInfo.providers !== "undefined" &&
Array.isArray( user.companyInfo.providers ) &&
user.companyInfo.providers.length > 0
){
traits.sso = true;
} else {
traits.sso = false;
}
}
traits.derived_plan = getPlanAffiliation(user, currentSubscription);
var context = {};
var userID = formatUserId(user.id,vendorPrefixByDefault);
segmentUserId = userID;
var callback = function () {
if ( typeof $window.mixpanel !== "undefined" && $window.mixpanel != null ) {
$window.mixpanel.name_tag(null);
}
};
$window.analytics.ready(function() {
if (typeof $window.mixpanel !== 'undefined' && $window.mixpanel != null) {
$window.mixpanel.reset();
$window.mixpanel.identify(userID);
}
if (
typeof ga !== 'undefined'
&& typeof ga === 'function'
&& ['LIVE', 'PREVIEW'].indexOf(config.serverType) !== -1
) {
ga('create', 'UA-24306919-3', 'projects.invisionapp.com', {'name': 'appTracker'} );
var gaDimensions = {};
gaDimensions.dimension1 = config.isCustomer ? "Existing Customer" : "Potential Customer";
ga( 'appTracker.send', 'pageview', gaDimensions);
}
});
$window.analytics.identify( userID, traits, context, callback );
var growthTraits = {
"Full Name": user.name,
Email: user.email,
"Plan Name": traits.plan_name,
"Current Plan Name": getCurrentPlan(user, currentSubscription),
"Signup Date": moment(user.userCreatedAt).format("YYYY-MM-DD HH:mm:ss"),
"Most Recent IP Address": user.lastKnownIpAddress,
"Screens Upload Count": user.screenUploadedCount,
"Last Activity": moment(user.lastRequestAt).format("YYYY-MM-DD HH:mm:ss"),
"Plan Affiliation": getPlanAffiliation(user, currentSubscription),
"Prototype Count": user.prototypeCountForQuota,
"Over Prototype Limit": (user.prototypeCountForQuota > currentSubscription.maxProjectCount ? "True" : "False")
};
if (user.paymentInfo){
var normalizedPaymentInfo = normalizePaymentTrackingInfo(user.paymentInfo);
growthTraits["Credit Card Expiration"] = normalizedPaymentInfo.cardExpiryDate || null;
growthTraits["Credit Card Expiration Remaining Days"] = normalizedPaymentInfo.cardExpiryRemainingDays || null;
}
identifyGrowth( user.id, growthTraits );
var MILLIS_PER_DAY = 60 * 60 * 24 * 1000;
$window.InvAnalytics = $window.InvAnalytics || {};
$window.InvAnalytics.accountAgeDays = (Date.now() - config.accountCreatedAt) / MILLIS_PER_DAY;
}
function translateSubscriptionToLifecycleStage( subscription ) {
var planNamesToConsiderLeads = [ "Free" ];
var lifecycleStage = "lead";
var hasQualifyingCustomerPlan = planNamesToConsiderLeads.indexOf( subscription.name ) < 0;
var hasPaidPlan = subscription.price > 0;
var shouldBeConsideredCustomer = hasQualifyingCustomerPlan && hasPaidPlan;
if ( shouldBeConsideredCustomer ) {
lifecycleStage = "customer";
}
return lifecycleStage;
}
function isSelfServeLocation (){
return window.location.hostname.split(".")[0] === 'projects' ? 'True' : 'False';
}
function splitName( name ) {
var split = name.split(/\s/);
var parts = {
firstname: "",
lastname: ""
};
if ( split.length === 1 ) {
parts.firstname = split[0];
} else if ( split.length > 1 ) {
parts.firstname = split[0];
parts.lastname = split[ split.length - 1 ];
}
return parts;
}
function segmentIo() {
try {
$timeout( segmentIoSync, 10, false );
} catch (error) {
errorLogService.exceptionHandler( error );
}
}
function segmentIoSync() {
if ( window.analytics && typeof window.analytics.load === "function" ) {
if ( config.allowExternalScripts !== false ) {
window.analytics.load(config.segmentIoKey);
window.analytics.page();
}
}
}
function outbrain() {
$timeout( outbrainSync, 10, false );
}
function outbrainSync() {
window.OB_ADV_ID = 13797;
if ( config.allowExternalScripts !== false ) {
loadScript('//widgets.outbrain.com/obtp.js');
}
}
function optimizelyCampaignDecided(event) {
try {
var experimentId  = event.data.decision.experimentId;
var variationId = event.data.decision.variationId;
if (!experimentId || !variationId) {
return;
}
var experiment = _.find(event.data.campaign.experiments, function(item) {
return item.id === experimentId;
});
var variation = experiment && experiment.variations ? _.find(experiment.variations, function(item) {
return item.id === variationId;
}) : null;
trackGrowth("Experiment Viewed", {
experimentId: experimentId,
experimentName: experiment ? experiment.name : '',
variationId: variationId,
variationName: variation ? variation.name  : ''
});
} catch (e) {
console.error("Optimizely data was not in expected format");
}
};
function setupTrackGrowthForOptimizelyCampaigns() {
if (window.optimizelyFailed) {
return;
}
window.optimizely = window.optimizely || [];
window.optimizelyCampaignsQueue = window.optimizelyCampaignsQueue || [];
window.optimizely.push({
type: "removeListener",
token: "queueOptimizelyCampaignDecisions"
});
window.optimizely.push({
type: "addListener",
filter: {
type: "lifecycle",
name: "campaignDecided"
},
handler: optimizelyCampaignDecided
});
window.optimizelyCampaignsQueue.forEach(optimizelyCampaignDecided);
}
function loadScript(url, cb) {
var el = document.createElement('script');
el.async = true;
el.src = url;
if (cb && angular.isFunction(cb)) {
el.onload = el.onreadystatechange = cb;
}
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(el, s);
}
function hashString(stringToHash) {
var hash = 0, i, chr, len;
if (stringToHash.length === 0) return hash;
for (i = 0, len = stringToHash.length; i < len; i++) {
chr   = stringToHash.charCodeAt(i);
hash  = ((hash << 5) - hash) + chr;
hash |= 0; // Convert to 32bit integer
}
return hash;
}
function getPlanAffiliation(user, subscription) {
if (!user || !subscription) {
return false;
}
var planAffiliation = subscription.name;
if (user.hasCompanyMembership) {
planAffiliation = 'Enterprise';
} else if (user.isTeamPlanMember) {
planAffiliation = 'Team';
}
return planAffiliation;
}
function getCurrentPlan(user, subscription) {
if (!user || !subscription) {
return false;
}
var currentPlan = subscription.name;
if (user.companyInfo && (user.companyInfo.companystatusid == 1 || user.companyInfo.companystatusid == 7)) {
currentPlan = 'Enterprise'
}
return currentPlan
}
function setSubscriptionInfo(user, subscription) {
planName = getCurrentPlan(user, subscription);
if (planName) {
document.cookie = "INV_CUSTOMER_PLAN_NAME=" + encodeURI(planName) + ";domain=.invisionapp.com;path=/";
}
}
function initGrowthAnalytics(user, subscription) {
setSubscriptionInfo(user, subscription);
window.amplitudeQueue = window.amplitudeQueue || [];
window.InvGrowth = window.InvGrowth || {
trackGrowth: trackGrowth,
trackGrowthPage: trackGrowthPage
};
$timeout( function () {
amplitudeInit();
var isSignedIn = config.user ? config.user.isAnonymous === false : true;
if (window.loadBraze && isSignedIn){
window.loadBraze(brazeInit);
}
}, 10, false );
}
function  amplitudeInit() {
var initParams = {
saveEvents: true,
includeUtm: true,
includeReferrer: true,
batchEvents: true,
includeGclid: true,
eventUploadThreshold: 10,
eventUploadPeriodMillis: 1000
};
if ( config.amplitudeKey ) {
try {
window.amplitude.getInstance().init(config.amplitudeKey, null, initParams, function(defaultInstance) {
getSafeAmplitudeInstance().init(config.amplitudeKey, null, initParams, function(instance) {
amplitudeFinishedInit = true;
if(window.amplitudeQueue && window.amplitudeQueue.length) {
try {
window.amplitudeQueue.forEach(function(args) {
getSafeAmplitudeInstance().logEvent(args[0], applyRequiredGrowthProps(args[1]));
});
} catch (error) {
errorLogService.exceptionHandler( error );
}
}
if(amplitudeIdentifyGrowthQueue.length) {
try {
amplitudeIdentifyGrowthQueue.forEach(function(args) {
amplitudeIdentify.apply(instance, args);
});
} catch (error) {
errorLogService.exceptionHandler( error );
}
}
window.amplitudeQueue = {
push: function(args) {
trackGrowth.apply(this, args);
}
};
});
});
} catch (error) {
errorLogService.exceptionHandler( error );
}
}
}
function amplitudeIdentify( id, traits ) {
var userID = formatUserId(id, vendorPrefixByDefault);
if ( amplitudeFinishedInit ) {
try {
getSafeAmplitudeInstance().setUserId( userID );
getSafeAmplitudeInstance().setUserProperties( traits );
} catch ( error ) {
errorLogService.exceptionHandler( error );
}
} else {
if ( config.amplitudeKey ) {
amplitudeIdentifyGrowthQueue.push([id, traits]);
}
}
}
function brazeInit() {
var brazeEnabled = config.featureFlags && config.featureFlags["aqua-braze-growth-analytics"];
if (config.brazeApiIdentifierV6 && brazeEnabled && window.appboy) {
try {
var appboy = window.appboy;
appboy.initialize(config.brazeApiIdentifierV6, {
doNotLoadFontAwesome: true,
noCookies: true
});
appboy.openSession();
$timeout(function(){
brazeFinishedInit = true;
if (brazeTrackQueue.length) {
try {
brazeTrackQueue.forEach(function (args) {
appboy.logCustomEvent(args[0], applyRequiredGrowthProps(args[1]));
});
} catch (error) {
errorLogService.exceptionHandler(error);
}
}
if (brazeIdentifyGrowthQueue.length) {
try {
brazeIdentifyGrowthQueue.forEach(function (args) {
brazeIdentify.apply(null, args);
});
} catch (error) {
errorLogService.exceptionHandler(error);
}
}
}, 20);
} catch (error) {
errorLogService.exceptionHandler(error);
}
}
}
function brazeIdentify( id, traits ) {
var subdomain = window.location.hostname.split(".")[0];
var userID = formatUserId(id, /*preferVendorID*/true);
if ( brazeFinishedInit ) {
try {
appboy.changeUser(userID);
var brazeUser = appboy.getUser();
if(traits.Email){
brazeUser.setEmail(traits.Email);
}
if (traits['Full Name']){
var nameParts = traits['Full Name'].split(' ');
brazeUser.setFirstName(nameParts.shift());
brazeUser.setLastName(nameParts.join(' '));
}
brazeUser.setCustomUserAttribute('User ID', id);
brazeUser.setCustomUserAttribute('Subdomain', subdomain);
_.mapKeys(traits, function(val, key){
brazeUser.setCustomUserAttribute(key, val);
});
if (window.brazeReadyHandlers && window.brazeReadyHandlers.length > 0) {
var cb;
while (cb = window.brazeReadyHandlers.shift()) {
if (typeof cb === 'function') {
try {
cb()
} catch (e) {
console.error(e);
}
}
}
}
} catch ( error ) {
errorLogService.exceptionHandler( error );
}
} else {
if ( config.brazeApiIdentifierV6 ) {
brazeIdentifyGrowthQueue.push([id, traits]);
}
}
}
function identifyGrowth(id, traits){
amplitudeIdentify(id, traits);
brazeIdentify(id, traits);
}
function appendGrowthUserAttribute(key, val){
try {
if(amplitudeFinishedInit){
var traits = {};
traits[key] = val;
getSafeAmplitudeInstance().setUserProperties(traits);
}
if(brazeFinishedInit){
appboy.getUser().setCustomUserAttribute(key, val);
}
} catch (error) {
errorLogService.exceptionHandler(error);
}
}
function normalizePaymentTrackingInfo(paymentInfo) {
var normalized = {};
if (paymentInfo && paymentInfo.cardExpirationYear > 0 && paymentInfo.cardExpirationMonth > 0) {
try {
var expirationDate = moment.utc(paymentInfo.cardExpirationYear + ' ' + paymentInfo.cardExpirationMonth + ' 01', 'YYYY MM DD').endOf('month');
var expirationDateInstance = new Date(expirationDate.format());
if(!isNaN(expirationDateInstance.getTime())){
normalized = {
cardExpiryDate: expirationDateInstance,
cardExpiryRemainingDays: expirationDate.diff(moment.utc(), 'days')
};
}
}catch(e){
console.error(e);
}
}
return normalized;
}
function applyRequiredGrowthProps(props){
return _.extend({
"Plan Name": planName || undefined,
"Self Serve": isSelfServeLocation()
}, props);
}
function getSafeAmplitudeInstance() {
var amplitudeStandaloneInstance;
try {
var defaultInstance = window.amplitude && window.amplitude.getInstance();
var amplitudeStandaloneInstance = window.amplitude && window.amplitude.getInstance("standalone");
if (defaultInstance) {
amplitudeStandaloneInstance.setDeviceId(defaultInstance.options.deviceId);
amplitudeStandaloneInstance.setSessionId(defaultInstance._sessionId);
}
} catch ( error ) {
errorLogService.exceptionHandler( error );
}
var amplitudeEnabled = config.featureFlags && config.featureFlags["aqua-amplitude-growth-analytics"];
var consoleNoop = function(){
if(amplitudeEnabled){
errorLogService.exceptionHandler( 'Tried to use amplitude but standalone instance did not exist' );
}
}
return ( amplitudeEnabled && amplitudeStandaloneInstance ) ? amplitudeStandaloneInstance : {
init: consoleNoop,
logEvent: consoleNoop,
logRevenue: consoleNoop,
setUserId: consoleNoop,
setUserProperties: consoleNoop,
setOptOut: consoleNoop,
setVersionName: consoleNoop,
setDomain: consoleNoop,
setDeviceId: consoleNoop,
setGlobalUserProperties: consoleNoop,
identify: consoleNoop,
clearUserProperties: consoleNoop,
setGroup: consoleNoop,
logRevenueV2: consoleNoop,
regenerateDeviceId: consoleNoop,
logEventWithTimestamp: consoleNoop,
logEventWithGroups: consoleNoop,
setSessionId: consoleNoop
};
}
function trackGrowth(event, props) {
var props = applyRequiredGrowthProps(props);
try {
if ( amplitudeFinishedInit ) {
getSafeAmplitudeInstance().logEvent(event, props);
} else if (config.amplitudeKey) {
window.amplitudeQueue = window.amplitudeQueue || [];
window.amplitudeQueue.push([event, props]);
}
if( brazeFinishedInit ){
appboy.logCustomEvent(event, props);
}else if(config.brazeApiIdentifierV6){
brazeTrackQueue.push([event, props]);
}
} catch ( error ) {
errorLogService.exceptionHandler( error );
}
}
function trackGrowthPage(name, category) {
var properties = {
"Page Name": name || "",
"Category Name": category || "",
"Title": document.title,
"URL": document.URL,
"Path": window.location.pathname,
"Referrer": document.referrer,
"Optimizely Loaded": !window.optimizelyFailed
};
var event = "App - Browsing - Visit Page";
trackGrowth(event, properties);
if ( $window.analytics ) {
$window.analytics.track("Browsing.PageVisited", {
page_name: name || "",
category_name: category || "",
title: document.title,
url: document.URL,
path: window.location.pathname,
referrer: document.referrer,
optimizely_loaded: !window.optimizelyFailed,
userID: config.userID,
vendorID: config.vendorID
});
}
}
function formatUserId(userId, preferVendorID) {
var subdomain = window.location.hostname.split(".")[0];
var userKey = (config.singleTenantConfig && config.singleTenantConfig.useSingleTenantAnalytics) ? subdomain + "-" + userId : userId;
if ( config.serverType == "LOCAL" && config.uniqueLocalUserPrefix && config.uniqueLocalUserPrefix.length > 0 ) {
userKey = config.uniqueLocalUserPrefix + "-" + userKey;
}
if (preferVendorID){
return config.vendorID || (config.user || {}).vendorID || userKey;
}
return userKey;
}
function clearLocalData() {
try {
cookieManager.removeCookiesMatchingPatterns([
/ab\.storage\..*/i,
/amplitude_id.*standaloneinvisionapp\.com/i
]);
}catch (e){
console.error(e);
}
}
function track() {
if ( $window.analytics ){
if ( typeof $window.analytics['user'] === 'function' ){
var user = $window.analytics.user();
if ( user && segmentUserId && segmentUserId != user.id() ) {
$window.analytics.identify( segmentUserId );
}
}
if ( typeof $window.analytics['track'] === 'function' ) {
$window.analytics['track'].apply($window.analytics, arguments);
}
}
}
return {
activatePageExperiment: activatePageExperiment,
identifyUser: identifyUser,
identifyGrowth: identifyGrowth,
normalizePaymentTrackingInfo: normalizePaymentTrackingInfo,
appendGrowthUserAttribute: appendGrowthUserAttribute,
initGrowthAnalytics: initGrowthAnalytics,
track: track,
trackGrowth: trackGrowth,
trackGrowthPage: trackGrowthPage,
debug: ($window.analytics && $window.analytics.debug) || angular.noop,
segmentIo: segmentIo,
googleAnalytics: angular.noop, // TODO: Remove all references to this
outbrain: outbrain,
setupTrackGrowthForOptimizelyCampaigns: setupTrackGrowthForOptimizelyCampaigns,
setSubscriptionInfo: setSubscriptionInfo,
clearLocalData: clearLocalData
};
}
})( angular, InVision );
;
;
/*! app-cache.service.js */ 
;
;
(function( ng, app ){
'use strict';
var _DEBUG_ = window._DEBUG_ || false;
app
.service('appCacheService', Service);
/** @ngInject */
function Service($log, Notification) {
var _appCache = window.applicationCache;
var updateOnce =  _.once(_appCache.update);
if (!localStorage.appCacheRetryCounts) {
try {
localStorage.setItem('appCacheRetryCounts', 0);
} catch(err) {
$log.error(err)
}
}
var service = {
update: update
};
init();
return service;
function init() {
if (_DEBUG_) $log.info('appCacheService.init');
_appCache.addEventListener('cached', handleCachedEvent, false);
_appCache.addEventListener('error', handleErrorEvent, false);
_appCache.addEventListener('obsolete', handleObsoleteEvent, false);
_appCache.addEventListener('updateready', handleUpdateReadyEvent, false);
window.addEventListener('load', handleWindowLoadEvent, false);
return service;
}
function handleCachedEvent(e) {
if (_DEBUG_) $log.info('appCacheService.handleCachedEvent', e);
if (_DEBUG_) {
Notification.success({
title: 'App Cache',
message: 'Successfully cached for offline viewing.',
delay: 15000
});
}
}
function handleCheckingEvent(e) {
if (_DEBUG_) $log.info('appCacheService.handleCheckingEvent', e);
}
function handleDownloadingEvent(e) {
if (_DEBUG_) $log.info('appCacheService.handleDownloadingEvent', e);
}
function handleErrorEvent(err) {
if (_DEBUG_) $log.error('appCacheService.handleErrorEvent', err);
var retryCount = +(localStorage.getItem('appCacheRetryCounts'));
if (retryCount < 2 && window.navigator.onLine) {
try {
localStorage.setItem('appCacheRetryCounts', retryCount + 1);
} catch(err) {
$log.error(err)
}
/*
Supress missing resource error until they can be fully solved
Notification.error({
title: 'Missing Resource',
message: '<p>Your project may not be fully cached. If you notice any missing screens, please restore your internet connection and refresh the app.</p><button class="button -refresh" onClick="javascript:window.location.reload()">Refresh</button>',
delay: 15000
}); 
*/
} else {
localStorage.setItem('appCacheRetryCounts', 0)
/*
Notification.error({
title: 'Missing Resource',
message: '<p>Your project may not be fully cached. If you notice any missing screens, please restore your internet connection and refresh the app.</p><button class="button -refresh" onClick="javascript:window.location.reload()">Refresh</button><a class="button -contact-customer-support" href="mailto:support@invisionapp.com?subject=' + encodeURIComponent('[Mobile Share] - App Cache Error') + '&body=' + encodeURIComponent('Dear Support,\n\n' + 'The Project: ' + window.location.href + ', is telling me it’s missing a resource.\n\n' + 'Please investigate the issue.\n\nThank you for your help!\n\n' + 'Cheers,\n[YOUR NAME]') + '">Contact Support</a>',
delay: 99999
});
*/
}
}
function handleNoUpdateEvent(e) {
if (_DEBUG_) $log.info('appCacheService.handleNoUpdateEvent', e);
}
function handleObsoleteEvent(e) {
if (_DEBUG_) $log.info('appCacheService.handleObsoleteEvent', e);
if (_DEBUG_) Notification.info('Outdated App Cache, updating...');
updateOnce();
}
function handleProgressEvent(e) {
if (_DEBUG_) $log.info('appCacheService.handleProgressEvent', e);
}
function handleUpdateReadyEvent(e) {
if (_DEBUG_) $log.info('appCacheService.handleUpdateReadyEvent', e);
if (_appCache.status === _appCache.UPDATEREADY) {
try {
_appCache.swapCache();
if (_DEBUG_) Notification.success('Successfully updated the App Cache.');
} catch (err) {
handleErrorEvent(err);
}
}
}
function handleWindowLoadEvent() {
handleUpdateReadyEvent();
window.removeEventListener('load', handleWindowLoadEvent);
}
function update() {
if (_DEBUG_) $log.info('appCacheService.update');
try {
_appCache.update();
} catch (err) {
handleErrorEvent(err);
}
return service;
}
}
})( angular, InVision );
;
;
/*! app-settings.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("InVision")
.factory( "appSettings", appSettings )
;
function appSettings( $location, _, sessionService, config ) {
var launchDarklyFeatureFlags = [
"enableMyNotifications",
"mentionShortcut",
"projectNotificationPreferences",
"shareCommentingLogin"
];
var settings = {
debug: false,
notifications: [],
features: {
tfa: false,
sessionInactivity: false
}
};
var user = {};
var isInVisionAppUser = false;
return {
setUser: setUser,
setSettings: setSettings,
getSettings: getSettings,
setFeatureFlag: setFeatureFlag
};
function setUser( u ) {
user = u;
isInVisionAppUser = (
user &&
! user.isAnonymous &&
user.email.indexOf("@invisionapp.com") > -1
);
settings.features.notifications = isInVisionAppUser;
settings.features.boardsSelectiveSync = isInVisionAppUser;
if ( ! isInVisionAppUser && config.featureFlags ) {
setSettings( {
debug: false,
notifications: [], 
features: config.featureFlags 
} );
}
}
function setSettings( newSettings ) {
_.each(launchDarklyFeatureFlags, function(k) {
newSettings.features[k] = settings.features[k];
});
ng.extend( settings, newSettings );
}
function setFeatureFlag( flagName, flagValue) {
settings.features[flagName] = flagValue;
}
function getSettings() {
if ( !settings.debug && isInVisionAppUser ) {
settings.features.inbox = true;
settings.features.scheduledLiveShare = true;
settings.features.boardsSelectiveSync = true;
}
return settings;
}
}
})( angular );
;
;
/*! braze-bridge-service.js */ 
;
;
(function (ng, app) {
"use strict";
app.service("brazeBridgeService", BrazeBridgeService);
/** @ngInject */
function BrazeBridgeService($http, $q, $rootScope, $timeout, $window, accountService, errorLogService, sessionService) {
function getUserEmail() {
return (sessionService.user || {}).email || '';
};
function submitEnterpriseLeadInfo(userDetails) {
var email = (sessionService.user || {}).email || '';
var employer = email.substring(email.lastIndexOf("@") + 1, email.lastIndexOf("."));
var q = $q.defer();
$http.get('/api/account/get-clearbit-data', {
params: {
email: email
},
type: 'get',
responseType: 'json'
}).then(function (resp) {
if (!resp || !resp.data) {
throw Error('No clearbit data provided');
}
var data = resp.data;
if (data && data.employment && data.employment.name) {
employer = data.employment.name;
}
submitLeadInfo(Object.assign({
companyName: employer
}, userDetails)).then(q.resolve, q.reject);
}).catch(function () {
submitLeadInfo(Object.assign({
companyName: employer
}, userDetails)).then(q.resolve, q.reject);
});
return q.promise;
};
function submitLeadInfo(data) {
var subscriptionUser = sessionService.user || {};
return accountService.sendEnterpriseInfoRequestWithLeadInfo(
"requestsMoreCollaborators",
Object.assign({}, {
firstName: (subscriptionUser.name || "").split(' ').shift(),
lastName: (subscriptionUser.name || "").split(' ').pop(),
email: subscriptionUser.email || "",
phone: "",
companyName: subscriptionUser.company || "",
companySize: "",
numOfDesigners: ""
}, data)
);
}
$window.addEventListener('message', function (event) {
if (!event || event.source !== window) {
return;
}
var regexp = /^[a-zA-Z0-9\s\:\-]+$/;
if (!event || !event.data || event.data.toString().indexOf('braze-trigger:') !== 0 || !regexp.test(event.data.toString())) {
return;
}
var triggerParams = event.data.split(':').slice(2);
if (triggerParams[0] === 'modal' && triggerParams[1]) {
var modalSegments = triggerParams.slice(2);
var modalData;
if (modalSegments.length === 1) {
modalData = modalSegments[0];
} else if (modalSegments.length > 1) {
modalData = modalSegments.reduce(function (obj, entry, index, segments) {
if (index % 2 === 0) {
obj[entry] = true;
} else {
obj[segments[index - 1]] = entry;
}
return obj;
}, {});
}
$timeout(function () {
$rootScope.openModalWindow(triggerParams[1], modalData);
}, 16);
} else {
errorLogService.exceptionHandler('Braze component triggering a js interaction that is not supported: ' + event.data.toString());
}
});
return {
initialize: function(){
$window.InvBrazeBridge = {
submitEnterpriseLeadInfo: submitEnterpriseLeadInfo,
getUserEmail: getUserEmail
};
}
};
}
})(angular, InVision);
;
;
/*! client-events.js */ 
;
;
(function( ng, app ) {
"use strict";
app.factory( "clientEvents", ClientEventsFactory );
function ClientEventsFactory( _ ) {
var bindings = [];
return({
add: add,
forNamespace: forNamespace,
remove: remove,
trigger: trigger
});
function add( namespace, eventType, eventHandler, context ) {
testNamespace( namespace );
testEventType( eventType );
testEventHandler( eventHandler );
bindings.push({
namespace: namespace,
eventType: eventType,
eventHandler: eventHandler,
context: ( context || null )
});
return( this );
}
function forNamespace( namespace ) {
return({
add: _.partial( add, namespace ),
forNamespace: forNamespace,
remove: _.partial( remove, namespace ),
trigger: trigger
});
}
function remove( namespace, eventType, eventHandler ) {
bindings = _.reject(
bindings,
function operator( binding ) {
return( bindingMatches( binding, namespace, eventType, eventHandler ) );
}
);
return( this );
}
function trigger( eventType ) {
var eventArguments = Array.prototype.slice.call( arguments );
var event = eventArguments[ 0 ] = {
type: eventType
};
_.each(
bindings,
function iterator( binding ) {
if ( binding.eventType === eventType ) {
binding.eventHandler.apply( binding.context, eventArguments );
}
}
);
return( event );
}
function bindingMatches( binding, namespace, eventType, eventHandler ) {
return(
( binding.namespace === namespace ) &&
( ! eventType || ( binding.eventType === eventType ) ) &&
( ! eventHandler || ( binding.eventHandler === eventHandler ) )
);
}
function testEventHandler( newEventHandler ) {
if ( ! _.isFunction( newEventHandler ) ) {
throw( new Error( "EventHandler must be a function." ) );
}
}
function testEventType( newEventType ) {
if ( ! _.isString( newEventType ) ) {
throw( new Error( "EventType must be a string value." ) );
}
if ( ! _.trim( newEventType ) ) {
throw( new Error( "EventType must not be empty." ) );
}
}
function testNamespace( newNamespace ) {
if ( ! _.isString( newNamespace ) ) {
throw( new Error( "Namespace must be a string value." ) );
}
if ( ! _.trim( newNamespace ) ) {
throw( new Error( "Namespace must not be empty." ) );
}
}
}
})( angular, InVision );
;
;
/*! comment-object-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.factory( "commentObjectService", CommentObjectService );
function CommentObjectService() {
var current = {
objectType: null,	// One of "project" or "board"
objectID: 0,			// The id of the project or board which is currently selected
conversationID: 0
};
return ({
get: function() {
return current;
},
reset: function() {
current = {
objectType: null,
objectID: 0,
conversationID: 0
};
},
set: function( objectType, opts ) {
if ( objectType !== null ) { // Allow setting objectType to null
if ( objectType !== "project" && objectType !== "board" ) {
throw ("Bug alert. When setting the comment object type, you must pass either 'project' or 'board'. You passed " + objectType + ".");
}
}
this.reset();
current = {
objectType: objectType,
objectID: opts.objectID,
conversationID: opts.conversationID
};
}
});
}
})( angular, InVision );
;
;
/*! cookie-manager-service.js */ 
;
;
(function (ng, app) {
"use strict";
app.factory("cookieManager", CookieManager);
/** @ngInject */
function CookieManager() {
return {
getCookies: function () {
var cookies = {};
try {
if (document.cookie && document.cookie !== '') {
document.cookie.split(';').forEach(function(kvGroup){
var nameVal = kvGroup.split("=");
nameVal[0] = nameVal[0].replace(/^ /, '');
cookies[decodeURIComponent(nameVal[0])] = decodeURIComponent(nameVal[1]);
});
}
} catch (e) {
console.error(e);
}
return cookies;
},
removeCookie: function (cookieName) {
if (cookieName) {
try {
document.cookie = cookieName + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;domain=.invisionapp.com;';
} catch (e) {
console.error(e);
}
}
},
removeCookiesMatchingPatterns: function (patterns){
var self = this;
try {
var cookies = self.getCookies();
Object.keys(cookies).forEach(function (key) {
var shouldDelete = patterns.some(function (pattern) {
return pattern.test(key);
});
if (shouldDelete) {
self.removeCookie(key);
}
});
} catch (e) {
console.error(e);
}
}
};
}
})(angular, InVision);
;
;
/*! date-helper.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "dateHelper", Service );
/** @ngInject */
function Service() {
this.dayAsStringMap = [
{
"long": "Sunday",
"short": "Sun"
},
{
"long": "Monday",
"short": "Mon"
},
{
"long": "Tuesday",
"short": "Tue"
},
{
"long": "Wednesday",
"short": "Wed"
},
{
"long": "Thursday",
"short": "Thr"
},
{
"long": "Friday",
"short": "Fri"
},
{
"long": "Saturday",
"short": "Sat"
}
];
this.monthAsStringMap = [
{
"long": "January",
"short": "Jan"
},
{
"long": "February",
"short": "Feb"
},
{
"long": "March",
"short": "Mar"
},
{
"long": "April",
"short": "Apr"
},
{
"long": "May",
"short": "May"
},
{
"long": "June",
"short": "Jun"
},
{
"long": "July",
"short": "Jul"
},
{
"long": "August",
"short": "Aug"
},
{
"long": "September",
"short": "Sep"
},
{
"long": "October",
"short": "Oct"
},
{
"long": "November",
"short": "Nov"
},
{
"long": "December",
"short": "Dec"
}
];
return( this );
}
Service.prototype = {
add: function( datetime, count, unit ) {
var newDatetime = this.duplicate( datetime );
switch ( unit.toLowerCase() ) {
case "y":
newDatetime.setFullYear( newDatetime.getFullYear() + count );
break;
case "m":
newDatetime.setMonth( newDatetime.getMonth() + count );
break;
case "d":
newDatetime.setDate( newDatetime.getDate() + count );
break;
case "w":
newDatetime.setDate( newDatetime.getDate() + ( count * 7 ) );
break;
case "h":
newDatetime.setTime( newDatetime.getTime() + ( count * 1000 * 60 * 60 ) );
break;
case "n":
newDatetime.setTime( newDatetime.getTime() + ( count * 1000 * 60 ) );
break;
case "s":
newDatetime.setTime( newDatetime.getTime() + ( count * 1000 ) );
break;
case "l":
newDatetime.setTime( newDatetime.getTime() + count );
break;
}
return( newDatetime );
},
addDays: function( datetime, dayCount ) {
var newDatetime = this.duplicate( datetime );
newDatetime.setDate( newDatetime.getDate() + dayCount );
return( newDatetime );
},
addLeadingZero: function( value ) {
if ( value.toString().length === 1 ) {
return( "0" + value );
}
return( value );
},
convertSecondsToMinutes: function( seconds, excludeZeroMinute ) {
var minutes = Math.floor( seconds / 60 );
var remainingSeconds = ( seconds % 60 );
if (
( excludeZeroMinute === true ) &&
( minutes === 0 )
) {
return( ":" + this.addLeadingZero( remainingSeconds ) );
} else {
return( minutes + ":" + this.addLeadingZero( remainingSeconds ) );
}
},
duplicate: function( datetime ) {
return(
new Date( datetime )
);
},
equals: function( date1, date2 ) {
return( date1.getTime() === date2.getTime() );
},
formatDate: function( datetime, dateMask ) {
var self = this;
var date = this.removeTime( datetime );
var result = dateMask.replace(
/M+|m+|d+|yyyy|yy/g,
function( $0 ) {
return(
self.getFormattedDatePart( date, $0 )
);
}
);
return( result );
},
formatRecentDate: function( datetime, dateMask ) {
var date = this.removeTime( datetime );
if ( this.isToday( date ) ) {
return( "Today" );
} else if ( this.isYesterday( date ) ) {
return( "Yesterday" );
} else {
return( this.formatDate( datetime, dateMask ) );
}
},
formatTime: function( datetime, timeMask ) {
var self = this;
var date = this.duplicate( datetime );
var result = timeMask.replace(
/H+|h+|m+|t+|T+/g,
function( $0 ) {
return(
self.getFormattedTimePart( date, $0 )
);
}
);
return( result );
},
getDayOfWeekAsString: function( dayOfWeek, useShortVersion ) {
if ( useShortVersion ) {
return( this.dayAsStringMap[ dayOfWeek ][ "short" ] );
} else {
return( this.dayAsStringMap[ dayOfWeek ][ "long" ] );
}
},
getFormattedDatePart: function( datetime, pattern ) {
switch( pattern ) {
case "D":
case "d":
return( datetime.getDate() );
break;
case "DD":
case "dd":
return( this.addLeadingZero( datetime.getDate() ) );
break;
case "DDD":
return( this.getDayOfWeekAsString( datetime.getDay() ).toUpperCase() );
break;
case "ddd":
return( this.getDayOfWeekAsString( datetime.getDay() ) );
break;
case "dddd":
return( this.getDayOfWeekAsString( datetime.getDay(), true ) );
break;
case "M":
case "m":
return( datetime.getMonth() + 1 );
break;
case "MM":
case "mm":
return( this.addLeadingZero( datetime.getMonth() + 1 ) );
break;
case "MMM":
case "mmm":
return( this.getMonthAsString( datetime.getMonth(), true ) );
break;
case "MMMM":
case "mmmm":
return( this.getMonthAsString( datetime.getMonth(), false ) );
break;
case "YY":
case "yy":
return( this.addLeadingZero( datetime.getFullYear() % 100 ) );
break;
case "YYYY":
case "yyyy":
return( datetime.getFullYear() );
break;
}
return( pattern );
},
getFormattedTimePart: function( datetime, pattern ) {
switch( pattern ) {
case "H":
return( datetime.getHours() );
break;
case "HH":
var value = datetime.getHours();
return( value < 10 ?  "0" + value : value );
break;
case "h":
var value = (datetime.getHours()  % 12);
return( value === 0 ? 12 : value );
break;
case "hh":
var value = (datetime.getHours()  % 12);
value = ( value === 0 ? 12 : value );
return( value < 10 ?  "0" + value : value );
break;
case "M":
case "MM":
case "m":
case "mm":
var value = datetime.getMinutes();
return( value < 10 ? "0" + value : value );
break;
case "T":
return( datetime.getHours() < 12 ? "A" : "P" );
break;
case "TT":
return( datetime.getHours() < 12 ? "AM" : "PM" );
break;
case "t":
return( datetime.getHours() < 12 ? "a" : "p" );
break;
case "tt":
return( datetime.getHours() < 12 ? "am" : "pm" );
break;
}
return( pattern );
},
getMonthAsString: function( month, useShortVersion ) {
if ( useShortVersion ) {
return( this.monthAsStringMap[ month ][ "short" ] );
} else {
return( this.monthAsStringMap[ month ][ "long" ] );
}
},
isRecent: function( datetime, delta, unit ) {
var cutoff = this.add( new Date(), -delta, unit );
return( datetime >= cutoff );
},
isToday: function( datetime ) {
return(
this.equals( datetime, this.today() )
);
},
isYesterday: function( datetime ) {
return(
this.equals( datetime, this.yesterday() )
);
},
notEquals: function( date1, date2 ) {
return( ! this.equals( date1, date2 ) );
},
removeTime: function( datetime ) {
var newDatetime = this.duplicate( datetime );
newDatetime.setHours( 0 );
newDatetime.setMinutes( 0 );
newDatetime.setSeconds( 0 );
newDatetime.setMilliseconds( 0 );
return( newDatetime );
},
today: function() {
return(
this.removeTime( new Date() )
);
},
tomorrow: function() {
return( this.addDays( this.today(), 1 ) );
},
yesterday: function() {
return(
this.addDays( this.today(), -1 )
);
},
formatRelativeWithinMonth: function(time, lang) {
lang = lang || "smallDate";
moment.lang("smallDate", {
relativeTime : {
future : "in %s",
past : "%s ago",
s : "1s",
m : "1m",
mm : "%dm",
h : "1h",
hh : "%dh",
d : "1d",
dd : "%dd",
M : "1mo",
MM : "%d months",
y : "a year",
yy : "%d years"
}
});
moment.lang("expandedDate", {
relativeTime : {
future : "in %s",
past : "%s ago",
s : "1 second",
ss : "%d seconds",
m : "1 minute",
mm : "%d minutes",
h : "1 hour",
hh : "%d hours",
d : "1 day",
dd : "%d days",
M : "1 month",
MM : "%d months",
y : "a year",
yy : "%d years"
}
});
moment.lang("expandedDate", {
relativeTime : {
future : "in %s",
past : "%s ago",
s : "1 second",
ss : "%d seconds",
m : "1 minute",
mm : "%d minutes",
h : "1 hour",
hh : "%d hours",
d : "1 day",
dd : "%d days",
M : "1 month",
MM : "%d months",
y : "a year",
yy : "%d years"
}
});
moment.lang("expandedDate", {
relativeTime : {
future : "in %s",
past : "%s ago",
s : "1 second",
ss : "%d seconds",
m : "1 minute",
mm : "%d minutes",
h : "1 hour",
hh : "%d hours",
d : "1 day",
dd : "%d days",
M : "1 month",
MM : "%d months",
y : "a year",
yy : "%d years"
}
});
var now = moment(),
diff = moment(time).diff(now, "months"),
output;
if ( Math.abs(diff) === 0 ) {
moment.lang( lang );
output = moment(time).fromNow();
moment.lang(false);
} else {
output = moment(time).format("MMM D");
}
return output;
}
};
})( angular, InVision );
;
;
/*! deferred.js */ 
;
;
(function( ng, app ) {
"use strict";
app.factory(
"Deferred",
/** @ngInject */
function( $q, _ ) {
function Deferred() {
var deferred = $q.defer();
var promise = deferred.promise;
var core = {
resolve: deferred.resolve,
reject: deferred.reject,
then: promise.then
};
var isResolved = false;
var isRejected = false;
var updateCallbacks = [];
var mistakeCallbacks = [];
deferred.resolve = function() {
if ( isResolved && !isRejected ) {
for ( var i = 0, length = updateCallbacks.length ; i < length ; i++ ) {
updateCallbacks[ i ].apply( {}, arguments );
}
} else {
isResolved = true;
core.resolve.apply( deferred, arguments )
}
};
deferred.reject = function() {
if ( isResolved ) {
for ( var i = 0, length = mistakeCallbacks.length ; i < length ; i++ ) {
mistakeCallbacks[ i ].apply( {}, arguments );
}
} else {
isRejected = true;
core.reject.apply( deferred, arguments )
}
};
promise.then = function() {
var newPromise = core.then.apply( promise, arguments );
newPromise.update = promise.update;
newPromise.mistake = promise.mistake;
return( newPromise );
};
promise.update = function( callback ) {
updateCallbacks.push( callback );
return( promise );
};
promise.mistake = function( callback ) {
mistakeCallbacks.push( callback );
return( promise );
};
return( deferred );
}
Deferred.handleAllPromises = function( promises, successCallback, errorCallback, runOnce ) {
var handleSuccess = function( index, response ) {
if ( hasError ) {
return;
}
results[ index ] = response;
if ( _.contains( results, null ) ) {
return;
}
successCallback.apply( null, results );
};
var handleError = function( index, response ) {
if ( hasError ) {
return;
}
hasError = true;
errorCallback.call( null, response );
};
var results = [];
for ( var i = 0, length = promises.length ; i < length ; i++ ) {
results.push( null );
}
var hasError = false;
successCallback = ( successCallback || ng.noop );
errorCallback = ( errorCallback || ng.noop );
_.forEach(
promises,
function( promise, index ) {
Deferred.handlePromise(
promise,
function( response ) {
handleSuccess( index, response );
},
function( response ) {
handleError( index, response );
},
runOnce
);
}
);
};
Deferred.handlePromise = function( promise, successCallback, errorCallback, runOnce ) {
var handleSuccess = function( response ) {
if ( hasRun && runOnce ) {
return;
}
hasRun = true;
successCallback( response );
};
var hasRun = false;
successCallback = ( successCallback || ng.noop );
errorCallback = ( errorCallback || ng.noop );
promise.then( handleSuccess, errorCallback );
promise.update( handleSuccess );
promise.mistake( errorCallback );
return( promise );
};
return( Deferred );
}
);
})( angular, InVision );
;
;
/*! error-log-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "errorLogService", ErrorLogService );
/** @ngInject */
function ErrorLogService( $log, $window, stackTraceService ) {
var debounceLog = {};
var appLoadedAt = ( new Date() ).getTime();
function log( exception ) {
$log.error.apply( $log, arguments );
try {
var errorMessage = typeof exception === "object" && exception.message ?
exception.message : exception.toString();
if ( shouldSkipErrorReporting( errorMessage ) ) {
return;
}
if ( $window.NREUM && $window.NREUM.noticeError ) {
try {
$window.NREUM.noticeError( exception );
} catch ( newRelicError ) {
$log.error.call( $log, newRelicError );
}
}
var stackTrace = exception instanceof Error ?
stackTraceService.print({ e: exception }) :
exception;
$.ajax({
type: "POST",
url: "/api/error-log/javascript",
contentType: "application/json",
headers: {
"X-Page-Loaded-At": appLoadedAt
},
data: ng.toJson({
errorUrl: $window.location.href,
errorMessage: errorMessage,
stackTrace: ng.toJson( stackTrace )
})
});
} catch ( loggingError ) {
$log.warn( "Error logging failed" );
$log.log( loggingError );
}
}
function normalizeErrorMessage( message ) {
return(
String( message ).toLowerCase().replace( /[^a-z0-9]+/gi, "_" )
);
}
function shouldSkipErrorReporting( message ) {
var errorKey = ( "debounce_" + normalizeErrorMessage( message ) );
if ( debounceLog.hasOwnProperty( errorKey ) ) {
return( true );
}
debounceLog[ errorKey ] = true;
return( false );
}
return({
exceptionHandler: log
});
}
})( angular, InVision );
;
;
/*! hashkey-copier.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "hashKeyCopier", HashKeyCopier );
/** @ngInject */
/** @ngInject */
function HashKeyCopier( _ ) {
function applyHashKeyIndex( hashKeyIndex, target, uniqueIdentifiers ) {
if ( _.isArray( target ) ) {
applyHashKeyIndexToArray( hashKeyIndex, "[]", target, uniqueIdentifiers );
} else if ( _.isObject( target ) ) {
applyHashKeyIndexToObject( hashKeyIndex, ".", target, uniqueIdentifiers );
}
return( target );
}
function applyHashKeyIndexToArray( hashKeyIndex, path, target, uniqueIdentifiers ) {
for ( var i = 0, length = target.length ; i < length ; i++ ) {
var targetItem = target[ i ];
if ( _.isArray( targetItem ) ) {
applyHashKeyIndexToArray( hashKeyIndex, ( path + "[]" ), targetItem, uniqueIdentifiers );
} else if ( _.isObject( targetItem ) ) {
applyHashKeyIndexToObject( hashKeyIndex, ( path + "." ), targetItem, uniqueIdentifiers );
}
}
}
function applyHashKeyIndexToObject( hashKeyIndex, path, target, uniqueIdentifiers ) {
var identifier = getUniqueIdentifierForObject( target, uniqueIdentifiers );
if ( identifier ) {
var hashKeyPath = ( path + target[ identifier ] );
if ( hashKeyIndex.hasOwnProperty( hashKeyPath ) ) {
target[ hashKeyLookup ] = hashKeyIndex[ hashKeyPath ];
path += ( target[ identifier ] + "." );
}
}
for ( var key in target ) {
if ( target.hasOwnProperty( key ) ) {
var targetItem = target[ key ];
if ( _.isArray( targetItem ) ) {
applyHashKeyIndexToArray( hashKeyIndex, ( path + key + "[]" ), targetItem, uniqueIdentifiers );
} else if ( _.isObject( targetItem ) ) {
applyHashKeyIndexToObject( hashKeyIndex, ( path + key + "." ) , targetItem, uniqueIdentifiers );
}
}
}
}
function buildHashKeyIndex( target, uniqueIdentifiers ) {
var hashKeyIndex = {};
if ( _.isArray( target ) ) {
buildHashKeyIndexForArray( hashKeyIndex, "[]", target, uniqueIdentifiers );
} else if ( _.isObject( target ) ) {
buildHashKeyIndexForObject( hashKeyIndex, ".", target, uniqueIdentifiers );
}
return( hashKeyIndex );
}
function buildHashKeyIndexForArray( hashKeyIndex, path, target, uniqueIdentifiers ) {
for ( var i = 0, length = target.length ; i < length ; i++ ) {
var targetItem = target[ i ];
if ( _.isArray( targetItem ) ) {
buildHashKeyIndexForArray( hashKeyIndex, ( path + "[]" ), targetItem, uniqueIdentifiers );
} else if ( _.isObject( targetItem ) ) {
buildHashKeyIndexForObject( hashKeyIndex, ( path + "." ), targetItem, uniqueIdentifiers );
}
}
}
function buildHashKeyIndexForObject( hashKeyIndex, path, target, uniqueIdentifiers ) {
if ( target.hasOwnProperty( hashKeyLookup ) ) {
var identifier = getUniqueIdentifierForObject( target, uniqueIdentifiers );
if ( identifier ) {
hashKeyIndex[ path + target[ identifier ] ] = target[ hashKeyLookup ];
path += ( target[ identifier ] + "." );
}
}
for ( var key in target ) {
if ( target.hasOwnProperty( key ) ) {
var targetItem = target[ key ];
if ( _.isArray( targetItem ) ) {
buildHashKeyIndexForArray( hashKeyIndex, ( path + key + "[]" ), targetItem, uniqueIdentifiers );
} else if ( _.isObject( targetItem ) ) {
buildHashKeyIndexForObject( hashKeyIndex, ( path + key + "." ) , targetItem, uniqueIdentifiers );
}
}
}
}
function copyHashKeys( existing, incoming, uniqueIdentifiers ) {
if ( isExistingDataEmpty( existing ) ) {
return( incoming );
}
if ( ! uniqueIdentifiers ) {
uniqueIdentifiers = [ "id" ];
}
var hashKeyIndex = buildHashKeyIndex( existing, uniqueIdentifiers );
applyHashKeyIndex( hashKeyIndex, incoming, uniqueIdentifiers );
return( incoming );
}
function getUniqueIdentifierForObject( target, uniqueIdentifiers ) {
for ( var i = 0, length = uniqueIdentifiers.length ; i < length ; i++ ) {
var identifier = uniqueIdentifiers[ i ];
if ( target.hasOwnProperty( identifier ) ) {
return( identifier );
}
}
return( null );
}
function isEmptyArray( target ) {
return(
target.hasOwnProperty( "length" ) && 
( target.length === 0 )
);
}
function isExistingDataEmpty( existing ) {
if ( ! existing || isEmptyArray( existing ) ) {
return( true );
}
return( false );
}
var hashKeyLookup = "$$hashKey";
return({
copyHashKeys: copyHashKeys
});
}
})( angular, InVision );
;
;
/*! http-activity-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "httpActivityService", Service );
/** @ngInject */
function Service() {
this.activeRequestCount = 0;
this.activeGetRequestCount = 0;
this.activePostRequestCount =  0;
return( this );
}
Service.prototype = {
isActive: function() {
return( this.activeRequestCount !== 0 );
},
isActiveWithGet: function() {
return( this.activeGetRequestCount !== 0 );
},
isActiveWithPost: function() {
return( this.activePostRequestCount !== 0 );
},
requestCompleted: function( isPostRequest ) {
if ( isPostRequest ) {
this.activePostRequestCount--;
} else {
this.activeGetRequestCount--;
}
this.activeRequestCount--;
if ( this.activeRequestCount === 0 ) {
this.activeGetRequestCount = 0;
this.activePostRequestCount = 0;
}
return( this.activeRequestCount );
},
requestStarted: function( isPostRequest ) {
if ( isPostRequest ) {
this.activePostRequestCount++;
} else { 
this.activeGetRequestCount++;
}
this.activeRequestCount++;
return( this.activeRequestCount );
}
};
})( angular, InVision );
;
;
/*! image-canvas-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "imageCanvasService", Service );
/** @ngInject */
function Service( serviceHelper ) {
var cachedColors = {};
function getImageColorAtCoodinates( imageUrl, coordinates, callback ) {
if ( imageUrl in cachedColors ) {
return( callback( cachedColors[ imageUrl ] ) );
}
var colors = [];
var image = new Image();
image.crossOrigin = "Anonymous";
image.onload = function() {
var canvas = document.createElement("canvas");
canvas.width = image.width;
canvas.height = image.height;
var ctx = canvas.getContext( "2d" );
ctx.drawImage( image, 0, 0 );
var imageData = ctx.getImageData( 0, 0, canvas.width, canvas.height );
for ( var i = 0 ; i < coordinates.length ; i++ ) {
var xCoord = coordinates[ i ].x;
var yCoord = coordinates[ i ].y;
var index = ( 4 * ( yCoord * imageData.width + xCoord ) );
var r = imageData.data[ index ];
var g = imageData.data[ index + 1 ];
var b = imageData.data[ index + 2 ];
var a = imageData.data[ index + 3 ];
colors.push( "rgba(" + r + "," + g + "," + b + "," + a + ")" );
}
callback( cachedColors[ imageUrl ] = colors );
imageUrl = coordinates = callback = colors = image = null;
$(canvas).remove();
};
image.src = imageUrl;
}
return({
getImageColorAtCoodinates: getImageColorAtCoodinates
});
}
})( angular, InVision );
;
;
/*! image-route-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "imageRouteService", Service );
/** @ngInject */
function Service(  ) {
function getProjectMobileDeviceID( projMobileDeviceID ){
if( typeof projMobileDeviceID != "number" ){
projMobileDeviceID = 0;
}
return projMobileDeviceID;
}
function getThumbnailURL( screenID, screenVersion, projectMobileDeviceID ){
return ( "/thumbnails/" + screenID + "/" + screenVersion + "/" + getProjectMobileDeviceID( projectMobileDeviceID ) );
}
function getScreenURL( screenID, screenVersion, projectMobileDeviceID ){
return ( "/screens/" + screenID + "/" + screenVersion + "/" + getProjectMobileDeviceID( projectMobileDeviceID ) );
}
function getHomeScreenURL( homeScreenID, homeScreenVersion, projectMobileDeviceID ){
if( homeScreenID ){
return ( "/thumbnails/" + homeScreenID + "/" + homeScreenVersion + "/" + getProjectMobileDeviceID( projectMobileDeviceID ) );
} else {
return ( "/assets/apps/common/img/blank.png" );
}
}
return({
getScreenURL: getScreenURL,
getThumbnailURL: getThumbnailURL,
getHomeScreenURL: getHomeScreenURL
});
}
})( angular, InVision );
;
;
/*! jquery.js */ 
;
;
(function( ng, app ) {
"use strict";
app.factory( "$", Factory );
function Factory() {
return $;
}
})( angular, InVision );
;
;
/*! lodash.js */ 
;
;
(function( ng, app, _, undefined ) {
"use strict";
app.factory( "_", Factory );
/** @ngInject */
function Factory() {
_.anyWithProperty = function( collection, name, value ) {
var result = _.any(
collection,
function( item ) {
return( item[ name ] === value );
}
);
return( result );
};
_.capitalizeFirstLetter = function( value ) {
if ( ! value ) {
return( "" );
}
return( value.slice( 0, 1 ).toUpperCase() + value.slice( 1 ) );
};
_.containsWithProperty = function( collection, name, value ) {
return( !! this.findWithProperty( collection, name, value ) );
};
_.countWithProperty = function( collection, name, value ) {
var count = 0;
for ( var i = 0 ; i < collection.length ; i++ ) {
if ( collection[ i ][ name ] === value ) {
count++;
}
}
return( count );
};
_.extendExistingProperties = function( destination, source ) {
if ( ! ( destination && source ) ) {
return( destination );
}
var angularKeyPattern = new RegExp( "^\\$+", "i" );
for ( var key in source ) {
if (
source.hasOwnProperty( key ) &&
destination.hasOwnProperty( key ) &&
! angularKeyPattern.test( key ) &&
! _.isFunction( source[ key ] )
) {
destination[ key ] = source[ key ];
}
}
return( destination );
};
_.filterWithProperty = function( collection, name, value ) {
var filteredCollection = _.filter(
collection,
function( item ) {
return( item[ name ] === value );
}
);
return( filteredCollection );
};
_.findWithProperty = function( collection, name, value ) {
var result = _.find(
collection,
function( item ) {
return( item[ name ] === value );
}
);
return( result );
};
_.findWithPropertyAndReplace = function( collection, name, value, replacement, operator ) {
if ( ! collection || ( replacement === undefined ) ) {
return( collection );
}
operator = ( operator || ng.noop );
for ( var i = 0, length = collection.length ; i < length ; i++ ) {
var item = collection[ i ];
if ( item[ name ] === value ) {
collection[ i ] = ( operator( replacement, item ) || replacement );
return( collection );
}
}
collection.push( replacement );
return( collection );
};
_.indexOfWithProperty = function( collection, name, value ) {
for ( var i = 0 ; i < collection.length ; i++ ) {
if ( collection[ i ][ name ] === value ) {
return( i );
}
}
return( -1 );
};
_.isValidEmail = function( value ) {
var pattern = /^[^@]+@[^.]+(\.[^.]+)+$/i;
return( pattern.test( value ) );
};
_.notContainsProperty = function( collection, name, value ) {
var filteredCollection = this.filter(
collection,
function( item ) {
return( !_.contains(item[ name ].toLowerCase(), value.toLowerCase()) );
}
);
return( filteredCollection );
};
_.maxProperty = function( collection, name ) {
if ( ! collection.length ) {
return;
}
return(
_.max(
_.pluck( collection, name )
)
);
};
_.minProperty = function( collection, name ) {
return(
_.min(
_.pluck( collection, name )
)
);
};
_.normalizeMixedDataValue = function( value ) {
var padding = "000000000000000";
value = value.replace(
/(\d+)((\.\d+)+)?/g,
function( $0, integer, decimal, repeatDecimal ) {
if ( decimal !== repeatDecimal ) {
return(
padding.slice( integer.length ) +
integer +
decimal
);
}
decimal = ( decimal || ".0" );
return(
padding.slice( integer.length ) +
integer +
decimal +
padding.slice( decimal.length )
);
}
);
return( value );
};
_.rejectWithProperty = function( collection, name, value ) {
var filteredCollection = _.reject(
collection,
function( item ) {
return( item[ name ] === value );
}
);
return( filteredCollection );
};
_.setProperty = function( collection, name, value ) {
this.forEach(
collection,
function( item ) {
item[ name ] = value;
}
);
return( collection );
};
_.similar = function( collectionA, collectionB ) {
var deltaA = _.difference( collectionA, collectionB ).length;
var deltaB = _.difference( collectionB, collectionA ).length;
return( ( deltaA + deltaB ) === 0 );
};
_.sortOnProperty = function( collection, name, direction, caseInsensitive ) {
direction = ( direction || "asc" );
var sortIndicator = ( direction === "asc" ? -1 : 1 );
collection.sort(
function( a, b ) {
if ( caseInsensitive ) {
return( a[ name ].toLowerCase() < b[ name ].toLowerCase() ? sortIndicator : - sortIndicator );
} else {
return( a[ name ] < b[ name ] ? sortIndicator : -sortIndicator );
}
}
);
return( collection );
};
_.sortOnPropertyUsingNaturalOrder = function( collection, name, direction ) {
direction = ( direction || "asc" );
var sortIndicator = ( direction === "asc" ? -1 : 1 );
collection.sort(
function( a, b ) {
var aMixed = _.normalizeMixedDataValue( a.name.toLowerCase() );
var bMixed = _.normalizeMixedDataValue( b.name.toLowerCase() );
return( aMixed < bMixed ? sortIndicator : -sortIndicator );
}
);
return( collection );
};
_.sortOnPropertyUsingLowerCase = function( collection, name, direction ) {
direction = ( direction || "asc" );
var sortIndicator = ( direction === "asc" ? -1 : 1 );
collection.sort(
function( a, b ) {
var nameA = ( a[ name ] || "" ).toLowerCase();
var nameB = ( b[ name ] || "" ).toLowerCase();
if ( nameA < nameB ) {
return( sortIndicator );
} else if ( nameB < nameA ) {
return( -sortIndicator );
}
return( 0 );
}
);
return( collection );
};
_.sumProperty = function( collection, name ) {
var sum = 0;
for ( var i = 0 ; i < collection.length ; i++ ) {
sum += collection[ i ][ name ];
}
return( sum );
};
_.trim = function( value ) {
return(
value.replace( /^\s+|\s+$/g, "" )
);
};
_.withoutProperty = function( collection, name, value ) {
var filteredCollection = this.filter(
collection,
function( item ) {
return( item[ name ] !== value );
}
);
return( filteredCollection );
};
_.withoutPropertyRange = function( collection, name, valueRange ) {
var filteredCollection = this.filter(
collection,
function( item ) {
return( _.indexOf( valueRange, item[ name ] ) === -1 );
}
);
return( filteredCollection );
};
_.withProperty = function( collection, name, value ) {
var filteredCollection = this.filter(
collection,
function( item ) {
return( item[ name ] === value );
}
);
return( filteredCollection );
};
_.withPropertyRange = function( collection, name, valueRange ) {
var filteredCollection = this.filter(
collection,
function( item ) {
return( _.indexOf( valueRange, item[ name ] ) !== -1 );
}
);
return( filteredCollection );
};
return( _ );
}
})( angular, InVision, _ );
;
;
/*! mention-shortcut-service.js */ 
;
;
(function( ng, app ) {
"use strict";
if (typeof module !== "undefined" && module.exports) {
module.exports = MentionShortcutService(null);
} else if (app) {
app.service( "mentionShortcutService", MentionShortcutService );
}
function MentionShortcutService(_) {
var lodash = _;
if (typeof module !== "undefined" && module.exports) {
lodash = require("lodash");
}
var mentionShortcuts = [
{
name: "project",
role: "shortcut"
},
{
name: "conversation",
role: "shortcut"
}
];
function getUserInfo( user, users ) {
if (user.name === "conversation") {
var conversationMembers = [];
lodash.map(users.candidates.conversationMembers, function(member) {
conversationMembers.push(member.name);
});
return conversationMembers.length ? createUserTeaser(conversationMembers) : "It's lonely in here!";
} else if (user.name === "project") {
var projectMembers = [];
var members = lodash.filter(users.candidates.candidates, function(candidate) {
return candidate.role === "member";
});
lodash.map(members, function(member) {
projectMembers.push(member.name);
});
return projectMembers.length ? createUserTeaser(projectMembers) : "It's lonely in here!";
} else {
return user.email;
}
}
function getShortcuts(ids) {
if (ids) {
var lastID = Math.max.apply( Math, ids );
mentionShortcuts.map(function(shortcut, i) {
shortcut.id = lastID + i + 1;
});
}
return mentionShortcuts;
}
function createUserTeaser(users) {
if (users.length < 3) {
return users.length === 2 ? users.join(", ") : users.join("");
} else {
var names = users.slice(0, 2).join(", ");
return names + " & " + ( users.length - 2 ) + " more";
}
}
return {
getUserInfo: getUserInfo,
getShortcuts: getShortcuts
};
}
})( angular, InVision );
;
;
/*! modal-window-request.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "modalWindowRequest", ModalWindowRequest );
/** @ngInject */
function ModalWindowRequest() {
function getData( index, defaultValue ) {
if ( arguments.length === 0 ) {
return( modalData );
} else if ( 
( index > modalData.length ) &&
( arguments.length == 2 )
) {
return( defaultValue );
} else {
return( modalData[ index ] );
}
}
function getType() {
return( modalType );
}
function isSuppressFade() {
return( suppressFade === true );
}
function setRequest( newModalType, newModalData, newSuppressFade ) {
modalType = newModalType;
modalData = newModalData;
suppressFade = ( newSuppressFade || false );
}
function setSuppressFade( newSuppressFade ) {
suppressFade = ( newSuppressFade || false );
}
function isSuppressClose() {
return( suppressClose === true );
}
function setSuppressClose( newSuppressClose ) {
suppressClose = ( newSuppressClose || false );
}
var modalType = "";
var modalData = [];
var suppressFade = false;
var suppressClose = false;
return({
getData: getData,
getType: getType,
isSuppressFade: isSuppressFade,
setRequest: setRequest,
setSuppressFade: setSuppressFade,
isSuppressClose: isSuppressClose,
setSuppressClose: setSuppressClose
});
}
})( angular, InVision );
;
;
/*! model-events.js */ 
;
;
(function( ng, app ) {
"use strict";
app.factory( "modelEvents", ModelEventsFactory );
/** @ngInject */
function ModelEventsFactory( PubSub ) {
return( new PubSub() );
}
})( angular, InVision );
;
;
/*! moment.js */ 
;
;
(function( ng, app, moment ) {
"use strict";
app.factory( "moment", Factory );
/** @ngInject */	
function Factory() {
return moment;
}
})( angular, InVision, moment );
;
;
/*! notifications-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "notificationsService", Service );
/** @ngInject */
function Service( $resource, serviceHelper, modelEvents ) {
function getSettings() {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "getSettings"
});
return( promise );
}
function removeCommentEmailFromQueue( commentID ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "removeCommentEmailFromQueue",
parameters: {
command: "removeCommentEmailFromQueue",
commentID: commentID
},
successCallback: function( response ) {
}
});
return( promise );
}
function updateEmailNotificationFrequency( frequency ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "updateEmailNotificationFrequency",
parameters: {
command: "updateEmailNotificationFrequency",
frequency: frequency
},
successCallback: function( response ) {
}
});
return( promise );
}
function updateSendDigestAt( wantsDigestAtFrequencyInHours, digestSendTime ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "updateSendDigestAt",
parameters: {
command: "digestSendTime",
wantsDigestAtFrequencyInHours: wantsDigestAtFrequencyInHours,
sendNextDigestAt: digestSendTime
},
successCallback: function( response ) {
}
});
return( promise );
}
function updateSettings( settings ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "updateSettings",
parameters: settings,
successCallback: function( response ) {
modelEvents.trigger( "notificationSettingsUpdated", settings );
}
});
return( promise );
}
var resource = $resource(
"/api/notifications/:command",
{
command: "@command"
},
{
getSettings: {
method: "GET"
},
removeCommentEmailFromQueue: {
method: "DELETE",
command: "removeCommentEmailFromQueue"
},
updateEmailNotificationFrequency: {
method: "POST",
command: "emailNotificationFrequency"
},
updateSendDigestAt: {
method: "POST",
command: "digestSendTime"
},
updateSettings: {
method: "POST"
}
}
);
return({
getSettings: getSettings,
removeCommentEmailFromQueue: removeCommentEmailFromQueue,
updateEmailNotificationFrequency: updateEmailNotificationFrequency,
updateSendDigestAt: updateSendDigestAt,
updateSettings: updateSettings
});
}
})( angular, InVision );
;
;
/*! pagination.js */ 
;
;
angular.module('InVision')
.factory('paginationHelper',
function( _ ) {
var MINIMUM_PAGES_TO_COMPRESS = 11 // 2 left, 2 right, 3 middle, 4 (2/2 compressed )
, ITEMS_PER_EDGE = 2
, ITEMS_PER_MID = 3 // should be an odd number
, ITEMS_BEFORE_COMPRESSING = 4
, ITEMS_PER_UNCOMPRESSED_EDGE = 6;
function _compress( instance ) {
var index = instance.index
, pages = instance.pages;
if ( pages.length < MINIMUM_PAGES_TO_COMPRESS ) return pages;
var ranges = {
start : {
at       : 0,
boundary : ITEMS_BEFORE_COMPRESSING,
total    : ITEMS_PER_EDGE
},
mid : { at: index - Math.floor(( ITEMS_PER_MID - 1  ) / 2 ), total: ITEMS_PER_MID },
end : { 
at       : pages.length - ITEMS_PER_EDGE,
boundary : pages.length - ITEMS_BEFORE_COMPRESSING,
total    : ITEMS_PER_EDGE
}
};
if ( ranges.mid.at < ranges.start.boundary ) {
delete ranges.start;
ranges.mid = { at: 0, total: ITEMS_PER_UNCOMPRESSED_EDGE };
}
if ( ranges.mid.at + ranges.mid.total > ranges.end.boundary ) {
ranges.mid = { at: pages.length - ITEMS_PER_UNCOMPRESSED_EDGE, total: ITEMS_PER_UNCOMPRESSED_EDGE };
delete ranges.end;
}
var compressed = [ ];
if ( ranges.start ) {
compressed = compressed.concat( pages.slice( ranges.start.at, ranges.start.at + ranges.start.total ));
compressed.push({ separator: true });
}
if ( ranges.mid )
compressed = compressed.concat( pages.slice( ranges.mid.at, ranges.mid.at + ranges.mid.total ));
if ( ranges.end ) {
compressed.push({ separator: true });
compressed = compressed.concat( pages.slice( ranges.end.at, ranges.end.at + ranges.end.total ));
}
instance.pages = compressed;
}
function Pagination( config ) {
_.assign( this, config );
this.pages = [ ];
this.index = config.index || 0;
if ( config.pages )
_.times( config.pages + 1, function( i ) {
this.pages.push({
index   : i,
number  : i+1,
current : i === this.index
});
}, this );
this.totalPages = this.pages.length;
if ( config.compress )
_compress( this );
this.atStart = this.index === 0;
this.atEnd = this.index === this.totalPages - 1;
}
_.assign( Pagination, {
});
_.assign( Pagination.prototype, {
next: function() {
this.go( this.index + 1 );
},
previous: function() {
this.go( this.index - 1 );
},
go: function( index ) {
var current = this.index;
this.index = Math.max( 0, Math.min( index, this.totalPages ));
if ( this.index !== current && _.isFunction( this.onPageChanged ))
this.onPageChanged( this.index );
}
});
return Pagination;
});
;
;
/*! preloader.js */ 
;
;
angular.module('InVision')
.factory('preloader',
function($q, $rootScope) {
function Preloader(imageLocations) {
this.imageLocations = imageLocations;
this.imageCount = this.imageLocations.length;
this.loadCount = 0;
this.states = {
PENDING: 1,
LOADING: 2,
RESOLVED: 3,
REJECTED: 4
};
this.state = this.states.PENDING;
this.deferred = $q.defer();
this.promise = this.deferred.promise;
}
Preloader.preloadImages = function( imageLocations ) {
var preloader = new Preloader( imageLocations );
return preloader.load();
};
Preloader.prototype = {
constructor: Preloader,
isInitiated: function() {
return( this.state !== this.states.PENDING );
},
isRejected: function() {
return( this.state === this.states.REJECTED );
},
isResolved: function() {
return( this.state === this.states.RESOLVED );
},
load: function() {
if ( this.isInitiated() ) {
return( this.promise );
}
this.state = this.states.LOADING;
for ( var i = 0 ; i < this.imageCount ; i++ ) {
this.loadImageLocation( this.imageLocations[ i ] );
}
return( this.promise );
},
handleImageLoad: function handleImageLoad( imageLocation ) {
this.loadCount++;
if ( this.isRejected() ) {
return;
}
this.deferred.notify({
percent: Math.ceil( this.loadCount / this.imageCount * 100 ),
imageLocation: imageLocation
});
if ( this.loadCount === this.imageCount ) {
this.state = this.states.RESOLVED;
this.deferred.resolve( this.imageLocations );
}
},
loadImageLocation: function(imageLocation) {
var preloader = this,
image = new Image();
image.onload = function( event ) {
$rootScope.$apply(function() {
preloader.handleImageLoad(event.target.src);
preloader = null;
image = null;
event = null;
});
};
image.onerror = function( event ) {
preloader.deferred.reject();
};
image.src = imageLocation;
}
};
return Preloader;
});
;
;
/*! pusher.js */ 
;
;
(function( ng, app ) {
"use strict";
app.value( "Pusher", Pusher );
})( angular, InVision );
;
;
/*! render-context.js */ 
;
;
(function( ng, app ) {
"use strict";
app.value( "RenderContext", RenderContext );
/** @ngInject */
function RenderContext( requestContext, actionPrefix, paramNames ) {
this._requestContext = requestContext;
this._actionPrefix = actionPrefix;
this._paramNames = paramNames;
return( this );
}
RenderContext.prototype = {
getNextSection: function() {
return(
this._requestContext.getNextSection( this._actionPrefix )
);
},
isChangeLocal: function() {
return(
this._requestContext.startsWith( this._actionPrefix )
);
},
isChangeRelevant: function() {
if ( ! this._requestContext.startsWith( this._actionPrefix ) ) {
return( false );
}
if ( this._requestContext.hasActionChanged() ) {
return( true ) ;
}
return(
this._paramNames.length && 
this._requestContext.haveParamsChanged( this._paramNames )
);
}
};
})( angular, InVision );
;
;
/*! request-context.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "requestContext", RequestContext );
/** @ngInject */
function RequestContext( RenderContext ) {
this.RenderContext = RenderContext;
this._action = "";
this._sections = [];
this._params = {};
this._previousAction = "";
this._previousParams = {};
return( this );
}
RequestContext.prototype = {
getAction: function() {
return( this._action );
},
getNextSection: function( prefix ) {
if ( ! this.startsWith( prefix ) ) {
return( null );
}
if ( prefix === "" ) {
return( this._sections[ 0 ] );
}
var depth = prefix.split( "." ).length;
if ( depth === this._sections.length ) {
return( null );
}
return( this._sections[ depth ] );
},
getParam: function( name ) {
return( this._params[ name ] || null );
},
getParams: function() {
return( this._params || null );
},
getParamAsInt: function( name, defaultValue ) {
var valueAsInt = parseInt( this.getParam( name ) );
if ( isNaN( valueAsInt ) ) {
return( defaultValue || 0 );
} else {
return( valueAsInt );
}
},
getRenderContext: function( requestActionLocation, paramNames ) {
requestActionLocation = (requestActionLocation || "");
paramNames = (paramNames || []);
if ( ! ng.isArray( paramNames ) ) {
paramNames = [ paramNames ];
}
return(
new this.RenderContext( this, requestActionLocation, paramNames )
);
},
hasActionChanged: function() {
return( this._action !== this._previousAction );
},
hasParamChanged: function( paramName, paramValue ) {
if ( ! ng.isUndefined( paramValue ) ) {
return( ! this.isParam( paramName, paramValue ) );
}
if (
!(paramName in this._previousParams) &&
(paramName in this._params)
) {
return( true );
} else if (
(paramName in this._previousParams) &&
!(paramName in this._params)
) {
return( true );
}
return( this._previousParams[ paramName ] !== this._params[ paramName ] );
},
haveParamsChanged: function( paramNames ) {
for ( var i = 0, length = paramNames.length ; i < length ; i++ ) {
if ( this.hasParamChanged( paramNames[ i ] ) ) {
return( true );
}
}
return( false );
},
isParam: function( paramName, paramValue ) {
if (
(paramName in this._params) &&
(this._params[ paramName ] == paramValue)
) {
return( true );
}
return( false );
},
setContext: function( action, routeParams ) {
this._previousAction = this._action;
this._previousParams = this._params;
this._action = action;
this._sections = action.split( "." );
this._params = ng.copy( routeParams );
},
startsWith: function( prefix ) {
if (
!prefix.length || 
(this._action === prefix) ||
(this._action.indexOf( prefix + "." ) === 0)
) {
return( true );
}
return( false );
}
};
})( angular, InVision );
;
;
/*! screen-alignment-helper.js */ 
;
;
angular.module('InVision')
.factory('ScreenAlignmentHelper',
function( _, $, $window, screenService ) {
function ScreenAlignment() {
}
_.assign( ScreenAlignment.prototype, {
calculate : function( screen, container ) {
if ( !container ) container = $window;
if (!( container instanceof $ )) container = $( container );
var alignment = {
containerWidth : Math.min( container.width(), $window.innerWidth ),
screenWidth : screen.width * screen.displayScale,
usingScroll : parseInt( screen.zoomScrollBehavior, 10 ) === screenService.zoomScrollBehaviors.NORMAL,
center : screen.alignment === 'center',
left : screen.alignment === 'left',
right : screen.alignment === 'right'
};
if ( alignment.usingScroll ) {
if ( alignment.right ) {
alignment.offset = alignment.screenWidth - alignment.containerWidth;
} else if ( alignment.left ) {
alignment.offset = 0;
} else {
alignment.offset = Math.max( 0, ( alignment.screenWidth - alignment.containerWidth ) / 2 );
}
} else {
if ( alignment.right ) {
alignment.offset = Math.min( alignment.containerWidth - alignment.screenWidth, 0 );
} else if ( alignment.left ) {
alignment.offset = 0;
} else { // center
alignment.offset = Math.min( ( alignment.containerWidth - alignment.screenWidth ) / 2, 0 );
}
}
return alignment;
}
});
return ScreenAlignment;
});
;
;
/*! service-helper.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "serviceHelper", ServiceHelper );
/** @ngInject */
function ServiceHelper( Deferred ) {
function executeRequest( options ) {
var resource = options.resource;
var name = options.name;
var parameters = ( options.parameters || {} );
var successCallback = ( options.successCallback || ng.noop );
var errorCallback = ( options.errorCallback || ng.noop );
var deferred = new Deferred();
if( window.location.protocol === "file:" ) {
deferred.resolve();
return deferred.promise;
}
var resourceResponse = resource[ name ]( 
parameters,
function( response ) {
successCallback( response );
deferred.resolve( response );
},
function( response ) {
errorCallback( response );
deferred.reject(
unwrapErrorMessage( response )
);
}
);
return( deferred.promise );
}
function unwrapErrorMessage( errorResponse ) {
try {
var response = ng.fromJson( errorResponse.data );
if ( ng.isString( response ) ) {
response = {
message: response,
code: -1
};
}
} catch ( error ) {
var response = {
message: errorResponse.data,
code: -1
};
}
return( response );
}
return({
executeRequest: executeRequest
});
}
})( angular, InVision );
;
;
/*! session-inactivity-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "sessionInactivityService", SessionInactivityService );
/** @ngInject */
function SessionInactivityService( $document,_ , modelEvents ) {
var 
keepAliveCb = ng.noop, 
timeoutCb = ng.noop, 
sessionIdentifier, 
throttledKeepAlive;
function killSession() {
teardown();
timeoutCb();
}
function setSessionActive() {
throttledKeepAlive();
}
function init( sessionId, keepAliveCallback, timeoutCallback ) {
keepAliveCb = keepAliveCallback;
timeoutCb = timeoutCallback;
throttledKeepAlive = _.throttle( keepAliveCb, 30000 ); // run the keepalive a max of once every 30 seconds. lastRequestAt isn't updated on the backend if it's not greater than 60 seconds
sessionIdentifier = sessionId; // the session we're currently using. 
teardown(); // make sure there aren't any leftovers
$document
.on("mousemove.sessionInactivity keypress.sessionInactivity", function (e) {
setSessionActive();
});
$(window)
.on("focus.sessionInactivity", function(e) { 
setSessionActive(); // don't throttle the call if we're focusing the tab
})
.on("blur.sessionInactivity", throttledKeepAlive.cancel ); // kill any trailing keepalives if we leave the tab
modelEvents.on(
"sessionInactive.sessionInactivity",
function(event, identifier) {
if ( identifier === sessionIdentifier ) {
killSession();
}
}
);
}
function teardown() {
$document
.off(".sessionInactivity");
$(window)
.off(".sessionInactivity");
modelEvents
.off("sessionInactive.sessionInactivity");
}
return({
init: init,
disable: teardown // in case you want to programmatically disable this after initialization for some reason
});
}
})( angular, InVision );
;
;
/*! sort-screens.js */ 
;
;
(function(app) {
app.factory('sortScreens', sortScreensFactory);
/** @ngInject */
function sortScreensFactory(_) {
return function sortScreens(screens, dividers, sortTypeID) {
var sortKey = sortTypeID === 2 ? "name" : "sort";
var sortedDividers = _.sortBy(dividers, "sort");
var groupedScreens = _.chain(screens)
.groupBy("screenGroupId")
.mapValues(function (screens) {
return _.sortBy(screens, sortKey);
})
.value();
return sortedDividers.reduce(function (sortedScreens, divider) {
if (groupedScreens[divider.dividerID]) {
sortedScreens = sortedScreens.concat(groupedScreens[divider.dividerID]);
}
return sortedScreens;
}, []);
}
}
})(InVision);
;
;
/*! stack-trace-service.js */ 
;
;
(function( ng, app, printStackTrace ) {
"use strict";
app.factory( "stackTraceService", Factory );
function Factory() {
return({
print: printStackTrace
});
}
})( angular, InVision, printStackTrace );
;
;
/*! tail-connector.js */ 
;
;
(function( ng, app ) {
"use strict";
var START_POINT_CONNECTING_CLASS = 'connecting'
, DEFAULT_CONFIG = {
};
app.service( "tailConnector", function( $, _, $rootScope, tailConnectorDisplay, utilityService ) {
var nextFrame = utilityService.getRequestAnimationFrame();
function invoke( action, point ) {
if (!( point && point.handler && point.handler[ action ])) return;
var args = [].slice.call( arguments, 2 );
point.handler[ action ].apply( point.handler, args );
}
function hitTest( at, x, y ) { return at.left <= x && x <= at.right && at.top <= y && y <= at.bottom; }
function inView( element, bounds ) {
var container = element.parentNode;
bounds = bounds || element.getBoundingClientRect();
do {
var area = container.getBoundingClientRect()
, boundless = area.top === area.bottom || area.left === area.right;
if ( !boundless && ( bounds.right < area.left || bounds.left > area.right || bounds.top > area.bottom || bounds.bottom < area.top ))
return false;
container = container.parentNode;
} while( container && container !== document.body );
return true;
}
function autoRefresh( instance ) {
function refresh() {
if ( !instance.active ) return;
instance.display.update();
nextFrame( refresh );
}
refresh();
}
function trackMovements( instance, event ) {
_.assign( instance.mouse, { 
x: event.clientX,
y: event.clientY
});
if ( !instance.active ) return;
event = { };
_.each( instance.targets, function( target ) {
if ( event.cancel ) return;
if ( !target.element.is(':visible')) return;
var element = target.element[ 0 ]
, bounds = element.getBoundingClientRect()
, over = hitTest( bounds, instance.mouse.x, instance.mouse.y );
if ( over && !inView( element, bounds )) return;
if ( over && !target.isMouseOver ) {
if ( target.focusable )
instance.display.focusAt( target.element );
invoke( 'handleMouseEnter', target, event, instance.source );
}
else if ( !over && target.isMouseOver ) {
if ( instance.display.isFocus( target.element ))
instance.display.clearFocus();
invoke( 'handleMouseLeave', target, event, instance.source );
}
target.isMouseOver = over;
});
instance.display.update();
}
function trackPresses( instance ) { }
function trackReleases( instance ) {
if ( !instance.active ) return;
var event = { };
var hits = _.filter( instance.targets, function( target ) {
if ( event.cancel || !target.isMouseOver )
return null;
invoke( 'handleConnect', target, event, instance.source );
return target;
});
if ( hits.length === 0 ) invoke( 'handleCancel', instance.source, event );
else invoke( 'handleConnect', instance.source, event, hits );
}
function registerPoint( instance, config, accepts, kind, item ) {
if (!( item.types || item.type )) return;
var ignore;
_.each( config.except, function( type ) {
if ( ignore ) return;
if ( 'type' in item ) ignore = item.type === type;
else if ( 'types' in item ) ignore = _.contains( item.types, type );
});
if ( ignore ) return;
var accept;
_.each( accepts, function( type ) {
if ( accept ) return;
if ( 'type' in item ) accept = item.type === type;
else if ( 'types' in item ) accept = _.contains( item.types, type );
});
if ( !accept ) return;
if (!( item.element instanceof $ ))
item.element = $( item.element );
item.element.setConnection = item.handler.handleSetConnection;
if ( kind === 'source' ) instance.source = item;
else instance.targets.push( item );
}
function Service() {
this.targets = [ ];
this.mouse = { x: 0, y: 0 };
this.display = new tailConnectorDisplay( document.body );
this._pending = [ ];
$( window ).mousemove( _.bind( trackMovements, null, this ))
.mousedown( _.bind( trackPresses, null, this ))
.mouseup( _.bind( trackReleases, null, this ));
}
_.assign( Service, {
});
_.assign( Service.prototype, {
activate : function( source, targets, config ) {
config = _.defaults( DEFAULT_CONFIG, config );
if ( _.isString( targets ))
targets = _.filter( _.map( $.trim( targets ).split(','), $.trim ));
delete this.source;
this.targets = this._pending;
this._pending = [ ];
if ( !_.isArray( this.targets )) this.targets = [ ];
$rootScope.$broadcast('tailConnector:activate:source', _.bind( registerPoint, null, this, config, [ source ], 'source' ));
$rootScope.$broadcast('tailConnector:activate:target', _.bind( registerPoint, null, this, config, targets, 'target' ));
this.active = this.source && this.targets.length > 0;
if ( !this.active ) return false;
this.source.element.addClass( START_POINT_CONNECTING_CLASS );
this.display.startAt( this.source.element );
this.display.endAt( this.mouse );
this.display.show();
if ( config.autoRefresh !== false )
autoRefresh( this );
},
register: function( instance ) {
var target = this.active ? this.targets : this._pending;
target.push( instance );
},
deactivate : function() {
this.active = false;
this.source.element.removeClass( START_POINT_CONNECTING_CLASS );
var event = { };
invoke( 'handleDeactivate', this.source, event );
_.each([ this.source ].concat( this.targets ), function( point ) {
invoke( 'handleDeactivate', point, event );
});
this.display.clear();
},
flash : function() { 
if ( !this.active ) return;
var event = { };
_.each([ this.source ].concat( this.targets ), function( point ) {
invoke( 'handleFlash', point, event );
});
}
});
return new Service();
});
})( angular, InVision );
;
;
/*! tail-connector-display.js */ 
;
;
(function( ng, app ) {
"use strict";
function invoke( action, point ) {
if (!( point && point[ action ])) return;
var args = [].slice.call( arguments, 2 );
point[ action ].apply( point, args );
}
app.factory( "tailConnectorDisplay", function( $, _ ) {
var DEFAULTS = {
view : document.body,
curve       : 0.6,
padding     : 10, // 4,
lineWidth   : 1.5,
colorSource : 'borderColor',
shadowColor : 'rgba( 0,0,0, 0.15 )',
color: {
start : '#4682a9',
end   : '#4682a9',
focus : '#4682a9'
}}
, END_POINT_BORDER_ADJUSTMENT = 3
, HIDDEN_MOUSE_CURSOR_CSS = 'hide-mouse-pointer';
function showMousePointer( instance ) {
instance.view.removeClass( HIDDEN_MOUSE_CURSOR_CSS );
instance.pointer.hide();
}
function hideMousePointer( instance ) {
instance.view.addClass( HIDDEN_MOUSE_CURSOR_CSS );
instance.pointer.show();
}
function getOpposite( side ) {
return ({ left: 'right', right: 'left', top: 'bottom', bottom: 'top' })[ side ];
}
function getBounds( instance, point ) {
var bounds = { };
if ( point instanceof $ )
bounds = point[ 0 ].getBoundingClientRect();
else {
bounds.x = bounds.left = bounds.right = 0|point.x;
bounds.y = bounds.top = bounds.bottom = 0|point.y;
bounds.width = 0;
bounds.height = 0;
}
bounds.centerX = bounds.left + ( bounds.width * 0.5 || 0 );
bounds.centerY = bounds.top + ( bounds.height * 0.5 || 0 );
return bounds;
}
function overlaps( a, b ) {
return hitTest( a.left, a.top, b ) || hitTest( a.right, a.bottom, b ) || hitTest( a.left, a.bottom, b ) || hitTest( a.right, a.top, b );
}
function hitTest( x, y, b ) {
return x >= b.left && x <= b.right && y >= b.top && y <= b.bottom;
}
function isPoint( a, b ) {
if ( !a || !b ) return false;
if ( a instanceof $ ) a = a[ 0 ];
if ( b instanceof $ ) b = b[ 0 ];
return a === b;
}
function setPoint( instance, which, point ) {
clearPoint( instance, which );
instance[ which ] = point;
}
function clearPoint( instance, which ) {
if ( !instance[ which ] ) return;
invoke( 'setConnection', instance[ which ], { connected: false });
delete instance[ which ];
}
function updateDrawingArea( instance ) {
_.assign( instance.canvas, { width: instance.container.width(), height: instance.container.height() });
}
function getStartingSide( instance, start, end ) {
var distance = {
left   : end.right - start.left,
right  : start.right - end.left,
top    : end.bottom - start.top,
bottom : start.bottom - end.top
};
var side;
_.each( distance, function( value, dir ) {
if ( !side || value > distance[ side ])
side = dir;
});
return side;
}
function getDrawingPath( instance, start, end, side, isCursor ) {
var points;
if ( side === 'top' )
points = {
start: { x: start.centerX, y: start.bottom },
end: { x: end.centerX, y: end.top }
};
else if ( side === 'bottom' )
points = {
start: { x: start.centerX, y: start.top },
end: { x: end.centerX, y: end.bottom }
};
else if ( side === 'left' )
points = {
start: { x: start.right, y: start.centerY },
end: { x: end.left, y: end.centerY }
};
else if ( side === 'right' )
points = {
start: { x: start.left, y: start.centerY },
end: { x: end.right, y: end.centerY },
};
if ( isCursor ) {
if ( side === 'top' ) points.end.y -= END_POINT_BORDER_ADJUSTMENT;
else if ( side === 'bottom' ) points.end.y += END_POINT_BORDER_ADJUSTMENT;
else if ( side === 'left' ) points.end.x -= END_POINT_BORDER_ADJUSTMENT;
else if ( side === 'right' ) points.end.x += END_POINT_BORDER_ADJUSTMENT;
}
return points;
}
function generateCurve( instance, path, side ) {
var curve = DEFAULTS.curve
, points = { };
_.assign( points, {
p1 : { x: path.start.x, y: path.start.y },
p2 : { x: path.end.x, y: path.end.y }
});
var adjust;
if ( side === 'right' ) {
adjust = ( points.p1.x - points.p2.x ) * curve;
points.p1.x -= adjust;
points.p2.x += adjust;
}
else if ( side === 'left' ) {
adjust = ( points.p2.x - points.p1.x ) * curve;
points.p1.x += adjust;
points.p2.x -= adjust;
}
else if ( side === 'bottom' ) {
adjust = ( points.p2.y - points.p1.y ) * curve;
points.p1.y += adjust;
points.p2.y -= adjust;
}
else if ( side === 'top' ) {
adjust = ( points.p1.y - points.p2.y ) * curve;
points.p1.y -= adjust;
points.p2.y += adjust;
}
return points;
}
function getConnectorColor( instance, point ) {
if (!( point instanceof $ )) return;
var source = point.is('[connector-line-color]') ? point : point.find('[connector-line-color]');
var color;
if ( source.length > 0 ) {
var prop = source.attr('connector-line-color') || DEFAULTS.colorSource;
color = source.css( prop );
}
return color;
}
function applyTheme( instance, path, start, end, useFocus ) {
var fill = instance.context.createLinearGradient( path.start.x, path.start.y, path.end.x, path.end.y );
var color1 = getConnectorColor( instance, start );
var color2 = getConnectorColor( instance, end );
fill.addColorStop( 0, color1 || instance.color.start );
fill.addColorStop( 1, color2 || instance.color[ useFocus ? 'focus' : 'end' ]);
instance.context.lineWidth = DEFAULTS.lineWidth;
instance.context.strokeStyle = fill;
}
function updateElementConnection( point, side ) {
invoke( 'setConnection', point, { connected: !!side, side: side });
}
function updateView( instance ) {
if (!( instance.start && ( instance.focus || instance.end )))
return instance.hide();
instance.show();
var startPoint = instance.start
, useCursor = !instance.focus
, useFocus = !useCursor
, endPoint = useFocus ? instance.focus : instance.end
, start = getBounds( instance, startPoint )
, end = getBounds( instance, endPoint )
, overlapsStart = useCursor && hitTest( end.x, end.y, start );
if ( useCursor && overlapsStart ) {
showMousePointer( instance );
return instance.pointer.hide();
}
var side = getStartingSide( instance, start, end )
, opposite = getOpposite( side )
, path = getDrawingPath( instance, start, end, side, useCursor )
, curve = generateCurve( instance, path, side );
updateDrawingArea( instance, path );
if ( DEFAULTS.debug ) {
instance.context.fillStyle = 'rgba(255,255,255,0.1)';
instance.context.fillRect( 0,0, instance.canvas.width, instance.canvas.height );
}
if ( useFocus ) {
showMousePointer( instance );
instance.pointer.hide();
}
else {
hideMousePointer( instance );
var nudge = instance.pointer.width() / 2;
instance.pointer.css({
left : end.left - nudge,
top  : end.top - nudge
}).show();
if ( opposite === 'top' ) end.top -= nudge;
else if ( opposite === 'bottom' ) end.top += nudge;
else if ( opposite === 'left' ) end.left += nudge;
else if ( opposite === 'right' ) end.left += nudge;
}
updateElementConnection( startPoint, opposite );
updateElementConnection( endPoint, side );
applyTheme( instance, path, startPoint, endPoint, useFocus );
instance.context.beginPath();
instance.context.moveTo( path.start.x, path.start.y );
instance.context.bezierCurveTo( curve.p1.x, curve.p1.y, curve.p2.x, curve.p2.y, path.end.x, path.end.y );
instance.context.stroke();
}
function Connector( options ) {
this.options = _.extend({ }, DEFAULTS, options );
this.color = _.assign({ }, this.options.color );
var view = this.options.view
, container = document.createElement('div')
, pointer = document.createElement('div')
, canvas = document.createElement('canvas')
, context = canvas.getContext('2d');
_.assign( this, {
view      : $( view ),
container : $( container ),
pointer   : $( pointer ),
canvas    : canvas,
context   : context
});
this.container
.css({ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, zIndex: 9999 })
.hide()
.append( canvas )
.appendTo( this.view );
this.pointer.addClass('tail-connector-pointer')
.prependTo( this.container );
}
_.assign( Connector.prototype, {
clear : function() {
this.clearStart();
this.clearEnd();
this.clearFocus();
this.hide();
},
clearStart : function() { return clearPoint( this, 'start' ); },
clearEnd : function() { return clearPoint( this, 'end' ); },
clearFocus : function() { return clearPoint( this, 'focus' ); },
startAt : function( at ) { return setPoint( this, 'start', at ); },
endAt : function( at ) { return setPoint( this, 'end', at ); },
focusAt : function( at ) { return setPoint( this, 'focus', at ); },
isStart : function( compare ) { return isPoint( this.start, compare ); },
isEnd : function( compare ) { return isPoint( this.end, compare ); },
isFocus : function( compare ) { return isPoint( this.focus, compare ); },
show : function() { 
this.container.addClass('active').show();
},
hide : function() {
showMousePointer( this );
_.assign( this.canvas, { width: 0, height: 0 });
this.container.removeClass('active').hide();
},
update : function() {
updateView( this );
}
});
return Connector;
});
})( angular, InVision );
;
;
/*! transitions.service.js */ 
;
;
(function(ng, app) {
var _DEBUG_ = _DEBUG_ || false;
app
.service('transitionsService', Service);
/** @ngInject */
function Service($log, _) {
var userAgent = navigator.userAgent.toLowerCase();
var isiOS = (/(ip(hone|od|ad))/g).test(userAgent);
var isAndroid = (/android/g).test(userAgent);
var _targ,
_curr,
_wrap,
_fixed,
_fixedCurr,
_fixedTarg,
_timeline;
var _ready = false;
var _clearProps = [
'transform',
'transformStyle',
'opacity',
'boxShadow',
'backfaceVisibility',
'zIndex',
'perspective',
'transformOrigin'
].join(',');
var _cb = _.noop;
var _tweenDefaults = {
autoRound: true,
delay: 0.05,
roundProps: 'x,y',
ease: Power3.easeOut
};
var _durations = {
dissolve:   0.45,
pop:        0.8,
flow:       1.0,
pushLeft:   0.5,
pushRight:  0.5,
flipLeft:   1.0,
flipRight:  1.0,
slideDown:  0.8,
slideUp:    0.8,
slideLeft:  0.5,
slideRight: 0.5,
slideFade:  1.0
};
var service = {
'dissolve':    dissolve,
'push-right':  pushRight,
'push-left':   pushLeft,
'flip-right':  flipRight,
'flip-left':   flipLeft,
'flow':        flow,
'pop':         pop,
'slide-up':    slideUp,
'slide-down':  slideDown,
'slide-right': slideRight,
'slide-left':  slideLeft,
'slide-fade':  slideFade,
configure:     configure,
play:          play
};
init();
return service;
function init() {
if (_DEBUG_) $log.info('transitionsService.init');
TweenLite.lagSmoothing(150, 21);
_timeline = new TimelineLite({
onComplete: onComplete,
paused: true
});
return service;
}
function configure(current, target, wrapper, fixed) {
if (_DEBUG_) $log.info('transitionsService.configure');
_curr  = current;
_targ  = target;
_wrap  = wrapper;
if (fixed) {
_fixed = true;
if (fixed.curr) _fixedCurr = fixed.curr;
if (fixed.targ) _fixedTarg = fixed.targ;
}
_ready = true;
return service;
}
function dissolve() {
if (_DEBUG_) $log.info('transitionsService.dissolve');
if (!_ready) return handleError({code: 'NotReady'});
TweenLite.set(_curr, {zIndex: 3, opacity: 1});
_timeline.add([
TweenLite.to(_curr, _durations.dissolve, ng.extend({},
_tweenDefaults, {
opacity: 0,
delay: 0.1,
ease: Power1.easeInOut
})
)
]);
return service;
}
function pushRight() {
if (_DEBUG_) $log.info('transitionsService.pushRight');
if (!_ready) return handleError({code: 'NotReady'});
var targCss = {
x: '0%'
}
if (!isAndroid) targCss.boxShadow = '0 0 40px 0 rgba(0, 0, 0, .2)';
TweenLite.set(_curr, {
x: '0%',
z: 0
});
TweenLite.set(_targ, {
x: '-100%',
z: 0,
zIndex: 3
});
_timeline.add([
TweenLite.to(_curr, _durations.pushRight, ng.extend({},
_tweenDefaults, {
x: '25%'
})
),
TweenLite.to(_targ, _durations.pushRight, ng.extend({},
_tweenDefaults, targCss)
)
]);
if (_fixed) _fadeFixed('pushRight');
return service;
}
function pushLeft() {
if (_DEBUG_) $log.info('transitionsService.pushLeft');
if (!_ready) return handleError({code: 'NotReady'});
var targCss = {
x: '0%'
}
if (!isAndroid) targCss.boxShadow = '0 0 40px 0 rgba(0, 0, 0, .2)';
TweenLite.set(_curr, {
x: '0%',
z: 0
});
TweenLite.set(_targ, {
x: '100%',
z: 0,
zIndex: 3
});
_timeline.add([
TweenLite.to(_curr, _durations.pushLeft, ng.extend({},
_tweenDefaults, {
x: '-25%'
})
),
TweenLite.to(_targ, _durations.pushLeft, ng.extend({},
_tweenDefaults, targCss)
)
]);
if (_fixed) _fadeFixed('pushLeft');
return service;
}
function flipRight() {
if (_DEBUG_) $log.info('transitionsService.flipRight');
if (!_ready) return handleError({code: 'NotReady'});
TweenLite.set(_wrap, {
transformStyle: 'preserve-3d',
perspective: 1000
});
TweenLite.set(_curr, {
rotationY: 0,
zIndex: 3,
transformOrigin: '50% 50%',
backfaceVisibility: 'hidden'
});
TweenLite.set(_targ, {
rotationY: -180,
scale: .7,
transformOrigin: '50% 50%',
backfaceVisibility: 'hidden'
});
_timeline.add([
TweenLite.to(_curr, _durations.flipRight, ng.extend({},
_tweenDefaults, {
rotationY: 180,
scale: .7
})
),
TweenLite.to(_targ, _durations.flipRight, ng.extend({},
_tweenDefaults, {
rotationY: 0,
scale: 1
})
)
]);
return service;
}
function flipLeft() {
if (_DEBUG_) $log.info('transitionsService.flipLeft');
if (!_ready) return handleError({code: 'NotReady'});
TweenLite.set(_wrap, {
transformStyle: 'preserve-3d',
perspective: 1000
});
TweenLite.set(_curr, {
rotationY: 0,
zIndex: 3,
transformOrigin: '50% 50%',
backfaceVisibility: 'hidden'
});
TweenLite.set(_targ, {
rotationY: 180,
scale: .7,
transformOrigin: '50% 50%',
backfaceVisibility: 'hidden'
});
_timeline.add([
TweenLite.to(_curr, _durations.flipLeft, ng.extend({},
_tweenDefaults, {
rotationY: -180,
scale: .7
})
),
TweenLite.to(_targ, _durations.flipLeft, ng.extend({},
_tweenDefaults, {
rotationY: 0,
scale: 1
})
)
]);
return service;
}
function slideRight() {
if (_DEBUG_) $log.info('transitionsService.slideRight');
if (!_ready) return handleError({code: 'NotReady'});
TweenLite.set(_curr, {x: 0, z: 0});
TweenLite.set(_targ, {x: '-99.8%', z: 0});
_timeline.add([
TweenLite.to(_wrap, _durations.slideRight, ng.extend({},
_tweenDefaults, {
delay: 0.3,
x: '100%'
})
)
]);
if (_fixed) _fadeFixed('slideRight');
return service;
}
function slideLeft() {
if (_DEBUG_) $log.info('transitionsService.slideLeft');
if (!_ready) return handleError({code: 'NotReady'});
TweenLite.set(_curr, {x: 0, z: 0});
TweenLite.set(_targ, {x: '99.8%', z: 0});
_timeline.add([
TweenLite.to(_wrap, _durations.slideLeft, ng.extend({},
_tweenDefaults, {
delay: 0.3,
x: '-100%'
})
)
]);
if (_fixed) _fadeFixed('slideLeft');
return service;
}
function slideDown() {
if (_DEBUG_) $log.info('transitionsService.slideDown');
if (!_ready) return handleError({code: 'NotReady'});
TweenLite.set(_curr, {y: '0%', zIndex: 3});
_timeline.add([
TweenLite.to(_curr, _durations.slideDown, ng.extend({},
_tweenDefaults, {
y: '100%',
ease: Power4.easeOut
})
)
]);
return service;
}
function slideUp() {
if (_DEBUG_) $log.info('transitionsService.slideUp');
if (!_ready) return handleError({code: 'NotReady'});
TweenLite.set(_targ, {y: '100%', zIndex: 3});
_timeline.add([
TweenLite.to(_targ, _durations.slideUp, ng.extend({},
_tweenDefaults, {
y: '0%',
ease: Power4.easeOut
})
)
]);
return service;
}
function slideFade() {
if (_DEBUG_) $log.info('transitionsService.slideFade');
if (!_ready) return handleError({code: 'NotReady'});
TweenLite.set(_curr, {
x: 0,
transformOrigin: '50% 50%'
});
TweenLite.set(_targ, {
opacity: 0,
scale: 0.8,
transformOrigin: '50% 50%'
});
_timeline.add([
TweenLite.to(_curr, _durations.slideFade, ng.extend({},
_tweenDefaults, {
x: '-100%',
opacity: 0.5
})
),
TweenLite.to(_targ, _durations.slideFade, ng.extend({},
_tweenDefaults, {
opacity: 1,
scale: 1
})
)
]);
return service;
}
function pop() {
if (_DEBUG_) $log.info('transitionsService.pop');
if (!_ready) return handleError({code: 'NotReady'});
TweenLite.set(_curr, {
opacity: 1,
transformOrigin: '50% 50%',
zIndex: 3
});
TweenLite.set(_targ, {
opacity: 0,
transformOrigin: '50% 50%',
scale: 0.5
});
_timeline.add([
TweenLite.to(_curr, _durations.pop, ng.extend({},
_tweenDefaults, {
scale: .5,
opacity: 0
})
),
TweenLite.to(_targ, _durations.pop, ng.extend({},
_tweenDefaults, {
opacity: 1,
scale: 1
})
)
]);
return service;
}
function flow() {
if (_DEBUG_) $log.info('transitionsService.flow');
if (!_ready) return handleError({code: 'NotReady'});
TweenLite.set(_curr, {
opacity: 1,
x: '0%',
transformOrigin: '50% 50%',
scale: 1
});
TweenLite.set(_targ, {
opacity: .5,
x: '100%',
transformOrigin: '50% 50%',
scale: 0.5
});
_timeline.add(
TweenLite.to(_curr, _durations.flow / 4, ng.extend({},
_tweenDefaults, {
opacity: .5,
scale: 0.5
})
)
);
_timeline.add([
TweenLite.to(_curr, _durations.flow / 2, ng.extend({},
_tweenDefaults, {
x: '-100%',
delay: 0
})
),
TweenLite.to(_targ, _durations.flow / 2, ng.extend({},
_tweenDefaults, {
x: '0%',
delay: 0
})
)
]);
_timeline.add(
TweenLite.to(_targ, _durations.flow / 4, ng.extend({},
_tweenDefaults, {
opacity: 1,
scale: 1,
delay: 0
})
)
);
return service;
}
function play(cb) {
if (_DEBUG_) $log.info('transitionsService.play');
if (!cb) return handleError({code: 'NoCallback'});
_cb = cb;
return _timeline.play();
}
function _fadeFixed(transitionType) {
if (_DEBUG_) $log.info('transitionsService._fadeFixed', transitionType);
TweenLite.set(_fixedCurr, {
opacity: 1
});
if (_fixedCurr) {
_timeline.add(
TweenLite.to(_fixedCurr, (_durations[transitionType] - 0.3), {
opacity: 0
}), (_durations[transitionType] - 0.3)
);
}
return service;
}
function onComplete() {
if (_DEBUG_) $log.info('transitionsService.onComplete');
_timeline.clear();
TweenLite.set([_targ, _curr, _wrap], {clearProps: _clearProps});
_targ, _curr, _wrap, _fixed, _fixedCurr, _fixedTarg = null;
return _cb();
}
function handleError(err) {
if (_DEBUG_) $log.error('transitionsService.handleError', err);
var message;
switch (err.code.toLowerCase()) {
case 'nocallback':
message = 'You did not provide an animation onComplete callback';
break;
case 'notarget':
message = 'You have to provide a target node before you can ' +
'animate something.';
break;
case 'notready':
message = 'You are trying to use the transitions service before ' +
'it was even ready. Please refactor your code.';
break;
default:
message = 'Something bad happened.';
}
throw new Error(message);
}
}
})(angular, InVision);
;
;
/*! utility-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "utilityService", UtilityService );
/** @ngInject */
function UtilityService() {
/**
* Generates a GUID string, according to RFC4122 standards.
* @returns {String} The generated GUID.
* @example af8a8416-6e18-a307-bd9c-f2c947bbb3aa
* @author Slavik Meltser (slavik@meltser.info).
* @link http://slavik.meltser.info/?p=142
*/
function guid() {
function _p8(s) {
var p = (Math.random().toString(16)+"000000000").substr(2,8);
return s ? "-" + p.substr(0,4) + "-" + p.substr(4,4) : p ;
}
return _p8() + _p8(true) + _p8(true) + _p8();
}
function stripHTML( str ) {
var htmlRegex = /(<([^>]+)>)/ig;
return str.replace(htmlRegex, "");
}
function isHTML( str ) { // results and regex set to var scope for reduced mutability over many requests
var regex = /(<([^>]+)>)/ig;
var result = regex.test( str );
return result;
}
function getRequestAnimationFrame() {
return window.requestAnimationFrame
|| window.webkitRequestAnimationFrame
|| window.mozRequestAnimationFrame
|| function( callback ){ window.setTimeout( callback, 1000 / 60 ); 
};
}
return({
isHTML: isHTML,
stripHTML: stripHTML,
getRequestAnimationFrame: getRequestAnimationFrame,
guid: guid
});
}
})( angular, InVision );
;
;
/*! validation-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "validationService", ValidationService );
/** @ngInject */
function ValidationService() {
this.errorCodes = [
{
code: 400,
message: "Invalid request for this resource."
},
{
code: 400,
message: "Invalid request body content."
},
{
code: 401,
message: "The credentials you provided are not valid."
},
{
code: 403,
message: "Forbidden."
},
{
code: 404,
message: "The requested resource could not be found."
},
{
code: 405,
message: "The requested resource does not support the given method."
},
{
code: 406,
message: "The screen you were attempting to view was not found."
},
{
code: 407,
message: "The project you were attempting to view was not found."
},
{
code: 1100,
message: "Validation failure"
},
{
code: 1101,
message: "Validation failure: missing field"
},
{
code: 1102,
message: "Validation failure: invalid field"
},
{
code: 1103,
message: "Validation failure: already exists"
},
{
code: 3003,
message: "Sorry, you have attempted your request too many times."
},
{
code: 5001,
message: "Sorry, you aren't a collaborator on the project you tried to access. Please inform the project owner."
},
{
code: 5002,
message: "Sorry, you aren't a collaborator on the project you tried to access. Would you like to Join this project?"
},
{
code: 500,
message: "Unexpected error"
}
];
return( this );
}
ValidationService.prototype = {
isAlreadyExists: function( error ) {
return( error.code === 1103 );
},
isBadRequest: function( error ) {
return( error.code === 400 );
},
isForbidden: function( error ) {
return( error.code === 403 );
},
isInvalid: function( error ) {
return( error.code === 1100 );
},
isInvalidField: function( error ) {
return( error.code === 1102 );
},
isMissingField: function( error ) {
return( error.code === 1101 );
},
isNotFound: function( error ) {
return( error.code === 404 );
},
isScreenNotFound: function( error ) {
return( error.code === 406 );
},
isProjectNotFound: function( error ) {
return( error.code === 407 );
},
isProjectEmpty: function( error ) {
return( error.code === 409 );
},
isOverQuota: function( error ) {
return( 
( error.code === 3000 ) ||
( error.code === 3001 )
);
},
isMissingProjectPermission: function( error ) {
return( error.code === 5001 );
},
canJoinProject: function( error ) {
return( error.code === 5002 );
},
isTooManyAttempts: function( error ) {
return( error.code === 3003 );
}
};
})( angular, InVision );
;
;
/*! comment.controller.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("InVision")   // FIXME -- shall we create a module comment?
.controller( "comment.CommentController", CommentController );
var mentionUID = 1;
function CommentController() {
var vm = this;
initialize();
function initialize() {
vm.uid = mentionUID++;
}
}
})( angular );
;
;
/*! comment.directive.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("InVision")
.directive( "invComment", CommentDirective );
function CommentDirective( $window ) {
return ({
controller: "comment.CommentController",
controllerAs: "vm",
restrict: "A",
templateUrl: "/assets/apps/common/ng-components/comment/comment.directive.htm",
link: linkFunction,
scope: {
comment: "=comment", 	// current comment
conversation: "=conversation",  // previous comments [0..N]
screenId: "=screenId",
boardId: "=boardId",
hasEmojis: "@hasEmojis",  							// dis/enable emojis
hasWhoIsNotified: "@hasWhoIsNotified", 	// dis/enable who-is-notified directive
hasMentions: "=hasMentions",
hasMentionShortcut: "@hasMentionShortcut",	// dis/enable shorcuts (@project, @conversation)
onAddComment: "&?onAddComment",
onExitComment: "&?onExitComment",
onFocusCallback: "&?onFocusCallback",
onAddOthers: "&?onAddOthers",
mentionPositioningClass: "@?",
classString: "@?",
placeholder: "@?",
tabIndex: "@?",
name: "@?"
}
});
function linkFunction( scope, element, attrs ) {
if ( ng.isUndefined( attrs.onExitComment ) ) {
return;
}
var firstClick = true;
ng.element( $window ).on( "click", handleClick );
scope.$on( "$destroy", handleDestroy );
function handleClick( event ) {			
if ( element[0].contains( event.target ) ) {
return;
}
if ( firstClick ) {
firstClick = false;
return;
}
var emojiPopover = ng.element( document.querySelector(".emoji-popover") );
if ( emojiPopover && emojiPopover[0].contains( event.target ) ) {
return;
}
scope.$apply(function() {
scope.onExitComment();
});
}
function handleDestroy() {
ng.element( $window ).off( "click" );
}
}
}
})( angular );
;
;
/*! mention.filter.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("InVision")
.filter("mention", function() {
return function( val ) {
if ( typeof val === "undefined") {
return false;
}
var nameParts = val.trim().split(" ").join("");
return "@" + nameParts;
};
});
})( angular );
;
;
/*! nice-date.filter.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("InVision")
.filter("niceDate", niceDateFilter)
;
function niceDateFilter( moment ) {
return function( val ) {
var now = moment();
var date = moment( val );
if ( date > now ) {
return now.fromNow();
}
return date.fromNow();
};
}
})( angular );
;
;
/*! parseCommentService.js */ 
;
;
(function( ng, app ) {
"use strict";
if (typeof module !== "undefined" && module.exports) {
var _ = require("lodash");
var MentionUtilities = require("../../../utilities/mention-utilities");
var EmojiValue = require("../../emoji/emoji-value");
var EmojiService = require("../../emoji/emoji-service")(EmojiValue);
module.exports = ParseCommentService( _, MentionUtilities, EmojiService );
} else if (app) {
app.service("parseCommentService", ParseCommentService);
}
var escapedEntities = {
"<": "&lt;",
">": "&gt;",
"&": "&amp;"
};
function ParseCommentService( _, mentionUtilities, emojiService ) {
function _str( str ) {
return ( str || "" ).toString();
}
function _extractMentionsHtmlFromComment ( comment, mentions, currentUserID ) {
var extracted = [];
if ( ! mentions ) {
return extracted;
}
var mentionText;
var mentionHTML;
var className;
var startPos;
var i = mentions.length;
while ( i-- ) {
var self = ( mentions[ i ].userID === currentUserID );
mentionText = mentions[ i ].text;
startPos = mentions[ i ].startPos;
className = self ? "me-mentioned" : "mention-blue";
mentionHTML = "<span class=\"" + className + "\">" + _.escape( mentionText ) + "</span>";
if ( comment.substr( startPos, mentionText.length ) === mentionText ) {
extracted.push( {
index: startPos,
html: mentionHTML,
css: className,
text: mentionText
} );
}
}
extracted.reverse();
return extracted;
}
function _applyMentionsToComment( comment, mentions ) {
var parsedComment = [ ];
var next = _.first( mentions );
for ( var i = 0; i < comment.length; i++ ) {
if ( next && next.index === i ) {
i += next.text.length - 1;
parsedComment.push( next.html );
var index = _.indexOf( mentions, next );
next = mentions[ index + 1 ];
}
else {
var letter = comment[ i ];
parsedComment.push( escapedEntities[ letter ] || letter );
}
}
return parsedComment.join("");
}
function _handleMentionShortcuts( mentions, userID ) {
var mentionData = [];
var sortedMentions = _.partition(mentions, function( m ) {
return m.text === "@project" || m.text === "@conversation";
});
if ( sortedMentions[0].length > 0 ) {
var grouped = _.groupBy( sortedMentions[0], "startPos" );
_.each(grouped, function( group ) {
var meMention =_.find( group, function( g ) {
return g.userID === userID;
});
mentionData.push( !!meMention ? meMention : group[0] );
});
}
return _.sortBy( sortedMentions[1].concat( mentionData ), function( mention ) {
return mention.startPos;
});
}
function getComment( comment, currentUserID, options ) {
if (
comment.mentions &&
options &&
options.hasOwnProperty("atConversationDisabled") &&
options.atConversationDisabled
) {
_.remove(comment.mentions, function(m) {
return m.text === "@conversation";
});
}
if ( _.isObject( currentUserID )) {
options = currentUserID;
currentUserID = null;
}
var mentions = _handleMentionShortcuts(comment.mentions, currentUserID) || [ ];
comment = _str( comment.comment );
options = options || { };
currentUserID = currentUserID || options.userID || options.currentUser || options.currentUserID;
mentions = _extractMentionsHtmlFromComment( comment, mentions, currentUserID );
comment = _applyMentionsToComment( comment, mentions );
if ( !options.ignoreLineBreaks ) {
comment = applyLineBreaks( comment );
}
if ( !options.ignoreLinks ) {
comment = applyHtmlLinks( comment );
}
if ( !options.ignoreEmojis ) {
comment = emojiService.parseEmoji( comment );
}
return comment;
}
function substrHtml( html, limit ) {
var output = [];
var inTag = false;
var count = 0;
var lastCharacter;
for ( var i = 0; i < html.length; i++ ) {
var character = html[ i ];
var openTag = character === "<";
var closeTag = character === ">";
var multiSpace = lastCharacter === " " && character === " ";
var isTag = openTag || closeTag;
lastCharacter = character;
if (!( inTag || multiSpace )) {
count++;
}
if (( count <= limit || isTag || inTag ) && !multiSpace ) {
output.push( character );
}
if ( count === limit && i < html.length ) {
output.push('...');
}
if ( openTag ) {
inTag = true;
}
else if ( closeTag ) {
inTag = false;
}
}
return output.join("");
}
function applyLineBreaks( string ) {
return _str( string ).replace( /(\r\n?|\n)/g, "<br />" );
}
function applyHtmlLinks( html ) {
var string = _str( html );
var patternURL = /(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim;
var patternWWW = /(^|\s)(www\.[\S]+(\b|$))/gim;
var patternEmail = /([^@\\s]+@[^@\\s]+\\.\\w{2}[\\.\\w]*)/gim;
return string
.replace(patternURL, '<a href="$&" target="_blank">$&</a>')
.replace(patternWWW, '<a href="http://$&" target="_blank">$&</a>')
.replace(patternEmail, function( match, plus, address ) {
/**
* Since JS does not support negative look behind, we check if
* there is a + character captured to lead the e-mail address
* and only replace the email address with a link if it is not
* there.
*/
return plus ? match : '<a href="mailto:' + address + '">' + address + '</a>';
})
;
}
return {
getComment: getComment,
substrHtml: substrHtml,
applyLineBreaks: applyLineBreaks,
applyHtmlLinks: applyHtmlLinks
};
}
})( angular, InVision );
;
;
/*! comment-teaser.controller.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("InVision")
.controller( "comment.CommentTeaserController", CommentTeaserController );
function CommentTeaserController(
$log,
$scope,
_,
appSettings,
mentionStorage,
mentionUtilityService,
itemOwnerPartial,
projectWatchersPartial,
sessionService
) {
var vm = this;
var props = $scope.props = $scope;
var isProjectNotificationEnabled = appSettings.getSettings().features.projectNotificationPreferences;
$scope.$watch( "isShown", handleIsShown );
$scope.$watch( "conversation", handleConversationChange );
$scope.$on( "$destroy", handleDestroy );
itemOwnerPartial.addBinding( setItemOwner );
projectWatchersPartial.addBinding( setProjectWatchers );
initialize();
function initialize() {
mentionStorage.load();
if ( isProjectNotificationEnabled && props.projectId ) {
loadProjectWatchers();
setProjectWatchers();
} else {
loadItemOwner();
setItemOwner();
}
setMentions( true );
}
function loadItemOwner() {
if ( ! sessionService.user.isAccountAuthenticated ) {
return;
}
var itemID = props.screenId || props.boardId;
var itemType = !!props.screenId ? "screen" : "board";
itemOwnerPartial
.load( itemID, itemType )
.catch( protectState( handleReject ) )
;
function handleReject( error ) {
$log.error("For some reason we couldn't load your screen owner");
}
}
function setItemOwner() {
var itemID = props.screenId || props.boardId;
var itemType = !!props.screenId ? "screen" : "board";
vm.itemOwner = itemOwnerPartial.get( itemID, itemType );
if ( ! vm.itemOwner ) {
return;
}
mentionStorage.setOwner( vm.itemOwner );
}
function loadProjectWatchers() {
if ( ! sessionService.user.isAccountAuthenticated ) {
return;
}
projectWatchersPartial
.load( props.projectId )
.catch( protectState( handleReject ) )
;
function handleReject( error ) {
$log.error("For some reason we couldn't load your project watchers");
}
}
function setProjectWatchers() {
vm.watchers = projectWatchersPartial.get( props.projectId );
if ( _.isEmpty( vm.watchers ) ) {
return;
}
mentionStorage.setWatchers( vm.watchers );
}
function setMentions( isInit ) {
if ( _.isEmpty( props.conversation ) ) {
return;
}
var lastComment = _.last( props.conversation );
var lastMentions = lastComment.mentions || [];
var userDetails = mentionUtilityService.getUserDetails( lastComment );
if ( isInit ) {
vm.peopleNotified = mentionUtilityService.getMyMentions( lastMentions, userDetails );
return;
}
mentionStorage.insert( lastMentions );
mentionStorage.insert( userDetails );
vm.peopleNotified = mentionStorage.get();
}
function handleIsShown( newVal ) {
if ( typeof newVal === "undefined" || newVal ) {
return;
}
$scope.$evalAsync( function() {
if (props.hasInitialMentions) {
setMentions();
}
});
}
function handleConversationChange( newVal, oldVal ) {
if ( ! newVal || newVal === oldVal ) {
return;
}
setMentions( true );
}
function handleDestroy() {
$scope.isDestroyed = true;
itemOwnerPartial.removeBinding( setItemOwner );
projectWatchersPartial.removeBinding( setProjectWatchers );
}
function protectState( callback ) {
return( proxy );
function proxy() {
if ( $scope.isDestroyed ) {
$log.warn( "Returning out of callback due to state change." );
return;
}
return( callback.apply( null, arguments ) );
}
}
}
})( angular );
;
;
/*! comment-teaser.directive.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("InVision")
.directive( "invCommentTeaser", CommentTeaserDirective )
;
function CommentTeaserDirective() {
return ({
controller: "comment.CommentTeaserController",
controllerAs: "vm",
restrict: "A",
templateUrl: "/assets/apps/common/ng-components/comment/teaser/comment-teaser.directive.htm",
scope: {
isShown: "=isShown",
hasInitialMentions: "=hasInitialMentions",
conversation: "=conversation",
screenId: "=screenId",
boardId: "=boardId",
projectId: "=projectId"
}
});
}
})( angular );
;
;
/*! emoji-add.directive.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("InVision")
.directive( "invEmojiAdd", Directive );
function Directive( emojiService ) {
return({
link: linkFunction,
restrict: "A",
replace: true,
scope: { 
commentTarget: "=target",
isOpen: "@"
},
templateUrl: "/assets/apps/common/ng-components/emoji/emoji-add.directive.htm"
});
function linkFunction( scope, element ) {
init();
scope.togglePopover = togglePopover;
function init() {
emojiService.setPopover( false );
emojiService.setPopoverOnModal( false );
scope.isOpen = false;
}
function togglePopover() {
scope.isOpen = !scope.isOpen;
scope.$emit("emoji:toggle", scope.isOpen, element );
}
}
}
})( angular );
;
;
/*! emoji-add-menu.directive.js */ 
;
;
(function (ng) {
"use strict";
ng
.module("InVision")
.directive("invEmojiAddMenu", Directive);
function Directive(
$window,
$document,
emojiService,
appSettings
) {
return ({
link: linkFunction,
restrict: "A",
replace: true,
templateUrl: "/assets/apps/common/ng-components/emoji/emoji-add-menu.directive.htm"
});
function linkFunction(scope, element) {
var menuObj = {
width: 320,
height: 335,
topLimit: 400 // limit to either show the menu above or beneath the emoji-add icon
};
var ESC = 27;
var textarea = null;
var addEmojiElement = null;
var emojiContainer = element.find(".emojis");
var emojiIcon = ".emoji-icon";
var emojiAttr = "data-emoji";
var isModal = element.closest(".modal").length > 0 || element.closest(".m-inbox-conversation").length || element.closest(".m-inbox-board-item").length;
var emojiPlaceholder = element.closest(".emoji-root").find(".emoji-placeholder");
var appendTo = (emojiPlaceholder.length > 0) ? emojiPlaceholder : $document.find("body");
scope.$on("emoji:toggle", handleToggle);
$document.on("keydown", keyboardEvents);
angular.element($window).on("click", handleClickOutside);
init();
function init() {
scope.tabs = emojiService.getCategories();
scope.activeTab = {
"idx": 0,
"tab": scope.tabs[0]
};
scope.emojis = emojiService.getEmojis();
scope.hoverEmoji = null;
}
scope.setTab = function (index) {
scope.activeTab.idx = index;
scope.activeTab.tab = scope.tabs[index];
};
emojiContainer.on("click", emojiIcon, function(e) {
textarea = addEmojiElement.closest(".post-emojis").find("textarea").val(); // can't cache it, enabled with ng-if
scope.$emit("emoji:add", textarea, this.getAttribute( emojiAttr ), scope.commentTarget );
scope.isOpen = false;
scope.$apply();
});
emojiContainer.on("mouseenter", emojiIcon, function (e) {
scope.hoverEmoji = this.getAttribute(emojiAttr);
scope.$digest();
});
emojiContainer.on("mouseleave", emojiIcon, function (e) {
scope.hoverEmoji = null;
scope.$digest();
});
function keyboardEvents(event) {
var keyCode = event.which || event.keyCode;
if (keyCode !== ESC) {
return;
}
if (!scope.isOpen) {
emojiService.setPopover(false);
}
scope.isOpen = false;
scope.$digest();
}
function handleToggle(event, isOpen, addEmojiElm) {
addEmojiElement = addEmojiElm;
if (!isOpen) {
return;
}
emojiService.setPopover(true);
emojiService.setPopoverOnModal(true);
appendTo.append(element);
var addEmojiIconCoords = emojiService.getElementBoundingCoords(addEmojiElement[0]);
var appendToCoords = emojiService.getElementBoundingCoords(appendTo[0]);
var top = (addEmojiIconCoords.top - appendToCoords.top) - (menuObj.height + menuObj.height * 0.1);
var left = (addEmojiIconCoords.left - appendToCoords.left) + menuObj.width / 2;
if (addEmojiIconCoords.top < menuObj.topLimit) {
top = addEmojiIconCoords.top - appendToCoords.top;
}
element.css({
top: top,
left: left
});
if (isModal) {
element.css({
zIndex: 1051
});
}
}
function handleClickOutside(event) {
if (addEmojiElement && (addEmojiElement[0].contains(event.target) || element[0].contains(event.target))) {
return;
}
scope.isOpen = false;
scope.$digest();
}
scope.$on(
"$destroy",
function () {
emojiService.setPopover(false);
emojiService.setPopoverOnModal(false);
$(emojiContainer).off("click mouseenter mouseleave");
angular.element($window).off("click", handleClickOutside);
$document.off("keydown", keyboardEvents);
element.remove();
}
);
}
}
})(angular);
;
;
/*! emoji-service.js */ 
;
;
(function( ng, app, _ ) {
"use strict";
if (typeof module !== "undefined" && module.exports) {
module.exports = EmojiService;
} else if (app) {
app.service( "emojiService", EmojiService );
}
function EmojiService( emojiValue ) {
var popoverActive          = false;
var typeaheadActive        = false;
var popoverActiveOnModal   = false;
var typeaheadActiveOnModal = false;
var flatEmojis = _.flatten( _.map( emojiValue.emojis, _.values ) );
var rEmojis = new RegExp(":(([a-z0-9_+-])+):|("+ emojiValue.faces.join("|") +")", "g");
return({
getEmojis: getEmojis,
getAllEmojis: getAllEmojis,
getCategories: getCategories,
parseEmoji: parseEmoji,
splitEmoji: splitEmoji,
findEmoji: findEmoji,
isPopoverActive: isPopoverActive,
isTypeaheadActive: isTypeaheadActive,
isPopoverActiveOnModal: isPopoverActiveOnModal,
isTypeaheadActiveOnModal: isTypeaheadActiveOnModal,
setPopover: setPopover,
setTypeahead: setTypeahead,
setPopoverOnModal: setPopoverOnModal,
setTypeaheadOnModal: setTypeaheadOnModal,
getElementBoundingCoords: getElementBoundingCoords
});
function getEmojis() {
return emojiValue.emojis;
}
function getCategories() {
return Object.keys( getEmojis() );
}
function getAllEmojis() {
return flatEmojis;
}
function isPopoverActive() {
return popoverActive;
}
function isTypeaheadActive() {
return typeaheadActive;
}
function isPopoverActiveOnModal() {
return popoverActiveOnModal;
}
function isTypeaheadActiveOnModal() {
return typeaheadActiveOnModal;
}
function setPopover( flag ) {
popoverActive = flag;
return popoverActive;
}
function setTypeahead( flag ) {
typeaheadActive = flag;
return typeaheadActive;
}
function setPopoverOnModal( flag ) {
popoverActiveOnModal = flag;
return popoverActiveOnModal;
}
function setTypeaheadOnModal( flag ) {
typeaheadActiveOnModal = flag;
return typeaheadActiveOnModal;
}
function parseEmoji( comment ) {
var icon = "";
if ( typeof comment === "undefined" || comment.split(":").length < 2 ) {
return comment;
}
return comment.replace( rEmojis, function( match, text ) {
if ( emojiValue.faceToEmojis[ match ] ) {
icon = emojiValue.faceToEmojis[ match ].emoji;
}
else if ( flatEmojis.indexOf( text ) >= 0 ) {
icon = text;
}
if ( !icon ) {
return match;
}
return "<i class='emoji-icon-comment emojis-" + icon + "' title=':" + icon + ":'></i>";
});
}
function findEmoji( q ) {
var results = [];
for ( var i = 0, nodes = flatEmojis.length; i < nodes; i++ ) {
var emoji = flatEmojis[ i ];
if ( emoji.indexOf( q ) === 0 ) {
results.push({
"label": emoji
});
}
}
return results;
}
function splitEmoji( val, index, showAll ) {
var comment = {
showAll: false
};
if ( typeof val !== "string" || val.indexOf(":") < 0 ) {
return comment;
}
var openingChar = ":";
var closingChar = " ";
var prefix = val.substring( 0, index );
var suffix = val.substring( index );
var openingCharPos = prefix.lastIndexOf( openingChar );
var closingCharPos = suffix.indexOf( closingChar );
if ( showAll && ( openingCharPos + openingChar.length === index ) ) {
comment = {
emoji: "",
showAll: true
};
return comment;
}
comment = {
before: prefix.substring( 0, openingCharPos ),
emoji: "",
after: suffix.substring( closingCharPos + closingChar.length ),
colon: openingChar
};
comment.emoji = val.substring( openingCharPos + openingChar.length, index );
if ( comment.emoji.indexOf(":") >= 0 || comment.emoji.indexOf(" ") >= 0 ) {
comment.emoji = "";
}
return comment;
}
function getElementBoundingCoords( element ) {
var coordinates = { top: 0, left: 0 };
var obj = element;
var body = document.body;
while ( obj ) {
coordinates.left += obj.offsetLeft + obj.clientLeft;
coordinates.top += obj.offsetTop + obj.clientTop;
obj = obj.offsetParent;
}
obj = element;
while ( obj !== body ) {
if ( obj &&  obj.scrollTop && obj.scrollTop > 0 ) {
coordinates.top -= obj.scrollTop;
}
if ( obj && obj.scrollLeft && obj.scrollLeft > 0 ) {
coordinates.left -= obj.scrollLeft;
}
obj = obj.parentNode;
}
return coordinates;
}
}
})( angular, InVision, _ );
;
;
/*! emoji-text.directive.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invEmojiText", EmojiTextDirective );
function EmojiTextDirective( emojiService ) {
return ({
link: linkFunction,
restrict: "A"
});
function linkFunction( $scope ) {
$scope.$on("emoji:add", addEmoji );
$scope.$on("emoji:typeahead", typeaheadEmoji );
function addEmoji( event, commentVal, emoji ) {
var emojiItem = ":" + emoji + ": ";
$scope.comment = commentVal + emojiItem; // updates the comment model
}
function typeaheadEmoji( event, emoji, caretPos ) {
var comment = "";
comment = emojiService.splitEmoji( $scope.comment, caretPos );
$scope.comment = comment.before + comment.colon + emoji + ": " + comment.after;
}
}
}
})( angular, InVision );
;
;
/*! emoji-typeahead.directive.js */ 
;
;
(function( ng, app ) {
"use strict";
ng
.module("InVision")
.directive( "invEmojiTypeahead", EmojiTypeaheadDirective );
function EmojiTypeaheadDirective(
$timeout,
$document,
emojiService,
appSettings
) {
return({
link: linkFunction,
scope: {
model: "=",
commentTarget: "=target",
isNarrow: "@"
},
restrict: "A",
replace: true,
templateUrl: "/assets/apps/common/ng-components/emoji/emoji-typeahead.directive.htm"
});
function linkFunction( $scope, element ) {
var minSearch = 2;
var HOT_KEYS = [
9,  // TAB
13, // RETURN
27, // ESC
32, // SPACE
37, // arrow left
38, // arrow up
39, // arrow right
40  // arrow down
];
var emojiIcon = "li";
var emojiAttr = "data-idx";
var textarea = element.parent().find("textarea");
var emojiList = element.find(".emoji-list");
var caretPos = 0;
var mentionEnabled = false;
var emojiPlaceholder = element.closest(".emoji-root").find(".emoji-placeholder");
var appendTo = ( emojiPlaceholder.length > 0 ) ? emojiPlaceholder : $document.find( "body" );
var isModal = element.closest(".modal").length > 0 || element.closest(".m-inbox-conversation").length;
init();
function init() {
$scope.current = 0;
$scope.items = [];
$scope.isActive = false;
$scope.isBrowsing = false;
$scope.comment = "";
emojiService.setTypeahead( false );
emojiService.setTypeaheadOnModal( false );
if ( !textarea ) {
throw new Error("Textarea not available. Please provide one");
}
}
function flush() {
$scope.current = 0;
$scope.items.length = 0;
$scope.isActive = false;
$scope.isBrowsing = false;
$scope.firstTab = true;
}
function getCaretPos( el ) {
if ( el && el.selectionStart ) {
return el.selectionStart;
} else if ( document.selection ) {
el.focus();
var sel = document.selection.createRange();
var selLen = document.selection.createRange().text.length;
sel.moveStart("character", -el.value.length);
return sel.text.length - selLen;
}
}
function setCaretPos( el, cPos ) {
if ( el.createTextRange ) {
var range = el.createTextRange();
range.move("character", cPos );
range.select();
} else {
el.focus();
if ( el.selectionStart !== undefined ) {
el.setSelectionRange( cPos, cPos );
}
}
}
function scrollToEmoji() {
var paddingOffset = 40;
var currentEmoji = $scope.items[ $scope.current ].label;
var posTop = element.find(".emojis-" + currentEmoji).position().top;
var scrollTop = emojiList.scrollTop();
if ( posTop < paddingOffset ) {
emojiList.scrollTop( scrollTop + ( posTop - paddingOffset ) );
} else if ( posTop > emojiList.height() + paddingOffset ) {
emojiList.scrollTop( scrollTop + ( posTop - emojiList.height() ) );
}
}
function updateTypeahead( showAll ) {
var splitComment = emojiService.splitEmoji( $scope.comment, caretPos, showAll );
if ( showAll && splitComment.showAll ) {
activateTypeahead( splitComment );
return;
}
if ( splitComment.emoji && splitComment.emoji.length >= minSearch ) {
activateTypeahead( splitComment );
}
}
function activateTypeahead( comment ) {
$scope.items = emojiService.findEmoji( comment.emoji );
if ( $scope.items.length <= 0 ) {
return;
}
$scope.isActive = true;
emojiService.setTypeahead( true );
emojiService.setTypeaheadOnModal( true );
appendTo.append( element );
requestAnimationFrame( function() {
var textareaCoords = emojiService.getElementBoundingCoords( textarea[ 0 ] );
var appendToCoords = emojiService.getElementBoundingCoords( appendTo[ 0 ] );
element.css({
top: textareaCoords.top - appendToCoords.top,
left: textareaCoords.left - appendToCoords.left
});
if ( isModal ) {
element.css({
zIndex: 1051
});
}
});
}
function emitEmoji() {
if ( typeof $scope.items[ $scope.current ] === "undefined" ) {
return;
}
$scope.$emit("emoji:typeahead", $scope.items[ $scope.current ].label, caretPos );
$scope.$apply();
}
function browseEmoji() {
emitEmoji();
setCaretPos( textarea[0], caretPos );
if ( $scope.items.length > 15 ) {
scrollToEmoji();
}
}
function selectEmoji() {
emitEmoji();
flush();
setCaretPos( textarea[0], $scope.model.length );
}
function keyboardEvents( event ) {
if ( !textarea.is(":focus") ) {
return;
}
var keyCode = event.which || event.keyCode;
if ( HOT_KEYS.indexOf( keyCode ) === -1 ) {
flush();
return;
}
if ( keyCode === 27 ) {
if ( !$scope.isActive ) {
emojiService.setTypeahead( false );
}
flush();
$scope.$digest();
return;
}
if ( keyCode === 9 && !$scope.isActive ) {
updateTypeahead( true );
event.preventDefault();
}
if ( !$scope.isActive ) {
return;
}
if ( keyCode === 32 ) {
flush();
$scope.$digest();
return;
}
event.preventDefault();
$scope.isBrowsing = true;
if ( keyCode === 37 || keyCode === 38 ) {
$scope.firstTab = false; // reset first tab
$scope.current = ( $scope.current === 0 ) ? $scope.items.length - 1 : $scope.current - 1;
browseEmoji();
}
else if ( keyCode === 39 || keyCode === 40 ) {
$scope.firstTab = false;
$scope.current = ( $scope.current >= $scope.items.length - 1 ) ? 0 : $scope.current + 1;
browseEmoji();
}
else if ( keyCode === 9 ) {
if ( $scope.firstTab ) {
$scope.firstTab = false;
}
else {
$scope.current = ( $scope.current >= $scope.items.length - 1 ) ? 0 : $scope.current + 1;
}
browseEmoji();
}
else if ( keyCode === 13 ) {
selectEmoji();
}
$scope.$digest();
}
textarea.on( "keydown", keyboardEvents );
element.on( "click", emojiIcon, function( e ) {
selectEmoji();
});
element.on( "mouseenter", emojiIcon, function( e ) {
$scope.current = parseInt( this.getAttribute( emojiAttr ), 10 );
$scope.$digest();
});
$scope.$watch("model", function( newValue, oldValue ) {
if ( newValue === oldValue ) {
return;
}
if ( $scope.isBrowsing ) {
return;
}
caretPos = getCaretPos( textarea[0] );
$scope.comment = newValue;
flush();
updateTypeahead();
});
$scope.$on(
"$destroy",
function() {
textarea.off( "keydown", keyboardEvents );
element.off( "click mouseenter" );
emojiService.setTypeahead( false );
emojiService.setTypeaheadOnModal( false );
element.remove();
}
);
}
}
})( angular, InVision );
;
;
/*! emoji-value.js */ 
;
;
(function( ng, app ) {
"use strict";
var emojiValue = {
emojis: {
"grinning": [
"grinning",
"grin",
"joy",
"smiley",
"smile",
"sweat_smile",
"satisfied",
"innocent",
"smiling_imp",
"wink",
"blush",
"yum",
"relieved",
"heart_eyes",
"sunglasses",
"smirk",
"neutral_face",
"expressionless",
"unamused",
"sweat",
"pensive",
"confused",
"confounded",
"kissing",
"kissing_heart",
"kissing_smiling_eyes",
"kissing_closed_eyes",
"stuck_out_tongue",
"stuck_out_tongue_winking_eye",
"stuck_out_tongue_closed_eyes",
"disappointed",
"worried",
"angry",
"rage",
"cry",
"persevere",
"triumph",
"disappointed_relieved",
"frowning",
"anguished",
"fearful",
"weary",
"sleepy",
"tired_face",
"grimacing",
"sob",
"open_mouth",
"hushed",
"cold_sweat",
"scream",
"astonished",
"flushed",
"sleeping",
"dizzy_face",
"no_mouth",
"relaxed",
"mask",
"smile_cat",
"joy_cat",
"smiley_cat",
"heart_eyes_cat",
"smirk_cat",
"kissing_cat",
"pouting_cat",
"crying_cat_face",
"scream_cat",
"no_good",
"ok_woman",
"bow",
"see_no_evil",
"hear_no_evil",
"speak_no_evil",
"raising_hand",
"person_frowning",
"person_with_pouting_face",
"bust_in_silhouette",
"busts_in_silhouette",
"boy",
"girl",
"man",
"woman",
"family",
"couple",
"two_men_holding_hands",
"two_women_holding_hands",
"cop",
"dancers",
"bride_with_veil",
"person_with_blond_hair",
"man_with_gua_pi_mao",
"man_with_turban",
"older_man",
"older_woman",
"baby",
"construction_worker",
"princess",
"japanese_ogre",
"japanese_goblin",
"ghost",
"angel",
"alien",
"space_invader",
"imp",
"skull",
"information_desk_person",
"guardsman"
],
"ok": [
"eyes",
"ear",
"nose",
"lips",
"tongue",
"point_up",
"fist",
"raised_hands",
"raised_hand",
"v",
"point_up_2",
"point_down",
"point_left",
"point_right",
"punch",
"wave",
"ok_hand",
"thumbsup",
"thumbsdown",
"clap",
"open_hands",
"rat",
"mouse2",
"ox",
"water_buffalo",
"cow2",
"tiger2",
"leopard",
"rabbit2",
"cat2",
"dragon",
"crocodile",
"whale2",
"snail",
"snake",
"racehorse",
"ram",
"goat",
"sheep",
"monkey",
"rooster",
"chicken",
"dog2",
"pig2",
"boar",
"elephant",
"octopus",
"shell",
"bug",
"ant",
"honeybee",
"beetle",
"fish",
"tropical_fish",
"blowfish",
"turtle",
"hatching_chick",
"baby_chick",
"hatched_chick",
"bird",
"penguin",
"koala",
"poodle",
"dromedary_camel",
"camel",
"dolphin",
"mouse",
"cow",
"tiger",
"rabbit",
"cat",
"dragon_face",
"whale",
"horse",
"monkey_face",
"dog",
"pig",
"frog",
"hamster",
"wolf",
"bear",
"panda_face",
"pig_nose",
"paw_prints"
],
"hamburger": [
"hamburger",
"coffee",
"pizza",
"meat_on_bone",
"poultry_leg",
"rice_cracker",
"rice_ball",
"rice",
"curry",
"ramen",
"spaghetti",
"bread",
"fries",
"sweet_potato",
"dango",
"oden",
"sushi",
"fried_shrimp",
"fish_cake",
"icecream",
"shaved_ice",
"ice_cream",
"doughnut",
"cookie",
"chocolate_bar",
"candy",
"lollipop",
"custard",
"honey_pot",
"cake",
"bento",
"stew",
"egg",
"fork_and_knife",
"tea",
"sake",
"wine_glass",
"cocktail",
"tropical_drink",
"beer",
"beers",
"baby_bottle",
"mushroom",
"tomato",
"eggplant",
"grapes",
"melon",
"watermelon",
"tangerine",
"lemon",
"banana",
"pineapple",
"apple",
"green_apple",
"pear",
"peach",
"cherries",
"strawberry",
"chestnut",
"seedling",
"evergreen_tree",
"deciduous_tree",
"palm_tree",
"cactus",
"tulip",
"cherry_blossom",
"rose",
"hibiscus",
"sunflower",
"blossom",
"corn",
"ear_of_rice",
"herb",
"four_leaf_clover",
"maple_leaf",
"fallen_leaf",
"leaves"
],
"star": [
"star",
"sunny",
"cloud",
"telephone",
"umbrella",
"spades",
"clubs",
"hearts",
"diamonds",
"recycle",
"wheelchair",
"warning",
"copyright",
"registered",
"tm",
"zap",
"soccer",
"baseball",
"snowman",
"partly_sunny",
"no_entry",
"golf",
"sailboat",
"fuelpump",
"scissors",
"ballot_box_with_check",
"white_check_mark",
"airplane",
"envelope",
"pencil2",
"black_nib",
"heavy_check_mark",
"heavy_multiplication_x",
"sparkles",
"snowflake",
"x",
"negative_squared_cross_mark",
"question",
"heavy_exclamation_mark",
"bangbang",
"interrobang",
"heart",
"heavy_plus_sign",
"heavy_minus_sign",
"heavy_division_sign",
"o",
"black_joker",
"cyclone",
"foggy",
"closed_umbrella",
"sunrise",
"ocean",
"earth_africa",
"earth_americas",
"earth_asia",
"globe_with_meridians",
"full_moon_with_face",
"sun_with_face",
"star2",
"ribbon",
"gift",
"birthday",
"jack_o_lantern",
"christmas_tree",
"santa",
"fireworks",
"sparkler",
"balloon",
"tada",
"confetti_ball",
"tanabata_tree",
"crossed_flags",
"bamboo",
"dolls",
"flags",
"wind_chime",
"rice_scene",
"school_satchel",
"mortar_board",
"microphone",
"movie_camera",
"cinema",
"headphones",
"art",
"tophat",
"circus_tent",
"ticket",
"clapper",
"performing_arts",
"video_game",
"dart",
"slot_machine",
"8ball",
"game_die",
"bowling",
"flower_playing_cards",
"musical_note",
"notes",
"saxophone",
"guitar",
"musical_keyboard",
"trumpet",
"violin",
"musical_score",
"tennis",
"ski",
"basketball",
"checkered_flag",
"snowboarder",
"running",
"surfer",
"trophy",
"horse_racing",
"football",
"rugby_football",
"swimmer",
"dancer",
"lipstick",
"nail_care",
"massage",
"haircut",
"barber",
"syringe",
"pill"
],
"bulb": [
"bulb",
"kiss",
"love_letter",
"ring",
"gem",
"couplekiss",
"bouquet",
"couple_with_heart",
"wedding",
"heartbeat",
"broken_heart",
"two_hearts",
"sparkling_heart",
"heartpulse",
"cupid",
"blue_heart",
"green_heart",
"yellow_heart",
"purple_heart",
"gift_heart",
"revolving_hearts",
"heart_decoration",
"diamond_shape_with_a_dot_inside",
"anger",
"bomb",
"zzz",
"collision",
"sweat_drops",
"droplet",
"dash",
"shit",
"muscle",
"dizzy",
"speech_balloon",
"thought_balloon",
"heavy_dollar_sign",
"credit_card",
"yen",
"dollar",
"euro",
"pound",
"money_with_wings",
"seat",
"computer",
"briefcase",
"minidisc",
"floppy_disk",
"cd",
"dvd",
"file_folder",
"open_file_folder",
"page_with_curl",
"page_facing_up",
"date",
"card_index",
"chart_with_upwards_trend",
"chart_with_downwards_trend",
"bar_chart",
"pushpin",
"round_pushpin",
"paperclip",
"notebook",
"book",
"books",
"pencil",
"telephone_receiver",
"pager",
"fax",
"satellite",
"loudspeaker",
"mega",
"outbox_tray",
"inbox_tray",
"package",
"mailbox_closed",
"mailbox",
"mailbox_with_mail",
"mailbox_with_no_mail",
"postbox",
"postal_horn",
"newspaper",
"iphone",
"no_mobile_phones",
"camera",
"video_camera",
"tv",
"radio",
"vhs",
"low_brightness",
"high_brightness",
"mute",
"sound",
"speaker",
"battery",
"electric_plug",
"mag",
"mag_right",
"lock_with_ink_pen",
"closed_lock_with_key",
"key",
"lock",
"unlock",
"bell",
"no_bell",
"bookmark",
"link",
"radio_button",
"underage",
"fire",
"flashlight",
"wrench",
"hammer",
"nut_and_bolt",
"hocho",
"gun",
"microscope",
"telescope",
"crystal_ball",
"clock3",
"pray"
],
"rocket": [
"rocket",
"helicopter",
"steam_locomotive",
"train",
"bullettrain_side",
"bullettrain_front",
"train2",
"light_rail",
"station",
"tram",
"bus",
"oncoming_bus",
"trolleybus",
"busstop",
"minibus",
"ambulance",
"fire_engine",
"police_car",
"oncoming_police_car",
"taxi",
"oncoming_taxi",
"red_car",
"oncoming_automobile",
"blue_car",
"truck",
"articulated_lorry",
"tractor",
"monorail",
"mountain_railway",
"suspension_railway",
"mountain_cableway",
"aerial_tramway",
"ship",
"rowboat",
"speedboat",
"traffic_light",
"vertical_traffic_light",
"construction",
"rotating_light",
"triangular_flag_on_post",
"door",
"house",
"house_with_garden",
"european_post_office",
"convenience_store",
"school",
"no_entry_sign",
"smoking",
"no_smoking",
"put_litter_in_its_place",
"bike",
"no_bicycles",
"bicyclist",
"mountain_bicyclist",
"walking",
"no_pedestrians",
"mens",
"womens",
"toilet",
"shower",
"bath",
"bathtub",
"cn",
"de",
"es",
"fr",
"uk",
"it",
"jp",
"kr",
"ru",
"us"
]
},
faces: [
":\\)", // :)
":\\|", // :|
":\\(", // :(
":\D",  // :D
":\P",  // :P
"\D:"   // D:
],
faceToEmojis: {
":)": {
emoji: "smile"
},
":|": {
emoji: "neutral_face"
},
":(": {
emoji: "disappointed"
},
":D": {
emoji: "smiley"
},
":P": {
emoji: "stuck_out_tongue"
},
"D:": {
emoji: "anguished"
}
}
};
if (app) {
app.value("emojiValue", emojiValue);	
}
if (typeof module !== "undefined" && module.exports) {
module.exports = emojiValue;
}
})( angular, InVision );
;
;
/*! mention.controller.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention", [])
.controller( "mention.MentionController", mentionController );
function mentionController(
_,
appSettings,
candidatesPartial,
config,
mentionService,
mentionShortcutService,
mentionStorage,
$scope
) {
var vm = this;
var MAX_MATCHES = 250;
vm.searchPeople = searchPeople;
vm.selectPerson = selectPerson;
vm.addMention = addMention;
initialize();
function initialize() {
if (!$scope.hasMentions) {
return;
}
candidatesPartial.load();
}
/**
* Takes the existingMention data and extracts the human-readable
* term, returning it.
*
* @param {Object} existingMention - mention data from the getMentionedUser method
* @returns {String} the extracted, human-readable term
*/
function getTermFromExistingMention( existingMention ) {
if ( existingMention.email ) {
return existingMention.email;
}
return existingMention.name;
}
/**
* Replaces the existing, encoded mention text with a readable
* version of the mention, and returns that readable version
*
* @param {Object} existingMention - mention data from the getMentionedUser method
* @param {Object} mentionInfo - mention data from the getTriggerInfo method
* @returns {String} the extracted, human-readable term
*/
function handleExistingMention( existingMention, mentionInfo ) {
var startPos = mentionInfo.mentionPosition;
var endPos = startPos + mentionInfo.mentionText.length + 1;
var term = getTermFromExistingMention( existingMention );
mentionService.replaceInputText(
mentionInfo.mentionSelectedElement,
mentionInfo.mentionTriggerChar + term,
startPos,
endPos
);
return term;
}
/**
* Loops over the `people` array and returns a new array where
* the appropriate values (determined by triggerChar) match the
* specified term
*
* @param {String} triggerChar - determines which filter algorithm to use
* @param {String} currentTerm - the value that will be matched against
* @returns {Array} the filtered list of people
*/
function generatePeopleList( triggerChar, currentTerm ) {
var term = currentTerm || "";
var upperCaseTerm = term.toUpperCase();
var mentionShortcuts = buildShortcuts();
var handlers = {
"@": function handleMentions( item ) {
var name = item.name.replace( /\s*/g, "" ).toUpperCase();
return ~name.indexOf( upperCaseTerm );
},
"+": function handleEmailMentions( item ) {
var email = ( item.email || "" ).toUpperCase();
return ~email.indexOf( upperCaseTerm );
}
};
var handler = handlers[triggerChar] || function noop() {};
var matches = _.filter( mentionShortcuts.concat(candidatesPartial.data.candidates.candidates), handler );
if (matches.length > MAX_MATCHES) {
return {
isOverMax: true,
matches: []
};
}
return {
isOverMax: false,
matches: matches
};
}
function searchPeople( mentionInfo ) {
var term = mentionInfo.mentionText || "";
var triggerChar = mentionInfo.mentionTriggerChar;
var existingMention = mentionService.getMentionedUser( term );
if ( existingMention ) {
term = handleExistingMention( existingMention, mentionInfo );
}
var peopleList = generatePeopleList( triggerChar, term );
var peopleListIsPopulated = peopleList.matches.length > 0;
var termHasValue = term.length > 0;
var isMention = triggerChar === "@";
var isDefaultView = isMention && !termHasValue;
var noMatches = isMention && termHasValue && !peopleListIsPopulated && !peopleList.isOverMax;
var overMax = isMention && termHasValue && peopleList.isOverMax;
var isNewUser = isMention && term.length > 2 && !peopleListIsPopulated;
vm.view = "default";
if ( isDefaultView ) {
vm.view = "defaultNoTerm";
}
if ( noMatches ) {
vm.view = "noCandidates";
}
if ( overMax ) {
vm.view = "overMax";
}
if ( isNewUser ) {
vm.view = "newUser";
}
vm.people = peopleList.matches;
}
function selectPerson( person ) {
var triggerChar = "@";
var name = person.name.replace( /\s/g, "" );
var id = person.id;
var isShortcut = person.role === "shortcut";
if ( !id && !isShortcut ) {
triggerChar = "+";
id = mentionService.isEmailAddress( person.email ) ? person.email : null;
name = id;
}
if ( id || isShortcut ) {
return triggerChar + name;
}
return person.name;
}
function addMention( person, startPos ) {
mentionStorage.insert( person, startPos );
}
function buildShortcuts() {
var hasMentionShortcuts = appSettings.getSettings().features.mentionShortcut;
if (!hasMentionShortcuts) {
return [];
}
var shortcuts = mentionShortcutService.getShortcuts();
if(
config.featureFlags["prototypes-rain-690-sunset-conversation"] ||
config.featureFlags["boards-rain-687-sunset-conversation"]
) {
return [_.find(shortcuts, function(s) {
return s.name === "project";
})];
}
return shortcuts;
}
}
})( angular );
;
;
/*! mention.directive.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.directive( "invMention", MentionDirective );
function MentionDirective() {
return ({
controller: "mention.MentionController",
controllerAs: "vm",
restrict: "A",
templateUrl: "/assets/apps/common/ng-components/mention/mention.directive.htm",
scope: {
uid: "@uid",
hasWhoIsNotified: "@hasWhoIsNotified",
hasMentions: "=hasMentions",
conversation: "=conversation",
screenId: "=screenId",
boardId: "=boardId",
mentionPositioningClass: "@?",
onAddOthers: "&?onAddOthers"
}
});
}
})( angular );
;
;
/*! utility.js */ 
;
;

;
;
/*! order-by-user-role.filter.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.filter("orderByUserRole", orderByUserRoleFilter );
function orderByUserRoleFilter( _ ) {
return function( input ) {
if ( !Array.isArray( input ) ) {
return input;
}
var CONTRIBUTOR = "Contributor";
var REVIEWER = "Reviewer";
var ADMIN = "Admin";
var MANAGER = "Manager";
var collaborators = [];
var others = [];
for ( var i = 0, nodes = input.length; i < nodes; i++ ) {
var userRole = input[ i ].role;
switch ( userRole ) {
case CONTRIBUTOR:
case REVIEWER:
case ADMIN:
case MANAGER:
collaborators.push( input[ i ] );
break;
default:
others.push( input[ i ] );
break;
}
}
var sortedCollaborators = _.sortBy( collaborators, "name" );
var sortedOthers = _.sortBy( others, "name" );
return sortedCollaborators.concat( sortedOthers );
};
}
})( angular );
;
;
/*! unsafe.filter.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.filter("unsafe", function( $sce ) {
return function( val ) {
return $sce.trustAsHtml( val );
};
});
})( angular );
;
;
/*! mention-menu.controller.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.controller( "mention.MenuController", menuController );
function menuController(
$scope,
_,
appSettings,
config,
candidatesPartial,
mentionShortcutService
) {
var vm = this;
var props = $scope.props = $scope;
props.visible = false;
vm.getInitials = getInitials;
vm.getUserInfo = getUserInfo;
vm.activate = props.activate = activate;
vm.isActive = props.isActive = isActive;
vm.selectItem = props.selectItem = selectItem;
vm.hasMentionShortcuts = appSettings.getSettings().features.mentionShortcut;
vm.isOverMentionCap = props.isOverMentionCap = isOverMentionCap;
vm.conversationDisabled = config.featureFlags["prototypes-rain-690-sunset-conversation"];
props.activateNextItem = activateNextItem;
props.activatePreviousItem = activatePreviousItem;
props.isFirstItemActive = isFirstItemActive;
props.isLastItemActive = isLastItemActive;
props.selectActive = selectActive;
props.isVisible = isVisible;
props.showMenu = showMenu;
props.setParent = setParent;
function getInitials( name ) {
if ( !name ) {
return ("");
}
var nameParts = name.replace( /^\s+|\s+$/g, "" ).split( /\s+/ );
var namePartsCount = nameParts.length;
if ( namePartsCount > 1 ) {
return (
nameParts[ 0 ].slice( 0, 1 ) +
nameParts[ namePartsCount - 1 ].slice( 0, 1 )
);
}
return ( nameParts[ 0 ].slice( 0, 1 ) );
}
function getUserInfo( person ) {
if ( vm.hasMentionShortcuts ) {
return mentionShortcutService.getUserInfo(person, candidatesPartial.data);
}
return person.email;
}
function activate( item ) {
props.activeItem = item;
}
function isActive( item ) {
return props.activeItem === item;
}
function selectItem( item ) {
var text = props.select({
item: item
});
var startPos = props.parentMentio.replaceText( text );
props.addMention({
person: item,
startPos: startPos
});
}
function activateNextItem() {
var index = props.items.indexOf(props.activeItem);
activate(props.items[(index + 1) % props.items.length]);
}
function activatePreviousItem() {
var index = props.items.indexOf(props.activeItem);
activate(props.items[index === 0 ? props.items.length - 1 : index - 1]);
}
function isFirstItemActive() {
var index = props.items.indexOf(props.activeItem);
return index === 0;
}
function isLastItemActive() {
var index = props.items.indexOf( props.activeItem );
return index === (props.items.length - 1);
}
function selectActive() {
if ( !props.activeItem ) {
return;
}
props.selectItem( props.activeItem );
}
function isVisible() {
return props.visible;
}
function isOverProjectMentionsCap () {
return candidatesPartial.data.candidates.isOverProjectMentionCap ? "project": false;
}
function isOverConversationMentionsCap () {
return candidatesPartial.data.candidates.isOverConversationMentionCap ? "conversation": false;
}
function isOverMentionCap(itemName) {
if(itemName) {
return (isOverProjectMentionsCap() === itemName || isOverConversationMentionsCap() === itemName)? itemName: false;
}
return isOverProjectMentionsCap() || isOverConversationMentionsCap();
}
function showMenu() {
if ( !props.visible ) {
props.requestVisiblePendingSearch = true;
}
}
function setParent( scope ) {
props.parentMentio = scope;
props.targetElement = scope.targetElement;
}
}
})( angular );
;
;
/*! mention-menu.directive.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.directive( "invMentionMenu", mentionMenuDirective );
function mentionMenuDirective(
mentionService,
$rootScope,
$log,
$window,
$document
) {
return ({
restrict: "A",
scope: {
search: "&mentioSearch",
select: "&mentioSelect",
addMention: "&addMention",
items: "=mentioItems",
view: "=mentioView",
triggerChar: "=mentioTriggerChar",
forElem: "=mentioFor",
mentionPositioningClass: "@?"
},
templateUrl: "/assets/apps/common/ng-components/mention/menu/mention-menu.directive.htm",
controller: "mention.MenuController",
controllerAs: "vm",
link: function( scope, element, attr ) {
if ( !scope.forElem ) {
$log.error("mentio-menu requires a target element in the mentio-for attribute");
return;
}
if ( !scope.triggerChar ) {
$log.error("mentio-menu requires a trigger char");
return;
}
var HOT_KEYS = [
9,  // TAB
13, // RETURN
27, // ESC
37, // arrow left
38, // arrow up
39, // arrow right
40  // arrow down
];
var textarea = element.closest(".comment-wrapper").find("textarea.mention-text");
textarea.on( "keydown paste", handleKeyEvent );
angular.element( $document ).on( "click", handleClick );
angular.element( $window ).on( "resize", handleResize );  // Do we need this?
scope.$on("$destroy", handleDestroy );
$rootScope.$broadcast("menuCreated", {
targetElement: attr.mentioFor,
scope: scope
});
scope.$watch("items", function( items ) {
if ( items && items.length >= 0 ) {
scope.activate( items[0] );
if ( !scope.visible && scope.requestVisiblePendingSearch) {
scope.visible = true;
scope.requestVisiblePendingSearch = false;
}
triggerPopUnderMention();
} else {
scope.hideMenu();
}
});
scope.$watch("isVisible()", function( visible ) {
if ( visible ) {
triggerPopUnderMention();
}
});
function triggerPopUnderMention() {
var triggerCharSet = [];
triggerCharSet.push(scope.triggerChar);
mentionService.popUnderMention(
scope.parentMentio.context(),
triggerCharSet,
element,
scope.requireLeadingSpace,
textarea
);
}
scope.hideMenu = function() {
scope.visible = false;
element.css("display", "none");
};
scope.adjustScroll = function( direction ) {
var menuEl = element[0];
var menuItemsList = menuEl.querySelector("ul");
if ( !menuItemsList ) {
return;
}
var menuItem = (menuEl.querySelector("[inv-mention-menu-item].active") ||
menuEl.querySelector("[data-inv-mention-menu-item].active"));
if ( scope.isFirstItemActive() ) {
menuItemsList.scrollTop = 0;
return;
} else if ( scope.isLastItemActive() ) {
menuItemsList.scrollTop = menuItemsList.scrollHeight;
return;
}
if ( direction === 1 ) {
menuItemsList.scrollTop += menuItem.offsetHeight;
} else {
menuItemsList.scrollTop -= menuItem.offsetHeight;
}
};
function handleKeyEvent( event ) {
if ( !textarea.is(":focus") ) {
return;
}
var keyCode = event.which || event.keyCode;
if ( ! scope.visible || HOT_KEYS.indexOf( keyCode ) === -1 ) {
return;
}
event.preventDefault();
if ( keyCode === 9 || keyCode === 13 ) {
if(scope.isOverMentionCap(scope.activeItem.name)) {
scope.hideMenu();
return;
}
scope.selectActive();
return;
}
if ( keyCode === 27 ) {
scope.$apply(function() {
scope.hideMenu();
});
return;
}
if ( keyCode === 40 ) {
scope.$apply(function() {
scope.activateNextItem();
});
scope.adjustScroll(1);
return;
}
if ( keyCode === 38 ) {
scope.$apply(function() {
scope.activatePreviousItem();
});
scope.adjustScroll(-1);
return;
}
}
function handleClick( event ) {
if ( scope.visible ) {
scope.$apply(function() {
scope.hideMenu();
});
}
}
function handleResize() {
if ( scope.visible ) {
var triggerCharSet = [];
triggerCharSet.push( scope.triggerChar );
mentionService.popUnderMention(
scope.parentMentio.context(),
triggerCharSet,
element,
scope.requireLeadingSpace
);
}
}
function handleDestroy() {
scope.hideMenu();
textarea.off( "keydown paste", handleKeyEvent );
angular.element( $document ).off( "click", handleClick );
angular.element( $window ).off( "resize", handleResize );
}
}
});
}
})( angular );
;
;
/*! mention-menu-item.directive.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.directive( "invMentionMenuItem", mentionMenuItemDirective );
function mentionMenuItemDirective() {
return ({
restrict: "A",
scope: {
item: "=invMentionMenuItem"
},
require: "^invMentionMenu",
link: function( scope, element, attrs, controller ) {
scope.$watch(function() {
return controller.isActive( scope.item );
}, function( active ) {
if ( active ) {
element.addClass("active");
} else {
element.removeClass("active");
}
});
element.bind("mouseenter", function() {
if(!(controller.isOverMentionCap(scope.item.name)  && scope.item.role === "shortcut")) {
scope.$apply(function() {
controller.activate( scope.item );
});
}
});
element.bind("click", function() {
if(!(controller.isOverMentionCap(scope.item.name) && scope.item.role === "shortcut")) {
controller.selectItem( scope.item );
}
return false;
});
}
});
}
})( angular );
;
;
/*! candidates-partial.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.factory( "candidatesPartial", CandidatesPartialFactory );
function CandidatesPartialFactory( $http, $q, commentObjectService ) {
var data = {};
return {
data: data,
load: load
};
function load() {
var deferred = $q.defer();
getCandidates().then(
function handleResolve( partial ) {
setData( partial.candidates );
deferred.resolve();
},
function handleReject( response ) {
deferred.reject( response );
}
);
return( deferred.promise );
}
function getCandidates() {
var commentObject = commentObjectService.get();
var apiUrl = ["/api/mentions/candidates?"];
if ( commentObject.objectType === "project" ) {
apiUrl.push(
"projectID=",
commentObject.objectID,
"&conversationID=",
commentObject.conversationID
);
} else if ( commentObject.objectType === "board" ) {
apiUrl.push(
"boardID=",
commentObject.objectID,
"&boardItemID=",
commentObject.conversationID
);
}
apiUrl.push("&hasMentionShortcuts=true");
var request = $http.get( apiUrl.join("") );
return request.then(
function handleResolve( response ) {
return response.data;
},
function handleReject( errorResponse ) {
return $q.reject( unwrapErrorResponse( errorResponse ) );
}
);
}
function unwrapErrorResponse( errorResponse ) {
var response = {
code: -1,
id: -1
};
try {
response = ng.fromJson( errorResponse.data );
if ( ng.isString( response ) ) {
response.message = response;
}
} catch( error ) {
response.message = "Error: " + error;
}
return response;
}
function setData( partial ) {
return( data.candidates = partial );
}
function deleteData() {
delete( data.candidates );
}
}
})( angular );
;
;
/*! item-owner-partial.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.factory( "itemOwnerPartial", ItemOwnerPartial );
function ItemOwnerPartial(
_,
$q,
$http,
$rootScope
) {
var data = {
itemOwners: []
};
var bindings = [];
var pendingTrigger = false;
return {
get: get,
load: load,
addBinding: addBinding,
removeBinding: removeBinding
};
function get( itemID, type ) {
if ( !itemID ) {
return;
}
var existingItem = _.find(data.itemOwners, { itemID: itemID, type: type });
return ng.copy( existingItem );
}
function load( itemID, type ) {
var deferred = $q.defer();
if ( !itemID ) {
deferred.reject("Error: undefined itemID");
return deferred.promise;
}
getOwner( itemID, type ).then(
function handleResolve( partial ) {
setData( partial, itemID, type );
deferred.resolve();
triggerChange();
},
function handleReject( response ) {
deferred.reject( response );
}
);
return( deferred.promise );
}
function addBinding( handler, context ) {
bindings.push({
handler: handler,
context: ( context || null )
});
}
function removeBinding( handler, context ) {
bindings = _.reject(
bindings,
function operator( binding ) {
return(
( binding.handler === handler ) && 
( ! context || ( handler.context === context ) )
);
}
);
}
function getOwner( itemID, type ) {
var typeURLPart = type === "screen" ? "screens" : "board";
var urlParts = ["/api", typeURLPart, itemID, "owner"];
var request = $http({
method: "GET",
url: ( urlParts.join("/") )
});
return request.then(
function handleResolve( response ) {
return response.data;
},
function handleReject( errorResponse ) {
return $q.reject( unwrapErrorResponse( errorResponse ) );
}
);
}
function setData( partial, itemID, type ) {
var existingItem = _.find(data.itemOwners, { itemID: itemID, type: type });
if ( !!existingItem ) {
return;
}
else {
data.itemOwners.push({
itemID: itemID,
type: type,
id: partial.id,
name: partial.name,
avatarID: partial.avatarID,
email: partial.email
});
}
triggerChange();
}
function triggerChange() {
if ( pendingTrigger ) {
return;
}
pendingTrigger = true;
$rootScope.$evalAsync(
function async() {
pendingTrigger = false;
_.each(
bindings,
function iterator( binding ) {
binding.handler.call( binding.context );
}
);
}
);
}
function unwrapErrorResponse( errorResponse ) {
var response = {
code: -1,
id: -1
};
try {
response = ng.fromJson( errorResponse.data );
if ( ng.isString( response ) ) {
response.message = response;
}
} catch( error ) {
response.message = "Error: " + error;
}
return response;
}
}
})( angular );
;
;
/*! mention.service.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.factory( "mentionService", MentionService );
function MentionService(
_,
$window,
$document,
$log,
sessionService,
mentionStorage
) {
var MENTION_PATTERN = "(?:@|\\+)(\\[[^\\]]+?\\])";
var READABLE_MENTION_STRINGPATTERN = "(^|\\s)((?:\\+|@)[^\\s]*)";
var SQUARE_BRACKET_CONTENTS_PATTERN = /^\[([^\]]+?)\]$/;
var NAME_AND_ID_PATTERN = /(^[^\|]+?)(?:\|)(.+)$/;
var EMAIL_ADDRESS_PATTERN = /^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;
function popUnderMention( ctx, triggerCharSet, selectionEl, requireLeadingSpace, textarea ) {
var coordinates;
var mentionInfo = getTriggerInfo( ctx, triggerCharSet, requireLeadingSpace, false );
if ( ! mentionInfo ) {
selectionEl.css({
display: "none"
});
return;
}
coordinates = getTextAreaOrInputUnderlinePosition( ctx, getDocument(ctx).activeElement, mentionInfo.mentionPosition );
selectionEl.css({
top: coordinates.top + "px",
left: coordinates.left + "px",
position: "absolute",
display: "block"
});
$document.find( "body" ).append( selectionEl );
requestAnimationFrame( function() {
var box = getElementBoundingCoords( selectionEl );
var textareaCoords = getElementBoundingCoords( textarea );
if ( ! box || ! textareaCoords ) {
return;
}
var topOffset = box.height + 60;  
var newTop = coordinates.top - box.height;
if ( coordinates.top < topOffset ) {
newTop = textareaCoords.bottom + 30;
}
selectionEl.css({
top: newTop
});
});
}
function getElementBoundingCoords( element ) {
if ( !element ) {
return;
}
var clientRectangle;
var el = element[ 0 ];
while ( typeof clientRectangle === "undefined" || clientRectangle.height === 0 ) {
clientRectangle = el.getBoundingClientRect();
if ( clientRectangle.height === 0 ) {
el = el.childNodes[ 0 ];
}
if ( ! el || ! el.getBoundingClientRect ) {
return;
}
}
return clientRectangle;
}
function scrollIntoView( ctx, elem, clientRect ) {
var reasonableBuffer = 20;
var maxScrollDisplacement = 100;
var elemTop = clientRect.top;
var elemBottom = elemTop + clientRect.height;
if ( elemTop < 0 ) {
$window.scrollTo(0, $window.pageYOffset + clientRect.top - reasonableBuffer);
} else if (elemBottom > $window.innerHeight) {
var maxY = $window.pageYOffset + clientRect.top - reasonableBuffer;
if (maxY - $window.pageYOffset > maxScrollDisplacement) {
maxY = $window.pageYOffset + maxScrollDisplacement;
}
var targetY = $window.pageYOffset - ($window.innerHeight - elemBottom);
if (targetY > maxY) {
targetY = maxY;
}
$window.scrollTo(0, targetY);
}
}
/**
* Determines if the active element is an input or text area
*
* @returns {Bool} - true if it IS an input or text area
*/
function isSelectedElementTextAreaOrInput( ctx ) {
var element = getDocument( ctx ).activeElement;
var isTextAreaOrInput = false;
var nodeName;
var type;
if ( element !== null ) {
nodeName = element.nodeName;
type = element.getAttribute( "type" );
isTextAreaOrInput = ( nodeName === "INPUT" && type === "text" ) || nodeName === "TEXTAREA";
}
return isTextAreaOrInput;
}
function selectElement( ctx, targetElement, path, offset ) {
var range;
var elem = targetElement;
if (path) {
for (var i = 0; i < path.length; i++) {
elem = elem.childNodes[path[i]];
if (elem === undefined) {
return;
}
while (elem.length < offset) {
offset -= elem.length;
elem = elem.nextSibling;
}
if (elem.childNodes.length === 0 && !elem.length) {
elem = elem.previousSibling;
}
}
}
var sel = getWindowSelection(ctx);
range = getDocument(ctx).createRange();
range.setStart(elem, offset);
range.setEnd(elem, offset);
range.collapse(true);
try {
sel.removeAllRanges();
} catch ( error ) {
$log.error( error );
}
sel.addRange( range );
targetElement.focus();
}
function pasteHtml( ctx, html, startPos, endPos ) {
var range, sel;
sel = getWindowSelection(ctx);
range = getDocument(ctx).createRange();
range.setStart(sel.anchorNode, startPos);
range.setEnd(sel.anchorNode, endPos);
range.deleteContents();
var el = getDocument(ctx).createElement("div");
el.innerHTML = html;
var frag = getDocument(ctx).createDocumentFragment(),
node, lastNode;
while ((node = el.firstChild)) {
lastNode = frag.appendChild(node);
}
range.insertNode(frag);
if (lastNode) {
range = range.cloneRange();
range.setStartAfter(lastNode);
range.collapse(true);
sel.removeAllRanges();
sel.addRange(range);
}
}
function resetSelection( ctx, targetElement, path, offset ) {
var nodeName = targetElement.nodeName;
if ( nodeName === "INPUT" || nodeName === "TEXTAREA" ) {
if ( targetElement !== getDocument( ctx ).activeElement ) {
targetElement.focus();
}
} else {
selectElement( ctx, targetElement, path, offset );
}
}
/**
* Replaces the text inside of the selected text area or input
*/
function replaceInputText( element, text, startPos, endPos ) {
text = text || "";
var value = element.value;
var preText = value.substring( 0, startPos );
var postText = value.substring( endPos, value.length );
var selectionPos = startPos + text.length;
element.value = preText + text + postText;
element.selectionStart = selectionPos;
element.selectionEnd = selectionPos;
}
/**
* @returns {String} - all the people that will be mentioned
* e.g.: "@leonardo @donatello @michelangelo "
**/
function getInitialMentions() {
var mentions = mentionStorage.get();
var myID = sessionService.user.id;
mentions = _.filter(mentions, function(m) {
return m.userID !== myID;
});
var initialMentions = _.uniq( mentions, "text" );
initialMentions = initialMentions.map(function( value ) {
return value.text + " ";
}).join("");
mentions.forEach(function( mention ) {
mention.startPos = initialMentions.indexOf(mention.text);
});
mentionStorage.set( mentions );
return initialMentions;
}
/**
* Checks if text matches an already selected user pattern, expects
* the brackets around the mentions.
*
* @param {String} text - the text, including brackets, to search for user data
* @param {Boolean} formatDataForAPI - true if the data should be formatted for the API
* @returns {Object} the mention data
*/
function getMentionedUser( text, formatDataForAPI ) {
var results = SQUARE_BRACKET_CONTENTS_PATTERN.exec( text );
var returnObj = {};
var name;
var id;
var user;
var parsed;
var idString = formatDataForAPI === true ? "userID" : "id";
if ( ! results ) {
return;
}
user = results[ 1 ];
if ( isEmailAddress( user ) ) {
returnObj = {email: user, text: "+" + user};
return returnObj;
}
parsed = NAME_AND_ID_PATTERN.exec( user );
if ( ! parsed ) {
return;
}
name = parsed[ 1 ];
id = parsed[ 2 ];
returnObj = {
name: name,
text: "@" + name,
};
returnObj[idString] = id;
return returnObj;
}
/**
* Finds all mentions within a raw comment text
*/
function findAllMentions( rawCommentText, formatDataForAPI ) {
rawCommentText = rawCommentText || "";
var match;
var results = [];
var regexp = new RegExp( MENTION_PATTERN, "g" );
while ( match = regexp.exec( rawCommentText ) ) {
var data = getMentionedUser( match[ 1 ], formatDataForAPI );
data.startPos = match.index;
data.endPos = data.startPos + match[ 0 ].length;
results.push( data );
}
return results;
}
function parseMention( comment, mentions ) {
if ( ! mentions ) {
return comment;
}
var mentionText;
var mentionHTML;
var className;
var startPos;
var myUserID = sessionService.user.id;
var i = mentions.length;
while ( i-- ) {
mentionText = mentions[ i ].text;
startPos = mentions[ i ].startPos;
className = ( mentions[ i ].userID === myUserID ) ? "me-mentioned" : "mention-blue";
mentionHTML = "<span class=\"" + className + "\">" + mentionText + "</span>";
if ( comment.substr( startPos, mentionText.length ) === mentionText ) {
comment = comment.slice( 0, startPos ) + mentionHTML + comment.slice( startPos + mentionText.length );
}
}
return comment;
}
/**
* Checks if text is an e-mail address
*/
function isEmailAddress( text ) {
var email = EMAIL_ADDRESS_PATTERN;
return email.test( text );
}
function replaceTriggerText( ctx, targetElement, path, offset, triggerCharSet, text, requireLeadingSpace, hasTrailingSpace ) {
resetSelection( ctx, targetElement, path, offset );
var mentionInfo = getTriggerInfo(ctx, triggerCharSet, requireLeadingSpace, true, hasTrailingSpace);
if ( ! mentionInfo ) {
return;
}
var startPos = mentionInfo.mentionPosition;
var endPos = startPos + mentionInfo.mentionText.length + 1;
var element = getDocument( ctx ).activeElement;
text = text + " ";
replaceInputText( element, text, startPos, endPos );
return startPos;
}
function getNodePositionInParent( ctx, elem ) {
if (elem.parentNode === null) {
return 0;
}
for (var i = 0; i < elem.parentNode.childNodes.length; i++) {
var node = elem.parentNode.childNodes[i];
if (node === elem) {
return i;
}
}
}
/**
* Gets the last index of a mention starting with `character` found
* inside of `text`
*
* @param {String} text - text to search through
* @param {String} character - the mention starting character
* @returns {Integer} the index of the mention within text, or -1
*/
function regexpLastIndexOf( text, character ) {
/**
* Matches "@" at the beginning of a string OR following a space,
* so we can find things like "@brian" or " @brian" but not match
* "email me at brian@joe.com"
*/
var regexp = new RegExp( "(^|\\s)\\" + character + "[^\\s]*", "g" );
var lastIndex = -1;
var result;
while ( result = regexp.exec( text ) ) {
lastIndex = result.index;
if ( typeof result[1] === "string" ) {
lastIndex += result[1].length;
}
}
return lastIndex;
}
function getTriggerInfo( ctx, triggerCharSet, requireLeadingSpace, menuAlreadyActive, hasTrailingSpace ) {
/*jshint maxcomplexity:11 */
var mostRecentTriggerCharPos = -1; // I am the index position of the last trigger character
var effectiveRange; // I am all of the text to be parsed
var offset; // ??? I am only related to content editable
var path; // ??? I am only related to content editable
var selected; // I am the active element
var selectionInfo; // I hold data for when we are dealing with content editable
var triggerChar; // I (should be) the currently active trigger character
if ( isSelectedElementTextAreaOrInput( ctx ) ) {
selected = getDocument( ctx ).activeElement;
}
effectiveRange = getTextPrecedingCurrentSelection( ctx );
if ( !effectiveRange ) {
return;
}
triggerCharSet.forEach( function( c ) {
var idx = regexpLastIndexOf( effectiveRange, c );
if ( idx > mostRecentTriggerCharPos ) {
mostRecentTriggerCharPos = idx;
triggerChar = c;
}
});
/**
* If logic simplification
*/
var preceedingChar = effectiveRange.substring( mostRecentTriggerCharPos - 1, mostRecentTriggerCharPos );
var triggerCharExists = ~mostRecentTriggerCharPos;
var triggerCharIsValid = mostRecentTriggerCharPos === 0 || ! requireLeadingSpace || /[\xA0\s]/g.test( preceedingChar );
if ( ! triggerCharExists || ! triggerCharIsValid ) {
return;
}
var currentTriggerSnippet = effectiveRange
.substring( mostRecentTriggerCharPos + 1, effectiveRange.length );
if ( hasTrailingSpace ) {
currentTriggerSnippet = currentTriggerSnippet.trim();
}
var doesNotHaveASpace = ! /[\xA0\s]/g.test(currentTriggerSnippet);
var isValid = currentTriggerSnippet.length >= 0 && doesNotHaveASpace;
if ( isValid ) {
return {
mentionPosition: mostRecentTriggerCharPos,
mentionText: currentTriggerSnippet,
mentionSelectedElement: selected,
mentionSelectedPath: path,
mentionSelectedOffset: offset,
mentionTriggerChar: triggerChar
};
}
}
function getWindowSelection( ctx ) {
if (!ctx) {
return window.getSelection();
} else {
return ctx.iframe.contentWindow.getSelection();
}
}
function getDocument( ctx ) {
if (!ctx) {
return document;
} else {
return ctx.iframe.contentWindow.document;
}
}
/**
* Gets all of the text in the input that comes before the cursor's
* current position.
*/
function getTextPrecedingCurrentSelection( ctx ) {
var text;
if (isSelectedElementTextAreaOrInput(ctx)) {
var textComponent = getDocument(ctx).activeElement;
var startPos = textComponent.selectionStart;
text = textComponent.value.substring(0, startPos);
} else {
var selectedElem = getWindowSelection(ctx).anchorNode;
if ( selectedElem !== null ) {
var workingNodeContent = selectedElem.textContent;
var selectStartOffset = getWindowSelection(ctx).getRangeAt(0).startOffset;
if ( selectStartOffset >= 0 ) {
text = workingNodeContent.substring( 0, selectStartOffset );
}
}
}
return text;
}
function localToGlobalCoordinates( ctx, element, coordinates ) {
var iframe = ctx ? ctx.iframe : null;
var obj = element;
var body = getDocument().body;
coordinates.top += obj.scrollTop;
while ( obj ) {
coordinates.left += obj.offsetLeft + obj.clientLeft;
coordinates.top += obj.offsetTop + obj.clientTop;
obj = obj.offsetParent;
if ( ! obj && iframe ) {
obj = iframe;
iframe = null;
}
}
obj = element;
iframe = ctx ? ctx.iframe : null;
while ( obj !== body ) {
if ( obj.scrollTop && obj.scrollTop > 0 ) {
coordinates.top -= obj.scrollTop;
}
if ( obj.scrollLeft && obj.scrollLeft > 0 ) {
coordinates.left -= obj.scrollLeft;
}
obj = obj.parentNode;
if ( ! obj && iframe ) {
obj = iframe;
iframe = null;
}
}
}
function getTextAreaOrInputUnderlinePosition( ctx, element, position ) {
var coordinates = {top: 0, left: 0};
localToGlobalCoordinates(ctx, element, coordinates);
return coordinates;
}
return {
popUnderMention: popUnderMention,
replaceTriggerText: replaceTriggerText,
getTriggerInfo: getTriggerInfo,
selectElement: selectElement,
replaceInputText: replaceInputText,
isEmailAddress: isEmailAddress,
getMentionedUser: getMentionedUser,
findAllMentions: findAllMentions,
parseMention: parseMention,
getInitialMentions: getInitialMentions,
getTextAreaOrInputUnderlinePosition: getTextAreaOrInputUnderlinePosition,
getTextPrecedingCurrentSelection: getTextPrecedingCurrentSelection,
getNodePositionInParent: getNodePositionInParent,
pasteHtml: pasteHtml,
resetSelection: resetSelection,
scrollIntoView: scrollIntoView
};
}
})( angular );
;
;
/*! mentions-store.js */ 
;
;
(function( ng, app) {
"use strict";
app.factory( "mentionsStore", MentionsStoreFactory );
var nextGetterID = 0;
function MentionsStoreFactory(
$http,
$q,
_,
appSettings,
clientEvents,
sessionService
) {
var state = {
isLoading: false
};
resetMentionData();
var getters = {};
/**
* Sets the state mention data to default (empty) values. Called on
* instantiation and any time we need to reset the mention data.
*/
function resetMentionData() {
state.mentions = [];
state.mentionsByID = {};
state.mentionsByProjectID = {};
state.mentionsByCommentID = {};
state.mentionsByConversationID = {};
state.mentionsByUserID = {};
state.mentionsByScreenID = {};
state.mentionsCount = 0;
}
clientEvents
.forNamespace( "inboxMentionsPartial" )
.add( "inbox.project.markedRead", handleProjectMarkedRead )
.add( "inbox.conversation.commentDeleted", handleCommentDeleted )
.add( "inbox.conversation.deleted", handleConversationDeleted )
.add( "inbox.conversation.markedRead", handleConversationMarkedRead )
.add( "allInboxNotificationsMarkedRead", handleAllNotificationsMarkedRead );
/**
* I handle the event when all notifications for a project have
* been marked read.
*
* @param {Event} event - the event data
* @param {Object} data - the custom payload of data about the event
*/
function handleProjectMarkedRead( event, data ) {
var projectID = data.projectID;
removeAllMentionsForProject( projectID );
}
/**
* I handle the event when a comment has been deleted.
*
* @param {Event} event - the event data
* @param {Object} data - the custom payload of data about the event
*/
function handleCommentDeleted( event, data ) {
var commentID = data.commentID;
removeAllMentionsForComment( commentID );
}
/**
* I handle the event when a conversation has been deleted.
*
* @param {Event} event - the event data
* @param {Object} data - the custom payload of data about the event
*/
function handleConversationDeleted( event, data ) {
var conversationID = data.conversationID;
removeAllMentionsForConversation( conversationID );
}
/**
* I handle the event when a conversation has been marked read.
*
* @param {Event} event - the event data
* @param {Object} data - the custom payload of data about the event
*/
function handleConversationMarkedRead( event, data ) {
var conversationID = data.conversationID;
removeAllMentionsForConversation( conversationID );
}
/**
* I handle the event when all notifications have been marked read.
*/
function handleAllNotificationsMarkedRead() {
resetMentionData();
callGetters();
}
/**
* @TODO: MAKE THIS A PROTOTYPE METHOD
* I add the specified getterFunction to the list of getters, bound
* to context, and return the ID of the getter
*
* @param {Function} getterFunction - the getter to be executed on state change
* @param {Context} context - the context to bind getterFunction to
* @returns {Integer} the id of the getter, for reference later
*/
function addGetter( getterFunction, context ) {
getters[nextGetterID] = {
handler: getterFunction,
context: context
};
return nextGetterID++;
}
/**
* @TODO: MAKE THIS A PROTOTYPE METHOD
* Removes the getter, specified by getterID, from the map of
* getters
*
* @param {Integer} getterID - the id of the getter to remove
*/
function removeGetterByID( getterID ) {
delete getters[getterID];
}
/**
* @TODO: MAKE THIS A PROTOTYPE METHOD
* Removes any getters which match the handler and context, or if
* no context is provided, removes any getters which match the
* handler.
*
* @param {Function} handler - the handler
* @param {Context} context - the context that is bound to handler
*/
function removeGetter( handler, context ) {
getters = _.reject( getters, function operator( getter, id ) {
var isHandler = getter.handler === handler;
var isContext = ! context || getter.context === context;
return isHandler && isContext;
});
}
/**
* @TODO: MAKE THIS A PROTOTYPE METHOD
* Iterates over all of the getters, calling them with the correct
* context and passing the current value of state.
*/
function callGetters() {
_.each( getters, function iterator( getter ) {
getter.handler.call( getter.context, state );
});
}
/**
* @TODO: MAKE THIS A PROTOTYPE METHOD
* We expect the server to return an object, but if there is a
* server-side error or something unexpected, we want to ensure
* that the error message is normalized.
*
* @param {Object|String} error - the error object or string
* @returns {Object} the error object
*/
function normalizeError( error ) {
if ( _.isString( error ) ) {
error = {
message: error,
code: -1
};
}
return error;
}
/**
* @TODO: MAKE THIS A PROTOTYPE METHOD
* Normalize the HTTP response to separate the HTTP structure from
* the data expected by the calling context
*
* @param {Promise} $httpPromise - the promise created by calling $http.verb
* @returns {Promise} the modified promise
*/
function normalizeHttpResponse( $httpPromise ) {
return $httpPromise.then(
function handleResolve( response ) {
return response.data;
},
function handleReject( response ) {
return $q.reject( normalizeError( response.data ) );
}
);
}
/**
* @TODO: MAKE THIS A PROTOTYPE METHOD
* Initiates the grabbing of the mention data from the API and
* returns a promise for that request
*
* @returns {Promise} the promise for the GET request
*/
function loadData() {
var subscriptionsEnabled = appSettings.getSettings().features.projectNotificationPreferences;
var endpoint = subscriptionsEnabled ?
"/api/partials/desktop/inbox/notifications/get-notification-badges" :
"/api/mentions/unread";
var request = $http.get(endpoint);
return normalizeHttpResponse( request );
}
/**
* Assigns the mention data to the state. Also, loops over all the
* mentions and assigns mentions by id, screen id, project id,
* comment id, and conversation id in a memory efficient way by
* referencing the already defined mention. This allows us to very
* efficiently and easily map mentions to other data.
*
* @param {Array} mentions - the mention data to be set on the state
*/
function parseMentionData( mentions ) {
var mentionIndex = 0;
state.mentions = mentions.mentions;
_.forEach( state.mentions, function( mention ) {
mentionIndex++;
mention.id = mentionIndex;
state.mentionsCount = mentionIndex;
state.mentionsByID[ mention.id ] = mention;
addMentionToMap( "mentionsByProjectID", mention.projectID, mention );
addMentionToMap( "mentionsByCommentID", mention.commentID, mention );
addMentionToMap( "mentionsByConversationID", mention.conversationID, mention );
addMentionToMap( "mentionsByUserID", mention.userID, mention );
addMentionToMap( "mentionsByScreenID", mention.screenID, mention );
});
};
/**
* Adds a mention to the specified map, also ensuring that the
* map is defined, and creating it if it is not yet defined. This
* is basically a utility method used by parseMentionData above.
*
* @param {String} mapName - the name of the map to add the mention to
* @param {Integer} key - the key (id) where the mention should get added
* @param {Object} mention - the mention to be added to the map
*/
function addMentionToMap( mapName, key, mention ) {
if ( ! key ) {
return;
}
state[ mapName ][ key ] = state[ mapName ][ key ] || {count: 0, mentions: {}};
state[ mapName ][ key ].count++;
state[ mapName ][ key ].mentions[ mention.id ] = mention;
}
/**
* Gets all of the mentions for the currently logged-in user
*
* @returns {Object} - a map of {count: N, mentions: {...}}
*/
function getAllMyMentions() {
var myID = sessionService.user.id;
return getAllMentionsByUserID( myID ) || {count: 0, mentions: {}};
}
/**
* Gets all mentions by user id
*
* @param {Integer} id - user id
* @returns {Object|Undefined} mention map or undefined
*/
function getAllMentionsByUserID( id ) {
return state.mentionsByUserID[ id ];
}
/**
* Gets all mentions by screen id
*
* @param {Integer} id - screen id
* @returns {Object|Undefined} mention map or undefined
*/
function getAllMentionsByScreenID( id ) {
return state.mentionsByScreenID[ id ];
}
/**
* Gets all mentions by project id
*
* @param {Integer} id - project id
* @returns {Object|Undefined} mention map or undefined
*/
function getAllMentionsByProjectID( id ) {
return state.mentionsByProjectID[ id ];
}
/**
* Gets all mentions by comment id
*
* @param {Integer} id - comment id
* @returns {Object|Undefined} mention map or undefined
*/
function getAllMentionsByCommentID( id ) {
return state.mentionsByCommentID[ id ];
}
/**
* Gets all mentions by conversation id
*
* @param {Integer} id - conversation id
* @returns {Object|Undefined} mention map or undefined
*/
function getAllMentionsByConversationID( id ) {
return state.mentionsByConversationID[ id ];
}
/**
* Gets a mention by mention id
*
* @param {Integer} id - the id value to search for in the map
* @returns {Object|Undefined} mention or undefined
*/
function getMentionByID( id ) {
return state.mentionsByID[ id ];
}
/**
* Gets all mentions formatted for my-mentions API
*
* @returns {Object|Undefined} mention map or undefined
*/
function getMyMentionsCommentIDs() {
var myMentions = getAllMyMentions();
if ( !myMentions ) {
return;
}
var val, prop;
var tempObj = {
commentIDs: {
prototypeComments: [],
boardComments: []
}
};
for ( prop in myMentions.mentions ) {
if ( myMentions.mentions.hasOwnProperty( prop ) ) {
val = myMentions.mentions[ prop ];
if ( val.mentionCommentType === "screen" ) {
tempObj.commentIDs.prototypeComments.push( val.commentID );
} else if ( val.mentionCommentType === "board_item" ) {
tempObj.commentIDs.boardComments.push( val.commentID );
}
}
}
return tempObj;
}
/**
* Purges a mention from the state, removing it from every list
* where it's referenced. This is useful for when a mention has
* been "read" on the client side.
*
* @param {Object|Integer} mention - the mention, or id of the mention to remove
*/
function purgeMention( mention ) {
if ( _.isNumber( mention ) ) {
mention = getMentionByID( id );
}
if ( ! mention ) {
return;
}
var id = mention.id;
state.mentionsCount--;
delete state.mentionsByID[ id ];
removeMentionFromUser( mention.userID, id );
removeMentionFromProject( mention.projectID, id );
removeMentionFromComment( mention.commentID, id );
removeMentionFromConversation( mention.conversationID, id );
removeMentionFromScreen( mention.screenID, id );
}
/**
* Removes all mentions for a particular conversation. Used when an
* entire conversation has been marked read.
*
* @param {Integer} conversationID - the id of the conversation
*/
function removeAllMentionsForConversation( conversationID ) {
removeAllMentionsFromMap( getAllMentionsByConversationID, conversationID );
}
/**
* Removes all mentions for a particular comment. Used when an
* entire comment has been marked read.
*
* @param {Integer} commentID - the id of the comment
*/
function removeAllMentionsForComment( commentID ) {
removeAllMentionsFromMap( getAllMentionsByCommentID, commentID );
}
/**
* Removes all mentions for a particular project. Used when an
* entire project has been marked read.
*
* @param {Integer} projectID - the id of the project
*/
function removeAllMentionsForProject( projectID ) {
removeAllMentionsFromMap( getAllMentionsByProjectID, projectID );
}
/**
* Removes all mentions for a particular user.
*
* @param {Integer} userID - the id of the user
*/
function removeAllMentionsForUser( userID ) {
removeAllMentionsFromMap( getAllMentionsByUserID, userID );
}
/**
* Removes all mentions for a particular screen.
*
* @param {Integer} screenID - the id of the screen
*/
function removeAllMentionsForScreen( screenID ) {
removeAllMentionsFromMap( getAllMentionsByScreenID, screenID );
}
/**
* Proxied by other methods to normalize/DRY code. Gets a map of
* mentions by passing mapID to the specified getMentionsMethod,
* looping over each of the returned mentions and calling the
* purgeMention method for each. Calls callGetters on completion.
*
* @param {Function} getMentionsMethod - the method to get the mentions list
* @param {Integer} mapID - the id value to pass to getMentionsMethod
*/
function removeAllMentionsFromMap( getMentionsMethod, mapID ) {
var mentionsMap = getMentionsMethod( mapID );
if ( ! mentionsMap ) {
return;
}
_.forEach( mentionsMap.mentions, purgeMention );
callGetters();
}
/**
* Proxy for removeMentionFor map that removes from the list of
* mentions by user id.
*
* @param {Integer} userID - the id of the user
* @param {Integer} mentionID - the id of the mention to remove
*/
function removeMentionFromUser( userID, mentionID ) {
removeMentionFromMap( "mentionsByUserID", userID, mentionID );
}
/**
* Proxy for removeMentionFor map that removes from the list of
* mentions by screen id.
*
* @param {Integer} screenID - the id of the screen
* @param {Integer} mentionID - the id of the mention to remove
*/
function removeMentionFromScreen( screenID, mentionID ) {
removeMentionFromMap( "mentionsByScreenID", screenID, mentionID );
}
/**
* Proxy for removeMentionFor map that removes from the list of
* mentions by project id.
*
* @param {Integer} projectID - the id of the project
* @param {Integer} mentionID - the id of the mention to remove
*/
function removeMentionFromProject( projectID, mentionID ) {
removeMentionFromMap( "mentionsByProjectID", projectID, mentionID );
}
/**
* Proxy for removeMentionFor map that removes from the list of
* mentions by comment id.
*
* @param {Integer} commentID - the id of the comment
* @param {Integer} mentionID - the id of the mention to remove
*/
function removeMentionFromComment( commentID, mentionID ) {
removeMentionFromMap( "mentionsByCommentID", commentID, mentionID );
}
/**
* Proxy for removeMentionFor map that removes from the list of
* mentions by conversation id.
*
* @param {Integer} conversationID - the id of the conversation
* @param {Integer} mentionID - the id of the mention to remove
*/
function removeMentionFromConversation( conversationID, mentionID ) {
removeMentionFromMap( "mentionsByConversationID", conversationID, mentionID );
}
/**
* Utility function, proxied by other methods to normalize and DRY
* up the code for deleting a mention from a map within state, such
* as mentionsByCommentID or mentionsByProjectID.
*
* @param {String} type - the map type to delete the mention from,
*   one of mentionsByScreenID, mentionsByProjectID, mentionsByCommentID,
*   or mentionsByConversationID
* @param {Integer} typeID - the id of the map type that holds the mention
* @param {Integer} mentionID - the id of the mention to remove
*/
function removeMentionFromMap( type, typeID, mentionID ) {
var map = state[ type ][ typeID ];
delete map.mentions[ mentionID ];
map.count--;
}
function get() {
return state;
}
function load() {
if ( state.isLoading ) {
return;
}
var deferred = $q.defer();
loadData().then(
function handleResolve( mentions ) {
state.isLoading = false;
resetMentionData();
parseMentionData( mentions );
callGetters();
deferred.resolve();
},
function handleReject( response ) {
state.isLoading = false;
deferred.reject( response );
}
);
return deferred.promise;
}
return {
load: load,
get: get,
addGetter: addGetter,
removeGetter: removeGetter,
removeGetterByID: removeGetterByID,
getAllMyMentions: getAllMyMentions,
getMyMentionsCommentIDs: getMyMentionsCommentIDs,
getAllMentionsByScreenID: getAllMentionsByScreenID
};
}
})( angular, InVision );
;
;
/*! mention-storage.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.factory( "mentionStorage", MentionStorage );
function MentionStorage(
_,
mentionUtilityService,
modelEvents,
sessionService
) {
var mentions = [];
var owner = {};
var watchers = [];
return {
load: load,
get: get,
getWhoIsNotified: getWhoIsNotified,
set: set,
insert: insert,
removeMention: removeMention,
setOwner: setOwner,
setWatchers: setWatchers,
destroy: destroy
};
function load() {
flush();
}
function get() {
return ng.copy( mentions );
}
function getWhoIsNotified() {
var currentMentions = getMentions();
var splitMentions = _.partition(currentMentions, function(o) { return o.userID; });
var uniqueEmails = _.uniq(splitMentions[1], "email");
return uniqueEmails.concat(_.uniq(splitMentions[0], "userID"));
}
function set( newMentions ) {
mentions = _.uniq( ng.copy( newMentions ) || [] );
modelEvents.trigger("MentionStorageUpdated");
}
function insert( person, startPos ) {
if ( ! person ) {
return;
}
var people = [].concat( person );
var text;
var item;
var newMention;
var i = 0;
var nodes = people.length;
var acceptDupes = ( startPos >= 0 );
for ( ; i < nodes; i++ ) {
item = people[ i ];
if ( ! mentionUtilityService.isNewMention( item, mentions, acceptDupes ) ) {
continue;
}
if ( item.email && ! item.id ) {
text = "+" + item.email;
} else {
text = item.text || "@" + item.name.replace(/\s/g, "");
}
newMention = {
userID: item.userID || item.id,
text: text,
name: item.name,
startPos: item.startPos || startPos
};
if ( ! mentionExists( newMention ) ) {
mentions.push( newMention );
}
}
modelEvents.trigger("MentionStorageUpdated");
}
function removeMention( text, startPos ) {
var itemID = _.findIndex( mentions, { "startPos": startPos } );
if ( itemID >= 0 ) {
mentions.splice( itemID, 1 );
modelEvents.trigger("MentionStorageUpdated");
}
}
function setOwner( item ) {
if ( ! item ) {
return;
}
owner = item;
modelEvents.trigger("MentionStorageUpdated");
}
function setWatchers( items ) {
if ( _.isEmpty( items ) ) {
return;
}
watchers = items;
modelEvents.trigger("MentionStorageUpdated");
}
function destroy() {
flush();
}
function getMentions() {
if ( _.isEmpty( owner ) && _.isEmpty( watchers ) ) {
return mentions;
}
if ( watchers.length ) {
return mentions.concat( watchers );
}
if ( hasItemOwner() ) {
return mentions;
}
var user = sessionService.user;
if ( +owner.id === user.id ) {
return mentions;
}
var returnedOwner = ng.copy( owner );
returnedOwner.name += " (screen owner)";
return mentions.concat( returnedOwner );
}
function mentionExists( newMention ) {
return ( _.findIndex(mentions, function( m ) {
var matching = m.text === newMention.text &&
m.startPos === newMention.startPos;
if ( newMention.userID !== undefined ) {
return matching && newMention.userID === m.userID;
} else {
return matching && newMention.email === m.email;
}
}) > -1 );
}
function flush() {
mentions.length = 0;
}
/*
* I check if mentions array already contains the screenOnwer
* @return {Boolean}
*/
function hasItemOwner() {
var matches = mentions.filter( function( mention ) {
return mention.userID === owner.id;
});
return ( matches.length > 0 );
}
}
})( angular );
;
;
/*! mention-utility.directive.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.factory( "mentionUtilityService", MentionUtilityService );
function MentionUtilityService(
_,		
sessionService
) {
return {
isNewMention: isNewMention,
getMyMentions: getMyMentions,
getUserDetails: getUserDetails
};
/*
** I check if the passed item can be a new mention
** @param {Object} item
** @param {Boolean} acceptDupes - if true, don't check possible duplicates
** @return {Boolean}
*/
function isNewMention( item, mentions, acceptDupes ) {
var userID = item.userID || item.id;
if ( sessionService.user.id === userID ) {
return false;
}
if ( acceptDupes ) {
return true;
}
if ( _.some( mentions, { "userID": userID } ) ) {
return false;
}
return true;
}
/*
** I parse all the passed mentions
** removing duplicates and the current user
** @return {Boolean}
*/
function getMyMentions() {
var args = _.flatten( [].slice.call( arguments ) );
var myMentions = [];
_.forEach( args, function( value, key ) {	
if ( isNewMention( value, myMentions ) ) {
myMentions.push( value );
}
} );
return _.uniq( myMentions, "text" );
}
function getUserDetails( comment ) {
if ( _.isEmpty( comment ) ) {
return {};
}
if ( comment.user ) {
return comment.user;
}
return {
userID: comment.userID,
name: comment.userName
};
}
}
})( angular );
;
;
/*! project-watchers-partial.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.factory( "projectWatchersPartial", ProjectWatchersPartial )
;
function ProjectWatchersPartial(
$http,
$q,
$rootScope,
_
) {
var projectWatchersData = {
watchers: []
};
var bindings = [];
var pendingTrigger = false;
return {
get: get,
load: load,
addBinding: addBinding,
removeBinding: removeBinding
};
function get( projectID ) {
if ( !projectID ) {
return [];
}
var existingWatchers = _.filter( projectWatchersData.watchers, function( i ) {
return i.projectID === projectID;
});
return ng.copy( existingWatchers );
}
function load( projectID ) {
var deferred = $q.defer();
if ( !projectID ) {
deferred.reject("Error: undefined itemID");
return deferred.promise;
}
getWatchers( projectID ).then(
function handleResolve( partial ) {
setData( partial, projectID );
deferred.resolve();
triggerChange();
},
function handleReject( response ) {
deferred.reject( response );
}
);
return( deferred.promise );
}
function addBinding( handler, context ) {
bindings.push({
handler: handler,
context: ( context || null )
});
}
function removeBinding( handler, context ) {
bindings = _.reject(
bindings,
function operator( binding ) {
return(
( binding.handler === handler ) && 
( ! context || ( handler.context === context ) )
);
}
);
}
function getWatchers( projectID ) {
var urlParts = [
"/api/conversations/project-watchers",
projectID
];
var request = $http({
method: "GET",
url: ( urlParts.join("/") )
});
return request.then(
function handleResolve( response ) {
return response.data;
},
function handleReject( errorResponse ) {
return $q.reject( unwrapErrorResponse( errorResponse ) );
}
);
}
function setData( partial, projectID ) {
var existingItem = _.find( projectWatchersData.watchers, { projectID: projectID });
if ( !!existingItem ) {
return;
}
else {
_.forEach( partial.watchers, function( value ) {
projectWatchersData.watchers.push({
projectID: projectID,
userID: value.id,
name: value.name
});
});
}
triggerChange();
}
function triggerChange() {
if ( pendingTrigger ) {
return;
}
pendingTrigger = true;
$rootScope.$evalAsync(
function async() {
pendingTrigger = false;
_.each(
bindings,
function iterator( binding ) {
binding.handler.call( binding.context );
}
);
}
);
}
function unwrapErrorResponse( errorResponse ) {
var response = {
code: -1,
id: -1
};
try {
response = ng.fromJson( errorResponse.data );
if ( ng.isString( response ) ) {
response.message = response;
}
} catch( error ) {
response.message = "Error: " + error;
}
return response;
}
}
})( angular );
;
;
/*! mention-text.controller.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.controller( "mention.TextController", textController )
;
function textController(
$attrs,
$scope,
$timeout,
_,
appSettings,
mentionService
) {
var props = $scope.props = $scope;
props.query = function( mentionInfo ) {
var remoteScope = props.triggerCharMap[mentionInfo.mentionTriggerChar];
if ( props.trimTerm === undefined || props.trimTerm ) {
mentionInfo.mentionText = mentionInfo.mentionText.trim();
}
remoteScope.showMenu();
remoteScope.search({
mentionInfo: mentionInfo
});
remoteScope.typedTerm = mentionInfo.mentionText;
};
props.defaultSearch = function( mentionInfo ) {
var results = [];
var term = mentionInfo.mentionText || "";
var itNeedsToBeReplaced;
_.forEach( props.items, function( item ) {
var text = item.name.toUpperCase() + item.surname.toUpperCase();
if ( ~text.indexOf( term.toUpperCase() ) ) {
results.push( item );
}
});
itNeedsToBeReplaced = mentionInfo.mentionTriggerChar === "@" && results.length < 1 && term.length > 2;
if ( itNeedsToBeReplaced ) {
var element = mentionInfo.mentionSelectedElement;
var text = "+" + term;
var startPos = mentionInfo.mentionPosition;
var endPos = startPos + text.length;
mentionService.replaceInputText( element, text, startPos, endPos );
}
props.localItems = results;
};
props.bridgeSearch = function( mentionInfo ) {
var searchFn = $attrs.mentioSearch ? props.search : props.defaultSearch;
searchFn( mentionInfo );
};
props.defaultSelect = function( locals ) {
var character = props.defaultTriggerChar;
if ( locals.item.label) {
return handleNewUserAdd( locals.item.label );
}
return character + locals.item.name + locals.item.surname;
};
function handleNewUserAdd( text ) {
if ( ! mentionService.isEmailAddress( text ) ) {
return "notemail";
}
return "+" + text;
}
props.bridgeSelect = function(itemVar) {
var selectFn = $attrs.mentioSelect ? props.select : props.defaultSelect;
return selectFn({
item: itemVar
});
};
props.setTriggerText = function( text ) {
if ( props.syncTriggerText ) {
props.typedTerm = (props.trimTerm === undefined || props.trimTerm) ? text.trim() : text;
}
};
props.context = function() {
};
props.replaceText = function( text, hasTrailingSpace, hideAll ) {
if ( hideAll === undefined || hideAll ) {
props.hideAll();
}
var startPos = mentionService.replaceTriggerText(
props.context(),
props.targetElement,
props.targetElementPath,
props.targetElementSelectedOffset,
props.triggerCharSet,
text,
props.requireLeadingSpace,
hasTrailingSpace
);
if ( !hasTrailingSpace ) {
props.setTriggerText('');
angular.element( props.targetElement ).triggerHandler('change');
if ( props.isContentEditable() ) {
props.contentEditableMenuPasted = true;
var timer = $timeout(function() {
props.contentEditableMenuPasted = false;
}, 200);
props.$on('$destroy', function() {
$timeout.cancel(timer);
});
}
}
return startPos;
};
props.hideAll = function() {
for ( var key in props.triggerCharMap ) {
if ( props.triggerCharMap.hasOwnProperty(key) ) {
props.triggerCharMap[key].hideMenu();
}
}
};
props.selectActive = function() {
var key = findVisibleKey( props.triggerCharMap );
key && key.selectActive();
};
props.isActive = function() {
var key = findVisibleKey( props.triggerCharMap );
return !! key;
};
props.isContentEditable = function() {
return (props.targetElement.nodeName !== 'INPUT' && props.targetElement.nodeName !== 'TEXTAREA');
};
props.addMenu = function( menuScope ) {
if ( menuScope.parentScope && props.triggerCharMap.hasOwnProperty(menuScope.triggerChar) ) {
return;
}
props.triggerCharMap[menuScope.triggerChar] = menuScope;
props.triggerCharMap['+'] = menuScope;
if (props.triggerCharSet === undefined) {
props.triggerCharSet = [];
}
props.triggerCharSet.push(menuScope.triggerChar, "+");
menuScope.setParent(props);
};
props.$on(
"menuCreated", function( event, data ) {
if ( $attrs.uid && $attrs.uid === data.targetElement ) {
props.addMenu( data.scope );
}
}
);
}
function findVisibleKey( map ) {
for ( var key in map ) {
if ( map.hasOwnProperty( key ) && map[key].visible ) {
return map[key];
}
}
return null;
}
})( angular );
;
;
/*! mention-text.directive.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.directive( "invMentionText", mentionTextDirective )
;
function mentionTextDirective(
$document,
$log,
$timeout,
appSettings,
candidatesPartial,
clientEvents,
config,
mentionService,
mentionStorage,
mentionUtilities
) {
return ({
restrict: "A",
controller: "mention.TextController",
controllerAs: "vm",
scope: {
uid: "=uid",
ngModel: "=",
typedTerm: "=mentioTypedTerm",
requireLeadingSpace: "=mentioRequireLeadingSpace",
trimTerm: "=mentioTrimTerm",
hasWhoIsNotified: "@hasWhoIsNotified",
hasMentions: "=hasMentions",
hasMentionShortcut: "@hasMentionShortcut"
},
link: linkFunction
});
function linkFunction( scope, element, attrs, controller ) {
scope.triggerCharMap = {};
scope.targetElement = element;
attrs.$set("autocomplete", "off");
var mentions = "";
var pendingMentionsUpdate = null;
var hasExistingMentions = false;
var firstEdit = true;
var hasMentionShortcut = appSettings.getSettings().features.mentionShortcut;
clientEvents
.forNamespace( "mention" )
.add( "mention.addOthers", handleAddOthers )
;
if (scope.hasMentions) {
scope.$watch( "ngModel", handleWatch );
}
scope.$on( "$destroy", handleDestroy );
initialize();
function initialize() {
if ( !scope.hasMentions || scope.ngModel && scope.ngModel.length ) {
return;
}
$timeout(function setCommentMentions() {
mentions = mentionService.getInitialMentions();
scope.ngModel = mentions;
focusElement();
});
}
function handleAddOthers( event, data ) {
if ( attrs.uid && attrs.uid === data.targetElement ) {
scope.ngModel = ( typeof scope.ngModel === "undefined" ) ? " @" : scope.ngModel + " @";
$timeout(function initWatch() {
focusElement();
handleWatch( scope.ngModel );
}, 1);
}
}
function updateMentions( newValue ) {
var hasConversation = hasMentionShortcut && !config.featureFlags["prototypes-rain-690-sunset-conversation"];
var mentionsData = mentionUtilities.findMentions(
newValue,
{
existingMentions: mentionStorage.get(),
candidates: candidatesPartial.data.candidates.candidates,
members: hasMentionShortcut ? candidatesPartial.data.candidates.members : [],
conversationMembers: hasConversation ? candidatesPartial.data.candidates.conversationMembers : [],
debug: false
}
);
mentionStorage.set( mentionsData );
hasExistingMentions = !!mentionsData.length;
}
function handleWatch( newValue, oldValue ) {
if ( newValue === oldValue || ( newValue === mentions && newValue !== "" ) ) {
return;
}
if ( firstEdit ) {
scope.$emit( "mentionText.editing", true );
firstEdit = false;
}
if ( !newValue ) {
scope.$emit( "mentionText.editing", false );
firstEdit = true;
}
var isActive = scope.isActive();
if ( ! scope.triggerCharSet ) {
$log.error("Error, no mention-items attribute was provided" );
return;
}
if (pendingMentionsUpdate) {
clearTimeout(pendingMentionsUpdate);
}
pendingMentionsUpdate = setTimeout( function() {
updateMentions( newValue );
pendingMentionsUpdate = null;
}, 250);
if ( hasExistingMentions ) {
var mentionsToCheck = mentionStorage.get();
document.activeElement.value = mentionUtilities.replaceMalformedEmails(newValue, mentionsToCheck);
}
var mentionInfo = mentionService.getTriggerInfo(
scope.context(),
scope.triggerCharSet,
scope.requireLeadingSpace,
isActive
);
if ( mentionInfo ) {
mentionInfo.mentionText = mentionInfo.mentionText.replace( /[^a-zA-Z0-9]+$/, "" );
}
/**
* content editable selection changes to local nodes which
* modifies the start position of the selection over time,
* just consider triggerchar changes which
* will have the odd effect that deleting a trigger char pops
* the menu for a previous
* trigger char sequence if one exists in a content editable
**/
var isContentEditable = scope.isContentEditable();
var mentionPositionMatches = mentionInfo && mentionInfo.mentionPosition === scope.currentMentionPosition;
var alreadyTriggeredFromInput = ! isContentEditable && mentionPositionMatches;
var triggerCharMatches = mentionInfo && mentionInfo.mentionTriggerChar === scope.currentMentionTriggerChar;
var alreadyTriggeredFromContentEditable = isContentEditable && triggerCharMatches;
var alreadyTriggered = isActive && ( alreadyTriggeredFromContentEditable || alreadyTriggeredFromInput );
var isNewOrAlreadyTriggered = ! isActive || alreadyTriggered;
if ( mentionInfo && isNewOrAlreadyTriggered ) {
/** save selection info about the target control for later re-selection */
if ( mentionInfo.mentionSelectedElement ) {
scope.targetElement = mentionInfo.mentionSelectedElement;
scope.targetElementPath = mentionInfo.mentionSelectedPath;
scope.targetElementSelectedOffset = mentionInfo.mentionSelectedOffset;
}
/* publish to external ngModel */
scope.setTriggerText( mentionInfo.mentionText );
/* remember current position */
scope.currentMentionPosition = mentionInfo.mentionPosition;
scope.currentMentionTriggerChar = mentionInfo.mentionTriggerChar;
/* perform query */
scope.query( mentionInfo );
} else {
var currentTypedTerm = scope.typedTerm;
scope.setTriggerText("");
scope.hideAll();
}
}
function focusElement() {
var el = element[0];
el.focus();
el.selectionStart = el.selectionEnd = el.value.length;
}
function handleDestroy() {
mentionStorage.destroy();
scope.$emit( "mentionText.editing", false );
}
}
}
})( angular );
;
;
/*! mention-who-is-notified.controller.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.controller("mention.WhoIsNotifiedController", WhoIsNotifiedController );
function WhoIsNotifiedController(
$attrs,
$log,
$scope,
_,
appSettings,
clientEvents,
mentionStorage,
modelEvents
) {
var vm = this;
var props = $scope.props = $scope;
modelEvents.on( "MentionStorageUpdated", handleMentionStorageUpdated );
$scope.$on( "$destroy", handleDestroy );
initialize();
vm.pluralizePerson = pluralizePerson;
vm.getUsername = getUsername;
vm.addOthers = addOthers;
function pluralizePerson() {
return vm.peopleNotified.length === 1 ? "person" : "people";
}
/**
* Return the username 
* if prop `name` is not present, return `text` without '@' or '+'
*
* @param {object} peopleNotified user
* @return {string}
*/
function getUsername( user ) {
if ( user.name ) {
return user.name;
}
if ( user.text && ( user.text[ 0 ] === "@" || user.text[ 0 ] === "+" ) ) {
return user.text.slice( 1 );
}
return user.text;
}
function addOthers() {
clientEvents.trigger(
"mention.addOthers", {
targetElement: $attrs.mentioFor
}
);
if($scope.onAddOthers) {
$scope.onAddOthers();
}
}
function initialize() {
updatePeopleNotified();
}
function updatePeopleNotified() {
vm.peopleNotified = mentionStorage.getWhoIsNotified();
}
function handleMentionStorageUpdated() {
$scope.$evalAsync(function() {
updatePeopleNotified();
});
}
function handleDestroy() {
modelEvents.off( "MentionStorageUpdated" );
}
}
})( angular );
;
;
/*! mention-who-is-notified.directive.js */ 
;
;
(function( ng ) {
"use strict";
ng
.module("mention")
.directive("invMentionWhoIsNotified", WhoIsNotifiedDirective );
function WhoIsNotifiedDirective() {
return ({
restrict: "A",
templateUrl: "/assets/apps/common/ng-components/mention/who-is-notified/mention-who-is-notified.directive.htm",
controller: "mention.WhoIsNotifiedController",
controllerAs: "vm",
scope: {
onAddOthers: "&?onAddOthers"
}
});
}
})( angular );
;
;
/*! pub-sub.js */ 
;
;
(function( ng, app ) {
"use strict";
app.factory( "PubSub", PubSubFactory );
/** @ngInject */
function PubSubFactory( _ ) {
var PubSub = function() {
function off( eventType, callback ) {
var eventConfig = parseEventConfig( eventType );
if ( ! subscriptions.hasOwnProperty( eventConfig.type ) ) {
return;
}
subscriptions[ eventConfig.type ] = _.reject(
subscriptions[ eventConfig.type ],
function( subscription ) {
if ( callback ) {
return(
( subscription.namespace === eventConfig.namespace ) &&
( subscription.callback === callback )
);
} else {
return( subscription.namespace === eventConfig.namespace );
} 
}
);
}
function on( eventType, callback, context ) {
if ( _.isArray( eventType ) ) {
_.forEach(
eventType,
function( eventType ) {
on( eventType, callback, context );
}
);
return;
}
var eventConfig = parseEventConfig( eventType );
if ( ! subscriptions.hasOwnProperty( eventConfig.type ) ) {
subscriptions[ eventConfig.type ] = [];
}
subscriptions[ eventConfig.type ].push({
namespace: eventConfig.namespace,
callback: callback,
context: ( context || {} )
});
}
function parseEventConfig( eventType ) {
var parts = eventType.split( "." );
return({
type: parts.shift(),
namespace: ( parts.join( "," ) || null )
});
}
function trigger( eventType, eventData ) {
var eventConfig = parseEventConfig( eventType );
if ( eventConfig.type === "*" ) {
throw( new Error( "IllegalEventType" ) );
}
if ( ! subscriptions.hasOwnProperty( eventConfig.type ) ) {
return;
}
var eventArguments = arguments;
eventArguments[ 0 ] = {
type: eventConfig.type,
namespace: eventConfig.namespace
};
_.forEach(
subscriptions[ eventConfig.type ],
function( subscription ) {
if ( 
( eventConfig.namespace === null ) ||
( eventConfig.namespace === subscription.namespace )
) {
subscription.callback.apply( subscription.context, eventArguments );
}
}
);
_.forEach(
subscriptions[ "*" ],
function( subscription ) {
subscription.callback.apply( subscription.context, eventArguments );
}
);
}
var subscriptions = {};
subscriptions[ "*" ] = [];
return({
off: off,
on: on,
trigger: trigger
});
};
return( PubSub );
}
})( angular, InVision );
;
;
/*! app-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "AppController", Controller );
/** @ngInject */
function Controller(
$document,
$location,
$route,
$routeParams,
$scope,
$timeout,
$window,
_,
analyticsService,
appSettings,
beforeUnloadService,
commentObjectService,
config,
Deferred,
hotspotService,
ipInfoService,
modelEvents,
projectViewingService,
requestContext,
ScreenAlignmentHelper,
screenService,
sessionInactivityService,
sessionService,
shareService,
userPreferenceService,
userService
) {
$scope.config = config;
$scope.share = config.share;
$scope.bodyStyle = config.share.isEmbed ? { 'background-color': 'rgba(0,0,0,0)' } : '';
analyticsService.setupTrackGrowthForOptimizelyCampaigns();
config.LOADING_COMPLETE_PERCENT = 50;
analyticsService.segmentIo();
analyticsService.googleAnalytics();
analyticsService.track("ShareLink.Viewed");
analyticsService.trackGrowthPage("Share", "Share");
analyticsService.trackGrowth("App - Public Share - View Project", {
"Project Type": "Prototype",
"Logged In": !!sessionService.user.isAccountAuthenticated
});
var enableInbox = false;
var enableMentionShortcut = false;
var shareCommentingLogin = false;
var enableTrustArc = false;
var enableFunnelEnvy = false;
if ( config && config.featureFlags ) {
enableInbox = !!config.featureFlags.enableInbox;
enableMentionShortcut = !!config.featureFlags.mentionShortcut;
shareCommentingLogin = !!config.featureFlags.shareCommentingLogin;
enableTrustArc = !! ( config.featureFlags[ "product-RAIN-1225-trust-arc-in-prototype-share" ] && config.allowExternalScripts );
enableFunnelEnvy = !! ( config.featureFlags[ "analytics-RAIN-1212-funnel-envy-platform" ] && config.allowExternalScripts );
}
appSettings.setFeatureFlag("inbox", enableInbox);
appSettings.setFeatureFlag("mentionShortcut", enableMentionShortcut);
appSettings.setFeatureFlag("shareCommentingLogin", shareCommentingLogin);
$scope.settings = appSettings.getSettings();
function hideNavBar () {
return $scope.share.isEmbed || _.has($location.search(), "hideNavBar");
}
function addScreenToHistory( screenID ) {
if (
screenHistory.length &&
( screenHistory[ screenHistory.length - 1 ] === screenID )
) {
return;
}
screenHistory.push( screenID );
}
function getBrowserCompatibliity() {
var userAgent = $window.navigator.userAgent.toLowerCase();
var isIE6 = ( $window.ieVersion === 6 );
var isIE7 = ( $window.ieVersion === 7 );
var isCompatible = ! ( isIE6 || isIE7 );
var reason = null;
if ( ! isCompatible ) {
reason = "version";
if ( userAgent.search( "trident/(4|5)\.0" ) !== -1 ) {
reason = "mode";
}
}
return({
isCompatible: isCompatible,
isNotCompatible: ! isCompatible,
reason: reason
});
}
function getCurrentScreenID() {
var screenID = requestContext.getParamAsInt( "screenID", $scope.defaultScreenIDForShare );
return( screenID );
}
function getNormalizedPixelDensityWidth( imageWidth, clientFilename ) {
if ( clientFilename.indexOf( "@2x" ) > 0 ) {
return( imageWidth * 0.5 );
} else if ( clientFilename.indexOf( "@print" ) > 0 ) {
return( imageWidth * 0.3333 );
} else {
return( imageWidth );
}
}
function getPreviousScreenFromHistory() {
if ( screenHistory.length < 2 ) {
return( null );
}
var currentScreenID = screenHistory.pop();
var previousScreenID = screenHistory.pop();
return( previousScreenID );
}
function getXsrfTokenCookie() {
var cookieString = ( $document.prop( "cookie" ) || "" );
var matches = cookieString.match( /\bXSRF-TOKEN=([^;]+)/i );
return( ( matches && matches[ 1 ] ) || "" );
}
function getViewportWidth() {
if ( $scope.project.isMobile ) {
return( $scope.deviceTemplate.viewportWidth );
} else {
return( cachedWindowWidth );
}
}
function isRouteRedirect( route ) {
return( ! route.current.action );
}
function loadCountryCode() {
var geolocationInfo = ipInfoService.getGeolocationData();
if( geolocationInfo && geolocationInfo.country && geolocationInfo.country !== "" ) {
$scope.share.countryCode = geolocationInfo.country.toLowerCase();
} else {
$scope.share.countryCode = "us";
}
}
function prepareToUpdateShareConfig( trigger ) {
pendingShareConfigChangeEvent = trigger;
if ( ! isAppFocused ) {
return;
}
$timeout.cancel( pendingShareConfigChangeTimer );
pendingShareConfigChangeTimer = $timeout(
function debouncer() {
$scope.updateShareConfig( "timer." + pendingShareConfigChangeEvent );
pendingShareConfigChangeEvent = "";
},
( 1000 * 5 ) // 5-seconds.
);
}
function shouldShowSMSTooltip() {
return;
var hasSeen = $.cookie("hasSeenSMSTooltip");
hasSeen = _.isUndefined( hasSeen ) ? false : hasSeen;
if ( hasSeen === false ) {
$scope.isShowingSmsForm = true;
$.cookie("hasSeenSMSTooltip", true);
}
}
function sendSlackActivityAnalytics() {
var searchObj = $location.search();
if (typeof searchObj.slackActivity === "undefined") {
return;
}
var eventProperties = {
slackActivity: searchObj.slackActivity
};
analyticsService.track("ShareLink.Clicked", eventProperties);
$location.search("slackActivity", null);
}
var hasLocalStorage = (function() {
var x = '__storage_test__';
try {
localStorage.setItem(x, x);
localStorage.removeItem(x);
return true;
} catch(e) {
return false;
}
})();
$scope.clearBodyStyle = function() {
$scope.headerStyle = {};
$scope.bodyStyle = {};
};
$scope.closeBrowse = function() {
$scope.isBrowseOpen = false;
};
$scope.closeBrowserCompatibilityAlert = function() {
$scope.browserCompatibility.isCompatible = true;
$scope.browserCompatibility.isNotCompatible = false;
};
$scope.closeLoading = function() {
$scope.isLoadingOpen = false;
$scope.$broadcast( "loadingSequenceCompleted" );
if (window.parent != window) {
window.parent.postMessage("inShareLoadingComplete", "*");
}
if($location.search().welcome && $scope.user.isAccountAuthenticated){
$scope.openModalWindow( 'welcomeUser', {fromSignUp: false});
}
if($location.search().welcome && $location.search().sso){
analyticsService.trackGrowth("App - Public Share - SSO Login", {
'User Authenticated': $scope.user.isAccountAuthenticated ? 'True' : 'False'
});
}
if($location.search().welcome){
$location.search('welcome', null);
if($location.search().sso){
$location.search('sso', null);
}
}
if (enableTrustArc) {
(function(){if(!window.__storageConsentAdded){window.__storageConsentAdded=!0,"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(a){"use strict";if(null==a)throw new TypeError("Cannot convert undefined or null to object");for(var b,c=Object(a),d=1;d<arguments.length;d++)if(b=arguments[d],null!=b)for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(c[e]=b[e]);return c},writable:!0,configurable:!0});var a=(/privacy-force-country=(\w{2})/i.exec(window.location.search||"")||[])[1],b=-1<(window.location.search||"").indexOf("privacy-force-banner"),c=-1<(window.location.search||"").indexOf("privacy-force-implied"),d=[/(iPhone|iPod|iPad)(?!.*Safari)/ig,/Android.*(wv|\.0\.0\.0)/ig,/Linux; U; Android/ig],e=top&&self&&top!==self,f=e||["invisionapp_ima","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_5) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/43.0.2357.65 Mobile Safari/537.36","InVisionStudio","WebView"].some(function(a){return-1<window.navigator.userAgent.toLowerCase().indexOf(a.toLowerCase())})||d.some(function(a){return a.test(window.navigator.userAgent)});if(b){var B=document.createElement("div");B.id="teconsent",document.body&&document.body.appendChild(B)}if(!f){var C=document.createElement("div");C.id="consent_blackbar",Object.assign(C.style,{position:"fixed",bottom:"20px",right:"20px",zIndex:2147483638}),document.body?document.body.appendChild(C):document.addEventListener("readystatechange",function(){document.getElementById("consent_blackbar")||"interactive"!==document.readyState&&"complete"!==document.readyState||document.body.appendChild(C)});var g="https://consent.truste.com/notice?domain=invisionapp.com&c=teconsent&js=nj&noticeType=bb&pcookie"+(a?"&country="+a:"")+(c?"&behavior=implied":""),h=document.createElement("script");h.src=g,h.async=!0,(document.body||document.head).appendChild(h)}var i=[],j=function(){var a=q();return(i||[]).every(function(b,c){return b===a[c]})},k={},l=function(){return Object.keys(k).every(function(a){return!k[a]||k[a]===StorageConsent.consentedToDomain(a)})};window.postMessage(JSON.stringify({PrivacyManagerAPI:{action:"getConsent",timestamp:new Date().getTime(),self:"invisionapp.com"}}),"*");var m=!1;window.addEventListener("message",function(a){var b;if(a&&a.data)try{b=JSON.parse(a.data)}catch(a){}b&&b.source&&"preference_manager"===b.source&&("submit_preferences"===b.message?setTimeout(function(){var a=j(),b=l(),c=0===i[0]&&!a;c||a&&b?v.forEach(function(a){return a()}):(console.log("User consent levels have changed to be more strict, reloading the page to establish a clean environment with these stricter preferences"),m=!0),i=q(),k=r()},16):"remove_iframe"===b.message&&m&&(m=!1,window.location.reload()))},!1);var n,o=function(a){var b=document.cookie.match(new RegExp("(^| )"+a+"=([^;]+)"));if(b)return b[2]},p=function(){var a=o("notice_gdpr_prefs");return a&&a.split(",").map(function(a){return parseInt(a.toString()[0],10)+1})},q=function(){var a=[],b=window.StorageConsent.getGDPRConsentDecision();return a=b&&b.consentDecision?b.consentDecision:p(),a},r=function(){return Object.keys(k).reduce(function(a,b){return a[b]=StorageConsent.consentedToDomain(b),a},{})},s=function(){return-1<document.cookie.indexOf("notice_behavior")||-1<document.cookie.indexOf("notice_gdpr_prefs")||-1<document.cookie.indexOf("notice_preference")},t=function(){return window.truste&&window.truste.cma},u=[],v=[],w=!1,x=20,y=window.forceStorageConsentTimeout||5e3,z=0,A=function(){setTimeout(function(){f||t()&&s()?(w=!0,i=!f&&q()||[],u.forEach(function(a){return a()})):z<y&&(z+=x,x+=180,A())},x)};A(),window.StorageConsent=window.StorageConsent||{REQUIRED:1,FUNCTIONAL:2,ADVERTISING:3,consentDomain:"invisionapp.com",getConsentDecisionForDomain:function b(a){return t()&&truste.cma.callApi("getConsent",this.consentDomain,a,this.consentDomain)},getConsentDecision:function a(){return t()&&truste.cma.callApi("getConsentDecision",this.consentDomain)},getGDPRConsentDecision:function a(){return t()&&truste.cma.callApi("getGDPRConsentDecision",this.consentDomain)},getConsentCategories:function a(){return t()&&truste.cma.callApi("getConsentCategories",this.consentDomain).categories},hasGDPRCookies:s,isForceRequiredLevelOnly:function a(){return f},qualifiesForGDPR:function a(){return this.hasGDPRCookies()&&-1<(o("notice_behavior")||"").indexOf("eu")},canRunFunctionalScripts:function b(){var a=this;return!f&&(!this.qualifiesForGDPR()||q().some(function(b){return a.FUNCTIONAL===b}))},canRunAdvertisingScripts:function b(){var a=this;return!f&&(!this.qualifiesForGDPR()||q().some(function(b){return a.ADVERTISING===b}))},consentedToDomain:function c(a){a&&-1<a.indexOf("/")&&(!n&&(n=document.createElement("a")),n.href=a,a=n.hostname||a);var b=!0;return f?b=!1:this.qualifiesForGDPR()&&(b="approved"===(this.getConsentDecisionForDomain(a)||{}).consent),void 0===k[a]&&(k[a]=b),b},onConsentLevelReady:function b(a){return w?setTimeout(function(){return a()},14):u.push(a)},onConsentLevelChange:function b(a){return v.push(a)}}}})();
}
if ( enableFunnelEnvy ) {
var funnelEnvyScript = document.createElement( "script" );
funnelEnvyScript.onload = function handleFunnelEnvyLoad() {
window.funnelEnvy = new FunnelEnvy({
customerId: "5ac5aba744badd657feea81a",
apiUrl: "//backstage.funnelenvy.com"
});
};
funnelEnvyScript.setAttribute( "type", "text/javascript" );
funnelEnvyScript.setAttribute( "src", "//cdn2.funnelenvy.com/organization/5ac5aba744badd657feea81a/backstage-client.js" );
document.body.appendChild( funnelEnvyScript );
}
};
$scope.getPercentOfScreensLoaded = function() {
return( percentOfScreensLoaded );
};
$scope.getScreenHistory = function(){
return screenHistory;
}
$scope.navigateToPreviousScreen = function() {
var previousScreenID = getPreviousScreenFromHistory();
if ( previousScreenID ) {
$location.url( "/screens/" + previousScreenID );
}
};
$scope.navigateToScreenComments = function() {
if ( ! share.isCommentingAllowed ) {
return;
}
$location.url( $scope.generateCommentUrl() );
};
$scope.generateCommentUrl = function(){
return "/screens/" + getCurrentScreenID() + "/comments";
};
$scope.navigateToScreenPreview = function() {
var screenID = getCurrentScreenID();
$location.url( "/screens/" + screenID );
};
$scope.navigateToTargetScreen = function( screenID, maintainScrollPosition ) {
if ( ! screenID ) {
console.error("Trying to navigate to no screen");
return;
}
$location.url( "/screens/" + screenID );
$scope.closeBrowse();
$scope.$broadcast("screenViewer:screenChanged");
};
$scope.goToShareStart = function(){
var shareStart = config.share.screenID;
if( shareStart == 0 ){
shareStart = config.screens[0].id;
}
$scope.$broadcast("relaunchMobileApp", config.share.screenID );
$scope.navigateToTargetScreen( shareStart , false );
};
$scope.getAppIcon = function() {
return $scope.appIcon.imageUrl || "/assets/apps/share/img/icon.png";
};
$scope.toggleSmsShareForm = function(){
$scope.isShowingSmsForm = !$scope.isShowingSmsForm;
}
$scope.sendShareSms = function(){
$scope.sms.phoneNumber =$scope.sms.phoneNumber.replace( /[^\d+]+/g, "" );
if ( $scope.sms.phoneNumber.length < 10 ) {
$scope.sms.message = "Invalid phone number.";
return;
}else if ( $scope.sms.phoneNumber.length == 10){
$scope.sms.message = "Please add country code.";
return;
}
$scope.sms.messageSent = false;
$scope.sms.message = "";
Deferred.handlePromise(
shareService.sendSMS( share.id, $scope.sms.phoneNumber),
function( response ) {
$scope.sms.messageSent = true;
if ( hasLocalStorage ) {
localStorage.setItem("smsPhoneNumber", $scope.sms.phoneNumber );
}
$timeout(function(){
$scope.sms.messageSent = false;
$scope.sms.message = "";
$scope.isShowingSmsForm = false;
}, 15000);
},
function( response ) {
$scope.sms.message = "Error: Unable to send SMS.";
}
);
}
$scope.openBrowse = function() {
if ( ! share.isLoadAllScreens ) {
return;
}
$scope.isBrowseOpen = true;
};
$scope.openModalWindow = function( type ) {
var modalData = _.toArray( arguments );
var modalType = modalData.shift();
$scope.$broadcast( "openModalWindow", modalType, modalData );
};
$scope.setBodyClass = function( className ) {
if( $scope.share.isEmbed == true ){
$scope.bodyClass = "embed";
return;
}
var bodyClass = $scope.subview;
if( $scope.screen.zoomScrollBehavior === screenService.zoomScrollBehaviors.DISABLE_HORIZONTAL_SCROLLING ){
bodyClass += " disable-horizontal-scrolling";
}
if ( $scope.project.isMobile ) {
bodyClass += " mobile";
};
$scope.bodyClass = ( bodyClass + " " + className );
};
$scope.setHeaderStyle = function( style ) {
style['background-color'] = null;
$scope.headerStyle = $scope.share.isEmbed ? '' : style;
};
$scope.setBodyStyle = function( style ) {
$scope.bodyStyle = $scope.share.isEmbed ? '' : style;
};
$scope.setPercentOfScreensLoaded = function( percent ) {
if ( percentOfScreensLoaded < config.LOADING_COMPLETE_PERCENT ) {
$scope.setWindowTitle(percent + "% Loaded");
}
percentOfScreensLoaded = percent;
};
$scope.setWindowTitle = function( title ) {
$scope.windowTitle = title;
};
$scope.toggleBrowse = function() {
$scope.isBrowseOpen = ! $scope.isBrowseOpen;
};
$scope.appliedClass = function(){
if( $scope.subview == "comments"){
return "desktop";
}else{
if( $scope.project.mobileStatusbarIsOpaque && $scope.project.mobileStatusbarIsVisible){
var statusbarClass = "opaque-status-bar";
}else if ( !$scope.project.mobileStatusbarIsOpaque || !$scope.project.mobileStatusbarIsVisible ){
var statusbarClass = "transparent-status-bar";
}
var classNames = $scope.deviceTemplate.className + " " + statusbarClass;
if ($scope.deviceTemplate.mobileSkinColor == 'white' ){
classNames = classNames + " white";
}
if( $scope.project.mobileStatusbarIsVisible ){
classNames = classNames + " statusbarIsVisible";
}
return classNames ;
}
};
$scope.applyScreenDisplayScaleToScreen = function( screen ) {
var binaryWidth = screen.width;
var screenWidth = getNormalizedPixelDensityWidth( binaryWidth, screen.clientFilename );
var viewportWidth = getViewportWidth();
var isZoomToBrowserWidth = ( +screen.zoomScrollBehavior === screenService.zoomScrollBehaviors.ZOOM_OUT_TO_BROWSER_WIDTH );
if ( $scope.project.isMobile ) {
screen.displayScale = ( viewportWidth / binaryWidth );
screen.scrollScale = ( viewportWidth / screenWidth );
} else if ( isZoomToBrowserWidth && ( screenWidth > viewportWidth ) ) {
screen.displayScale = ( viewportWidth / binaryWidth );
screen.scrollScale = ( viewportWidth / screenWidth );
} else {
screen.displayScale = ( screenWidth / binaryWidth );
screen.scrollScale = 1;
}
return( screen );
};
$scope.applyScreenDisplayScale = function(){
$scope.applyScreenDisplayScaleToScreen( $scope.screen );
};
$scope.getReverseDisplayScale = function( screen ){
if( $scope.project.isMobile ){
var displayScale = ( screen.width / $scope.deviceTemplate.viewportWidth);
}else if ( !$scope.project.isMobile && screen.clientFilename.indexOf("@2x") > 0 ){
var displayScale = 2;
} else if ( ! $scope.project.isMobile && screen.clientFilename.indexOf("@print") > 0 ) {
var displayScale = 3;
} else{
var displayScale = 1;
}
if ( !$scope.project.isMobile && screen.zoomScrollBehavior === screenService.zoomScrollBehaviors.ZOOM_OUT_TO_BROWSER_WIDTH ){
if( screen.width * displayScale > $(window).width() ){
var displayScale =  screen.width / $(window).width();
}
}
return displayScale;
};
$scope.getFixedDesktopHeaderHeight = function(){
var height = $scope.screen.fixedHeaderHeight * $scope.screen.displayScale;
if( $scope.screen.backgroundFrame == true ){
height += 40; // add 40px for the spacing at the top of the frame.
}
return height;
};
$scope.setMobileLoadingForGifIsReady = function( value ){
$scope.mobileLoadingForGifIsReady = value;
};
$scope.setDesktopLoadingForGifIsReady = function( value ){
$scope.desktopLoadingForGifIsReady = value;
};
$scope.setIsTransitioning = function( value ){
$scope.isTransitioning = value;
};
$scope.setTransitionData = function( data ){
$scope.transitionData = data;
};
$scope.setScreen = function( screen ){
$scope.screen = screen;
$scope.applyScreenDisplayScaleToScreen( screen );
if( !$scope.project.isMobile ){
$scope.applyDesktopWrapperOffset( screen );
}
};
$scope.applyDesktopWrapperOffset = function( screen ){
var scaledScreenWidth = screen.width * screen.displayScale;
var windowWidth = $(window).width();
if( screen.zoomScrollBehavior == screenService.zoomScrollBehaviors.DISABLE_HORIZONTAL_SCROLLING &&
scaledScreenWidth > windowWidth && $scope.subview == "preview" ){
if ( screen.alignment === "left" ) {
$scope.desktopWrapperOffset = 0;
} else if ( screen.alignment === "right" ) {
$scope.desktopWrapperOffset = ( scaledScreenWidth - windowWidth ) * -1;
} else {
$scope.desktopWrapperOffset = ( ( scaledScreenWidth - windowWidth ) / 2 ) * -1;
}
}else{
$scope.desktopWrapperOffset = 0;
}
};
$scope.updateShareConfig = function( trigger ){
var shareID = $scope.share.id;
Deferred.handlePromise(
shareService.getShareConfig( shareID, null, trigger ),
function( response ) {
config.project = response.project;
config.screens = response.screens;
config.share = _.isArray(response.share) ? response.share[0] : response.share;
config.metaScreens = response.metaScreens;
config.hotspots = response.hotspots;
config.conversations = response.conversations;
config.comments = response.comments;
config.commentSketches = response.commentSketches;
config.dividers = response.dividers;
config.members = response.members;
config.affiliates = response.affiliates;
$scope.$broadcast( "configUpdated.share", config );
},
function( response ) {
}
);
};
$scope.updateShareUsers = function( shareUsers ){
config.members = shareUsers.members;
config.affiliates = shareUsers.affiliates;
};
$scope.updateDeviceTemplate = function(){
$scope.deviceTemplate = _.withProperty( $scope.deviceTemplates, "mobileDeviceID", config.project.mobileDeviceID )[0];
};
$scope.setHasSeenShareWalkThrough = function( val ){
$scope.hasSeenShareWalkThrough = val;
};
$scope.getHasSeenShareWalkThroughUserPreferenceID = function(){
if( window.location.protocol === "file:" || $scope.hideNavBar ){
$scope.setHasSeenShareWalkThrough( true );
return;
}
var getByName = userPreferenceService.getPreferenceTypeByName("hasSeenShareWalkThrough", false, "boolean");
getByName.then(function( response1 ) {
$scope.hasSeenShareWalkThroughUserPreferenceID = response1.data.id;
var getHasSeenShareWalkThroughValue = userPreferenceService.getUserPreferenceById( $scope.hasSeenShareWalkThroughUserPreferenceID );
getHasSeenShareWalkThroughValue.then(function( response2 ) {
$scope.setHasSeenShareWalkThrough( response2.data.value === "true" );
});
});
};
var renderContext = requestContext.getRenderContext( "", "screenID" );
var percentOfScreensLoaded = 0;
var screenHistory = [];
var share = shareService.getShare();
var cachedWindowWidth = $( $window ).width();
var pendingShareConfigChangeEvent = "";
var pendingShareConfigChangeTimer = 0;
var isAppFocused = true;
$scope.xsrfToken = getXsrfTokenCookie();
$scope.windowTitle = "InVision Share";
$scope.bodyClass = "";
$scope.subview = null;
$scope.isLoadingOpen = true;
$scope.isBrowseOpen = false;
$scope.shouldShowPoweredBy = config.shouldShowPoweredBy;
$scope.isModalOpen = false;
$scope.mobileLoadingForGifIsReady = config.project.isMobile ? false : true;
$scope.desktopLoadingForGifIsReady = ! config.project.isMobile ? false : true;
$scope.enterpriseConfig = config.companyInfo;
$scope.hideNavBar = hideNavBar();
if ( shareService.getShare().screenID == 0 ) {
$scope.defaultScreenIDForShare = screenService.getScreens()[0].id;
} else {
$scope.defaultScreenIDForShare = shareService.getShare().screenID;
}
if ( !_.findWithProperty( config.screens, "id", $scope.defaultScreenIDForShare ) ) {
$scope.defaultScreenIDForShare = screenService.getScreens()[0].id;
}
$scope.project = config.project;
$scope.project.loadingScreen = _.withProperty( config.screens, "screenTypeID", 3 )[0] || ""
$scope.share = shareService.getShare();
$scope.deviceTemplates = config.mobileDevices;
$scope.deviceTemplate = _.withProperty( $scope.deviceTemplates, "mobileDeviceID", config.project.mobileDeviceID )[0];
$scope.project.isWatch = $scope.deviceTemplate.deviceType === "watch";
$scope.appIcon = screenService.getAppIcon();
$scope.loadingScreen = screenService.getLoadingScreen();
$scope.screenID = $scope.defaultScreenIDForShare;
$scope.screen = null;
$scope.setScreen( screenService.getScreenByID( $scope.screenID ) );
$scope.desktopWrapperOffset = 0;
$scope.isInAppMode = false;
$scope.isTransitioning = false;
$scope.transitionData = {};
$scope.isShowingSmsForm = false;
$scope.sms = {};
$scope.sms.phoneNumber = "";
$scope.sms.messageSent = false;
$scope.sms.message = "";
if ( hasLocalStorage && localStorage.getItem('smsPhoneNumber') ) {
$scope.sms.phoneNumber = localStorage.getItem("smsPhoneNumber");
}
$scope.browserCompatibility = getBrowserCompatibliity();
$scope.hasSeenShareWalkThrough = false;
$scope.hasSeenShareWalkThroughUserPreferenceID = 0;
$scope.getHasSeenShareWalkThroughUserPreferenceID();
$scope.shareUser = config.user;
$scope.user = sessionService.user;
appSettings.setUser( $scope.user );
$scope.user.isUserValidationRequired = false;
$scope.user.tempAvatar;
if ( appSettings.getSettings().features.shareCommentingLogin && sessionService.user.email ) {
shareService
.getExistingUser( sessionService.user.email )
.then(function( response ) {
$scope.user.isUserValidationRequired = response && response.name;
if ( $scope.user.isUserValidationRequired ) {
$scope.user.tempAvatar = response.avatarID;
$scope.user.tempInitials = userService.getInitials( response.name );
$scope.user.hasSystemAvatar = userService.isSystemAvatar( response.avatarID );
}
})
;
}
if ( $scope.user.isAccountAuthenticated ) {
sessionService.authenticate().then(function(){
analyticsService.initGrowthAnalytics(sessionService.user, sessionService.subscription);
});
} else {
analyticsService.initGrowthAnalytics();
}
$scope.isShowingSlideshowNav = sessionService.get( "isShowingSlideshowNav" );
$scope.$on(
"requestContextChanged",
function() {
if ( ! renderContext.isChangeRelevant() ) {
return;
}
$scope.subview = renderContext.getNextSection();
addScreenToHistory(
requestContext.getParamAsInt( "screenID", $scope.defaultScreenIDForShare )
);
$scope.closeBrowse();
if( $scope.screenID != getCurrentScreenID() ){
$scope.screenID = getCurrentScreenID();
if ( !!$scope.xsfrToken ) {
projectViewingService.incrementScreenCount( $scope.share.id );
}
}
}
);
$scope.$on(
"$routeChangeSuccess",
function( event, currentRoute, previousRoute ) {
commentObjectService.set( null, 0 ); // clear the currently selected comment object.
if ( config.project && config.project.id && currentRoute.params.screenID ) {
commentObjectService.set( "project", {
objectID: config.project.id,
conversationID: currentRoute.params.conversationID
} );
}
if ( isRouteRedirect( $route ) ) {
return;
}
requestContext.setContext( $route.current.action, $routeParams );
if (
( renderContext.getNextSection() === "comments" ) &&
! share.isCommentingAllowed
) {
return(
$location.path( "/" )
);
}
$scope.$broadcast( "requestContextChanged", requestContext );
}
);
$scope.$on("modal.isWindowOpen", function( event, isOpen ) {
$scope.isModalOpen = isOpen;
});
$scope.$watch("screen", function( newVal, oldVal ){
if ( newVal !== oldVal ) {
$scope.applyScreenDisplayScale();
}
});
$scope.$watch(function () {
return sessionService.get('isShowingSlideshowNav');
}, function (newValue) {
$scope.isShowingSlideshowNav = newValue;
});
modelEvents.on(
"projectUpdated.share",
function( event, project ) {
if( project.id == config.project.id || project.mobileDeviceID !== config.project.mobileDeviceID ){
prepareToUpdateShareConfig( "event.project-updated" );
}
}
);
modelEvents.on(
"screenUploaded.share",
function( event, screen ) {
if( screen.projectID == config.project.id ){
prepareToUpdateShareConfig( "event.screen-uploaded" );
}
}
);
modelEvents.on(
"screenConfigUpdated.share",
function( event, screen ) {
if( screen.projectID == config.project.id ){
prepareToUpdateShareConfig( "event.screen-config-updated" );
}
}
);
modelEvents.on(
"screenDeleted.share",
function( event, screenID, projectID ) {
if( projectID == config.project.id ){
prepareToUpdateShareConfig( "event.screen-deleted" );
}
}
);
modelEvents.on(
"commentAdded.share",
function( event, commentID, conversationID, projectID ) {
if( projectID == config.project.id ){
prepareToUpdateShareConfig( "event.comment-added" );
}
}
);
modelEvents.on(
"commentUpdated.share",
function( event, commentID, conversationID, projectID ) {
if( projectID == config.project.id ){
prepareToUpdateShareConfig( "event.comment-updated" );
}
}
);
modelEvents.on(
"commentDeleted.share",
function( event, commentID, conversationID, projectID ) {
if( projectID == config.project.id ){
prepareToUpdateShareConfig( "event.comment-deleted" );
}
}
);
modelEvents.on(
"conversationUpdated.share",
function( event, conversationID, projectID) {
if( projectID == config.project.id ){
prepareToUpdateShareConfig( "event.conversation-updated" );
}
}
);
modelEvents.on(
"hotspotCreated.share",
function( event, hotspotID, projectID ){
if( projectID == config.project.id ){
prepareToUpdateShareConfig( "event.hotspot-created" );
}
}
);
modelEvents.on(
"hotspotUpdated.share",
function( event, hotspotID, projectID ){
if( projectID == config.project.id ){
prepareToUpdateShareConfig( "event.hotspot-updated" );
}
}
);
modelEvents.on(
"hotspotDeleted.share",
function( event, hotspotID, projectID ){
if( projectID == config.project.id ){
prepareToUpdateShareConfig( "event.hotspot-deleted" );
}
}
);
$scope.$on(
"configUpdated.share",
function( event, localConfig ) {
var isTemplateChange = localConfig.project.mobileDeviceID !== $scope.project.mobileDeviceID;
$scope.project = localConfig.project;
$scope.project.loadingScreen = _.withProperty( localConfig.screens, "screenTypeID", 3 )[0] || "";
if (isTemplateChange) {
$scope.share = localConfig.share;
$scope.deviceTemplate = _.withProperty($scope.deviceTemplates, "mobileDeviceID", localConfig.project.mobileDeviceID)[0];
$scope.project.isWatch = $scope.deviceTemplate.deviceType === "watch";
}
}
);
$(window).on("resize.sharePreview", function windowResize(){
cachedWindowWidth = $( $window ).width();
$scope.applyScreenDisplayScale();
if( !$scope.project.isMobile ){
$scope.applyDesktopWrapperOffset( $scope.screen );
}
syncWindowToScreenAlignment();
$scope.$apply();
});
function syncWindowToScreenAlignment() {
if ( !$scope.screen ) return;
var helper = new ScreenAlignmentHelper();
var alignment = helper.calculate( $scope.screen );
$scope.$broadcast("screenAlignment:update", alignment );
}
$( window ).on(
"focus blur",
function handleFocusChange( event ) {
isAppFocused = ( event.type === "focus" );
}
);
$( window ).on(
"mousemove keydown focus",
function handleUserInteraction( event ) {
if ( pendingShareConfigChangeEvent ) {
$scope.$apply(
function handleViewModelChange() {
$timeout.cancel( pendingShareConfigChangeTimer );
$scope.updateShareConfig( "flushing." + pendingShareConfigChangeEvent );
pendingShareConfigChangeEvent = "";
}
);
}
}
);
beforeUnloadService.push(
this,
function() {
projectViewingService.setEndedAt( $scope.share.id );
}
);
shouldShowSMSTooltip();
$timeout(function() {
if ( $window.analytics ) {
analytics.track('Share viewed via desktop');
}
}, 1000);
sendSlackActivityAnalytics();
if ( $scope.project.isMobile ) {
loadCountryCode();
}
if ( $scope.user.isAccountAuthenticated && $scope.user.hasCompanyMembership ) {
sessionInactivityService.init(
$scope.user.sessionIdentifier,
sessionService.authenticate,
function() {
document.location.reload(true);
}
);
}
if ( sessionService.user.isAccountAuthenticated ) {
var subdomain = window.location.hostname.split(".")[0];
var analyticsUserID = (config.singleTenantConfig && config.singleTenantConfig.useSingleTenantAnalytics) ? subdomain + "-" + sessionService.user.id : sessionService.user.id;
analyticsService.identifyGrowth( analyticsUserID, {
"Full Name": sessionService.user.name,
Email: sessionService.user.email,
"Last Activity": moment(sessionService.user.lastRequestAt).format("YYYY-MM-DD HH:mm:ss")
});
}
}
})( angular, InVision );
;
;
/*! auth-ask-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "banner.AuthAskController", Controller );
/** @ngInject */
function Controller( $scope, $window, analyticsService, config, sessionService, shareService ) {
$scope.showAuthAskBanner = false;
$scope.$on('loadingSequenceCompleted', function(){
var share = shareService.getShare();
var enterpriseShareSignupFlowVariant = ($window.InvAnalytics || {}).enterpriseShareSignupFlowVariant === 1;
$scope.showAuthAskBanner = !sessionService.user.isAccountAuthenticated && share.isCommentingAllowed && enterpriseShareSignupFlowVariant;
if($scope.showAuthAskBanner){
analyticsService.trackGrowth("App - Public Share - View Create Account Banner");
}
});
$scope.triggerAuthModal = function(isSignUp){
var opts = {
showSignup: !!isSignUp,
isFullScreenMode: true
};
$scope.openModalWindow( 'auth', opts);
$scope.showAuthAskBanner = false;
};
$scope.closeAuthAskBanner = function(){
if($scope.showAuthAskBanner){
analyticsService.trackGrowth("App - Public Share - Dismiss Create Account Banner");
}
$scope.showAuthAskBanner = false;
};
}
})( angular, InVision );
;
;
/*! browse-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "browse.BrowseController", Controller );
/** @ngInject */
function Controller( $scope, requestContext, shareService, screenService, sessionService, dateHelper, _ ){
function augmentScreens( screens ) {
for ( var i = 0 ; i < screens.length ; i++ ) {
var screen = screens[ i ];
screen.updatedAtDateLabel = (
dateHelper.formatDate( screen.updatedAt, "mmm d" ) + " at " +
dateHelper.formatTime( screen.updatedAt, "h:mm tt" )
);
}
return( screens );
}
function getScreensInSection( object ) {
if( object.type !== "divider" ) {
return [];
}
return _.where( $scope.displayObjects, { 'screenGroupId': object.dividerID });
}
$scope.applyScreenNavigation = function( screen ) {
$scope.navigateToTargetScreen( screen.id );
};
$scope.showSubview = function( subview ) {
$scope.subview = subview;
sessionService.set( "browse.BrowseController.defaultSubview", subview );
};
$scope.mergeScreensAndDividersForDisplay = function(){
var displayObjectsTemp = $scope.screens;
if ($scope.project.sortTypeID !== 2) {
displayObjectsTemp = [];
var sortedDividers = _.sortBy( $scope.dividers, "sort" );
var sortedScreens = _.sortBy( $scope.screens, "sort" );
for(var d = 0; d < sortedDividers.length; d++){
var screensInGroup = _.where(sortedScreens, {'screenGroupId' : sortedDividers[d].dividerID} );
sortedDividers[d].screenCount = screensInGroup.length;
displayObjectsTemp.push(sortedDividers[d]);
for( var s = 0; s < screensInGroup.length; s++ ){
screensInGroup[s].type = "screenObj";
displayObjectsTemp.push(screensInGroup[s]);
}
}
}else{
displayObjectsTemp.forEach(function(screen){
screen.type = "screenObj";
});
displayObjectsTemp = _.sortOnPropertyUsingNaturalOrder(displayObjectsTemp, 'name');
}
$scope.displayObjects = displayObjectsTemp;
};
$scope.shouldDividerDisplay = function( item ) {
if ( item.type === 'divider' && item.sort != 0 && item.screenCount > 0 ) {
return true;
}
return false;
};
$scope.isTabletPortrait = $scope.deviceTemplate.deviceType === "tablet" && $scope.deviceTemplate.orientation === "portrait";
$scope.screenID = requestContext.getParamAsInt( "screenID", $scope.defaultScreenIDForShare );
$scope.screens = augmentScreens( screenService.getScreens() );
$scope.dividers = _.sortBy( screenService.getDividers(), "sort" );
$scope.selectedScreen = _.findWithProperty( $scope.screens, "id", $scope.screenID );
$scope.subview = sessionService.get( "browse.BrowseController.defaultSubview", "thumbnails" );
$scope.excludeComments = ! shareService.getShare().isCommentingAllowed;
$scope.displayObjects = [];
$scope.mergeScreensAndDividersForDisplay();
}
})( angular, InVision );
;
;
/*! catchup-toolbar-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "comments.CatchupToolbarController", Controller );
/** @ngInject */
function Controller( $scope, $location, requestContext, Deferred, screenService, conversationService, commentService, modelEvents, _ ){
}
})( angular, InVision );
;
;
/*! comments-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "comments.CommentsController", Controller );
/** @ngInject */
function Controller(
$location,
$sce,
$scope,
$window,
_,
analyticsService,
commentService,
config,
conversationService,
requestContext,
screenService,
sessionService
){
function applyRemoteData( screen, conversations ) {
$scope.setScreen( screen );
if( document.URL.indexOf("/comments") >= 0 ) {
$scope.setWindowTitle( screen.name + " - Comments" );
}
$scope.conversations = augmentConversations(conversations);
applyFilters();
updateUnreadConversations();
if ( $scope.unreadConversations.length ){
$scope.showUnreadComments = true;
}
}
function augmentConversations( conversations ) {
return conversations;
}
function loadRemoteData() {
var screen = screenService.getScreenByID( $scope.screenID );
if ( ! screen ) {
return;
}
var conversations = conversationService.getConversationsByScreenID( screen.id );
conversations = markConversationsAsUnread( conversations );
applyRemoteData( screen, conversations );
}
function markConversationsAsUnread( conversations ){
for ( var i = 0 ; i < conversations.length ; i++ ) {
var comments =  commentService.getCommentsByConversationID( conversations[ i ].id );
conversations[ i ].isUnread =  !!( _.withProperty( comments, "isUnread", true).length );
}
return conversations;
}
function navigateToComments() {
$location.path( "/screens/" + $scope.screenID + "/comments" );
}
function applyFilters() {
var conversations = $scope.conversations;
updateFilterCounts();
showConversations( conversations );
applyShowCompletedFilter( conversations );
applyTypeFilter( conversations );
showConversationsNotAffectedByFiltering( conversations );
}
function applyShowCompletedFilter( conversations ) {
if ( ! $scope.filters.showCompleted.value ) {
hideConversations(
_.withProperty( conversations, "isComplete", true )
);
}
}
function applyTypeFilter( conversations ) {
if ( $scope.filters.type.value === "comments" ) {
hideConversations(
_.withProperty( conversations, "isForDevelopment", true )
);
hideConversations(
_.withProperty( conversations, "isTourPoint", true )
);
} else if ( $scope.filters.type.value === "dev-notes" ) {
hideConversations(
_.withProperty( conversations, "isForDevelopment", false )
);
} else if ( $scope.filters.type.value === "tour-points" ) {
hideConversations(
_.withProperty( conversations, "isTourPoint", false )
);
}
}
function showConversations( conversations ) {
_.setProperty( conversations, "isShown", true );
}
function hideConversations( conversations ) {
_.setProperty( conversations, "isShown", false );
}
function showConversationsNotAffectedByFiltering( conversations ) {
showConversations(
_.withPropertyRange( $scope.conversations, "id", conversationIDsNotAffectedByFiltering )
);
}
function clearExcludedConversationIDs() {
conversationIDsNotAffectedByFiltering = [];
}
function excludeConversationIDFromFiltering( id ) {
conversationIDsNotAffectedByFiltering.push( id );
showConversationsNotAffectedByFiltering( $scope.conversations );
}
$scope.startSketchBuilder = function(){
$scope.isShowingSketchBuilder = true;
$scope.isBottomBarShown = false;
$scope.$emit("isShowingSketchBuilder", true);
};
$scope.getMarkerPos = function(conversation, displayScale) {
var markerPos = {
top: conversation.y * displayScale,
left: conversation.x * displayScale
};
return markerPos;
};
$scope.getScreenDisplayData = function(screen) {
var displayData = {
height: screen.height,
width: screen.width,
displayScale: screen.displayScale
};
return displayData;
};
$scope.hideSketchBuilder = function(){
$scope.isShowingSketchBuilder = false;
$scope.isBottomBarShown = true;
$scope.$emit("isShowingSketchBuilder", false);
};
$scope.exportTempSketches = function() {
return _.clone( $scope.tempSketches );
};
$scope.clearCommentSketches = function(){
$scope.tempSketches.splice( 0, $scope.tempSketches.length );
};
$scope.deleteTempSketch = function( tempID ){
_.eachRight( $scope.tempSketches, function( sketch, index ) {
if ( tempID === sketch.tempID )
$scope.tempSketches.splice( index, 1 );
});
};
$scope.setTempSketches = function( tempSketches ){
$scope.clearCommentSketches();
_.each( tempSketches, function( sketch ) {
$scope.tempSketches.push( sketch );
});
};
$scope.startSketchViewer = function( sketch, isTemp, marker ){
if ( sketch.sketchID !== undefined){
sketch.id = sketch.sketchID;
}
$scope.sketchViewerSketch = angular.copy( sketch );
$scope.sketchViewerSketch.svg = $sce.trustAsHtml(sketch.svg);
$scope.sketchViewerMarker = marker;
$scope.sketchViewerSketchIsTemp = ( sketch.tempID !== undefined ? true: false);
$scope.isShowingSketchViewer = true;
$scope.isBottomBarShown = false;
$scope.setSketchImageIsProcessing( false );
};
$scope.closeSketchViewer = function(){
$scope.sketchViewerSketch = {};
$scope.sketchViewerMarker = {};
$scope.sketchViewerSketchIsTemp = false;
$scope.isShowingSketchViewer = false;
$scope.isBottomBarShown = true;
$scope.setSketchImageIsProcessing( false );
};
$scope.setSketchImageIsProcessing = function( isProcessing ){
$scope.sketchImageIsProcessing = isProcessing;
};
$scope.setIsHoveringViewport = function( val ){
$scope.isHoveringViewport = val;
};
$scope.setIsHoveringHotspot = function( val ){
$scope.isHoveringHotspot = val;
};
$scope.setIsShowingConversationMenu = function( val ){
$scope.isShowingConversationMenu = val;
};
$scope.getIsShowingConversationMenu = function() {
return $scope.isShowingConversationMenu;
};
$scope.reloadConversations = function( conversations ){
loadRemoteData();
};
$scope.changeShowCompletedFilter = function() {
clearExcludedConversationIDs();
navigateToComments();
applyFilters();
};
$scope.changeTypeFilter = function( option ) {
clearExcludedConversationIDs();
navigateToComments();
$scope.filters.type = option;
applyFilters();
};
$scope.markConversationAsRead = function( conversation ){
var conversationIndex = _.indexOfWithProperty( $scope.conversations, "id", conversation.id );
$scope.conversations[conversationIndex].isUnread = false;
conversationService.markRead( conversation.id );
var conversations = _.filter(
$scope.conversations,
function( conversation ) {
return(
( conversation.isUnread && ! conversation.isComplete )
||
_.contains( visitedUnreadConversationIDs, conversation.id )
);
}
);
$scope.unreadConversations = conversations;
};
function updateFilterCounts() {
var conversations = $scope.conversations;
if ( ! $scope.filters.showCompleted.value ) {
conversations = _.withoutProperty( conversations, "isComplete", true );
}
$scope.typeFilterOptions[ 0 ].count = conversations.length;
$scope.typeFilterOptions[ 1 ].count = _.where( conversations, {"isForDevelopment": false, "isTourPoint": false} ).length;
$scope.typeFilterOptions[ 2 ].count = _.withProperty( conversations, "isForDevelopment", true ).length;
$scope.typeFilterOptions[ 3 ].count = _.withProperty( conversations, "isTourPoint", true ).length;
if ( $scope.filters.type.value === "all" ) {
$scope.filters.showCompleted.count = _.withProperty( $scope.conversations, "isComplete", true ).length;
} else if ( $scope.filters.type.value === "comments" ) {
$scope.filters.showCompleted.count = _.where( $scope.conversations, { isForDevelopment: false, isTourPoint: false, isComplete: true } ).length;
} else if ( $scope.filters.type.value === "dev-notes" ) {
$scope.filters.showCompleted.count = _.where( $scope.conversations, { isForDevelopment: true, isComplete: true } ).length;
} else if( $scope.filters.type.value === "tour-points" ) {
$scope.filters.showCompleted.count = _.where( $scope.conversations, { isTourPoint: true, isComplete: true } ).length;
}
}
function updateUnreadConversations() {
$scope.unreadConversations = _.filter(
$scope.conversations,
function( conversation ) {
return(
( conversation.isUnread && ! conversation.isComplete )
||
_.contains( visitedUnreadConversationIDs, conversation.id )
);
}
);
updateVisibleUnreadConversations();
}
function updateVisibleUnreadConversations() {
$scope.visibleUnreadConversations = $scope.unreadConversations;
$scope.hiddenUnreadConversations = [];
if ( $scope.unreadConversations.length > $scope.unreadConversationCapacity ) {
$scope.visibleUnreadConversations = $scope.unreadConversations.slice( 0, $scope.unreadConversationCapacity );
$scope.hiddenUnreadConversations = $scope.unreadConversations.slice( $scope.unreadConversationCapacity );
}
}
$scope.updateUnreadConversationCapacity = function( capacity ) {
$scope.unreadConversationCapacity = capacity;
updateVisibleUnreadConversations();
};
$scope.setConversations = function( conversations ){
$scope.conversations = augmentConversations(conversations);
};
$scope.setCurrentCommentType = function(type) {
$scope.currentCommentType = type;
};
var renderContext = requestContext.getRenderContext( "comments", "screenID", "sketchID" );
var conversationIDsNotAffectedByFiltering = [];
var visitedUnreadConversationIDs = [];
$scope.screenID = requestContext.getParamAsInt( "screenID", $scope.defaultScreenIDForShare );
$scope.typeFilterOptions = [
{
label: "All Types",
value: "all",
count: 0,
isPrivate: false
},
{
label: "Comments",
value: "comments",
count: 0,
isPrivate: false
},
{
label: "Notes",
value: "dev-notes",
count: 0,
isPrivate: true
},
{
label: "Tour Points",
value: "tour-points",
count: 0,
isPrivate: false
}
];
$scope.filters = {
type: $scope.typeFilterOptions[ 0 ],
showCompleted: {
value: false,
count: 0
}
};
$scope.conversations = [];
$scope.unreadConversations = [];
$scope.visibleUnreadConversations = [];
$scope.hiddenUnreadConversations = [];
$scope.unreadConversationCapacity = 10;
$scope.isShowingSketchBuilder = false;
$scope.isShowingSketchViewer = false;
$scope.sketchViewerSketchIsTemp = false;
$scope.sketchViewerSketch = {};
$scope.sketchViewerMarker = {};
$scope.sketchImageIsProcessing = false;
$scope.tempSketches = [];
$scope.isHoveringViewport = false;
$scope.isHoveringHotspot = false;
$scope.isShowingConversationMenu = false;
$scope.isUserAccountAuthenticated = sessionService.user.isAccountAuthenticated;
$scope.showUnreadComments = false;
$scope.currentCommentType = "comment";
var clickToCommentCTA = $window.InvAnalytics && $window.InvAnalytics.clickToCommentCTA || {};
$scope.clickToCommentCTAActive = clickToCommentCTA.active;
$scope.clickToCommentCTAVariant = clickToCommentCTA.variant || "dark";
function calculateClickToCommentCTAMargin(windowHeight, screenHeight, isMobile) {
var margin = (config.project.isMobile ? 95 : 0 );
margin += 12;
margin += (screenHeight > windowHeight ? windowHeight : screenHeight ) / 2;
return margin;
}
var screenHeight = $scope.screen.height * $scope.screen.displayScale;
var windowHeight = $window.innerHeight;
$scope.clickToCommentCTAMargin = calculateClickToCommentCTAMargin(windowHeight, screenHeight, config.project.isMobile);
$window.addEventListener('resize', function () {
$scope.$apply(function () {
windowHeight = $window.innerHeight;
$scope.clickToCommentCTAMargin = calculateClickToCommentCTAMargin(windowHeight, screenHeight, config.project.isMobile);
});
});
$scope.dismissClickToCommentCTA = function(event) {
$scope.clickToCommentCTAActive = false;
$window.InvAnalytics.clickToCommentCTA.active = false;
function getEvent(name){
var e = $.Event(name);
Object.assign(e, {
clientX: event.clientX,
clientY: event.clientY,
pageX: event.pageX,
pageY: event.pageY
});
return e;
}
var el = document.elementFromPoint(event.pageX,event.pageY)
requestAnimationFrame(function(){
$(el).trigger(getEvent('mousedown'));
$(el).trigger(getEvent('click'));
$(el).trigger(getEvent('mouseup'));
});
}
$scope.$on(
"loadingSequenceCompleted",
function( event ) {
if ( $scope.screen && document.URL.indexOf("/comments") >= 0 ) {
$scope.setWindowTitle( $scope.screen.name + " - Comments" );
}
}
);
$scope.$on(
"requestContextChanged",
function() {
if ( ! renderContext.isChangeRelevant() ) {
return;
}
$scope.screenID = requestContext.getParamAsInt( "screenID", $scope.defaultScreenIDForShare );
loadRemoteData();
}
);
$scope.$on(
"configUpdated.share",
function( localConfig ) {
if( localConfig != config ){
loadRemoteData();
}
}
);
var trackingProperties = {
location: 'share',
username: sessionService.user.email
};
loadRemoteData();
analyticsService.track("CommentsMode", trackingProperties);
}
})( angular, InVision );
;
;
/*! form-controller.js */ 
;
;
(function( ng, app ) {
"use strict";
app.controller( "comments.FormController", Controller );
function Controller(
$scope,
$sce,
$timeout,
$window,
_,
accountService,
analyticsService,
appSettings,
commentService,
companyService,
config,
conversationService,
dateHelper,
Deferred,
emojiService,
hashKeyCopier,
mentionUtilities,
mentionStorage,
modelEvents,
moment,
parseCommentService,
projectService,
projectViewingService,
requestContext,
screenService,
sessionService,
shareService,
userService,
validationService
) {
function applyRemoteData( share, project, comments, members, affiliates ) {
$scope.share = share;
$scope.project = augmentProject( project );
$scope.comments = augmentComments( comments );
$scope.members = augmentUsers( _.rejectWithProperty( members, "id", $scope.user.id ) );
$scope.affiliates = augmentUsers( affiliates );
$scope.hideCommentInput = false;
$scope.conversationTitle = $scope.conversationTitle;
$scope.isTeamMember = !! _.findWithProperty( members, "id", $scope.user.id );
$scope.showInternalOptions = ( sessionService.user.isAccountAuthenticated && $scope.isTeamMember );
$scope.sketchesDisabled = config.featureFlags["prototypes-rain-690-sunset-sketches"];
$scope.gdprOptOutEnabled = shouldShowMarketingOptOut();
var membersWithoutUser = _.rejectWithProperty( members, "id", $scope.user.id );
var allUsers = membersWithoutUser.concat( affiliates );
var currentUserID = sessionService.user.id;
if ( comments.length ) {
var preselectedUserIDs = $scope.conversation.subscribers;
$scope.isShowingUserList = false;
$scope.isShowingTeaser = true;
} else {
var defaultUserIDs = _.pluck( membersWithoutUser, "id" );
var preselectedUserIDs = ( sessionService.get( "selectedUserIDs" ) || defaultUserIDs );
$scope.isShowingUserList = ! _.similar( defaultUserIDs, preselectedUserIDs );
$scope.isShowingTeaser = false;
}
_.each(
allUsers,
function( user ) {
user.isSelected = _.contains( preselectedUserIDs, user.id );
}
);
if ( $scope.isInternalConversation || $scope.share.isUserTesting ) {
$scope.selectedUserCount = _.countWithProperty( membersWithoutUser, "isSelected", true );
} else {
$scope.selectedUserCount = _.countWithProperty( allUsers, "isSelected", true );
}
}
$scope.isSigningUp = false;
function augmentComment( comment, index, collection ) {
var atConversationDisabled = config.featureFlags["prototypes-rain-690-sunset-conversation"];
var isFirstOrLastN = false;
var isCollapsed = false;
var isFirstCollapsed = false;
var previousCollapsedComments = [];
var commentHTML = parseCommentService.getComment( {
comment: comment.comment,
emojiParsed: comment.emojiparsedcomment,
mentions: comment.mentions
}, sessionService.user.id, {
atConversationDisabled: atConversationDisabled
});
comment.isOwnedByUser = false;
if ( sessionService.user.isAccountAuthenticated ) {
comment.isOwnedByUser = ( sessionService.user.id === comment.userID );
} else {
comment.isOwnedByUser = ( ( sessionService.user.id === comment.userID ) && userService.isAffiliate( comment.userID ) );
}
isFirstOrLastN = ( index === 0 || index >= ( collection.length - 3 ) );
previousCollapsedComments = _.filterWithProperty( collection.slice( 0, index ), "isCollapsed", true );
isCollapsed = !( isFirstOrLastN || comment.isUnread );
isFirstCollapsed = isCollapsed && ( previousCollapsedComments.length === 0 );
comment.isFirstCollapsed = isFirstCollapsed;
comment.isCollapsed = isCollapsed;
comment.dateLabel = getDateLabel( comment.createdAt );
comment.niceDate = moment( comment.createdAt ).fromNow();
comment.isEditing = false;
comment.html = commentHTML;
comment.editedComment = comment.comment;
comment.isDeleting = false;
comment.userHasSystemAvatar = userService.isSystemAvatar( comment.userAvatarID );
comment.userInitials = userService.getInitials( comment.userName );
comment.userOnlineStatus = userService.getOnlineStatus( comment.userLastRequestAt );
comment.userFirstName = comment.userName.split(" ")[0];
return( comment );
}
function augmentComments( comments ) {
_.each( comments, augmentComment );
return( comments );
}
function augmentProject( project ) {
project.isOwnedByUser = ( sessionService.user.isAccountAuthenticated && ( project.userID === sessionService.user.id ) );
return( project );
}
function augmentUser( user ) {
user.isSelected = false;
user.initials = userService.getInitials( user.name );
user.onlineStatus = userService.getOnlineStatus( user.lastRequestAt );
user.hasSystemAvatar = userService.isSystemAvatar( user.avatarID );
return( user );
}
function augmentUsers( users ) {
_.each( users, augmentUser );
return( users );
}
function getDateLabel( createdAt ) {
return moment( createdAt ).fromNow();
}
function loadRemoteData() {
var share = shareService.getShare();
var project = projectService.getProject();
var comments = commentService.getCommentsByConversationID( $scope.conversation.id );
var members = userService.getMembers();
var affiliates = userService.getAffiliates();
applyRemoteData( share, project, comments, members, affiliates );
}
function saveConversation() {
Deferred.handlePromise(
conversationService.saveConversation( $scope.conversation ),
null,
function( response ) {
$scope.openModalWindow( "error", "For some reason, we couldn't update your conversation. Try refreshing your browser." );
}
);
}
function shouldShowMarketingOptOut() {
if ( ! config.featureFlags[ "rain-1178-gdpr-marketing-opt-out" ] ) {
return( false );
}
if ( ! config.featureFlags[ "product-RAIN-1213-geofencing-opt-out" ] ) {
return( true );
}
return( config.isRequestFromGdprCountry );
}
function startConversation() {
function getConversationPromise( dataUrl, isUnsupported) {
return conversationService.startConversation(
$scope.screenID,
$scope.conversation.label,
$scope.conversation.x,
$scope.conversation.y,
$scope.conversation.isForDevelopment,
$scope.conversation.isPrivate,
$scope.conversation.isTourPoint,
dataUrl,
isUnsupported
);
}
var tempSketches = $scope.exportTempSketches();
placeholderComment.create( $scope.newComment, true, tempSketches );
$timeout(function() {
Deferred.handlePromise(
getConversationPromise( "", true ), // bypass canvas, since we're already calling it in saveComment() below
function( response ) {
$scope.conversation.id = response.id;
$scope.setTempSketches( tempSketches );
saveComment();
placeholderComment.destroy();
},
function( response ) {
$scope.openModalWindow( "error", "For some reason, we couldn't save your comment. Try refreshing your browser." );
}
);
}, 1000);
}
function updatePrivacySettings( isForDevelopment, isPrivate, isTourPoint ) {
$scope.conversation.isForDevelopment = isForDevelopment;
$scope.conversation.isPrivate = isPrivate;
$scope.conversation.isTourPoint = isTourPoint;
$scope.isInternalConversation = ( isForDevelopment || isPrivate );
if ( $scope.isInternalConversation || $scope.share.isUserTesting) {
$scope.selectedUserCount = _.countWithProperty( $scope.members, "isSelected", true );
} else {
$scope.selectedUserCount = (
_.countWithProperty( $scope.members, "isSelected", true ) +
_.countWithProperty( $scope.affiliates, "isSelected", true )
);
}
setMarkerLabel( true );
if ( $scope.conversation.id  ) {
saveConversation();
}
}
var placeholderComment = {
current: false,
create:function( newComment, isNewConversation, sketches ) {
if(this.current) {
return this.current;
}
var atConversationDisabled = config.featureFlags["prototypes-rain-690-sunset-conversation"];
if ( isNewConversation ) $scope.clearCommentSketches();
isNewConversation = isNewConversation || false;
$scope.isShowingUserList = false;
$scope.newComment = isNewConversation ? newComment : "";
$scope.setMarkersAsClean();
$scope.$broadcast( "invSuccessButton:success" );
var createdAt = new Date().getTime();
var interstitial = {
userName: $scope.user.name || "Me",
userFirstName: $scope.user.name.split(" ")[0],
userAvatarID: $scope.user.avatarID || 0,
userHasSystemAvatar: $scope.user.isAnonymous || $scope.user.hasSystemAvatar,
userInitials: $scope.user.initials || "ME",
dateLabel: "Just Now",
comment: newComment,
html: parseCommentService.getComment( {
comment: newComment,
mentions: mentionStorage.get()
}, sessionService.user.id,{
atConversationDisabled: atConversationDisabled
}),
sketches: !! sketches ? sketches : [],
isEditing: false,
numberOfLikes: 0,
likedBy: [],
conversationID: $scope.conversation.id,
isPlaceholder: true,
createdAt: createdAt
};
$scope.comments.push( interstitial );
if( !isNewConversation ){
config.comments.push( interstitial );
for( var cs = 0; cs < sketches.length; cs++ ){
config.commentSketches.push( sketches[cs] );
}
}
this.current = interstitial;
return this;
},
destroy: function() {
this.current = false;
return this;
}
}
function saveComment() {
var sketches = $scope.exportTempSketches();
analyticsService.trackGrowth("App - Public Share - Add Comment", {
Location: "Public Share",
"Is Reply": !!$scope.comments.length,
"Logged In": !!sessionService.user.isAccountAuthenticated
});
$scope.hideCommentInput = true;
function processCommentSave( dataUrl, isUnsupported ) {
Deferred.handlePromise(
commentService.addComment( $scope.conversation.id, newComment, mentions, notify, sketches, "", isUnsupported ),
function( response ) {
submissionInProgress = false;
$scope.clearCommentSketches();
projectViewingService.incrementCommentCount( $scope.share.id );
if ( ! _.contains( $scope.conversation.subscribers, $scope.user.id ) ) {
conversationService.addSubscribers( $scope.conversation.id, [ $scope.user.id ] );
}
if ( notify.others.length ) {
Deferred.handlePromise(
projectService.reloadStakeholders( $scope.project.id ),
function() {
var affiliates = userService.getAffiliates();
var allUserIDs = _.pluck( affiliates, "id" );
var knownUserIDs = _.pluck( $scope.affiliates, "id" );
var newUserIDs = _.difference( allUserIDs, knownUserIDs );
if ( newUserIDs.length ) {
conversationService.addSubscribers( $scope.conversation.id, newUserIDs );
}
if ( newUserIDs.length && ! $scope.comments.length ) {
sessionService.set( "selectedUserIDs", sessionService.get( "selectedUserIDs" ).concat( newUserIDs ) );
}
}
);
}
setMarkerLabel();
},
function( error ) {
submissionInProgress = false;
$scope.openModalWindow( "error", "For some reason, we couldn't save your comment. Try refreshing your browser." );
}
);
}
if ( ! $scope.conversation.id ) {
return( startConversation() );
}
if ( $scope.isInternalConversation ) {
_.setProperty( $scope.affiliates, "isSelected", false );
$scope.emailAddresses = "";
}
if ( $scope.share.isUserTesting && ! $scope.comments.length ) {
_.setProperty( $scope.affiliates, "isSelected", false );
$scope.emailAddresses = "";
}
var newComment = $scope.newComment;
var mentions = mentionStorage.get();
placeholderComment.create( newComment, false, sketches );
var selectedMembers = _.withProperty( $scope.members, "isSelected", true );
var selectedAffiliates = _.withProperty( $scope.affiliates, "isSelected", true );
var notify = {
members: _.pluck( selectedMembers, "id" ),
stakeholders: _.pluck( selectedAffiliates, "id" ),
others: [],
unsubscribe: []
};
var membersToUnsubscribe = _.withProperty( $scope.members, "isSelected", false );
var stakeholdersToUnsubscribe = _.withProperty( $scope.affiliates, "isSelected", false );
notify.unsubscribe = _.pluck( membersToUnsubscribe, "id" );
notify.unsubscribe = notify.unsubscribe.concat( _.pluck( stakeholdersToUnsubscribe, "id" ) );
if ( _.trim( $scope.emailAddresses ) ) {
notify.others = $scope.emailAddresses.split( /[,;:\s]+/gi );
}
processCommentSave("", true);
screenService.alterCommentCount( $scope.conversation.screenID, 1 );
if ( ! $scope.comments.length ) {
var selectedUserIDs = _.pluck( selectedMembers, "id" ).concat( _.pluck( selectedAffiliates, "id" ) );
if (
! _.findWithProperty( $scope.members, "id", $scope.user.id ) &&
! _.findWithProperty( $scope.affiliates, "id", $scope.user.id )
) {
selectedUserIDs.push( $scope.user.id );
}
sessionService.set( "selectedUserIDs", selectedUserIDs );
}
analyticsService.track(
"Comment.Added",
{
username: $scope.user.email,  // can't comment if not authenticated
isReply: $scope.comments.length > 1,
isAuthenticated: $scope.user.isAccountAuthenticated,
commentType: $scope.currentCommentType,
commentLocation: "share",
userNotified: ( mentions.length > 0 ),
passwordGiven: $scope.passwordGiven,
containsMention: mentionUtilities.hasNonInvites(mentions),
containsInvite: mentionUtilities.hasInvites(mentions)
}
);
}
function setMarkerLabel( skipSave ) {
skipSave = !! skipSave;
if( ! $scope.conversation ) {
return;
}
if( ! isNaN(parseInt($scope.conversation.label, 10)) && ! $scope.conversation.isTourPoint ) {
return;
}
var getNewLabel = false;
var clearLabel = false;
if ( $scope.conversation.isTourPoint ) {
var comments = ( !! $scope.comments ) ? _.filter($scope.comments, { "conversationID": $scope.conversation.id }) : [];
if ( !! comments && comments.length > 1 && isNaN(parseInt($scope.conversation.label, 10)) ) {
getNewLabel = true;
} else if( ! comments || (!! comments && comments.length <= 1 && ! isNaN(parseInt($scope.conversation.label, 10))) ) {
clearLabel = true;
}
} else if ( isNaN(parseInt($scope.conversation.label, 10)) ) {
getNewLabel = true;
}
if ( getNewLabel ) {
var labels = _.pluck( $scope.conversations, "label" );
var maxLabel = _.max(
labels,
function( label ) {
if ( label === "" ) {
return 0;
} else {
return( parseInt( label, 10 ) );
}
}
);
$scope.conversation.label = ( ( parseInt( maxLabel, 10 ) || 0 ) + 1 );
if ( $scope.conversation.label === 0 ) {
$scope.conversation.label = "";
}
if ( !! $scope.conversation.id && $scope.conversation.id > 0 ) {
if ( ! skipSave ) {
conversationService.saveConversation( $scope.conversation );
}
}
} else if ( clearLabel ) {
$scope.conversation.label = "";
if ( !! $scope.conversation.id && $scope.conversation.id > 0 ) {
if ( ! skipSave ) {
conversationService.saveConversation( $scope.conversation );
}
}
}
}
$scope.showNewCommentForm = function() {
$scope.stopEditingComments();
$scope.isShowingTeaser = false;
};
$scope.closeIdentifyForm = function() {
$scope.isIdentifying = false;
$scope.isAuthenticating = false;
};
$scope.openLoginForm = function () {
$scope.isLoggingIn = true;
$scope.isIdentifying = false;
$scope.isAuthenticating = false;
$scope.errorMessage = "";
analyticsService.trackGrowth("App - Public Share - View Comment Login Form");
};
$scope.closeLoginForm = function () {
$scope.isIdentifying = true;
$scope.isLoggingIn = false;
$scope.isAuthenticating = false;
$scope.errorMessage = "";
analyticsService.trackGrowth("App - Public Share - View Comment Signup Form");
};
$scope.submitLoginForm = function () {
$scope.errorMessage = "";
if ( isEmailPasswordRequirementSatisfied() ) {
$scope.currentEmail = $scope.identity.email;
$scope.isSigningIn = true;
authenticateUser( "login" );
}
};
$scope.submitLazyPasswordToSignup = function(){
$scope.identity.email = sessionService.user.email;
$scope.identity.name = sessionService.user.name;
$scope.errorMessage = "";
if ( !isPasswordValid($scope.identity.password) ) {
$scope.errorMessage = "Make sure you have a minimum of 5 characters.";
return false;
}
$scope.submitFormSignup();
};
$scope.closeLazyPasswordToSignup = function() {
$scope.thanksForLazyPassword = false;
$scope.lazyPasswordToSignUpFlow = false;
$scope.closeJustThisConversationPanel($scope.conversation.id);
$scope.deselectAllConversations();
};
$scope.showThanksForLazyPasswordFlow = function(){
$scope.thanksForLazyPassword = true;
$scope.setNeedsSignup(false);
$timeout(function() {
$scope.closeLazyPasswordToSignup();
}, 5000);
};
$scope.$on('shareAuthenticationChanged', function(){
setTimeout(function(){
angular.element('.submitComment').triggerHandler('click');
}, 200)
});
$scope.addComment = function() {
if ( submissionInProgress ){
return;
}
if ( ! _.trim( $scope.newComment ) && (!$scope.tempSketches || ! $scope.tempSketches.length) ) {
return;
}
if (!sessionService.user.isAccountAuthenticated) {
if ( sessionService.user.isAnonymous ) {
if ($scope.signupRequiredForComment) {
analyticsService.track("Comment.SignupFormView");
analyticsService.trackGrowth("App - Signup - View Signup Form", {
"Flow": isEnterprise ? "Signup to Comment - Enterprise" : "Signup to Comment"
});
analyticsService.trackGrowth("App - Public Share - View Comment Signup Form");
}
$scope.openModalWindow( 'auth', {
showSignup: true,
showWelcomeUser: false,
isFullScreenMode: false
});
return;
} else if ( $scope.user.isUserValidationRequired ) {
existingUser(true);
return;
}
}
submissionInProgress = true;
$scope.hasUnauthorizedEmail = false;
if (
$scope.emailAddresses &&
config.companyInfo &&
config.companyInfo.permissions &&
config.companyInfo.permissions.requireShareAuth
) {
var emails = $scope.emailAddresses.split( "," );
Deferred.handlePromise(
companyService.assertEmailsAreCompanyMembers( emails ),
function( response ) {
if( ! response.emailsAreMembers ){
submissionInProgress = false;
$scope.hasUnauthorizedEmail = true;
return;
}
saveComment();
},
function( response ){
submissionInProgress = false;
$scope.openModalWindow( "error", "For some reason, we couldn't save your comment. Try refreshing your browser." );
}
);
} else {
saveComment();
}
};
$scope.stopEditingComments = function() {
_.setProperty( $scope.comments, "isEditing", false );
};
$scope.deleteComment = function( comment ) {
Deferred.handlePromise(
commentService.deleteComment( comment.id ),
null,
function( response ) {
$scope.openModalWindow( "error", "For some reason, we couldn't delete your comment. Try refreshing your browser." );
}
);
$scope.comments = _.without( $scope.comments, comment );
setMarkerLabel();
screenService.alterCommentCount( $scope.conversation.screenID, -1 );
};
$scope.deleteSketch = function( sketchID ) {
conversationService.deleteSketch( sketchID );
for( var c = 0; c < $scope.comments.length; c++){
$scope.comments[c].sketches = _.rejectWithProperty( $scope.comments[c].sketches, "id", sketchID );
}
};
$scope.editComment = function( comment ) {
$scope.stopEditingComments();
$scope.isShowingTeaser = true;
comment.isEditing = true;
comment.editedComment = comment.comment;
mentionStorage.set( comment.mentions );
};
$scope.expandComments = function( ) {
var comments = $scope.comments;
_.setProperty( comments, "isCollapsed", false );
};
$scope.getUsersToBeNotified = function() {
var userNames = [];
var pushUserOnStackIfNotified = function( user ) {
if ( user.isSelected ) {
userNames.push( userService.getFirstName( user.name ) );
}
};
if( $scope.conversation.isPrivate || $scope.conversation.isForDevelopment ){
_.each( $scope.members, function( member ){
if( member.canViewPrivateComments ){
pushUserOnStackIfNotified( member );
}
});
} else {
_.each( $scope.members, pushUserOnStackIfNotified );
}
_.each( $scope.affiliates, pushUserOnStackIfNotified );
if ( _.trim( $scope.emailAddresses ) ) {
var others = $scope.emailAddresses.split( /[,;:\s]+/gi );
userNames = userNames.concat( others );
}
return userNames[0];
};
$scope.hideDeleteConfirmation = function( comment ) {
( comment || $scope ).isDeleting = false;
};
/** I check if name and email are present in the identify form.
* @returns {Boolean}
**/
function isFormValid() {
if ( ! $scope.identity.name ) {
$scope.errorMessage = "Please enter your name.";
return false;
}
if ( ! $scope.identity.email ) {
$scope.errorMessage = "Please enter your email.";
return false;
}
if ( ! mentionUtilities.isEmailAddress( $scope.identity.email ) ) {
$scope.errorMessage = "Please enter a valid email address.";
return false;
}
if ( $scope.signupRequiredForComment && !isPasswordValid($scope.identity.password) ) {
$scope.errorMessage = "Please enter a valid password.";
return false;
}
return true;
}
/** I check if the given password value is valid
* @returns {Boolean}
**/
function isPasswordValid(password){
return password && password.length && password.length >= 5;
}
/** I check if email/password requirement is met
* @returns {Boolean}
**/
function isEmailPasswordRequirementSatisfied() {
if ( $scope.isLoggingIn && !$scope.identity.email  ) {
$scope.errorMessage = "Please enter your email.";
return false;
}
if ( ! $scope.identity.password ) {
$scope.errorMessage = "Please enter your password.";
return false;
}
return true;
}
function existingUser(isUserValidationRequired) {
if ( ! $scope.isCommentingLoginEnabled ) {
identifyUser();
return;
}
var userEmail = $scope.identity.email || sessionService.user.email;
if ( isUserValidationRequired ) {
$scope.isAuthenticating = true;
$scope.currentEmail = userEmail;
} else {
identifyUser();
}
analyticsService.track(
"Comment.Adding",
{
passwordRequired: isUserValidationRequired
}
);
}
function identifyUser() {
shareService
.identify( $scope.identity.name, $scope.identity.email )
.then( function( response ) {
$scope.isIdentifying = false;
$scope.canLike = true;
$scope.hasInitialMentions = true;
var isEnterprise = config && config.companySettings && config.companySettings.isEnterprise
if (!isEnterprise && $scope.isCommentingLoginEnabled) {
if ($scope.lazyPasswordToSignUpFlow) {
$scope.setNeedsSignup(true);
}
}
$scope.addComment();
})
.catch( function( response ) {
if ( validationService.isInvalidField( response ) ) {
$scope.errorMessage = INVALID_FIELD_ERROR;
} else if ( validationService.isForbidden( response ) ) {
$scope.errorMessage = FORBIDDEN_ERROR;
} else {
$scope.errorMessage = UNEXPECTED_ERROR;
}
})
;
}
function authenticateUser( workflow ) {
shareService
.validateUser( $scope.currentEmail, $scope.identity.password, $scope.project.id, $scope.user.id, workflow )
.then( function( response ) {
$scope.isIdentifying = false;
$scope.isAuthenticating = false;
$scope.passwordGiven = true;
$scope.errorMessage = "";
$scope.isSigningUp = false;
$scope.isSigningIn = false;
sessionService.authenticate().then(function(){
analyticsService.setSubscriptionInfo(sessionService.subscription);
if($scope.lazyPasswordToSignUpFlow){
$scope.setNeedsSignup(false);
$scope.showThanksForLazyPasswordFlow();
}
$scope.addComment();
$scope.$emit('shareAuthenticationChanged');
});
})
.catch( function( response ) {
$scope.isSigningIn = false;
if ( validationService.isInvalidField( response ) ) {
$scope.errorMessage = INVALID_PASSWORD_ERROR;
} else if ( validationService.isForbidden( response ) ) {
$scope.errorMessage = FORBIDDEN_ERROR;
} else if ( validationService.isTooManyAttempts( response ) ) {
$scope.errorMessage = BRUTEFORCE_ERROR;
} else {
$scope.errorMessage = UNEXPECTED_ERROR;
}
})
;
}
$scope.handleKeyDown = function(e) {
if ($scope.isIdentifying) {
e.preventDefault();
$scope.submitForm({ comment: $scope.newComment, sketches: $scope.tempSketches });
} else if ($scope.isSignup) {
e.preventDefault();
$scope.submitLazyPasswordToSignup();
} else if ($scope.isLoggingIn) {
e.preventDefault();
$scope.submitLoginForm();
} else if ($scope.isAuthenticating) {
e.preventDefault();
$scope.submitFormPassword();
}
};
$scope.handleKeyDownAuth = function(e) {
if ($scope.showLogin) {
e.preventDefault();
$scope.submitLoginForm();
} else if ($scope.showSignup) {
e.preventDefault();
$scope.submitFormSignup();
}
};
$scope.isStakeholdersShowing = function(){
return( !! $scope.affiliates.length && !$scope.share.isUserTesting );
};
$scope.removeStakeholder = function( user ){
projectService.removeStakeholderFromProject( user.id );
};
$scope.saveComment = function( comment ) {
var atConversationDisabled = config.featureFlags["prototypes-rain-690-sunset-conversation"];
var newComment = _.trim( comment.comment );
if ( !newComment ) {
return( comment.isEditing = false );
}
Deferred.handlePromise(
commentService.updateComment( comment.id, comment.conversationID, newComment ),
null,
function( response ) {
$scope.openModalWindow( "error", "For some reason, we couldn't save your comment. Try refreshing your browser." );
}
);
comment.comment = newComment;
comment.mentions = mentionStorage.get();
comment.html = parseCommentService.getComment( {
comment: newComment,
mentions: comment.mentions
}, sessionService.user.id,{
atConversationDisabled: atConversationDisabled
});
comment.isEditing = false;
$scope.isShowingTeaser = true;
setMarkerLabel();
$scope.$broadcast("commentChanged");
};
$scope.showDeleteConfirmation = function( comment, isFirstComment ) {
if ( isFirstComment ) {
$scope.isDeleting = true;
} else {
comment.isDeleting = true;
}
};
$scope.submitForm = function( comment ) {
$scope.errorMessage = "";
$scope.newComment = comment.comment;
$scope.tempSketches = comment.sketches;
if ( $scope.isIdentifying ) {
analyticsService.track(
"Comment.Adding",
{
identityRequired: settings.features.shareCommentingLogin
}
);
}
if ( $scope.isIdentifying && isFormValid() ) {
var isUserValidationRequired = false;
if ( settings.features.shareCommentingLogin ) {
shareService
.getExistingUser( $scope.identity.email )
.then( function( response ) {
isUserValidationRequired = response && response.name;
if ( isUserValidationRequired ) {
$scope.user.tempAvatar = response.avatarID;
$scope.user.tempInitials = userService.getInitials( response.name );
$scope.user.hasSystemAvatar = userService.isSystemAvatar( response.avatarID );
}
existingUser( isUserValidationRequired );
return;
})
;
} else {
existingUser( isUserValidationRequired );
return;
}
}
$scope.addComment();
};
$scope.submitFormPassword = function() {
$scope.errorMessage = "";
if ( $scope.isAuthenticating && isEmailPasswordRequirementSatisfied() ) {
authenticateUser( "login2" );
}
};
$scope.submitFormSignup = function( comment ) {
comment = comment || { comment: '', sketches: [] };
$scope.errorMessage = "";
$scope.newComment = comment.comment;
$scope.tempSketches = comment.sketches;
if ( isFormValid() ) {
$scope.isSigningUp = true;
shareService
.getExistingUser( $scope.identity.email )
.then( function( response ) {
var isExistingUser = response && response.name;
if ( isExistingUser ) {
$scope.user.tempAvatar = response.avatarID;
$scope.user.tempInitials = userService.getInitials( response.name );
$scope.user.hasSystemAvatar = userService.isSystemAvatar( response.avatarID );
$scope.isAuthenticating = true;
$scope.currentEmail = $scope.identity.email;
$scope.isSigningUp = false;
$scope.addComment();
$scope.$emit('shareAuthenticationSignupError:existingUser');
} else {
var newAccountCriteria = {
name: $scope.identity.name,
email: $scope.identity.email,
password: $scope.identity.password,
marketingOptOut: !! ( $scope.gdprOptOutEnabled && $scope.identity.optout )
};
accountService
.createAccount( newAccountCriteria )
.then( function() {
$scope.currentEmail = $scope.identity.email;
document.cookie = "PUSHGAQSIGNUPEVENT=; path=/; domain="+window.location.hostname.match(/\.\w+\.\w+$/g)[0]+"; expires=" + new Date(0).toUTCString();
authenticateUser( "signup" );
})
.catch( function() {
$scope.errorMessage = UNEXPECTED_ERROR;
$scope.isSigningUp = false;
});
}
});
}
}
$scope.$on('shareAuthenticationSetErrorMessage', function(event, message){
$scope.errorMessage = message;
});
$scope.setTypeAsComment = function() {
updatePrivacySettings( false, false, false );
$scope.setCurrentCommentType("comment");
$scope.isNewTourPoint = false;
};
$scope.setTypeAsPrivateComment = function(){
updatePrivacySettings( false, true, false );
$scope.setCurrentCommentType("private-comment");
$scope.isNewTourPoint = false;
};
$scope.setTypeAsDevNote = function() {
updatePrivacySettings( true, true, false );
$scope.setCurrentCommentType("dev-note");
$scope.isNewTourPoint = false;
};
$scope.setTypeAsTourPoint = function() {
updatePrivacySettings( false, false, true );
$scope.setCurrentCommentType("tour-point");
$scope.isNewTourPoint = ! $scope.conversation.id || $scope.conversation.id === 0;
};
$scope.closeCommentFormOnSave = function(conversationID) {
if( $scope.conversation.isTourPoint && !! $scope.conversation.id ) {
$scope.isNewTourPoint = false;
}
$scope.closeJustThisConversationPanel(conversationID);
};
$scope.toggleIsForDevelopment = function() {
updatePrivacySettings( ! $scope.conversation.isForDevelopment, $scope.conversation.isPrivate, false );
};
$scope.toggleIsPrivate = function() {
updatePrivacySettings( $scope.conversation.isForDevelopment, ! $scope.conversation.isPrivate, false );
};
$scope.toggleLike = function( comment ) {
comment.hasUserLiked = !comment.hasUserLiked;
if( comment.hasUserLiked ) {
comment.numberOfLikes++;
var hasNotLiked = _.isUndefined( _.findWithProperty( comment.likedBy, 'email', sessionService.user.email ) );
if( hasNotLiked ) {
comment.likedBy.unshift( { name: sessionService.user.name, email: sessionService.user.email } );
}
var isReply = !!_.find($scope.comments,function(item,x) {
return x > 0 && item.id === comment.id;
});
analyticsService.track(
"Comment.Liked",
{
username: sessionService.user.email,
commentLocation: "share",
isReply: isReply
}
);
} else {
comment.numberOfLikes--;
comment.likedBy = _.rejectWithProperty( comment.likedBy, "email", sessionService.user.email );
}
comment.likedByList = commentService.formatCommentLikers( comment );
conversationService.toggleCommentLike( comment.id, comment.conversationID );
};
$scope.toggleUserList = function() {
$scope.isShowingUserList = ! $scope.isShowingUserList;
};
$scope.toggleUserSelection = function( user ) {
if ( user.isSelected ) {
$scope.selectedUserCount++;
} else {
$scope.selectedUserCount--;
}
};
$scope.updateConversationStatus = function( conversation ) {
var methodName = ( conversation.isComplete ? "markComplete" : "markIncomplete" );
Deferred.handlePromise(
conversationService[ methodName ]( conversation.id ),
null,
function( response ) {
$scope.openModalWindow( "error", "For some reason, we couldn't update the conversation. Try refreshing your browser." );
}
);
if ( conversation.isComplete ) {
$timeout(
function() {
$scope.closeConversation();
},
250
);
}
};
$scope.notifyOptionSelected = "All";
$scope.checkAll = function() {
_.setProperty( $scope.members, "isSelected", true);
_.setProperty( $scope.affiliates, "isSelected", true);
$scope.hasAllChecked = true;
};
$scope.uncheckAll = function() {
_.setProperty( $scope.members, "isSelected", false);
_.setProperty( $scope.affiliates, "isSelected", false);
$scope.notifyOthers = "";
$scope.hasAllChecked = false;
};
$scope.checkAllCollaborators = function() {
$scope.uncheckAll();
_.setProperty( $scope.members, "isSelected", true);
};
$scope.selectAll = function() {
$scope.checkAll();
$scope.notifyOptionSelected = "All";
};
$scope.selectCollaborators = function() {
$scope.checkAllCollaborators();
$scope.notifyOptionSelected = "Collaborators";
};
$scope.toggleNotifyOption = function() {
if ( $scope.getNotifyCount() > 0 ) {
$scope.uncheckAll();
return;
}
switch(	$scope.notifyOptionSelected ) {
case "All":
$scope.selectAll();
break;
case "Collaborators":
$scope.selectCollaborators();
break;
}
};
$scope.getNotifyCount = function() {
var count = 0;
_.each( $scope.members, function( user ) {
if ( user.isSelected ) {
count++;
}
});
if( ! $scope.conversation.isForDevelopment && ! $scope.conversation.isPrivate ){
_.each( $scope.affiliates, function( user ) {
if ( user.isSelected ) {
count++;
}
});
}
if ( ( $scope.affiliates.length + $scope.members.length ) !== count && $scope.hasAllChecked ) {
$scope.hasAllChecked = false;
}
if ( ( $scope.affiliates.length + $scope.members.length ) === count ) {
$scope.hasAllChecked = true;
}
return count;
};
function handleProjectStakeholderRemoved( event, projectID, userID ){
$scope.affiliates = _.rejectWithProperty( $scope.affiliates, "id", userID );
}
function handleConversationSubscriberUpdate( event, conversationID, notify ) {
if ( conversationID == $scope.conversation.id ) {
var subscribers  = _.uniq( [].concat( notify.members ).concat( notify.stakeholders ) ),
deSelectedMembers,
selectedAffiliates;
$scope.conversation.subscribers = subscribers;
_.setProperty( $scope.members, "isSelected", true );
deSelectedMembers = _.withoutPropertyRange( $scope.members, "id", subscribers );
_.setProperty( deSelectedMembers, "isSelected", false );
if ( notify.resubscribe ) {
projectService.reloadStakeholders( $scope.project.id ).then(function( response ) {
$scope.affiliates = augmentUsers( response );
_.setProperty( $scope.affiliates, "isSelected", false );
selectedAffiliates = _.withPropertyRange( $scope.affiliates, "id", subscribers );
_.setProperty( selectedAffiliates, "isSelected", true );
});
} else {
_.setProperty( $scope.affiliates, "isSelected", false );
selectedAffiliates = _.withPropertyRange( $scope.affiliates, "id", subscribers );
$scope.affiliates = selectedAffiliates;
_.setProperty( selectedAffiliates, "isSelected", true );
}
}
}
$scope.share = null;
$scope.project = null;
$scope.conversation = $scope.selectedConversation || $scope.newConversation || {};
$scope.isNewTourPoint = $scope.conversation.isTourPoint && (! $scope.conversation.id || $scope.conversation.id === 0);
$scope.showInternalOptions = false;
$scope.comments = [];
$scope.isDeleting = false;
$scope.isIdentifying = false;
$scope.isAuthenticating = false;
$scope.isLoggingIn = false;
$scope.passwordGiven = false;
$scope.isSignup = $scope.isSignup;
$scope.identity = {
name: "",
email: "",
password: ""
};
var settings = appSettings.getSettings();
$scope.isCommentingLoginEnabled = settings.features.shareCommentingLogin;
$scope.members = [];
$scope.affiliates = [];
$scope.isShowingUserList = false;
$scope.isInternalConversation = ( $scope.conversation.isForDevelopment || $scope.conversation.isPrivate );
$scope.selectedUserCount = 0;
$scope.isShowingTeaser = true;
$scope.emailAddresses = "";
$scope.newComment = "";
$scope.canLike = !sessionService.user.isAnonymous;
$scope.hasInitialMentions = !sessionService.user.isAnonymous;
$scope.canEdit = sessionService.user.isAccountAuthenticated;
$scope.hasAllChecked = false;
$scope.isTeamMember = false;
$scope.hasUnauthorizedEmail = false;
$scope.errorMessage = null;
$scope.conversationTitle = "Start a conversation";
$scope.currentEmail = "";
var isEnterprise = config && config.companySettings && config.companySettings.isEnterprise;
var disableSingleTenantSignupToComment = config.singleTenantConfig && config.singleTenantConfig.disableSingleTenantSignupToComment;
var requireSignupToCommentEnterprise = isEnterprise && !disableSingleTenantSignupToComment;
var lazyPasswordFlowFlag = ($window.InvAnalytics && $window.InvAnalytics['commentSignupCTA']) || {};
var lazyPasswordFlowFlagActive = lazyPasswordFlowFlag.active && lazyPasswordFlowFlag.variant === 'cta';
var requireSignupToCommentNonEnterprise = !isEnterprise && !lazyPasswordFlowFlagActive;
$scope.signupRequiredForComment = $scope.isCommentingLoginEnabled && (requireSignupToCommentNonEnterprise || requireSignupToCommentEnterprise);
$scope.lazyPasswordToSignUpFlow = !$scope.signupRequiredForComment && lazyPasswordFlowFlagActive;
var GENERAL_ERROR = "Something went wrong. Please refresh your browser.";
var INVALID_FIELD_ERROR = "Please enter a valid name and email address.";
var INVALID_PASSWORD_ERROR = $sce.trustAsHtml("Sorry, password isn't right. We can help you <a class='underline' href='/d/password/requestReset' target='_blank'>recover your password.</a>");
var UNEXPECTED_ERROR = "Unexpected error.";
var BRUTEFORCE_ERROR = "Sorry, you have attempted to login too many times.";
var FORBIDDEN_ERROR = "Something is funky - it looks like you already identified yourself. Try refreshing your browser - that should fix it.";
$scope.$on(
"$destroy",
function( event ) {
if (
$scope.conversation.id &&
_.findWithProperty( $scope.comments, "isUnread", true )
) {
conversationService.markRead( $scope.conversation.id );
screenService.alterUnreadCommentCount(
$scope.conversation.screenID,
- _.countWithProperty( $scope.comments, "isUnread", true )
);
}
modelEvents.off( "projectStakeholderRemoved.commentsFormController" );
modelEvents.off("conversationSubscribersUpdated.commentsFormController" );
}
);
$scope.$on( "configUpdated.share", function( event, response ){
$scope.members = augmentUsers( _.rejectWithProperty( response.members, "id", $scope.user.id ) );
$scope.affiliates = augmentUsers( response.affiliates );
var membersWithoutUser = _.rejectWithProperty( $scope.members, "id", $scope.user.id );
var allUsers = membersWithoutUser.concat( $scope.affiliates );
if ( $scope.comments.length ) {
var preselectedUserIDs = $scope.conversation.subscribers;
} else {
var defaultUserIDs = _.pluck( membersWithoutUser, "id" );
var preselectedUserIDs = ( sessionService.get( "selectedUserIDs" ) || defaultUserIDs );
}
_.each(
allUsers,
function( user ) {
user.isSelected = _.contains( preselectedUserIDs, user.id );
}
);
});
var submissionInProgress = false;
var unwatchNewComment = $scope.$watch(
"newComment",
function( newValue, oldValue ) {
if ( newValue === oldValue ) {
return;
}
$scope.setMarkersAsDirty();
unwatchNewComment();
}
);
$scope.$on("$selectEmoji", addEmoji );
$scope.$on("$typeaheadEmoji", typeaheadEmoji );
function addEmoji( event, commentVal, emoji, target ) {
var emojiItem = ":" + emoji + ":";
if ( typeof target === "undefined") {
$scope.newComment = commentVal + emojiItem;
$scope.showCommentInput();
}
else {
target.comment = commentVal + emojiItem;
}
}
function typeaheadEmoji( event, emoji, caretPos, target ) {
var comment = "";
if ( typeof target === "undefined" ) {
comment = emojiService.splitEmoji( $scope.newComment, caretPos );
$scope.newComment = comment.before + comment.colon + emoji + ": " + comment.after;
}
else {
comment = emojiService.splitEmoji( target.comment, caretPos );
target.comment = comment.before + comment.colon + emoji + ": " + comment.after;
}
}
$scope.$on(
"reloadComments",
function() {
var comments = commentService.getCommentsByConversationID( $scope.conversation.id );
$scope.comments = hashKeyCopier.copyHashKeys(augmentComments( comments ), $scope.comments);
}
);
modelEvents.on(
"shareIdentityChanged.commentsFormController",
function( event, user ) {
_.extendExistingProperties( $scope.user, user );
$scope.user.hasSystemAvatar = userService.isSystemAvatar( $scope.user.avatarID );
$scope.user.initials = userService.getInitials( $scope.user.name );
var subdomain = window.location.hostname.split(".")[0];
var analyticsUserID = (config.singleTenantConfig && config.singleTenantConfig.useSingleTenantAnalytics) ? subdomain + "-" + $scope.user.id : $scope.user.id;
analyticsService.identifyGrowth( analyticsUserID, {
"Full Name": $scope.user.name,
Email: $scope.user.email,
"Last Activity": moment($scope.user.lastRequestAt).format("YYYY-MM-DD HH:mm:ss")
});
analyticsService.trackGrowth("App - Login",{
"Login Type": "Email",
"Login Location": "Share"
});
document.cookie = "LOGINEVENTSOURCE=; path=/; domain="+window.location.hostname.match(/\.\w+\.\w+$/g)[0]+"; expires=" + new Date(0).toUTCString();
}
);
modelEvents.on( "projectStakeholderRemoved.commentsFormController", handleProjectStakeholderRemoved );
modelEvents.on( "conversationSubscribersUpdated.commentsFormController", handleConversationSubscriberUpdate );
loadRemoteData();
}
})( angular, InVision );
;
;
/*! markers-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "comments.MarkersController", Controller );
/** @ngInject */
function Controller(
$location,
$scope,
$timeout,
_,
analyticsService,
commentService,
config,
conversationService,
Deferred,
modelEvents,
requestContext,
screenService,
sessionService,
userService
){
function applyData() {
$scope.viewport.width = $scope.screen.width * $scope.screen.displayScale;
$scope.viewport.height = $scope.screen.height * $scope.screen.displayScale;
$scope.viewport.alignment = $scope.screen.alignment;
loadConversation();
}
function loadConversations( screenID ){
$scope.reloadConversations();
applyData();
}
function getNewConversationLabel() {
var maxLabel = 0;
for ( var i = 0, length = $scope.conversations.length ; i < length ; i++ ) {
if( ! isNaN(parseInt( $scope.conversations[ i ].label, 10 )) ) {
maxLabel = Math.max( maxLabel, parseInt( $scope.conversations[ i ].label, 10 ) );
}
}
return( maxLabel + 1 );
}
function loadConversation(conversationID) {
var manualConversationID = !! conversationID;
conversationID = conversationID || requestContext.getParamAsInt( "conversationID", 0 );
if ( conversationID ) {
analyticsService.trackGrowth("App - Public Share - Open Comment Modal", {
Location: "Public Share",
"Is Reply": true,
"Logged In": !!sessionService.user.isAccountAuthenticated
});
$scope.clearCommentSketches();
$scope.setIsShowingConversationMenu( false );
$scope.selectedConversation = null;
$scope.newConversation = null;
$timeout(function() {
if ($scope.needsSignup) {
$scope.setNeedsSignup(false);
$scope.isSignup = true;
analyticsService.track("Comment.SignupFormView");
analyticsService.trackGrowth("App - Signup - View Signup Form", {
"Flow": "Signup to Comment"
});
}
$scope.selectedConversation = _.findWithProperty( $scope.conversations, "id", conversationID );
$scope.setIsShowingConversationMenu( true );
if ( ! $scope.selectedConversation && ! manualConversationID ) {
$location.url( "/screens/" + $scope.screenID + "/comments" );
}
analyticsService.track(
"Comment.Viewed",
{
username: sessionService.user.email,
commentType: conversationService.getMarkerType( $scope.selectedConversation ),
commentLocation: "share",
wasUnread: $scope.selectedConversation.isUnread,
viewedSidebar: false
},
{
integrations: {
All: true,
Mixpanel: true
}
}
);
});
}
}
function isUserACollaborator(){
var user = sessionService.user;
var members = userService.getMembers();
var isTeamMember = !! _.findWithProperty( members, "id", user.id );
return ( user.isAccountAuthenticated && isTeamMember);
}
$scope.areMarkersDirty = function() {
return( hasActiveMarkerWithDirtyData );
};
$scope.closeConversation = function(isScreenChange) {
if ($scope.newConversation && $scope.needsSignup) {
var conversationID = $scope.newConversation.id;
$timeout(function() {
loadConversation(conversationID);
})
}
if( $scope.selectedConversation && !isScreenChange ){
$scope.markConversationAsRead( $scope.selectedConversation );
}
$scope.newConversation = null;
$scope.selectedConversation = null;
$scope.clearCommentSketches();
$scope.isCommentInputVisible = false;
hasActiveMarkerWithDirtyData = false;
if (!isScreenChange) {
$location.url( "/screens/" + $scope.screenID + "/comments" );
}
$scope.setIsShowingConversationMenu( false );
};
$scope.closeJustThisConversationPanel = function(currentConversationID) {
if ( ! $scope.selectedConversation ) {
$scope.closeConversation();
return;
}
if ( currentConversationID === $scope.selectedConversation.id ) {
$scope.closeConversation();
}
};
$scope.deleteConversation = function( conversation ) {
var comments = commentService.getCommentsByConversationID( conversation.id );
Deferred.handlePromise(
conversationService.deleteConversation( conversation.id ),
null,
function( response ) {
$scope.openModalWindow( "error", "For some reason, we couldn't delete the conversation. Try refreshing your browser." );
}
);
$scope.setConversations( _.without( $scope.conversations, conversation ) );
$scope.selectedConversation = null;
screenService.alterCommentCount( conversation.screenID, -comments.length );
};
$scope.setMarkersAsDirty = function() {
hasActiveMarkerWithDirtyData = true;
};
$scope.setMarkersAsClean = function() {
hasActiveMarkerWithDirtyData = false;
};
$scope.setNeedsSignup = function(needsSignup) {
$scope.needsSignup = needsSignup;
}
$scope.deselectAllConversations = function() {
$scope.isSignup = false;
$scope.setNeedsSignup(false);
$scope.closeConversation();
}
$scope.showNextConversation = function() {
var currentIndex = _.indexOf( $scope.conversations, $scope.selectedConversation );
var nextIndex = ( currentIndex + 1 );
var nextConversation = ( $scope.conversations[ nextIndex ] || _.first( $scope.conversations ) );
$location.url( "/screens/" + $scope.screenID + "/comments/" + nextConversation.id );
};
$scope.showPreviousConversation = function() {
var currentIndex = _.indexOf( $scope.conversations, $scope.selectedConversation );
var previousIndex = ( currentIndex - 1 );
var previousConversation = ( $scope.conversations[ previousIndex ] || _.last( $scope.conversations ) );
$location.url( "/screens/" + $scope.screenID + "/comments/" + previousConversation.id );
};
$scope.startNewConversation = function( x, y ) {
analyticsService.trackGrowth("App - Public Share - Open Comment Modal", {
Location: "Public Share",
"Is Reply": false,
"Logged In": !!sessionService.user.isAccountAuthenticated
});
$scope.newConversation = {
id: 0,
x: x / $scope.screen.displayScale,
y: y / $scope.screen.displayScale,
label: $scope.currentCommentType === "tour-point" ? "" : getNewConversationLabel(),
screenID: $scope.screenID,
isForDevelopment: $scope.currentCommentType === "dev-note" ? true :false,
isPrivate: $scope.currentCommentType === "dev-note" || $scope.currentCommentType === "private-comment" ? true : false,
isTourPoint: $scope.currentCommentType === "tour-point" ? true : false,
isComplete: false,
subscribers: []
};
$scope.isCommentInputVisible = true;
$scope.setIsShowingConversationMenu( true );
$scope.setNeedsSignup(false);
$scope.isSignup = false;
analyticsService.track(
"Comment.AnnotationPlaced",
{
username: sessionService.user.email,
commentType: "comment",
commentLocation: "share"
}
);
};
$scope.updateConversationPosition = function( conversation, x, y ) {
conversation.x = x / $scope.screen.displayScale;
conversation.y = y / $scope.screen.displayScale;
Deferred.handlePromise(
conversationService.changePosition( conversation.id, x / $scope.screen.displayScale, y / $scope.screen.displayScale, "" ),
null,
function( response ) {
$scope.openModalWindow( "error", "For some reason, we couldn't update the position of the conversation. Try refreshing your browser." );
}
);
};
$scope.updateNewConversationPosition = function( x, y ) {
$scope.newConversation.x = x / $scope.screen.displayScale;
$scope.newConversation.y = y / $scope.screen.displayScale;
};
var renderContext = requestContext.getRenderContext( "comments", [ "screenID", "conversationID" ] );
var hasActiveMarkerWithDirtyData = false;
$scope.screenID = requestContext.getParamAsInt( "screenID", $scope.defaultScreenIDForShare );
$scope.selectedConversation = null;
$scope.newConversation = null;
$scope.viewport = {
width: 0,
height: 0,
alignment: "center"
};
$scope.userAuthenticated = config.user.isAccountAuthenticated;
$scope.isUserACollaborator = isUserACollaborator();
$scope.$on( "mentionText.editing", function( event, isDirty ) {
if ( !isDirty ) {
$scope.setMarkersAsClean();
} else {
$scope.setMarkersAsDirty();
}
});
$scope.$on(
"$destroy",
function() {
modelEvents.off( "conversationCreated.commentsMarkers" );
modelEvents.off( "conversationUpdated.commentsMarkers" );
}
);
$scope.$on(
"requestContextChanged",
function() {
if ( ! renderContext.isChangeRelevant() ) {
return;
}
hasActiveMarkerWithDirtyData = false;
if ( requestContext.hasParamChanged( "screenID" ) ) {
$scope.screenID = requestContext.getParamAsInt( "screenID", $scope.defaultScreenIDForShare );
$scope.closeConversation(true);
loadConversations( $scope.screenID );
} else if ( requestContext.hasParamChanged( "conversationID" ) ) {
loadConversation();
}
}
);
$scope.$on(
"conversationSelected",
function(event, conversation) {
if( ! $scope.selectedConversation ) {
$scope.selectedConversation = conversation;
} else if( !! conversation ) {
loadConversation(conversation.id);
} else {
$scope.selectedConversation = null;
}
}
);
modelEvents.on(
"conversationCreated.commentsMarkers",
function( event, conversation ) {
if ( conversation.screenID !== $scope.screenID ) {
return;
}
loadConversations( $scope.screenID );
}
);
modelEvents.on(
"conversationUpdated.commentsMarkers",
function( event, conversation ) {
if ( conversation.screenID !== $scope.screenID ) {
return;
}
var cachedConversation = _.findWithProperty( $scope.conversations, "id", conversation.id );
if ( cachedConversation ) {
cachedConversation.isComplete = conversation.isComplete;
cachedConversation.subscribers = conversation.subscribers;
}
}
);
modelEvents.on(
"conversationDeleted.commentsMarkers",
function( event, conversationID ){
if( $scope.selectedConversation ){
if( conversationID == $scope.selectedConversation.id){
$scope.selectedConversation = null;
}
}
}
);
applyData();
}
})( angular, InVision );
;
;
/*! modal-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "layouts.ModalController", Controller );
/** @ngInject */
function Controller( $scope, modalWindowRequest, beforeUnloadService, _ ) {
var originalBodyClass = "";
var isPageRefreshing = false;
$scope.subview = null;
$scope.nextSubview = null;
$scope.$on(
"modalWindowHidden",
function( event ) {
$scope.subview = $scope.nextSubview;
$scope.nextSubview = null;
if( $scope.subview === null ) {
$scope.setBodyClass( originalBodyClass );
}
}
);
$scope.$on(
"openModalWindow",
function( event, modalType, modalData ) {
if ( isPageRefreshing ) {
return;
}
if ( $scope.subview === null ) {
modalWindowRequest.setRequest( modalType, modalData );
$scope.subview = modalType;
originalBodyClass = $scope.bodyClass;
$scope.setBodyClass( $scope.bodyClass + " modal-open" );
} else if ( modalType === "error" && $scope.subview === modalType ) {
return;
} else {
modalWindowRequest.setRequest( modalType, modalData, true ); // TRUE == suppress fade
$scope.nextSubview = modalType;
$scope.$broadcast( "closeModalWindowWithoutFade" );
}
}
);
beforeUnloadService.push(
this,
function() {
isPageRefreshing = true;
setTimeout(
function() {
isPageRefreshing = false;
},
1000
);
}
);
}
})( angular, InVision );
;
;
/*! loading-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "loading.LoadingController", Controller );
/** @ngInject */
function Controller( $scope, config ){
$scope.loadingSequenceCompleted = function() {
$scope.closeLoading();
};
$scope.percentLoaded = 0;
$scope.$watch(
function() {
return ( $scope.getPercentOfScreensLoaded() );
},
function( newValue ) {
$scope.percentLoaded = newValue;
}
);
}
})( angular, InVision );
;
;
/*! auth-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "modal.Auth", Controller );
function Controller( $scope, $window, analyticsService, config, modalWindowRequest ) {
var modalData = modalWindowRequest.getData( 0 ) || {};
var companySettings = (config && config.companySettings || {});
var isEnterprise = companySettings.isEnterprise;
var invAnalytics = ($window.InvAnalytics || {});
var forceOffSSO = invAnalytics.forceOffSSO !== undefined ? !!invAnalytics.forceOffSSO : false;
$scope.showSignup = modalData.showSignup === undefined ? true : modalData.showSignup;
$scope.showLogin = !$scope.showSignup;
$scope.showWelcomeUser = modalData.showWelcomeUser === undefined ? true : modalData.showWelcomeUser;
$scope.isFullScreenMode = modalData.isFullScreenMode === undefined ? true : modalData.isFullScreenMode;
$scope.ssoEnabled = forceOffSSO ? false : companySettings.isSSO;
$scope.companyImage = companySettings.companyLogo ? ('/logos/' + companySettings.companyLogo) : null;
$scope.companyName = companySettings.companyName;
$scope.ssoURL = '/sso/sp_login?redir=' + encodeURIComponent(window.location.pathname + '#' + $scope.generateCommentUrl() + '?welcome=true&sso=true');
analyticsService.track("Comment.SignupFormView");
analyticsService.trackGrowth("App - Signup - View Signup Form", {
"Flow": isEnterprise ? "Signup to Comment Modal - Enterprise" : "Signup to Comment Modal",
"Triggered By": modalData.trigger === 'banner' ?  "Share Banner" : "Comment Mode Toggle"
});
$scope.closeModal = function(){
$scope.closeModalWindow();
};
$scope.ssoLinkClick = function(){
analyticsService.trackGrowth("App - Signup - Click SSO Login Link");
};
$scope.switchPrompt = function(requireSignIn){
$scope.setErrorMessage(/*empty*/);
$scope.showSignup = !requireSignIn && !$scope.showSignup;
$scope.showLogin = requireSignIn || !$scope.showLogin;
};
$scope.$on('shareAuthenticationChanged', function(){
$scope.closeModal();
setTimeout(function(){
if($scope.showWelcomeUser) {
$scope.openModalWindow( 'welcomeUser', {fromSignUp: $scope.showSignup});
}
}, 200)
});
$scope.$on('shareAuthenticationSignupError:existingUser', function(){
$scope.switchPrompt(/*requireSignIn*/ true);
});
$scope.setErrorMessage = function(message){
$scope.$broadcast('shareAuthenticationSetErrorMessage', message || '');
};
}
})( angular, InVision );
;
;
/*! error-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "modal.ErrorController", Controller );
/** @ngInject */
function Controller( $scope, modalWindowRequest, _ ) {
$scope.errorMessage = modalWindowRequest.getData( 0 );
}
})( angular, InVision );
;
;
/*! share-tour-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "modal.ShareTour", Controller );
function Controller( $scope, userPreferenceService, modelEvents ) {
$scope.closeTour = function(){
$scope.closeModalWindow();
};
modelEvents.trigger( "markHasSeenCommentTooltipFromTour" );
userPreferenceService.setUserPreferenceById( $scope.hasSeenShareWalkThroughUserPreferenceID, "true" );
$scope.setHasSeenShareWalkThrough( true );
}
})( angular, InVision );
;
;
/*! welcome-user-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "modal.WelcomeUser", Controller );
function Controller( $scope, $timeout, modalWindowRequest, sessionService ) {
var modalData = modalWindowRequest.getData( 0 ) || {};
$scope.signedUp = !!modalData.fromSignUp;
$scope.user = sessionService.user;
$scope.closeModal = function(){
$scope.closeModalWindow();
};
$timeout(function(){
$scope.closeModal();
$scope.navigateToScreenComments();
}, 4000);
}
})( angular, InVision );
;
;
/*! preview-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "preview.PreviewController", Controller );
/** @ngInject */
function Controller(
$scope,
$rootScope,
$timeout,
$window,
requestContext,
hotspotService,
projectService,
screenService,
sessionService,
commentService,
userService,
shareService,
_,
config,
$q,
conversationService
) {
var vm = this;
var tourPointTooltipTimeout;
var cachedConfig = angular.copy(config);
function supportsHtml5Storage() {
var tempString = "test";
try {
localStorage.setItem(tempString, tempString);
localStorage.removeItem(tempString);
return true;
} catch(e) {
return false;
}
}
function loadTourPoints() {
var initialTourPoints = augmentTourPoints(_.filter(config.conversations, {
isTourPoint: true,
isComplete: false
}));
var tourPoints = [];
var screen = null;
for ( var i = 0; i < config.screens.length; i++ ) {
screen = config.screens[ i ];
var screenTourPoints = _.filter(initialTourPoints, {
screenID: screen.id
});
if ( !! screenTourPoints ) {
var partitionedPoints = _.partition(screenTourPoints, function(n) {
return n.manualOrder === -1 || n.manualOrder === "";
});
var normalSortedTourPoints = partitionedPoints[0];
var manuallySortedTourPoints = partitionedPoints[1];
normalSortedTourPoints.sort(function( a, b ) {
return a.y - b.y || a.x - b.x;
});
var resortedTourPoints = [];
if(manuallySortedTourPoints.length > 0) {
manuallySortedTourPoints.sort(function( a,b ) {
if( a.manualOrder === b.manualOrder ) {
return a.y - b.y || a.x - b.x;
}
return a.manualOrder - b.manualOrder;
});
var minManualOrder = _.min(manuallySortedTourPoints, 'manualOrder').manualOrder;
var maxManualOrder = _.max(manuallySortedTourPoints, 'manualOrder').manualOrder;
var position = (minManualOrder === 0 ? 0 : 1);
for( position; position <= maxManualOrder; position++) {
var manualForPosition = _.filter(manuallySortedTourPoints, { manualOrder: position });
if(manualForPosition.length === 0 && normalSortedTourPoints.length > 0) {
resortedTourPoints.push( normalSortedTourPoints.shift() );
} else {
resortedTourPoints = resortedTourPoints.concat(manualForPosition);
}
}
}
resortedTourPoints = resortedTourPoints.concat(normalSortedTourPoints);
resortedTourPoints.forEach(function( point ) {
point.section = tourPointSection( point, screen );
tourPoints.push( point );
});
}
}
$timeout(function() {
$rootScope.$broadcast("loadTourPoints", tourPoints);
});
return tourPoints;
}
function tourPointSection( tourPoint, screen ) {
var HEADER = "header";
var BODY = "body";
var FOOTER = "footer";
if ( !tourPoint || !screen ) {
return BODY;
}
var screenHeader = screen.fixedHeaderHeight;
var screenFooter = screen.height - screen.fixedFooterHeight;
var footerOffset = 25;
if ( tourPoint.y < screenHeader ) {
return HEADER;
}
if ( tourPoint.y + footerOffset >= screenFooter ) {
return FOOTER;
}
return BODY;
}
function augmentTourPoints( tourPoints ) {
for ( var i = 0; i < tourPoints.length; i++ ) {
var comments = commentService.getCommentsByConversationID( tourPoints[ i ].id );
tourPoints[ i ].comment = comments[0];
tourPoints[ i ].comment.html = commentService.getHtmlForComment( tourPoints[ i ].comment.comment );
tourPoints[ i ].comment.userHasSystemAvatar = userService.isSystemAvatar( tourPoints[ i ].comment.userAvatarID );
tourPoints[ i ].comment.userInitials = userService.getInitials( tourPoints[ i ].comment.userName );
tourPoints[ i ].comment.userOnlineStatus = userService.getOnlineStatus( tourPoints[ i ].comment.userLastRequestAt );
tourPoints[ i ].comment.userFirstName = tourPoints[ i ].comment.userName.split(" ")[0];
tourPoints[ i ].isUnread = isTourPointUnread( tourPoints[ i ].id );
}
return tourPoints;
}
function isTourPointUnread( conversationID ) {
var tourPoints = [];
if ( !supportsHtml5Storage() ) {
return true;
}
if ( window.localStorage.getItem("tourPoints") === null ) {
window.localStorage.setItem("tourPoints", JSON.stringify(tourPoints) );
}
tourPoints = JSON.parse( window.localStorage.getItem("tourPoints") );
var thisTourPoint = _.findWithProperty( tourPoints, "conversationID", conversationID );
if ( thisTourPoint === undefined ) {
thisTourPoint = {
conversationID: conversationID,
isUnread: true
};
tourPoints.push( thisTourPoint );
window.localStorage.setItem("tourPoints", JSON.stringify(tourPoints) );
}
return thisTourPoint.isUnread;
}
function setTourPointIsUnread( conversationID, isUnread ) {
var tourPoints = [];
if ( !supportsHtml5Storage() ) {
return;
}
if ( window.localStorage.getItem("tourPoints") === null ) {
window.localStorage.setItem("tourPoints", JSON.stringify(tourPoints) );
}
tourPoints = JSON.parse( window.localStorage.getItem("tourPoints") );
var thisTourPoint = _.findWithProperty( tourPoints, "conversationID", conversationID );
if ( thisTourPoint === undefined ) {
thisTourPoint = {
conversationID: conversationID,
isUnread: !!isUnread
};
tourPoints.push( thisTourPoint );
} else {
thisTourPoint.isUnread = !!isUnread;
}
window.localStorage.setItem("tourPoints", JSON.stringify(tourPoints) );
}
function convertBottomPositionedHotspots() {
for ( var h = 0; h < $scope.hotspots.length; h++) {
if ( $scope.hotspots[h].isBottomAligned ) {
$scope.hotspots[h].y = $scope.screen.height - ( $scope.hotspots[h].y + $scope.hotspots[h].height);
}
}
}
function applyRemoteData( screen ) {
if ( !screen ) {
$scope.hotspots = [];
return;
}
$scope.setScreen( screen );
$scope.setBodyClass();
$scope.hotspots = hotspotService.getHotspotsByScreenID( $scope.screenID );
$scope.allHotspots = config.hotspots;
$scope.project.mobileTemplate = _.filter(config.mobileDevices, { mobileDeviceID: $scope.project.mobileDeviceID })[0];
convertBottomPositionedHotspots();
$scope.setWindowTitle( screen.name );
}
function getSampleProjectStatus( project ) {
return (
project.isSample &&
( project.id !== 75 ) && // Desktop wireframe.
( project.id !== 87 ) && // Desktop hi-fidelity.
( project.id !== 101727 ) && // Mobile hi-fidelity.
( project.id !== 5701 ) // Mobile wireframe.
);
}
function updateSlideshowSettings() {
var isSlideshowNavAllowed = sessionService.get( "isSlideshowNavAllowed" );
var hasFirstScreenHotSpots = sessionService.get( "hasFirstScreenHotSpots" );
var isKeyboardNavUsed = sessionService.get( "isKeyboardNavUsed", false );
var hasMultipleScreens = ( $scope.screens.length > 1 );
if (
isSlideshowNavAllowed === true &&
hasMultipleScreens === true &&
(
hasFirstScreenHotSpots === false ||
isKeyboardNavUsed === true
)
) {
sessionService.set( "isShowingSlideshowNav", true );
$scope.isShowingSlideshowNav = true;
}
}
function initShareSettings() {
var share = shareService.getShare();
sessionService.set(
"hasFirstScreenHotSpots",
( !_.isEmpty( $scope.hotspots ) )
);
sessionService.set(
"isSlideshowNavAllowed", (
!share.isUserTesting &&
share.isLoadAllScreens // Allow access to all screens in project
)
);
$scope.isUserTesting = share.isUserTesting;
$timeout(function() {
updateSlideshowSettings();
});
}
function loadRemoteData() {
var screen = screenService.getScreenByID( $scope.screenID );
if ( screen ) {
$timeout(function() {
applyRemoteData(screen);
}, $scope.project.isMobile ? 100 : 0);
}
}
function transitionToNextScreen(hotspot) {
$scope.navigateToTargetScreen( hotspot.targetScreenID );
}
function prepareTransitionLayer() {
return $scope.$broadcast("mobile:transition:prepare");
}
function runTransitionLayer() {
return $timeout(function() {
vm.isTransitioning = true;
$scope.$broadcast("mobile:transition:run");
});
}
function updateTransitionLayer(target, update, isHotspotPositionOnScreen) {
return $timeout(function() {
if (!isHotspotPositionOnScreen && target) {
$scope.setScreen(target);
}
vm.isTransitioning = false;
if (update) {
$scope.$broadcast("mobile:transition:updateCurrent");
}
});
}
vm.hot = {
initialized: false,
threshold: 5, // pixel
x: 0,
y: 0
};
$scope.applyHotspotNavigation = function( hotspot, transitionData ) {
if ( !hotspot ) { // if we've got no hotspot, we've got no navigation
return;
}
screenService.setScreenClickedOn( $scope.screen );
var targetScreen;
var isHotspotPositionOnScreen = false;
if ( hotspot.targetTypeID === hotspotService.targetTypes.previousScreenInSort ) {
targetScreen = screenService.getPreviousScreen( $scope.screenID );
} else if ( hotspot.targetTypeID === hotspotService.targetTypes.nextScreenInSort ) {
targetScreen = screenService.getNextScreen( $scope.screenID );
} else if ( hotspot.targetTypeID === hotspotService.targetTypes.lastScreenVisited ) {
var history = $scope.getScreenHistory();
targetScreen = screenService.getScreenByID( history[ history.length - 2] ); //go back two steps.
} else {
targetScreen = screenService.getScreenByID( hotspot.targetScreenID );
}
hotspot.targetScreenID = targetScreen.id;
if (
$scope.project.isMobile &&
hotspot.transitionTypeID > 1 &&
hotspot.targetTypeID !== 6 &&
hotspot.targetTypeID !== 5
) {
if ( targetScreen && hotspot.transitionTypeID !== 1 ) {
transitionData.targetScreen = targetScreen;
screenService.setCurrentScreen(targetScreen);
$scope.setTransitionData(transitionData);
$scope.$broadcast(
"mobile:transition:updateCurrent",
function() {
$timeout(prepareTransitionLayer)
.then(runTransitionLayer)
.then(transitionToNextScreen
.bind(this, hotspot)
)
.then(updateTransitionLayer
.bind(this, targetScreen, false)
);
}
);
}
} else {
updateTransitionLayer(targetScreen, true)
.then(transitionToNextScreen
.bind(this, hotspot)
);
}
};
$scope.keyboardNavUsed = function() {
sessionService.set( "isKeyboardNavUsed", true );
updateSlideshowSettings();
};
$scope.showNextScreen = function() {
var nextScreen = screenService.getNextScreen( $scope.screenID );
$scope.navigateToTargetScreen( nextScreen.id );
};
$scope.showPreviousScreen = function() {
var previousScreen = screenService.getPreviousScreen( $scope.screenID );
$scope.navigateToTargetScreen( previousScreen.id );
};
$scope.selectTooltipTourPoint = function( tourPoint ) {
if ( !!tourPointTooltipTimeout ) {
$timeout.cancel(tourPointTooltipTimeout);
}
if ( !!$scope.selectedTourPoint ) {
$scope.tooltipTourPoint = null;
} else {
$scope.tooltipTourPoint = tourPoint;
}
$rootScope.$broadcast("tourPointTooltipSelected", tourPoint);
};
$scope.clearTooltipTourPoint = function() {
if ( !$scope.tooltipTourPoint ) {
return;
}
tourPointTooltipTimeout = $timeout(function() {
$rootScope.$broadcast("clearTooltipTourPoint");
}, 125);
};
$scope.clearTooltipTimeout = function() {
$timeout.cancel(tourPointTooltipTimeout);
};
$scope.selectTourPoint = function(tourPoint, $event) {
$scope.selectedTourPoint = !!tourPoint ? _.findWithProperty($scope.tourPoints, "id", tourPoint.id) : null;
$rootScope.$broadcast("selectTourPoint", tourPoint, $event);
};
var renderContext = requestContext.getRenderContext( "preview", "screenID" );
var hotspotTimeout;
var hotspotWatcher = angular.noop;
var hotspotDebounced = false;
var hotspotDebounceTimeout = null;
var firstLoad = true;
$scope.screens = screenService.getScreens();
var defaultScreenID = requestContext.getParamAsInt( "screenID", $scope.defaultScreenIDForShare );
if (!config.project.isMobile) {
$scope.screenID = defaultScreenID;
} else {
var defaultScreen = _.findWithProperty( $scope.screens, "id", defaultScreenID );
if ( defaultScreen && ( defaultScreen.screenTypeID === 3 ) ) {
var targetScreen = _.min($scope.screens, "sort");
$scope.screenID = targetScreen.id;
} else {
$scope.screenID = defaultScreenID;
}
}
$scope.inViewport = false;
$scope.hotspots = [];
$scope.allHotspots = [];
$scope.isSampleProject = getSampleProjectStatus( projectService.getProject() );
$scope.project = projectService.getProject();
$scope.project.mobileTemplate = _.filter(config.mobileDevices, { mobileDeviceID: $scope.project.mobileDeviceID })[0];
$scope.isShowingHotspots = false;
$scope.isShowingSlideshowNav = false;
$scope.tourPoints = loadTourPoints();
$scope.selectedConversation = null;
$scope.selectedTourPoint = null;
$scope.tooltipTourPoint = null;
$scope.currentScreenIndex = screenService.getCurrentScreenIndex();
$scope.screenCount = screenService.getTotalScreenCount();
$scope.$on(
"loadingSequenceCompleted",
function() {
if ( $scope.screen ) {
$scope.setWindowTitle( $scope.screen.name );
}
}
);
$scope.$on(
"requestContextChanged",
function() {
if ( !renderContext.isChangeRelevant() ) {
return;
}
$scope.screenID = requestContext.getParamAsInt( "screenID", $scope.defaultScreenIDForShare );
loadRemoteData();
$scope.isShowingHotspots = false;
}
);
$scope.$on(
"doTransition",
function(event, hotspot, transitionData) {
$scope.applyHotspotNavigation(hotspot, transitionData);
}
);
$scope.$on(
"setSelectedTourPoint",
function(event, tourPoint) {
$scope.selectedTourPoint = tourPoint;
}
);
$scope.$watch(
"isShowingSlideshowNav",
function( newValue ) {
$scope.$emit("isShowingSlideshowNav", newValue);
}
);
$scope.$watch(
screenService.getCurrentScreenIndex,
function(newValue) {
$scope.currentScreenIndex = newValue;
}
);
$scope.$on(
"showNextScreen",
function() {
$scope.showNextScreen();
}
);
$scope.$on(
"showPreviousScreen",
function() {
$scope.showPreviousScreen();
}
);
$scope.$on(
"autoRedirectTriggered.share",
function( event, hotspot ) {
$rootScope.$broadcast("clearTourPointForm");
InvScreenViewer.actions.activateHotspot( hotspot );
}
);
$scope.$on(
"clearTooltipTimeout",
function() {
$scope.clearTooltipTimeout();
}
);
$scope.$on(
"configUpdated.share",
function( event, localConfig ) {
var isTemplateChange = localConfig.project.mobileDeviceID !== $scope.project.mobileDeviceID;
if (isTemplateChange) {
$scope.project = localConfig.project;
$scope.project.mobileTemplate = _.withProperty($scope.deviceTemplates, "mobileDeviceID", localConfig.project.mobileDeviceID)[0];
$scope.project.isWatch = $scope.project.mobileTemplate.deviceType === "watch";
$scope.deviceTemplate = $scope.project.mobileTemplate;
}
if ( !_.isEqual(localConfig, cachedConfig) || isTemplateChange ) {
$scope.screens = screenService.getScreens();
$scope.screenCount = $scope.screens.length;
loadRemoteData();
}
}
);
$scope.Math = window.Math;
loadRemoteData();
initShareSettings();
}
})( angular, InVision );
;
;
/*! tour-comments-controller.js */ 
;
;
(function( ng, app ) {
"use strict";
app.controller( "preview.TourCommentsController", Controller );
/** @ngInject */
function Controller( $scope, $rootScope, $log, $timeout, $location, $window, requestContext, hotspotService, projectService, screenService, sessionService, commentService, userService, shareService, _, config, $q, conversationService) {
function supportsHtml5Storage() {
var tempString = "test";
try {
localStorage.setItem(tempString, tempString);
localStorage.removeItem(tempString);
return true;
} catch(e) {
return false;
}
}
function isTourPointUnread( conversationID ) {
var tourPoints = [];
if ( !supportsHtml5Storage() ) {
return true;
}
if ( $window.localStorage.getItem("tourPoints") === null ) {
$window.localStorage.setItem("tourPoints", JSON.stringify(tourPoints) );
}
tourPoints = JSON.parse( $window.localStorage.getItem("tourPoints") );
var thisTourPoint = _.findWithProperty( tourPoints, "conversationID", conversationID );
if ( thisTourPoint === undefined ) {
thisTourPoint = {
conversationID: conversationID,
isUnread: true
};
tourPoints.push( thisTourPoint );
$window.localStorage.setItem("tourPoints", JSON.stringify(tourPoints) );
}
return thisTourPoint.isUnread;
}
function setTourPointIsUnread( conversationID, isUnread ) {
var tourPoints = [];
if ( ! supportsHtml5Storage() ) {
return;
}
if ( $window.localStorage.getItem("tourPoints") === null ) {
$window.localStorage.setItem("tourPoints", JSON.stringify(tourPoints) );
}
tourPoints = JSON.parse( $window.localStorage.getItem("tourPoints") );
var thisTourPoint = _.findWithProperty( tourPoints, "conversationID", conversationID );
if ( thisTourPoint === undefined ) {
thisTourPoint = {
conversationID: conversationID,
isUnread: !!isUnread
};
tourPoints.push( thisTourPoint );
} else {
thisTourPoint.isUnread = !!isUnread;
}
$window.localStorage.setItem("tourPoints", JSON.stringify(tourPoints) );
}
$scope.clearTooltipTourPoint = function() {
$timeout(function() {
$scope.tooltipTourPoint = null;
});
};
$scope.clearTooltipTimeout = function() {
$rootScope.$broadcast("clearTooltipTimeout");
};
$scope.hasPreviousTourPoint = function() {
if ( !$scope.selectedTourPoint ) {
return false;
}
var pointIndex = _.indexOfWithProperty($scope.tourPoints, "id", $scope.selectedTourPoint.id);
if ( pointIndex >= 1 ) {
return true;
} else {
return false;
}
};
$scope.hasNextTourPoint = function() {
if ( !$scope.selectedTourPoint ) {
return false;
}
var pointIndex = _.indexOfWithProperty($scope.tourPoints, "id", $scope.selectedTourPoint.id);
if ( !!$scope.tourPoints[pointIndex + 1] ) {
return true;
} else {
return false;
}
};
$scope.previousTourPoint = function() {
if ( !$scope.selectedTourPoint || isTransitioning ) {
return;
}
isTransitioning = true;
var pointIndex = _.indexOfWithProperty($scope.tourPoints, "id", $scope.selectedTourPoint.id);
$scope.selectTourPoint( $scope.tourPoints[pointIndex - 1] );
};
$scope.nextTourPoint = function() {
if ( !$scope.selectedTourPoint || isTransitioning ) {
return;
}
isTransitioning = true;
var pointIndex = _.indexOfWithProperty($scope.tourPoints, "id", $scope.selectedTourPoint.id);
$scope.selectTourPoint( $scope.tourPoints[pointIndex + 1] );
};
$scope.selectTourPoint = function( tourPoint, $event ) {
var screenID = requestContext.getParamAsInt( "screenID" );
var timeoutTimer = 0;
if ( !!tourPoint ) {
tourPoint.isUnread = false;
setTourPointIsUnread( tourPoint.id, false );
if ( config.user.isAccountAuthenticated ) {
conversationService.markRead( tourPoint.id );
}
}
if ( !!tourPoint && tourPoint.screenID !== screenID ) {
$scope.selectedTourPoint = null;
$scope.$broadcast("conversationSelected", null, $event);
timeoutTimer = 250;
$scope.navigateToTargetScreen( tourPoint.screenID, false );
} else if ( !!$scope.selectedTourPoint ) {
$scope.selectedTourPoint = null;
$scope.$broadcast("clearTooltipTourPoint");
$scope.$broadcast("conversationSelected", null, $event);
}
$timeout(function() {
$rootScope.$broadcast("setSelectedTourPoint", tourPoint);
$scope.tooltipTourPoint = null;
$scope.$broadcast("clearTooltipTourPoint");
$scope.selectedTourPoint = tourPoint;
$scope.$broadcast("conversationSelected", tourPoint, $event);
if ( timeoutTimer === 250 ) {
$timeout(function() {
isTransitioning = false;
}, 350);
} else {
isTransitioning = false;
}
}, timeoutTimer);
};
$scope.clearTourPointForm = function() {
$scope.$broadcast("conversationSelected", null);
$rootScope.$broadcast("setSelectedTourPoint", null);
};
var isTransitioning = false;
$scope.selectedTourPoint = null;
$scope.tourPoints = [];
$scope.tooltipTourPoint = null;
$scope.$watch(
"screen.id",
function(newValue, oldValue) {
if ( newValue !== oldValue ) {
$scope.selectedTourPoint = null;
$scope.tooltipTourPoint = null;
}
}
);
$scope.$on(
"loadTourPoints",
function( event, tourPoints ) {
$scope.tourPoints = _.clone(tourPoints);
}
);
$scope.$on(
"conversationSelected",
function( event, conversation, mouseEvent ) {
$scope.selectedTourPoint = conversation;
}
);
$scope.$on(
"tourPointTooltipSelected",
function( event, tourPoint ) {
$scope.tooltipTourPoint = tourPoint;
$timeout(function() {
$scope.$broadcast("refreshTooltipStyle");
});
}
);
$scope.$on(
"clearTooltipTourPoint",
function() {
$scope.clearTooltipTourPoint();
}
);
$scope.$on(
"selectTourPoint",
function(event, tourPoint, mouseEvent) {
$scope.selectTourPoint( tourPoint, mouseEvent );
}
);
$scope.$on(
"clearTourPointForm",
function() {
$scope.clearTourPointForm();
}
);
}
})( angular, InVision );
;
;
/*! screens-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "screens.ScreensController", Controller );
/** @ngInject */
function Controller( $scope, $timeout, $location, requestContext, screenService, hashKeyCopier, projectService, shareService, projectViewingService, hotspotService, _, config ) {
$scope.Math = window.Math;
function applyBackgroundStyles( screen, suppressBackgroundOptions ) {
var style = {};
if ( $scope.project.isMobile ){
style[ "background" ] = "#afb2bd top center no-repeat";
} else {
style[ "border-style" ] = "";
style[ "border-image" ] = "none";
style[ "border-width" ] = "";
style[ "height" ] = "";
style[ "border-image-outset" ] = "";
style[ "background-attachment" ] = "";
style[ "background-position" ] = "";
style[ "background-color" ] = "#f9f9fb";
if ( screen.backgroundColor ) {
style[ "background-color" ] = ( "#" + screen.backgroundColor );
}
if ( screen.backgroundImageUrl ) {
var offsetTop = $scope.subview == "comments" ? "55px" : "0px";
style[ "background-image" ] = ( "url( '" + screen.backgroundImageUrl + "' )" )
switch ( screen.backgroundImagePosition ) {
case "center":
case "50% 0 no-repeat": // TODO: remove after db is updated
style[ "background-position" ] = "50% " + offsetTop;
style[ "background-repeat" ] = "no-repeat";
break;
case "tile":
case "repeat": // TODO: remove after db is updated
style[ "background-position" ] = "0px " + offsetTop;
style[ "background-repeat" ] = "repeat";
break;
case "tile-horizontally":
case "0 0 repeat-x": // TODO: remove after db is updated
style[ "background-position" ] = "0px " + offsetTop;
style[ "background-repeat" ] = "repeat-x";
break;
case "fixed":
style[ "background-attachment" ] = "fixed";
style[ "background-repeat" ] = "no-repeat";
switch ( screen.alignment ){
case "left":
style[ "background-position" ] = "left top";
break;
case "center":
style[ "background-position" ] = "center top";
break;
case "right":
style[ "background-position" ] = "right top";
break;
default:
break;
}
break;
}
}
if( screen.backgroundImageClientFilename.indexOf("@2x") >= 0 ){
style["background-size"] = screen.backgroundImageWidth * 0.5 + "px " + screen.backgroundImageHeight * 0.5 + "px";
} else if ( screen.backgroundImageClientFilename.indexOf("@print") > 0 ) {
style["background-size"] = screen.backgroundImageWidth * 0.3333 + "px " + screen.backgroundImageHeight * 0.3333 + "px";
}
if ( screen.backgroundAutostretch ) {
style[ "background-image" ] = "";
style[ "border-style" ] = "solid";
style[ "border-image" ] = "url('" + screen.imageUrl + "') 0 0 0 " + ( screen.width - 1 ) + " fill stretch";
style[ "border-width" ] = "0px 1px 0px 1px";
style[ "height" ] = screen.height * screen.displayScale;
style[ "border-image-outset" ] = "0% 100%";
style["margin-left"] = "-1px";
style["margin-right"] = "-2px";
} else if ( screen.backgroundFrame ) {
}
}
$scope.setHeaderStyle( angular.copy(style) );
$scope.setBodyStyle( style );
$scope.setBodyClass( screen.backgroundFrame ? "framed" : "" );
}
function augmentScreen( screen ) {
screen.isImageLoaded = false;
screen.isGif = /\.gif$/i.test( screen.clientFilename );
$scope.applyScreenDisplayScaleToScreen( screen );
screen.now = new Date().getTime();
}
function augmentScreens( screens ) {
_.each( screens, augmentScreen );
return( screens );
}
function getScreensToPreload() {
if ( $scope.project.isMobile ) {
return( $scope.screens );
}
var screens = _.filter(
$scope.screens,
function( screen ) {
return( screen.distanceFromStartScreen <= 1 );
}
);
return( screens );
}
function sortScreensByRelevance( screens ) {
var startScreen = _.findWithProperty( screens, "id", $scope.screenID );
if ( ! startScreen ) {
startScreen = _.findWithProperty( screens, "id", $scope.defaultScreenIDForShare );
}
startScreen.distanceFromStartScreen = 0;
var index = _.indexOf( screens, startScreen );
for ( var i = ( index + 1 ) ; i < screens.length ; i++ ) {
screens[ i ].distanceFromStartScreen = ( i - index );
}
for ( var i = ( index - 1 ) ; i >= 0 ; i-- ) {
if ( i == ( index - 1 ) ) {
screens[ i ].distanceFromStartScreen = ( index - i );
} else {
screens[ i ].distanceFromStartScreen = ( screens.length - 1 - i );
}
}
spiderScreensForNavigationalDistance(
screens,
_.pluck( screens, "id" ),		// List of all the screen IDs (for sort-based hotspots).
startScreen.id,					// Current screen to examine.
1,								// Start depth of spidering.
1								// Max depth of spidering
);
screens.sort(
function( a, b ) {
if ( a.distanceFromStartScreen < b.distanceFromStartScreen ) {
return( -1 );
}
if ( a.distanceFromStartScreen > b.distanceFromStartScreen ) {
return( 1 );
}
return( 0 );
}
);
return( screens );
}
function spiderScreensForNavigationalDistance( screens, allScreenIDs, screenID, depth, maxDepth ) {
if ( depth > maxDepth ) {
return;
}
var hotspots = hotspotService.getHotspotsByScreenID( screenID );
for ( var i = 0 ; i < hotspots.length ; i++ ) {
var hotspot = hotspots[ i ];
if ( hotspot.targetTypeID === hotspotService.targetTypes.screen ) {
var targetScreen = _.findWithProperty( screens, "id", hotspot.targetScreenID );
if ( ! targetScreen ) {
continue;
}
targetScreen.distanceFromStartScreen = Math.min(
targetScreen.distanceFromStartScreen,
( hotspot.templateID ? ( depth + .5 ) : depth )
);
spiderScreensForNavigationalDistance( screens, allScreenIDs, targetScreen.id, ( depth + 1 ), maxDepth );
} else if ( hotspot.targetTypeID === hotspotService.targetTypes.nextScreenInSort ) {
var currentIndex = _.indexOf( allScreenIDs, screenID );
if ( currentIndex < ( screens.length - 1 ) ) {
var targetScreen = screens[ currentIndex + 1 ];
targetScreen.distanceFromStartScreen = Math.min( targetScreen.distanceFromStartScreen, depth );
spiderScreensForNavigationalDistance( screens, allScreenIDs, targetScreen.id, ( depth + 1 ), maxDepth );
}
}
} // END: For.
}
$scope.imageLoadedForScreen = function( screen ) {
if ( !screen ) {
return;
}
screen.isImageLoaded = true;
if ( $scope.getPercentOfScreensLoaded() >= 100 ) {
return;
}
if ( _.findWithProperty( $scope.screensToPreload, "id", screen.id ) ) {
$scope.screensThatHavePreloaded.push( screen );
}
var percent = Math.floor( $scope.screensThatHavePreloaded.length / $scope.screensToPreload.length * 100 );
$scope.setPercentOfScreensLoaded( percent );
}
var renderContext = requestContext.getRenderContext( "", "screenID" );
var numberOfScreensLoaded = 0;
$scope.share = shareService.getShare();
$scope.screenID = requestContext.getParamAsInt( "screenID", $scope.defaultScreenIDForShare );
$scope.screens = sortScreensByRelevance( augmentScreens( screenService.getScreens() ) );
$scope.screensToPreload = getScreensToPreload();
$scope.screensThatHavePreloaded = [];
$scope.project = projectService.getProject();
$scope.selectedScreen = _.findWithProperty( $scope.screens, "id", $scope.screenID );
if ( $scope.selectedScreen ) {
applyBackgroundStyles( $scope.selectedScreen );
} else {
$location.url( "/" );
}
$scope.$on(
"requestContextChanged",
function() {
if ( ! renderContext.isChangeRelevant() ) {
return;
}
var previousScreenID = $scope.screenID;
$scope.screenID = requestContext.getParamAsInt( "screenID", $scope.defaultScreenIDForShare );
if ( previousScreenID !== $scope.screenID ) {
$timeout(function() {
$scope.selectedScreen = _.findWithProperty( $scope.screens, "id", $scope.screenID );
if ( $scope.selectedScreen ) {
applyBackgroundStyles( $scope.selectedScreen );
} else {
return( $location.url( "/" ) );
}
}, 200);
}
}
);
$scope.$watch( "subview", function( newValue, oldValue){
if( newValue != oldValue){
applyBackgroundStyles( $scope.selectedScreen );
}
});
$scope.$on(
"configUpdated.share",
function(event, localConfig){
var isTemplateChange = localConfig.project.mobileDeviceID !== $scope.project.mobileDeviceID;
if (isTemplateChange) {
$scope.project = localConfig.project;
$scope.share = localConfig.share;
}
if( !_.isEqual(localConfig, config) || isTemplateChange ){
$scope.screens = sortScreensByRelevance( augmentScreens( screenService.getScreens() ) );
_.setProperty( $scope.screens, "isImageLoaded", true );
$scope.selectedScreen = _.findWithProperty( $scope.screens, "id", $scope.screenID );
applyBackgroundStyles( $scope.selectedScreen );
}
}
);
$(window).on("resize.shareScreens", function windowResize(){
$scope.screens = sortScreensByRelevance( augmentScreens( screenService.getScreens() ) );
$scope.$apply();
});
}
})( angular, InVision );
;
;
/*! toolbar-controller.js */ 
;
;
(function( ng, app ){
"use strict";
app.controller( "toolbar.ToolbarController", Controller );
/** @ngInject */
function Controller(
$rootScope,
$scope,
$window,
_ ,
accountService,
analyticsService,
commentService,
config,
conversationService,
hotspotService,
modelEvents,
requestContext,
screenService,
sessionService,
shareService,
userPreferenceService
) {
function applyRemoteData( share, screens, comments, hotspots ) {
$scope.share = share;
$scope.includeBrowseTool = share.isLoadAllScreens;
$scope.includeCommentsTool = share.isCommentingAllowed;
$scope.commentCount = comments.length;
$scope.unreadCommentCount = _.countWithProperty( comments, "isUnread", true );
tourData.hasMultipleScreens = screens.length > 1;
tourData.hasHotSpots = hotspots.length > 0;
$scope.displayFilename = sanitizePhotoshopFilename( $scope.screen.clientFilename );
}
function loadRemoteData() {
var comments = [];
var conversations = conversationService.getConversationsByScreenID( $scope.screenID );
for ( var i = 0, length = conversations.length ; i < length ; i++ ) {
comments = comments.concat( commentService.getCommentsByConversationID( conversations[ i ].id ) );
}
var screens = screenService.getScreens();
var hotspots = hotspotService.getAllHotSpots();
var share = shareService.getShare();
applyRemoteData( share, screens, comments, hotspots );
}
function sanitizePhotoshopFilename( clientFilename ) {
if ( ! clientFilename ) {
return( "" );
}
return(
clientFilename
.replace( /@2x@2x/i, "@2x" )
.replace( /@print/i, "" )
);
}
$scope.closeIntroduction = function() {
$scope.isShowingIntroduction = false;
$scope.updateActiveStatus();
};
$scope.updateActiveStatus = function() {
$scope.isActive = false;
if (
$scope.isUserOverToolbar ||
$scope.isShowingComments ||
$scope.isBrowseOpen ||
$scope.isShowingIntroduction ||
( !$scope.hasSeenCommentsTooltip )
) {
$scope.isActive = true;
}
};
$scope.toggleShareModal = function() {
$scope.isShowingShareModal = !$scope.isShowingShareModal;
}
$scope.hasSeenCommentTooltip = function(){
accountService.markHasSeenCommentTooltip( 1 );
$scope.hasSeenCommentsTooltip = true;
$scope.isActive = false;
modelEvents.trigger( "toolbarOpacityChange", $scope.isActive );
};
$scope.updateIsUserOverToolbar = function( isUserOverToolbar ) {
$scope.isUserOverToolbar = isUserOverToolbar;
$scope.updateActiveStatus();
}
$scope.showShareTour = function(){
$scope.openModalWindow( 'shareTour', tourData );
}
$scope.shouldShowBounceToolTip = function() {
var showBouncyToolTip = false;
/*
* ORANGE-336
* Disables the bouncing comments tooltip.
* Logic commented out as future use or rework
* of this feature may utilize it.
*
if ( $scope.includeCommentsTool &&
!$scope.hasSeenCommentsTooltip &&
!$scope.isLiveShare &&
!$scope.isShareTourRunning ){
showBouncyToolTip = true;
}
*/
return showBouncyToolTip;
};
$scope.shouldShowHelpQuestionMark = function(){
var showHelperQuestionMark = false;
if (!$scope.hasSeenShareWalkThrough &&
( $scope.includeCommentsTool || $scope.includeBrowseTool ) ){
showHelperQuestionMark = true;
}
return showHelperQuestionMark;
};
$scope.closeCommentTooltipExperiment = function() {
if (!$scope.hasSeenCommentsTooltip && $scope.includeCommentsTool) {
accountService.markHasSeenCommentTooltip( 1 );
$scope.hasSeenCommentsTooltip = true;
}
$scope.commentToolTipVisible = false;
}
var renderContext = requestContext.getRenderContext( "", "screenID" );
var tourData = { hasMultipleScreens: true, hasHotSpots: true  };
var hasShownAuthModal = false;
$scope.screenID = requestContext.getParamAsInt( "screenID", $scope.defaultScreenIDForShare );
$scope.displayFilename = "";
$scope.share = null;
$scope.includeBrowseTool = false;
$scope.includeCommentsTool = false;
$scope.isShowingComments = ( renderContext.getNextSection() === "comments" );
$scope.commentCount = 0;
$scope.unreadCommentCount = 0;
$scope.isUserOverToolbar = false;
$scope.isActive = false;
$scope.isShowingIntroduction = false;
$scope.isShowingShareModal = false;
$scope.isShareTourRunning = false;
$scope.tourSubView = "";
$scope.hasSeenTour = false;
$scope.hasSeenCommentsTooltip = ( config.user.hasSeenCommentToolTip || false );
$scope.shareUrl = ( !! $scope.$parent.$parent.share.key ) ? "http://invis.io/" + $scope.$parent.$parent.share.key : null;
$scope.commentToolTipVisible = false;
$scope.$on(
"$destroy",
function() {
modelEvents.off( "commentCreated.toolbar" );
modelEvents.off( "commentDeleted.toolbar" );
modelEvents.off( "conversationDeleted.toolbar" );
modelEvents.off( "conversationMarkedRead.toolbar" );
modelEvents.off( "poweredByOpacityChange.toolbar" );
modelEvents.off( "shareTourSubview.toolbar" );
modelEvents.off( "shareTour.toolbar" );
modelEvents.off( "markHasSeenCommentTooltipFromTour.toolbar" );
}
);
$scope.$watch(
"isBrowseOpen",
function(newVal) {
$scope.updateActiveStatus();
$rootScope.$emit('isBrowseOpen', newVal);
}
);
$scope.$watch(
"isShowingComments",
function( newValue, oldValue ) {
var isAlreadyShowingComments = ( renderContext.getNextSection() === "comments" );
if ( newValue && ! isAlreadyShowingComments ) {
var enterpriseShareSignupFlowVariant = ($window.InvAnalytics || {}).enterpriseShareSignupFlowVariant === 2;
if(!config.user.isAccountAuthenticated && !hasShownAuthModal && enterpriseShareSignupFlowVariant){
$scope.openModalWindow( 'auth', {
showSignup: true,
isFullScreenMode: false
});
hasShownAuthModal = true;
}
if( $scope.isShowingSmsForm ) {
$scope.toggleSmsShareForm();
}
$scope.navigateToScreenComments();
$scope.closeCommentTooltipExperiment();
analyticsService.track("Comment.ToggleCommentModeOn");
analyticsService.trackGrowth("App - Public Share - Toggle Comment Mode", {
"Logged In": !!sessionService.user.isAccountAuthenticated,
"Enabled": true
});
} else if ( ! newValue && isAlreadyShowingComments ) {
$scope.navigateToScreenPreview();
analyticsService.trackGrowth("App - Public Share - Toggle Comment Mode", {
"Logged In": !!sessionService.user.isAccountAuthenticated,
"Enabled": false
});
}
}
);
$scope.$on(
"requestContextChanged",
function() {
if ( ! renderContext.isChangeRelevant() ) {
return;
}
$scope.isShowingComments = ( renderContext.getNextSection() === "comments" );
if ( requestContext.hasParamChanged( "screenID" ) ) {
$scope.screenID = requestContext.getParamAsInt( "screenID", $scope.defaultScreenIDForShare );
loadRemoteData();
}
$scope.updateActiveStatus();
}
);
modelEvents.on(
[
"commentCreated.toolbar",
"commentDeleted.toolbar"
],
function( event ) {
loadRemoteData();
}
);
modelEvents.on(
[
"conversationDeleted.toolbar",
"conversationMarkedRead.toolbar"
],
function( event, conversationID ) {
loadRemoteData();
}
);
modelEvents.on(
"poweredByOpacityChange.toolbar",
function( event, isActive ) {
if( ! $scope.isShowingComments ) {
$scope.isActive = isActive;
}
}
);
modelEvents.on(
"shareTourSubview.toolbar",
function( event, tourSubView ){
$scope.tourSubView = tourSubView;
}
);
modelEvents.on(
"shareTour.toolbar",
function( event, isShareTourRunning ){
$scope.isShareTourRunning = isShareTourRunning;
$scope.hasSeenTour = true;
if( !isShareTourRunning ){
$scope.tourSubView = "";
}
}
);
modelEvents.on(
"markHasSeenCommentTooltipFromTour.toolbar",
function( event ) {
$scope.hasSeenCommentTooltip();
}
);
$scope.$on(
"configUpdated.share",
function( event, localConfig ) {
loadRemoteData();
}
);
$scope.$on(
"loadingSequenceCompleted",
function( event ) {
$scope.commentToolTipVisible = !$scope.hasSeenCommentsTooltip;
}
);
loadRemoteData();
}
})( angular, InVision );
;
;
/*! add-padding-on-scroll.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invAddPaddingOnScroll", Directive );
/** @ngInject */
function Directive( $timeout ) {
var linkFunction = function( $scope, element ) {
var $win = $(window),
$body = $("body"),
$element = $(element),
windowHeight = $win.height(),
extraPadding = 50,
hasExtraPadding = false,
scrollDelay = 1000;
function init() {
if ( ( $scope.screen.height * $scope.screen.displayScale ) > windowHeight ) {
$win.on("scroll.invAddPaddingOnScroll", function() {
var scrollBottom = $scope.screen.height * $scope.screen.displayScale;
if ( hasExtraPadding ) {
if ( ( $win.scrollTop() + windowHeight ) < ( scrollBottom - extraPadding ) ) {
removeExtraPadding();
}
} else {
if ( ( $win.scrollTop() + windowHeight ) > scrollBottom ) {
addExtraPadding();
}
}
});
}
}
function destroy() {
$win.off("scroll.invAddPaddingOnScroll");
removeExtraPadding();
}
function addExtraPadding() {
if ( hasExtraPadding ) {
return;
}
hasExtraPadding = true;
$timeout(function() {
$element.css({
paddingBottom: extraPadding
});
}, scrollDelay);
}
function removeExtraPadding() {
if ( ! hasExtraPadding ) {
return;
}
hasExtraPadding = false;
$element.css({
paddingBottom: 0
});
}
$win.on("resize.invAddPaddingOnScroll", function() {
destroy();
$timeout(init);
});
$scope.$on(
"$destroy",
function() {
destroy();
$win.off("resize.invAddPaddingOnScroll");
}
);
$timeout(init);
};
return({
link: linkFunction,
restrict: "A"
});
}
})( angular, InVision );
;
;
/*! autofocus.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invAutofocus",
function() {
var linkFunction = function( $scope, element, attributes ) {
function focus() {
setTimeout( 
function() {
target[ 0 ].focus();
}
);
}
var target = $( element );
var modal = target.closest( "div[ inv-modal ]" );
if ( 
( modal.length === 1 ) &&
( modal.is( ".fade" ) && ! modal.is( ".in" ) )
) {
modal.on(
"shown.invAutofocus",
function() {
focus();
}
);
} else if ( target.is( ":visible" ) ) {
focus();
}
$scope.$watch(
function() {
return(
target.is( ":visible" )
);
},
function( newValue, oldValue ) {
if ( 
( newValue === true ) &&
( newValue !== oldValue )
) {
focus();
}
}
);
$scope.$on(
"$destroy",
function() {
modal.off( "shown.invAutofocus" );				
}
);
};
return({
link: linkFunction,
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! autosize.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invAutosize",
function() {
var linkFunction = function( $scope, element, attributes ) {
function getInitialDelta() {
var content = element.val();
element.val( "" );
var height = element.outerHeight();
var scrollHeight = element[ 0 ].scrollHeight;
var delta = Math.max( 0, ( scrollHeight - height ) );
element.val( content );
return( delta );
}
function resize() {
var height = element.outerHeight();
var scrollHeight = element[ 0 ].scrollHeight;
var scrollableHeight = ( scrollHeight - height - initialDelta );
if ( scrollableHeight <= 0 ) {
return;
}
var newHeight = scrollHeight;
element.height( newHeight );
}
element.addClass( "autosize" );
var initialDelta = getInitialDelta();
element.on(
"keyup.invAutosize",
function( event ) {
if ( element.val() === "" ) {
element.height( initialDelta );
return;
};
resize();
}
);
$scope.$on(
"$destroy",
function() {
element.off( "keypress.invAutosize" );
}
);
};
return({
link: linkFunction,
priority: 2,
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! bouncyTooltip.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invBouncyTooltip",
function() {
var linkFunction = function( $scope, element, attributes ) {
var target = $( element );
var tooltipInstance = null;
var styleClass = ( attributes.tooltipstyleclass || "" );
var message = ( attributes.msg || "no message" );
var callback = ( attributes.callback || null );
var $tooltip = $('<div class="popover top comment-tip floating '+ styleClass + '"><i></i><div class="arrow"></div><div class="popover-content">' + message + '</div></div>');
$tooltip
.appendTo(target)
.on('mouseenter', function(){
$(this).removeClass('cssRunning').addClass('cssPause');
})
.on('mouseleave', function(){
$(this).removeClass('cssPause').addClass('cssRunning');
});
$('i', $tooltip).on('click', function(){
$tooltip.fadeOut(200, function(){
$tooltip.remove();
if(callback){
$scope.$apply( callback );
}
});
});
$scope.$on(
"$destroy",
function() {
if ( tooltipInstance ) {
tooltipInstance.remove();
}
}
);
};
return({
link: linkFunction,
restrict: "A",
scope: false
});
}
);
})( angular, InVision );
;
;
/*! browse-key-combos.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invBrowseKeyCombos",
/** @ngInject */
function( $document, keyComboHelper, _ ) {
var linkFunction = function( $scope, element, attributes, keyCombosController ) {
function closeBrowse() {
$scope.$apply(
function() {
$scope.closeBrowse();
}
);
}
var listenerConfig = {};
listenerConfig[ "keydown.invBrowseKeyCombos" ] = function( event ) {
if ( event.metaKey ) {
return;
}
if ( keyComboHelper.isEscapeKeyEvent( event ) ) {
closeBrowse();
}
};
keyCombosController.addListener( listenerConfig );
$scope.$on(
"$destroy",
function() {
keyCombosController.removeListener( listenerConfig );
}
);
};
return({
link: linkFunction,
require: "^invKeyCombos",
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! comments-catchup-toolbar-helper.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invCommentsCatchupToolbarHelper", Directive );
/** @ngInject */
function Directive( $window, $timeout ) {
var linkFunction = function( $scope, element, attributes ) {
function updateMarkerCapacity() {
var markerWidth = 35;
var calloutWidth = 150;
var hiddenCalloutWidth = 65;
var filterWidth = 400;
var windowWidth = win.width();
var wiggleRoom = 100;
var minMarkerCount = 10;
var availableWidth = ( windowWidth - calloutWidth - hiddenCalloutWidth - filterWidth - wiggleRoom );
var markerCapacity = Math.floor( availableWidth / markerWidth );
$scope.updateUnreadConversationCapacity(
Math.max( markerCapacity, minMarkerCount ) 
);
}
var win = $( $window ).on(
"resize.invCommentsCatchupToolbarHelper", 
function( event ) {
$scope.$apply(
function() {
updateMarkerCapacity();
}
);
}
);
$timeout( updateMarkerCapacity );
$scope.$on(
"$destroy",
function() {
win.off( "resize.invCommentsCatchupToolbarHelper" );
}
);
};
return({
link: linkFunction,
restrict: "A"
});
}
})( angular, InVision );
;
;
/*! comments-cursor-tooltip.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invCommentsCursorTooltip",
function() {
var linkFunction = function( $scope, element, attributes ) {
var $document = $(document),
$win = $(window);
$document.on("mousemove.cursorTooltip", function(e){
$(element).css({
left: ( e.pageX - $win.scrollLeft() ) + 15,
top: ( e.pageY - $win.scrollTop() ) - 10
});
});
$scope.$on(
"$destroy",
function() {
$document.off("mousemove.cursorTooltip");
}
);
};
return({
link: linkFunction,
restrict: "A",
scope: false
});
}
);
})( angular, InVision );
;
;
/*! comments-form.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invCommentsForm",
/** @ngInject */
function( $window, $document, $timeout, _ ) {
var linkFunction = function( $scope, element, attributes, markersController ) {
function updatePosition( markerX, markerY ) {
var formWidth = 550,
formPadding = 10;
element.css({
left: ( markerX + "px" ),
top: ( markerY + "px" )
});
var rightmostOffset = ( containerOffset.left + markerX + formWidth + formPadding );
if ( rightmostOffset > documentWidth ) {
element.addClass( "left" );
} else {
element.removeClass( "left" );
}
}
function setTextClass() {
if( ! $scope.conversation.isTourPoint ) {
return;
}
if( $(".comment-item.first .post-comment").height() <= 40 ) {
$(".comment-item.first .post-comment").addClass("single-line");
} else {
$(".comment-item.first .post-comment").removeClass("single-line");
}
}
var documentWidth = $document.width();
var viewport = element.closest( "div.viewport" );
var containerOffset = viewport.offset();
markersController.setCallback( updatePosition );
updatePosition( $scope.conversation.x, $scope.conversation.y );
$timeout(function() {
setTextClass();
});
$scope.showCommentInput = function() {
$scope.isCommentInputVisible = true;
};
if ( $scope.conversation.id === 0 ) {
$scope.isShowingUserList = true;
}
$( window ).on(
"resize.invCommentsForm",
function( event ) {
documentWidth = $document.width();
containerOffset = viewport.offset();
}
);
$document.on("keydown.invCommentsForm", function(e) {
if ( e.keyCode === 13 && ( e.metaKey || e.ctrlKey ) ) {
$scope.$apply(
function invokeNgSubmitBinding() {
$scope.$eval( attributes.ngSubmit );
}
);
}
});
$scope.$on(
"commentChanged",
function() {
$timeout(function() {
setTextClass();
});
}
);
$scope.$on(
"$destroy",
function() {
markersController.clearCallback();
$document.off( "resize.invCommentsForm" );
$document.off( "keydown.invCommentsForm" );
}
);
};
return({
link: linkFunction,
require: "^invCommentsMarkers",
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! comments-key-combos.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invCommentsKeyCombos",
/** @ngInject */
function( $document, $location, keyComboHelper, screenService, _ ) {
var linkFunction = function( $scope, element, attributes, keyCombosController ) {
function showBrowse() {
$scope.$apply(
function() {
$scope.openBrowse();
}
);
}
function showNextScreen() {
$scope.$apply(
function() {
var nextScreen = screenService.getNextScreen( $scope.screenID );
$location.url( "/screens/" + nextScreen.id + "/comments" );
}
);
}
function showPreview() {
$scope.$apply(
function() {
$scope.navigateToScreenPreview();
}
);
}
function showPreviousScreen() {
$scope.$apply(
function() {
var previousScreen = screenService.getPreviousScreen( $scope.screenID );
$location.url( "/screens/" + previousScreen.id + "/comments" );
}
);
}
var listenerConfig = {};
listenerConfig[ "keydown.invCommentsKeyCombos" ] = function( event ) {
if ( event.metaKey ||  event.target.tagName.toUpperCase() == "TEXTAREA" ||  event.target.tagName.toUpperCase() == "INPUT" ) {
return;
}
if ( !$scope.isShowingSketchBuilder && !$scope.isShowingSketchViewer ){
if ( keyComboHelper.isEscapeKeyEvent( event ) ) {
showPreview();
} else if ( keyComboHelper.isLeftArrowKeyEvent( event ) ) {
event.preventDefault();
showPreviousScreen();
} else if ( keyComboHelper.isRightArrowKeyEvent( event ) ) {
event.preventDefault();		
showNextScreen();
} else if ( !event.ctrlKey && keyComboHelper.isCharKeyEvent( event, "c" ) ) {
event.preventDefault();
showPreview();
} else if (
keyComboHelper.isCharKeyEvent( event, "b" ) ||
keyComboHelper.isCharKeyEvent( event, "j" )
) {
event.preventDefault();
showBrowse();
}
}
};
keyCombosController.addListener( listenerConfig );
$scope.$on(
"$destroy",
function() {
keyCombosController.removeListener( listenerConfig );
}
);
};
return({
link: linkFunction,
require: "^invKeyCombos",
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! comments-markers.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invCommentsMarkers",
/** @ngInject */
function( $document, $location, $timeout, _, sessionService, userService ) {
function Controller() {
function announceMarkerPosition( markerX, markerY ) {
if ( ! formPositionCallback ) {
return;
}
formPositionCallback( markerX, markerY );
}
function clearCallback() {
formPositionCallback = null;
}
function setCallback( callback ) {
formPositionCallback = callback;
}
var formPositionCallback = null;
return({
announceMarkerPosition: announceMarkerPosition,
clearCallback: clearCallback,
setCallback: setCallback
});
}
var linkFunction = function( $scope, element, attributes, markersController ) {
function ConversationActivationState( stateManager, marker, initialPageX, initialPageY ) {
function handleMouseMove( event ) {
if ( hasMoved( event.pageX, event.pageY ) ) {
stateManager.gotoState( MovingConversationState, marker, initialPageX, initialPageY, event.pageX, event.pageY );
}
}
function handleMouseUp( event ) {
if ( $scope.areMarkersDirty() ) {
alert( "Oops, you haven't saved your comment!" );
} else {
$scope.$apply(
function() {
$scope.closeConversation();
}
);
}
cancelClick = true;
stateManager.gotoState( ReadyState );
}
function hasMoved( pageX, pageY ) {
var tolerance = 3;
return(
( Math.abs( initialPageX - pageX ) > tolerance ) ||
( Math.abs( initialPageY - pageY ) > tolerance )
);
}
function teardown() {
viewport.off( "mousemove.invCommentMarkers" );
viewport.off( "mouseup.invCommentMarkers" );
}
viewport.on( "mousemove.invCommentMarkers", handleMouseMove );
viewport.on( "mouseup.invCommentMarkers", handleMouseUp );
return( teardown );
}
function MarkerActivationState( stateManager, marker, initialPageX, initialPageY ) {
function handleMouseMove( event ) {
if ( hasMoved( event.pageX, event.pageY ) ) {
stateManager.gotoState( MovingMarkerState, marker, initialPageX, initialPageY, event.pageX, event.pageY );
}
}
function handleMouseUp( event ) {
stateManager.gotoState( ReadyState );
}
function hasMoved( pageX, pageY ) {
var tolerance = 3;
return(
( Math.abs( initialPageX - pageX ) > tolerance ) ||
( Math.abs( initialPageY - pageY ) > tolerance )
);
}
function teardown() {
viewport.off( "mousemove.invCommentMarkers" );
viewport.off( "mouseup.invCommentMarkers" );
}
viewport.on( "mousemove.invCommentMarkers", handleMouseMove );
viewport.on( "mouseup.invCommentMarkers", handleMouseUp );
return( teardown );
}
function MovingConversationState( stateManager, marker, initialPageX, initialPageY, currentPageX, currentPageY ) {
function getLocalPosition( pageX, pageY ) {
var deltaX = ( initialPageX - pageX );
var deltaY = ( initialPageY - pageY );
var newX = ( initialMarkerPosition.left - deltaX );
var newY = ( initialMarkerPosition.top - deltaY );
return({
left: newX,
top: newY
});
}
function handleMouseMove( event ) {
updateMarkerPosition( event.pageX, event.pageY );
}
function handleMouseUp( event ) {
var position = marker.position();
$scope.$apply(
function() {
$scope.updateConversationPosition( marker.scope().conversation, position.left, position.top );
}
);
stateManager.gotoState( ReadyState );
}
function teardown() {
$document.off( "mousemove.invCommentMarkers" );
$document.off( "mouseup.invCommentMarkers" );
marker.removeClass( "activation" );
}
function updateMarkerPosition( pageX, pageY ) {
var localPosition = getLocalPosition( pageX, pageY );
marker.css({
left: ( localPosition.left  + "px" ),
top: ( localPosition.top + "px" )
});
markersController.announceMarkerPosition( localPosition.left, localPosition.top );
}
$document.on( "mousemove.invCommentMarkers", handleMouseMove );
$document.on( "mouseup.invCommentMarkers", handleMouseUp );
var initialMarkerPosition = marker.position();
var containerOffset = viewport.offset();
updateMarkerPosition( currentPageX, currentPageY );
marker.addClass( "activation" );
cancelClick = true;
return( teardown );
}
function MovingMarkerState( stateManager, marker, initialPageX, initialPageY, currentPageX, currentPageY ) {
function getLocalPosition( pageX, pageY ) {
var deltaX = ( initialPageX - pageX );
var deltaY = ( initialPageY - pageY );
var newX = ( initialMarkerPosition.left - deltaX );
var newY = ( initialMarkerPosition.top - deltaY );
return({
left: newX,
top: newY
});
}
function handleMouseMove( event ) {
updateMarkerPosition( event.pageX, event.pageY );
}
function handleMouseUp( event ) {
var position = marker.position();
$scope.$apply(
function() {
$scope.updateConversationPosition( marker.scope().conversation, position.left, position.top );
}
);
stateManager.gotoState( ReadyState );
}
function teardown() {
$document.off( "mousemove.invCommentMarkers" );
$document.off( "mouseup.invCommentMarkers" );
marker.removeClass( "activation" );
}
function updateMarkerPosition( pageX, pageY ) {
var localPosition = getLocalPosition( pageX, pageY );
marker.css({
left: ( localPosition.left + "px" ),
top: ( localPosition.top + "px" )
});
}
$document.on( "mousemove.invCommentMarkers", handleMouseMove );
$document.on( "mouseup.invCommentMarkers", handleMouseUp );
var initialMarkerPosition = marker.position();
updateMarkerPosition( currentPageX, currentPageY );
marker.addClass( "activation" );
cancelClick = true;
return( teardown );
}
function MovingNewConversationState( stateManager, marker, initialPageX, initialPageY, currentPageX, currentPageY ) {
function getLocalPosition( pageX, pageY ) {
var deltaX = ( initialPageX - pageX );
var deltaY = ( initialPageY - pageY );
var newX = ( initialMarkerPosition.left - deltaX );
var newY = ( initialMarkerPosition.top - deltaY );
return({
left: newX,
top: newY
});
}
function handleMouseMove( event ) {
updateMarkerPosition( event.pageX, event.pageY );
}
function handleMouseUp( event ) {
var position = marker.position();
$scope.$apply(
function() {
$scope.updateNewConversationPosition( position.left, position.top );
}
);
stateManager.gotoState( ReadyState );
}
function teardown() {
$document.off( "mousemove.invCommentMarkers" );
$document.off( "mouseup.invCommentMarkers" );
marker.removeClass( "activation" );
}
function updateMarkerPosition( pageX, pageY ) {
var localPosition = getLocalPosition( pageX, pageY );
marker.css({
left: ( localPosition.left + "px" ),
top: ( localPosition.top + "px" )
});
markersController.announceMarkerPosition( localPosition.left, localPosition.top );
}
$document.on( "mousemove.invCommentMarkers", handleMouseMove );
$document.on( "mouseup.invCommentMarkers", handleMouseUp );
var initialMarkerPosition = marker.position();
var containerOffset = viewport.offset();
updateMarkerPosition( currentPageX, currentPageY );
marker.addClass( "activation" );
cancelClick = true;
return( teardown );
}
function NewConversationActivationState( stateManager, marker, initialPageX, initialPageY ) {
function handleMouseMove( event ) {
if ( hasMoved( event.pageX, event.pageY ) ) {
stateManager.gotoState( MovingNewConversationState, marker, initialPageX, initialPageY, event.pageX, event.pageY );
}
}
function handleMouseUp( event ) {
if ( $scope.areMarkersDirty() ) {
alert( "Oops, you haven't saved your comment!" );
} else {
$scope.$apply(
function() {
$scope.closeConversation();
}
);
}
stateManager.gotoState( ReadyState );
}
function hasMoved( pageX, pageY ) {
var tolerance = 3;
return(
( Math.abs( initialPageX - pageX ) > tolerance ) ||
( Math.abs( initialPageY - pageY ) > tolerance )
);
}
function teardown() {
viewport.off( "mousemove.invCommentMarkers" );
viewport.off( "mouseup.invCommentMarkers" );
}
viewport.on( "mousemove.invCommentMarkers", handleMouseMove );
viewport.on( "mouseup.invCommentMarkers", handleMouseUp );
return( teardown );
}
function PotentialMarkerState( stateManager, initialPageX, initialPageY ) {
function handleMouseLeave() {
stateManager.gotoState( ReadyState );
}
function handleMouseUp( event ) {
if ( hasMoved( event.pageX, event.pageY ) ) {
stateManager.gotoState( ReadyState );
} else {
var viewportOffset = viewport.offset();
var x = ( initialPageX - viewportOffset.left - 24 );
var y = ( initialPageY - viewportOffset.top - 24 );
$scope.$apply(
function() {
$scope.startNewConversation( x, y );
}
);
stateManager.gotoState( ReadyState );
}
}
function hasMoved( pageX, pageY ) {
var tolerance = 3;
return(
( Math.abs( initialPageX - pageX ) > tolerance ) ||
( Math.abs( initialPageY - pageY ) > tolerance )
);
}
function teardown() {
viewport.off( "mouseleave.invCommentMarkers" );
viewport.off( "mouseup.invCommentMarkers" );
}
viewport.on( "mouseleave.invCommentMarkers", handleMouseLeave );
viewport.on( "mouseup.invCommentMarkers", handleMouseUp );
return( teardown );
}
function ReadyState( stateManager ) {
function handleMouseDown( event ) {
var target = $( event.target );
if ( target.closest( "form.conversation" ).length ) {
return;
}
if ( target.is( ".marker" ) ) {
handleMouseDownOnMarker( event );
} else if ( target.is( ".viewport" ) ) {
handleMouseDownOnViewport( event );
}
}
function isUserACollaborator(){
var user = sessionService.user;
var members = userService.getMembers();
var isTeamMember = !! _.findWithProperty( members, "id", user.id );						
return ( user.isAccountAuthenticated && isTeamMember);
}
function handleMouseDownOnMarker( event ) {
event.preventDefault(); // Prevent any dragging.
var target = $( event.target );
if ( target.scope().conversation && target.scope().conversation.isTourPoint && !isUserACollaborator() ) {
return;
}
if ( $scope.selectedConversation ) {
if ( $scope.selectedConversation === target.scope().conversation ) {
stateManager.gotoState( ConversationActivationState, target, event.pageX, event.pageY );
} else if ( $scope.areMarkersDirty() ) {
alert( "Oops, you haven't saved your comment!" );
}
} else if ( $scope.newConversation ) {
if ( target.is( ".new-marker" ) ) {
stateManager.gotoState( NewConversationActivationState, target, event.pageX, event.pageY );
} else if ( $scope.areMarkersDirty() ) {
alert( "Oops, you haven't saved your comment!" );
}
} else {
stateManager.gotoState( MarkerActivationState, target, event.pageX, event.pageY );
}
}
function handleMouseDownOnViewport( event ) {
if ( $scope.areMarkersDirty() ) {
return;
} else if ( $scope.selectedConversation || $scope.newConversation ) {
$scope.$apply(
function() {
$scope.closeConversation();
}
);
} else {
stateManager.gotoState( PotentialMarkerState, event.pageX, event.pageY );
}
}
function teardown() {
viewport.off( "mousedown.invCommentMarkers" );
}
viewport.on( "mousedown.invCommentMarkers", handleMouseDown );
return( teardown );
}
function getMarkerByConversationID( id ) {
var marker = viewport.children( "a.marker:not(.new-marker)" )
.filter(
function() {
var conversation = $( this ).scope().conversation;
return( conversation && ( conversation.id == id ) );
}
)
;
return( marker )
}
function scrollToActiveMarkerIfNecessary() {
if ( ! $scope.selectedConversation ) {
return;
}
var marker = getMarkerByConversationID( $scope.selectedConversation.id );
if ( ! marker.length ) {
return;
}
var win = $( window );
var viewTop = win.scrollTop();
var viewBottom = ( viewTop + win.height() );
var viewLeft = win.scrollLeft();
var viewRight = ( viewLeft + win.width() );
var markerOffset = marker.offset();
var markerTop = markerOffset.top;
var markerBottom = ( markerTop + 49 );
var markerLeft = markerOffset.left;
var markerRight = ( markerLeft + 49 );
var markerIsHidden = (
( markerTop <= viewTop ) ||
( markerBottom >= viewBottom ) ||
( markerLeft <= viewLeft ) ||
( markerRight >= viewRight )
);
if ( markerIsHidden ) {
$( "html, body" ).stop( true ).animate(
{
scrollLeft: ( markerLeft - 100 ),
scrollTop: ( markerTop - 100 )
},
500
);
}
}
function measureScrollBarWidth() {
var scrollBarMeasure = $('<div />');
$('body').append(scrollBarMeasure);
scrollBarMeasure
.width(50)
.height(50)
.css({
overflow: 'scroll',
visibility: 'hidden',
position: 'absolute'
});
var scrollBarMeasureContent = $('<div />').height(1);
scrollBarMeasure.append(scrollBarMeasureContent);
var insideWidth = scrollBarMeasureContent.width(),
outsideWidth = scrollBarMeasure.width(),
width = outsideWidth - insideWidth;
scrollBarMeasure.remove();
return width <= 0 ? 8 : width;
}
var stateManager = {
currentStateTeardown: null,
gotoState: function() {
var stateArguments = _.toArray( arguments );
var newStateConstructor = stateArguments.shift();
stateArguments.unshift( stateManager );
if ( stateManager.currentStateTeardown && _.isFunction( stateManager.currentStateTeardown ) ) {
stateManager.currentStateTeardown();
}
stateManager.currentStateTeardown = newStateConstructor.apply( {}, stateArguments );
}
};
element.on(
"click.invCommentMarkers",
"a.marker",
function( event ) {
if ( cancelClick ) {
event.preventDefault();
event.stopPropagation();
cancelClick = false;
}
}
);
$document.on(
"mousedown.invDocumentClick",
function( event ) {
var target = $( event.target);
var marker = $(".marker");
var sketch = $("#shareSketchViewer");
var sketchBulder = $("#shareSketchBuilder");
var commentForm = $(".comment-thread-container");
var mentionsPopover = $(".mention-menu-wrapper");
var isCommentForm = commentForm.is(target) || !!commentForm.has(target).length;
var isMarker = marker.is(target) || !!marker.has(target).length;
var isSketch = sketch.is(target) || !!sketch.has(target).length;
var isSketchBuilder = sketchBulder.is(target) || !!sketchBulder.has(target).length;
var clientW = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
var clientH = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
if (!isCommentForm &&
!isMarker &&
!isSketch &&
!isSketchBuilder &&
!mentionsPopover &&
!$scope.areMarkersDirty() &&
$scope.getIsShowingConversationMenu() &&
event.clientY < clientH - sbWidth &&
event.clientX < clientW - sbWidth
) {
$scope.closeConversation();
}
}
);
var viewport = element.children( "div.viewport" );
var cancelClick = false;
var sbWidth = measureScrollBarWidth();
stateManager.gotoState( ReadyState );
$timeout( scrollToActiveMarkerIfNecessary );
$scope.$watch(
"screenID",
function( newValue ) {
cancelClick = false;
stateManager.gotoState( ReadyState );
}
);
$scope.$watch(
"selectedConversation",
function( conversation ) {
if ( ! conversation ) {
return;
}
$timeout( scrollToActiveMarkerIfNecessary );
}
);
$scope.$on(
"$destroy",
function() {
element.off( "click.invCommentMarkers" );
element.off( "mousedown.invCommentMarkers" );
element.off( "mousemove.invCommentMarkers" );
element.off( "mouseup.invCommentMarkers" );
$document.off( "mousedown.invCommentMarkers" );
$document.off( "mousemove.invCommentMarkers" );
$document.off( "mouseup.invCommentMarkers" );
$document.off( "mousedown.invDocumentClick" );
}
);
};
return({
controller: Controller,
link: linkFunction,
require: "invCommentsMarkers",
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! comments-tour-form-key-combos.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invCommentsTourFormKeyCombos", CommentsTourFormKeyCombos );
function CommentsTourFormKeyCombos(
$document,
_,
emojiService,
keyComboHelper
) {
return( {
link: linkFunction,
require: "^invKeyCombos",
restrict: "A"
} );
function linkFunction( $scope, element, attributes, keyCombosController ) {
function closeForm() {
$scope.$apply(
function() {
$scope.selectTourPoint( null );
}
);
}
function showNextConversation() {
if ( $scope.areMarkersDirty() ) {
return(
alert( "Oops, you haven't saved your comment!" )
);
}
if ( $scope.conversation.id === 0 ) {
return;
}
$scope.$apply(
function() {
$scope.nextTourPoint();
}
);
}
function showPreviousConversation() {
if ( $scope.areMarkersDirty() ) {
return(
alert( "Oops, you haven't saved your comment!" )
);
}
if ( $scope.conversation.id === 0 ) {
return;
}
$scope.$apply(
function() {
$scope.previousTourPoint();
}
);
}
var listenerConfig = {};
listenerConfig[ "keydown.invTourCommentsFormKeyCombos" ] = function( event ) {
if ( event.metaKey ) {
return;
}
var target = $( event.target );
if ( keyComboHelper.isEscapeKeyEvent( event ) ) {
if ( emojiService.isTypeaheadActive() || emojiService.isPopoverActive() ) {
return;
}
closeForm();
} else if ( event.shiftKey || keyComboHelper.isShiftKeyEvent( event ) ) {
event.stopPropagation();
} else if ( ! target.is( ":input" ) ) {
if ( keyComboHelper.isLeftArrowKeyEvent( event ) ) {
showPreviousConversation();
} else if ( keyComboHelper.isRightArrowKeyEvent( event ) ) {
showNextConversation();
}
}
};
keyCombosController.addListener( listenerConfig );
$scope.$on(
"$destroy",
function() {
keyCombosController.removeListener( listenerConfig );
}
);
}
}
})( angular, InVision );
;
;
/*! confirm-popover.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invConfirmPopover",
function() {
var linkFunction = function( $scope, element, attributes ) {
var handleCancelClick = function( event ) {
event.preventDefault();
target.popover( "destroy" );
doc.off( "mousedown.invConfirmPopover" );
doc.off( "click.invConfirmPopover" );
};
var handleConfirmClick = function( event ) {
event.preventDefault();
target.popover( "destroy" );
doc.off( "mousedown.invConfirmPopover" );
doc.off( "click.invConfirmPopover" );
$scope.$apply( confirmExpression );
};
var handleDocumentMousedown = function( event ) {
if ( $( event.target ).closest( "div.popover" ).length ) {
return;
}
target.popover( "destroy" );
doc.off( "mousedown.invConfirmPopover" );
doc.off( "click.invConfirmPopover" );
};
var doc = $( document );
var target = $( element );
var confirmExpression = attributes.onConfirm;
target.on(
"click.invConfirmPopover",
function( event ) {
event.preventDefault();
target.popover({
html: true,
placement: "top",
trigger: "manual",
title: function() {
return( attributes.invConfirmPopover );
},
content: "<a class='btn btn-primary btn-small invConfirmPopoverConfirm'>&nbsp;Yes&nbsp;</a> &nbsp; <a class='btn btn-small invConfirmPopoverCancel'>&nbsp;No&nbsp;</a> "
});
target.tooltip( "hide" );
target.popover( "show" );
doc.on( "mousedown.invConfirmPopover", handleDocumentMousedown );
doc.on( "click.invConfirmPopover", "a.invConfirmPopoverConfirm", handleConfirmClick );
doc.on( "click.invConfirmPopover", "a.invConfirmPopoverCancel", handleCancelClick );
return( false );
}
);
$scope.$on( 
"$destroy",
function() {
target.off( "click.invConfirmPopover" );
target.popover( "destroy" );
doc.off( "mousedown.invConfirmPopover" );
doc.off( "click.invConfirmPopover" );
}
);
};
return({
link: linkFunction,
restrict: "A",
scope: false
});
}
);
})( angular, InVision );
;
;
/*! copy-to-clipboard.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invCopyToClipboard",
function( $timeout ) {
var linkFunction = function( $scope, element, attributes ) {
var $element = $(element),
$button = $element.find("button"),
$copiedText = $(".copied");
var clip = new ZeroClipboard( $button , {
moviePath: "/assets/apps/common/vendor/zeroclipboard/ZeroClipboard.swf"
});
clip.on( "complete", function(clip, args) {
$timeout(function() {
$scope.toggleShareModal();
});
$copiedText.fadeIn(250);
$timeout(function() {
$copiedText.fadeOut(250);
}, 4000);
} );
$scope.$watch("isShowingShareModal", function watchIsShowingModal( _new ) {
if ( _new ) {
$timeout(function() {
$(element).find("input#share_link").select();
});
}
});
$scope.$on(
"$destroy",
function() {
}
);
};
return({
link: linkFunction
});
}
);
})( angular, InVision );
;
;
/*! fade-show.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invFadeShow",
function() {
var linkFunction = function( $scope, element, attributes ) {
var duration = ( "fast" || attributes.fadeDuration );
var expression = attributes.invFadeShow;
if ( $scope.$eval( expression ) ) {
element.show();
} else {
element.hide();
}
$scope.$watch(
expression,
function( newValue, oldValue ) {
if (
ng.isUndefined( newValue ) ||
( newValue === oldValue )
) {
return;
}
if ( newValue ) {
element
.stop( true, true )
.fadeIn( duration )
;
} else if ( ! newValue ) {
element
.stop( true, true )
.fadeOut( duration )
;
}
}
);
$scope.$on(
"$destroy",
function() {
}
);
};
return({
link: linkFunction,
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! focus.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invFocus", Directive );
/** @ngInject */
function Directive() {
var linkFunction = function( $scope, element, attributes ) {
element.one(
"focus.invFocus",
function( event ) {
$scope.$apply( attributes.invFocus );
}
);
$scope.$on(
"$destroy",
function() {
element.off( "focus.invFocus" );					
}
);
};
return({
link: linkFunction,
restrict: "A"
});
}
})( angular, InVision );
;
;
/*! history-overlay.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invHistoryOverlay", Directive );
/** @ngInject */
function Directive( _, $timeout ) {
var linkFunction = function( $scope, element, attributes ) {
var $window = $(window);
var $body = $("body");
var timer;
var screenData = JSON.parse(attributes.overlayScreenData);
var markerPos = JSON.parse(attributes.overlayMarkerPos);
var elPos = getElementBoundingCoords(element[0]);
var $screenImage = 	$("<div class='history-overlay'>" +
"<div class='history-overlay-image-container'>" +
"<img src='" + attributes.overlayImage + "'>" +
"</div></div>");
var $img = $screenImage.find("img");
var $commentContainer = element.closest(".comment-content");
var imageStyle = {
top: -elPos.top + (elPos.top - markerPos.top) + 135,
left: -elPos.left + (elPos.left - markerPos.left) + 275,
height: screenData.height * screenData.displayScale,
width: screenData.width * screenData.displayScale
};
$img.css(imageStyle);
element.on("mouseenter.history-overlay", function() {
var toolDiff = (3 - element.closest(".comment-item-options__tools").children("li:visible").length) * 29;
var containerStyle = {
top: elPos.top - $commentContainer.scrollTop(),
left: elPos.left + toolDiff
};
$screenImage.css(containerStyle);
$body.append($screenImage);
timer = $timeout(function() {
if ( ( $screenImage.offset().top - $window.scrollTop() ) <= 47 ) {
$screenImage.addClass("flip");
}
}, 1);
$screenImage.stop().fadeIn(250);
});
element.on("mouseleave.history-overlay", function() {
$screenImage.stop().fadeOut(250, function() {
$screenImage.remove();
$screenImage.removeClass("flip");
});
});
$scope.$on( "$destroy", function() {
element.unbind("mouseenter.history-overlay");
element.unbind("mouseleave.history-overlay");
$timeout.cancel( timer );
} );
function getElementBoundingCoords( el ) {
var coordinates = { top: 0, left: 0 };
var obj = el;
var body = document.body;
while ( obj ) {
coordinates.left += obj.offsetLeft + obj.clientLeft;
coordinates.top += obj.offsetTop + obj.clientTop;
obj = obj.offsetParent;
}
obj = el;
while ( obj !== body ) {
if ( obj && obj.scrollTop && obj.scrollTop > 0 ) {
coordinates.top -= obj.scrollTop;
}
if ( obj && obj.scrollLeft && obj.scrollLeft > 0 ) {
coordinates.left -= obj.scrollLeft;
}
obj = obj.parentNode;
}
return coordinates;
}
};
return({
link: linkFunction
});
}
})( angular, InVision );
;
;
/*! i8n-telephone.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invI8nTelephone", Directive );
/** @ngInject */
function Directive() {
var linkFunction = function( $scope, element, attributes ) {
var defaultCountry = ( $scope[ attributes.countryCode ] || "us" );
$( element ).intlTelInput({
defaultCountry: defaultCountry,
americaMode: false,
defaultStyling: true
});
$scope.$watch( 
attributes.countryCode,
function( newValue, oldValue ) {
if( newValue !== $( element ).intlTelInput("getSelectedCountryData").iso2 ) {
$( element ).intlTelInput("selectCountry", newValue );
}
}
);
$scope.$on(
"$destroy",
function() {			
}
);
};
return({
link: linkFunction,
restrict: "A"
});
}
})( angular, InVision );
;
;
/*! key-combos.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invKeyCombos",
/** @ngInject */
function( $document, _ ) {
function Controller( $scope, $element ) {
function addListener( config ) {
var currentConfig = getCurrentConfig();
if ( currentConfig ) {
removeExistingBindings( currentConfig );
}
listeners.push( config );
addNewBindings( config );
}
function addNewBindings( config ) {
for ( var eventType in config ) {
$document.on( eventType, config[ eventType ] );
}
}
function getCurrentConfig() {
var lastIndex = ( listeners.length - 1 );
return( listeners[ lastIndex ] || null );
}
function removeExistingBindings( config ) {
for ( var eventType in config ) {
$document.off( eventType );
}
}
function removeActiveListener() {
removeExistingBindings( listeners.pop() );
var nextConfig = getCurrentConfig();
if ( nextConfig ) {
addNewBindings( nextConfig );
}
}
function removeInactiveListener( config ) {
listeners = _.without( listeners, config );
}
function removeListener( config ) {
var currentConfig = getCurrentConfig();
if ( currentConfig === config ) {
removeActiveListener();
} else {
removeInactiveListener( config );
}
}
var listeners = [];
return({
addListener: addListener,
removeListener: removeListener
});
}
function linkFunction( $scope, element, attributes, controller ) {
}
return({
controller: Controller,
link: linkFunction,
required: "@",
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! loading-sequence.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invLoadingSequence",
/** @ngInject */
function( $timeout, $, _, config ) {
var linkFunction = function( $scope, element, attributes ) {
function handleEndOfLoadingSequence() {
$scope.$apply($scope.loadingSequenceCompleted);
}
function setStatus( percentage ) {
var totalImagesInSprite = 20;
var imagesPerRow = 5;
var imageWidth = 258;
var index = Math.ceil( totalImagesInSprite * percentage / 100  ) - 1;
if ( percentage ) {
index = Math.max( 0, index );
}
var row = Math.floor( index / imagesPerRow );
var column = ( index % imagesPerRow );
var xOffset = ( column * (-1 * imageWidth) );
var yOffset = ( row * (-1 * imageWidth) );
dom.status.css( 
"background-position", 
( xOffset + "px " + yOffset + "px" )
);
}
var dom = {
target: element,
loader: element.find( "div.loading-backdrop" ),
status: element.find( "div.status" ),
text: element.find(".loading-container")
};
$scope.$watch(
"percentLoaded",
function( newValue ) {
setStatus( newValue );
if ( newValue > config.LOADING_COMPLETE_PERCENT ) {
if ( config.isLite === false || config.isLite === undefined ) {
$scope.setDesktopLoadingForGifIsReady( true );
};
dom.text.fadeOut(250, function() {
dom.loader.fadeOut(250, handleEndOfLoadingSequence);
});
}
}
);
};
return({
link: linkFunction,
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! mobile-simulated-loading-screen.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invMobileSimulatedLoadingScreen",
function( $timeout ) {
var linkFunction = function( $scope, element, attributes ) {
attributes.$observe( "isShareLoaded" , function watchLoaderCompleted( newVal ){
if ( newVal == "false" ){
$timeout( function hideLoadingScreen(){
$scope.setMobileLoadingForGifIsReady( true );
element.fadeOut( 600 );
}, 1000 );
}
});
$scope.$on(
"relaunchMobileApp",
function( event, screenID ){
element.show();
$scope.setMobileLoadingForGifIsReady( false );
$timeout( function hideLoadingScreen(){
$scope.setMobileLoadingForGifIsReady( true );
element.fadeOut( 600 );
}, 1000 );
}
);
};
return({
link: linkFunction,
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! mobile-skin.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invMobileSkin",
/** @ngInject */
function( $timeout, config, modelEvents ) {
var linkFunction = function( $scope, element, attributes ) {
var positionSkin = function(){
if( config.share.isEmbed == true ){
$(element).css( "margin", "20px 0 0 20px" );
return;
}
var winHeight = $(window).height();
var winWidth = $(window).height();
var skinHeight = $(element).height();
var shadowHeight = 0;  // This is the height of the shaddow at the bottom of every skin image
var bottomBarHeight = 0;
if( ( skinHeight - shadowHeight + 25 ) >= ( winHeight - bottomBarHeight ) ){
var topMargin = "25px";
}else{
var topMargin = ( winHeight - bottomBarHeight - skinHeight + shadowHeight ) / 2;
}
$(element).css( "margin-top", Math.round(topMargin) );
}
if( $scope.deviceTemplate.mobileDeviceID > 0){
$timeout(function(){
positionSkin(); // INIT
});
$(window).on("resize.mobileSkin", positionSkin );
element.on( "mousedown.mobileSkin", function( event ){
event.preventDefault();
if( $(event.target).parents(".mobile-viewport").length ){
return;
}
modelEvents.trigger( "flashHotspots" );
});
}
$scope.showArrows = true;
$scope.$on(
"$destroy",
function() {
$(window).off("resize.mobileSkin");
element.off( "mousedown.mobileSkin" );
}
);
};
return({
link: linkFunction,
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! mobile-slideshow-nav.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invMobileSlideshowNav",
function( $timeout, sessionService, screenService ) {
var linkFunction = function( $scope, element, attributes ) {
function updateSlideshowSettings() {
var isSlideshowNavAllowed = sessionService.get( "isSlideshowNavAllowed" );
var hasMultipleScreens = $('.screen').length > 1;
if( isSlideshowNavAllowed !== false && hasMultipleScreens ) {
$scope.isShowingMobileSlideshowNav = true;
} else {
$scope.isShowingMobileSlideshowNav = false;
}
}
function setupMobileNav() {
$('.skin').on(
"mouseenter.invMobileSlideshowNav",
function(e) {
if( ! $(e.target).is('.preview-nav img') ) {
$('.preview-nav').removeClass('visible');
}
}
);
$('.skin').on(
"mouseleave.invMobileSlideshowNav",
function(e) {
$('.preview-nav').addClass('visible');
}
);
}
function killEventHandlers() {
$('.skin').off("mouseenter.invMobileSlideshowNav");
$('.skin').off("mouseleave.invMobileSlideshowNav");
}
$scope.showPreviousScreen = function() {
$scope.$broadcast("showPreviousScreen");
$scope.$broadcast("showSlideshowStatus");
};
$scope.showNextScreen = function() {
$scope.$broadcast("showNextScreen");
$scope.$broadcast("showSlideshowStatus");
};
$scope.isShowingMobileSlideshowNav = true;
$scope.currentScreenIndex = screenService.getCurrentScreenIndex();
$scope.screenCount = screenService.getTotalScreenCount();
$scope.$on(
"isShowingSlideshowNav",
function( event, value ) {
updateSlideshowSettings();
}
);
$scope.$on(
"$destroy",
function() {
killEventHandlers();
}
);
$scope.$watch(
screenService.getCurrentScreenIndex,
function (newValue) {
$scope.currentScreenIndex = newValue;
}
);
$timeout(function() {
setupMobileNav();
updateSlideshowSettings();
});
};
return({
link: linkFunction,
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! notify-text.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invNotifyText", Directive );
/** @ngInject */
function Directive() {
var linkFunction = function( $scope, element, attributes ) {
var notifyNames = "0 people",
notifyOthers = "";
function setText(names, others) {
$(element).text("Send notification to " + names + " " + others);
}
attributes.$observe("names", function(value) {
value = value || "0 people";
notifyNames = value;
setText(value, notifyOthers);
});
attributes.$observe("others", function(value) {
value = value - 1;
var text = value <= 0 ? "" : "& " + value + " other" + ( value > 1 ? "s" : "" );
notifyOthers = text;
setText(notifyNames, text);
});
};
return({
link: linkFunction,
restrict: "A"
});
}
})( angular, InVision );
;
;
/*! preview-auto-redirect-listener.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invPreviewAutoRedirectListener", Directive );
var timer;
/** @ngInject */
function Directive( $, _, $rootScope, $timeout, hotspotService ) {
return {
restrict: 'A',
scope: true, // This is required so the $broadcast only goes down the DOM.
link: function( $scope, element, attributes ){
var delayOnLoadTimer;
function getAutoRedirectHotspot( screenID ){
var hotspots = hotspotService.getHotspotsByScreenID( screenID );
var autoRedirectHotspot = _.findWithProperty( hotspots, "eventTypeID", 9 );
if( autoRedirectHotspot != undefined ){
$timeout.cancel( timer );
timer = $timeout(
function onTimerTimeout(){
$scope.$broadcast("autoRedirectTriggered.share", autoRedirectHotspot, undefined, true );
$timeout.cancel( timer );
},
autoRedirectHotspot.metaData.redirectAfter
);
}else{
$timeout.cancel( timer );
}
}
$scope.$watch(
"screen",
function hotspotsChangedFunction( newScreen, oldScreen){
$timeout.cancel( timer );
if( attributes.isShareLoaded == "true" ){
getAutoRedirectHotspot( newScreen.id );
}else{
}
}
);
$rootScope.$on("isBrowseOpen", function pauseRedirect(event, isOpen) {
if ( isOpen ) {
$timeout.cancel(timer);
} else {
getAutoRedirectHotspot($scope.screenID);
}
});
attributes.$observe( "isShareLoaded" , function watchLoaderCompleted( newValue ){
if( newValue == "true" ){
$timeout.cancel( delayOnLoadTimer );
delayOnLoadTimer = $timeout( function waitForLoadingScreenToComplete(){
getAutoRedirectHotspot( $scope.screenID );
}, 2000 );
}
});
$scope.$on(
"$destroy",
function( event ) {
$timeout.cancel( timer );
$timeout.cancel( delayOnLoadTimer );
}
);
}
};
}
})( angular, InVision );
;
;
/*! preview-helper.js */ 
;
;
(function( ng, app ) {
"use strict";
var isViewportEventRegistered = false;
app.directive(
"invPreviewHelper",
/** @ngInject */
function( $timeout, keyComboHelper, _, modelEvents, sessionService, config ) {
var linkFunction = function( $scope, element, attributes, keyCombosController ) {
var slideshowNav = element.find( ".slideshow-nav" );
var slideshowStatus = slideshowNav.find( ".slideshow-status" );
function flashPreviewHotspots( fadeInDuration, pauseDuration, fadeOutDuration ) {
fadeInDuration = ( fadeInDuration || 100 );
pauseDuration = ( pauseDuration || 200 );
fadeOutDuration = ( fadeOutDuration || 200 );
var hotspots = element.closest("body").find( "a.hotspot" );
if ( hotspots.is( ".flashing" ) ) {
return;
}
hotspots
.addClass( "flashing" )
.stop(true)
.fadeTo( fadeInDuration, 1 )
.delay( pauseDuration )
.fadeTo(
fadeOutDuration, 0,
function() {
$(this).removeClass("flashing");
}
);
}
function showSlideshowStatus( forceShow ) {
forceShow = !!forceShow;
if ( $scope.isShowingSlideshowNav !== true && !forceShow ) {
return;
}
slideshowStatus
.stop( true, true )
.show()
.delay( 1000 )
.fadeOut( 500 )
;
}
function highlightSlideshowNav() {
if ( $scope.isShowingSlideshowNav !== true || $scope.project.isMobile ) {
return;
}
showSlideshowStatus();
}
function keyboardNavUsed() {
$scope.keyboardNavUsed();
}
function showBrowse() {
$scope.$apply(
function() {
$scope.openBrowse();
}
);
}
function showComments() {
$scope.$apply(
function() {
$scope.navigateToScreenComments();
}
);
}
function showNextScreen() {
$scope.$apply(
function() {
$scope.showNextScreen();
var forceStatus = !!$scope.project.isMobile;
showSlideshowStatus( forceStatus );
}
);
}
function showPreviousScreen() {
$scope.$apply(
function() {
$scope.showPreviousScreen();
var forceStatus = !!$scope.project.isMobile;
showSlideshowStatus( forceStatus );
}
);
}
if ( !$scope.isUserTesting ) {
var mousedata = {
threshold: 5, // pixel
x: 0,
y: 0
};
element.on("mousedown.invPreviewHelper", function(event) {
mousedata.x = event.clientX;
mousedata.y = event.clientY;
});
}
/**
*
* 	Dynamically handle hover/clicking events within a given viewport.
*
*  This is necessary to distinguish between square/round devices,
*  as border-radius doesn't affect the interactive area of an element,
*  just what's visible.
*
*  https://invisionapp.atlassian.net/browse/INVISION-3134
*
*/
var viewportElements = ".mobile-viewport, .mobile-status-bar, #mobile_transition_layer";
var mobileSkinName = attributes.mobileSkinName
if (sessionService.get("inViewport") === undefined) {
sessionService.set("inViewport", false);
}
if ( !isViewportEventRegistered && $scope.project.isMobile ) {
isViewportEventRegistered = true;
var $html = $("html");
$html.on("mouseenter.viewportIntent touchstart.viewportIntent", viewportElements, verifyHoverIntent);
$html.on("mouseleave.viewportIntent", viewportElements, hoverLeave);
}
function hoverLeave( event ) {
var $skin = $(".mobile-skin");
var $viewport = $(".mobile-viewport");
var circleWidth	= $viewport.outerWidth( true );
var circleHeight = $viewport.outerHeight( true );
var circleLeft = $viewport.offset().left;
var circleTop = $viewport.offset().top;
var circlePos = {
x: circleLeft + circleWidth / 2,
y: circleTop + circleHeight / 2,
radius: circleWidth / 2
};
var distance = Math.sqrt( Math.pow( event.pageX - circlePos.x, 2 ) + Math.pow( event.pageY - circlePos.y, 2 ) );
if ( distance > circlePos.radius && sessionService.get("inViewport") ) {
sessionService.set("inViewport", false);
$skin.removeClass("viewport-hover");
$(this).off("mousemove.viewportIntent");
}
}
function verifyHoverIntent( event ) {
var $skin = $(".mobile-skin");
var $viewport = $(".mobile-viewport");
if ( parseInt($viewport.css('border-top-left-radius')) !== 0 && mobileSkinName != "iPhoneX" ) {
var circleWidth	= $viewport.outerWidth( true );
var circleHeight= $viewport.outerHeight( true );
var circleLeft = $viewport.offset().left;
var circleTop = $viewport.offset().top;
var circlePos = {
x: circleLeft + circleWidth / 2,
y: circleTop + circleHeight / 2,
radius: circleWidth / 2
};
$(this).on("mousemove.viewportIntent", function( event ) {
var distance = Math.sqrt( Math.pow( event.pageX - circlePos.x, 2 ) + Math.pow( event.pageY - circlePos.y, 2 ) );
if ( distance <= circlePos.radius && !sessionService.get("inViewport") ) {
sessionService.set("inViewport", true);
if (!isChrome46()) {
$skin.addClass("viewport-hover");
}
} else if ( distance > circlePos.radius && sessionService.get("inViewport") ) {
sessionService.set("inViewport", false);
$skin.removeClass("viewport-hover");
}
});
} else {
sessionService.set("inViewport", true);
if (!isChrome46()) {
$skin.addClass("viewport-hover");
}
}
}
function isChrome46() {
var version = navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);
var platform = navigator.platform;
return platform === "MacIntel" && !!version && parseInt(version[2], 10) === 46;
}
var listenerConfig = {};
listenerConfig[ "keydown.invPreviewKeyCombos" ] = function( event ) {
if (event.target.tagName.toUpperCase() == 'INPUT' || $(".tour-point-form").length > 0) {
return;
}
if ( event.metaKey ) {
return;
}
if ( keyComboHelper.isLeftArrowKeyEvent( event ) ) {
event.preventDefault();
if ( !$scope.share.isLoadAllScreens ) {
return;
}
if ( $scope.project.isMobile ) {
$timeout(function() {
$scope.showPreviousScreen();
});
} else {
showPreviousScreen();
}
keyboardNavUsed();
} else if ( keyComboHelper.isRightArrowKeyEvent( event ) ) {
event.preventDefault();
if ( !$scope.share.isLoadAllScreens ) {
return;
}
if ( $scope.project.isMobile ) {
$timeout(function() {
$scope.showNextScreen();
});
} else {
showNextScreen();
}
keyboardNavUsed();
} else if ( !event.ctrlKey && keyComboHelper.isCharKeyEvent( event, "c" ) ) {
event.preventDefault();
showComments();
} else if (
keyComboHelper.isCharKeyEvent( event, "b" ) ||
keyComboHelper.isCharKeyEvent( event, "j" )
) {
event.preventDefault();
showBrowse();
}
};
keyCombosController.addListener( listenerConfig );
$scope.$on(
"showSlideshowStatus",
function() {
showSlideshowStatus( true );
}
);
$scope.$watch(
"isLoadingOpen",
function( newValue, oldValue ) {
if ( newValue === oldValue ) {
return;
}
if ( !$scope.isUserTesting && newValue === false ) {
flashPreviewHotspots();
highlightSlideshowNav();
}
}
);
$scope.$watch(
"isShowingSlideshowNav",
function( newValue, oldValue ) {
if ( newValue === oldValue ) {
return;
}
if ( newValue === true && $scope.isLoadingOpen === false ) {
highlightSlideshowNav();
}
}
);
modelEvents.on("flashHotspots.preview",
function( event ) {
flashPreviewHotspots();
}
);
$scope.$on(
"$destroy",
function() {
keyCombosController.removeListener( listenerConfig );
modelEvents.off( "flashHotspots.preview" );
element.off("mousedown.invPreviewHelper");
}
);
};
return ({
link: linkFunction,
require: "^invKeyCombos",
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! realtime.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invRealtime", Directive );
/** @ngInject */
function Directive( $window, config, Pusher, modelEvents, _ ) {
function link( $scope, element, attributes ) {
function buildModelEventTriggerArguments( event, eventType, propertyNames ) {
var triggerArguments = _.map(
propertyNames,
function( propertyName ) {
return( event.data[ propertyName ] );
}
);
triggerArguments.unshift( eventType );
return( triggerArguments );
}
function getChannelName( userID ) {
var privateChannelName = ["private", "user", userID];
if (config.featureFlags["share-silver-1081-pusher-namespace"] &&
config.featureFlags["pusher-namespace"] &&
config.pusher.namespace) {
privateChannelName.push(config.pusher.namespace);
}
return( privateChannelName.join("-") );
}
function mapPushEvent( channel, eventType, property1, property2, propertyN ) {
var propertyNames = _.toArray( arguments );
var channel = propertyNames.shift();
var eventType = propertyNames.shift();
channel.bind(
eventType,
function( event ) {
var triggerArguments = buildModelEventTriggerArguments( event, eventType, propertyNames );
$scope.$apply(
function() {
modelEvents.trigger.apply( modelEvents, triggerArguments );
}
);
}
);
}
function subscribeToChannelEvents( channel ) {
mapPushEvent( channel, "screenDeleted", "screenID", "projectID" );
mapPushEvent( channel, "screenUploaded", "screen" );
mapPushEvent( channel, "screenSortNotification", "projectID" );
mapPushEvent( channel, "screenConfigUpdated", "screen");
mapPushEvent( channel, "projectUpdated", "project" );
mapPushEvent( channel, "hotspotCreated", "hotspotID", "projectID" );
mapPushEvent( channel, "hotspotUpdated", "hotspotID", "projectID" );
mapPushEvent( channel, "hotspotDeleted", "hotspotID", "projectID" );
mapPushEvent( channel, "commentAdded", "commentID", "conversationID", "projectID" );
mapPushEvent( channel, "commentUpdated", "commentID", "conversationID", "projectID" );
mapPushEvent( channel, "commentDeleted", "commentID", "conversationID", "projectID" );
mapPushEvent( channel, "conversationAdded", "conversationID", "screenID", "projectID" );
mapPushEvent( channel, "conversationUpdated", "conversationID", "projectID" );
mapPushEvent( channel, "conversationDeleted", "conversationID", "projectID" );
mapPushEvent( channel, "conversationSubscribersUpdated", "conversationID", "notify" );
mapPushEvent( channel, "sessionInactive", "identifier" );
return( channel );
}
$window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR = true;
Pusher.channel_auth_endpoint = "/api/pusher/authenticate";
var pusherOptions = ( config.allowExternalScripts !== false ) ? {} : {disableStats: true};
var pusher = new Pusher( config.pusher.appKey, pusherOptions );
var userChannel = null
var unwatchUserID = $scope.$watch(
function watchUserIDExpression() {
return( config.user.id );
},
function watchUserID( newUserID, oldUserID ) {
if ( ! config.user.isAnonymous ) {
unwatchUserID();
}
if ( userChannel && oldUserID ) {
pusher.unsubscribe( getChannelName( oldUserID ) );
}
userChannel = subscribeToChannelEvents( pusher.subscribe( getChannelName( newUserID ) ) );
userChannel.bind('pusher:subscription_error', function(status) {
if(status == 403){
pusher.unsubscribe( getChannelName( newUserID ) );
}
});
}
);
/*
$scope.$on(
"$destroy",
function() {
}
);
*/
};
return({
link: link,
restrict: "A"
});
}
})( angular, InVision );
;
;
/*! screen.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invScreen",
/** @ngInject */
function( $timeout, _ ) {
var linkFunction = function( $scope, element, attributes ) {
var imgGifPrev,
imgGif;
function handleImageLoaded() {
element
.off( "load.invScreen" )
.off( "error.invScreen" )
;
$timeout(
function() {
$scope.imageLoadedForScreen( $scope.screen );
}
);
}
function handleScreenSelectionForGif( newValue, oldValue ) {
if ( newValue === oldValue || !newValue || !element.prop( "src" )) {
return;
}
element.attr('src', imgGifPrev.src);
setTimeout(function() {
element.attr('src', imgGif.src);
}, 0);
}
element.on( "load.invScreen", handleImageLoaded );
element.on( "error.invScreen", handleImageLoaded );
if ( $scope.screen && $scope.screen.isGif ) {
if (!imgGif) {
imgGif = new Image();
imgGif.src = $scope.screen.imageUrl;
imgGifPrev = new Image();
}
$scope.$watch('selectedScreen.id', function(val) {
if (val != $scope.screen.id) {
imgGifPrev.src = $scope.selectedScreen.imageUrl;
}
});
$scope.$watch( "( selectedScreen.id == screen.id && mobileLoadingForGifIsReady == true && desktopLoadingForGifIsReady == true && isLoadingOpen == false )", handleScreenSelectionForGif);
}
$scope.$on(
"$destroy",
function() {
element.off( "load.invScreen" );
element.off( "error.invScreen" );
}
);
};
function isIE() {
var ua = window.navigator.userAgent;
var msie = ua.indexOf("MSIE ");
if ( msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./) ){
return true;  // If old IE or new, but just as bad IE 11
}
return false;
}
return({
link: linkFunction,
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! screens.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invScreens",
/** @ngInject */
function( $window, _, config, $location, $timeout, screenService ) {
var linkFunction = function( $scope, element, attributes ) {
var isFirstScreenChange = true;
function handleSelectedScreenChange( screen, isSubviewSwitch ) {
if (isFirstScreenChange) isFirstScreenChange = false;
if ( ! screen ) {
return;
}
var screenWidth = screen.width * screen.displayScale;
var screenHeight = screen.height * screen.displayScale;
var isMaintainScrollPosition = (
isFirstScreenChange
? false
: $location.search().maintainScrollPosition !== 'false'
);
if (
( screenWidth <= windowWidth ) &&
( screenHeight <= windowHeight )
) {
return;
}
var targetScrollLeft;
if ( isMaintainScrollPosition && !isSubviewSwitch ) {
targetScrollLeft = $jqWindow.scrollLeft();
} else if ( screen.alignment === "left" ) {
targetScrollLeft = 0;
} else if ( screen.alignment === "right" ) {
targetScrollLeft = ( screenWidth - windowWidth );
} else {
targetScrollLeft = ( ( screenWidth - windowWidth ) / 2 );
}
var targetScrollTop = 0;
if ( isMaintainScrollPosition ) {
targetScrollTop = $jqWindow.scrollTop();
}
if( screen.zoomScrollBehavior !== screenService.zoomScrollBehaviors.DISABLE_HORIZONTAL_SCROLLING || $scope.subview == "comments" ){
$jqWindow.scrollLeft( targetScrollLeft );
}
if ($scope.subview !== "comments") {
$jqWindow.scrollTop( targetScrollTop );
}
$timeout(
function() {
if( screen.zoomScrollBehavior !== screenService.zoomScrollBehaviors.DISABLE_HORIZONTAL_SCROLLING || $scope.subview == "comments" ){
$jqWindow.scrollLeft( targetScrollLeft );
}
if ($scope.subview !== "comments") {
$jqWindow.scrollTop( targetScrollTop );
}
});
}
var $jqWindow = $( window );
var windowWidth = $jqWindow.width();
var windowHeight = $jqWindow.height();
$jqWindow.on(
"resize.invScreens",
function() {
windowWidth = $jqWindow.width();
windowHeight = $jqWindow.height();
}
);
var unwatchLoading = $scope.$watch(
function() {
return( $scope.getPercentOfScreensLoaded() > config.LOADING_COMPLETE_PERCENTAGE );
},
function( isLoaded ) {
if ( ! isLoaded ) {
return;
}
unwatchLoading();
$scope.$watch(
"selectedScreen",
function( newScreen, oldScreen ) {
handleSelectedScreenChange( newScreen, false );
}
);
}
);
$scope.$watch(
"subview",
function( newSection, oldSection ){
if( newSection == "comments" && oldSection != "comments" ){
handleSelectedScreenChange( $scope.screen, true );
}
}
);
$scope.$on(
"$destroy",
function() {
$jqWindow.off( "resize.invScreens" );
}
);
};
return({
link: linkFunction,
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! screen-version-image-scaler.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invScreenVersionImageScaler", Directive );
/** @ngInject */
function Directive() {
function link( $scope, element, attributes ) {
element.on(
"load.invHistoryImageLoadEvent",
function( event ) {
scaleImage();
}
);
function scaleImage(){
var imageWidth = element[0].naturalWidth;
var imageHeight = element[0].naturalHeight;
var displayScale = $scope.screen.displayScale;
var scaledWidth = displayScale * imageWidth;
var scaledHeight = displayScale * imageHeight;
element.css({ 
height: "auto",
width: scaledWidth + "px"
});
}
$scope.$watch(
"activeVersion.imageUrl",
function( oldImageUrl, newImageUrl ) {
if( oldImageUrl != newImageUrl ) {
scaleImage();
}
}
);
$scope.$watch(
"screen.displayScale",
function( oldDisplayScale, newDisplayScale ){
if( oldDisplayScale != newDisplayScale ){
scaleImage();
} 
}
);
$scope.$on(
"$destroy",
function() {
element.off( "load.invHistoryImageLoadEvent" );					
}
);
}
return({
link: link,
restrict: "A"
});
}
})( angular, InVision );
;
;
/*! share-screen-viewer.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invShareScreenViewer", Directive );
/** @ngInject */
function Directive( _, $location, $routeParams, $timeout, $window, config, ScreenAlignmentHelper ) {
var linkFunction = function( $scope, element ) {
var $win = angular.element($window);
var niceScrollInstance = null;
var scrollWatcher = angular.noop;
if (!( "startingScreenID" in $scope )) {
$scope.startingScreenID = parseInt( $routeParams.screenID, 10 ) || $scope.screen.id;
}
var statusBarHeights = {
iPhoneX: 44,
iPad: 15,
"HTC One": 24,
"Samsung Galaxy S4": 24
};
function getConfig() {
var _share = $scope.share;
_share = _.omit(_share, "id");
var _config = _.merge($scope.project, $scope.screen );
_config = _.merge(_config, _share);
_config.isShare = true;
_config.mobileStatusbarBackgroundIsTransparent = ( _config.mobileStatusbarBackgroundColor === "" );
return _config;
}
function prepData(data) {
if (data && data.hasOwnProperty("forceRefreshGUID")) {
return _.omit(data, "forceRefreshGUID");
}
return data;
}
function syncScreenAlignment( alignment ) {
if ( !alignment ) {
var helper = new ScreenAlignmentHelper();
alignment = helper.calculate( $scope.screen );
}
InvScreenViewer.store.setAlignment( alignment );
}
function mergeDataIntoScreen(screen) {
var _screen = angular.copy(screen);
var loadingScreenID = $scope.project.loadingScreen.id || null;
if (_screen.id !== loadingScreenID) {
_screen.displayScale = _screen.displayScale || 1;
_screen.hotspots = $scope.hotspots;
_screen.config = getConfig();
}
return _screen;
}
function handleDataChange(newValue, oldValue) {
if ( newValue !== oldValue ) {
var _screen = mergeDataIntoScreen($scope.screen);
var _screens = _.map($scope.screens, mergeDataIntoScreen);
var _project = $scope.project;
var _config = getConfig();
var allHotspots = prepData($scope.allHotspots);
_project.loadingScreen = _.withProperty( _screens, "screenTypeID", 3 )[0] || "";
if ( !$scope.hasChangedScreens && $scope.startingScreenID === _screen.id ) {
$scope.isNavigationDisabled = _.isArray( _screen.hotspots ) && _screen.hotspots.length > 0;
}
InvScreenViewer.store.pushNewData({
project: prepData( _project ),
screen: prepData(_screen),
currentScreenID: _screen.id,
screens: prepData(_screens),
screenCount: _.size(_screens),
allHotspots: allHotspots,
config: prepData(_config),
templates: prepData($scope.templates),
tourPoints: prepData($scope.tourPoints),
disableHotspotFlash: _config.isUserTesting || false,
isNavigationDisabled: $scope.isNavigationDisabled
});
positionOtherViewports();
window.setTimeout( syncScreenAlignment );
}
}
function pushScreenCount() {
InvScreenViewer.store.pushNewData({
screenCount: _.size($scope.screens)
});
}
function remount(_screen, _screens) {
ReactDOM.unmountComponentAtNode(element[0]);
ReactDOM.render(
React.createFactory(InvScreenViewer.component)(
{
screen: _screen,
screens: _screens,
project: prepData($scope.project),
screenCount: 100
}
),
element[0]
);
pushScreenCount();
}
function init() {
var _screen = mergeDataIntoScreen($scope.screen);
var _screens = _.map($scope.screens, mergeDataIntoScreen);
var disableHotspotFlash = $scope.isUserTesting;
InvScreenViewer.store.getDefaultData({
screen: prepData(_screen),
screens: prepData(_screens),
project: prepData($scope.project),
tourPoints: prepData($scope.tourPoints),
disableHotspotFlash: disableHotspotFlash || false,
screenCount: _.size(_screens),
config: getConfig()
});
remount(_screen, _screens);
syncScreenAlignment();
}
function positionOtherViewports() {
if ( !$scope.project.isMobile ) {
return;
}
var viewportPosition = $("#viewport").offset();
var statusBarHeight = statusBarHeights[$scope.project.mobileTemplate.mobileSkin] || 20;
var viewportHeight = parseInt($scope.project.mobileTemplate.viewportHeight, 10);
var transitionLayer = $("#mobile_transition_layer, #mobile_sketch_layer");
var transitionImage = transitionLayer.find(".target-screen").find("img");
if ( $scope.project.mobileStatusbarIsOpaque && $scope.project.mobileStatusbarIsVisible ) {
viewportHeight -= statusBarHeight;
}
var transitionLayerStyles = {
overflow: "hidden",
top: viewportPosition.top - window.pageYOffset,
left: viewportPosition.left - window.pageXOffset,
height: viewportHeight,
width: $scope.project.mobileTemplate.viewportWidth
};
if (
$scope.project &&
$scope.project.mobileTemplate &&
$scope.project.mobileTemplate.mobileSkin === "iPhoneX"
) {
if (
$scope.project.mobileStatusbarIsVisible &&
!$scope.project.mobileStatusbarBackgroundIsTransparent &&
!$scope.project.mobileStatusbarIsOpaque
) {
transitionLayerStyles.borderRadius = "42px 42px 40px 40px";
} else if (
$scope.project.mobileStatusbarIsOpaque &&
$scope.project.mobileStatusbarIsVisible
) {
transitionLayerStyles.borderRadius = "0 0 40px 40px";
} else {
transitionLayerStyles.borderRadius = "40px";
}
}
transitionLayer.css(transitionLayerStyles);
transitionImage.css({
marginTop: -InvScreenViewer.store.transitionScroll.y || 0
});
}
$scope.$on("$destroy", function() {
ReactDOM.unmountComponentAtNode(element[0]);
$win.off("resize.invScreenViewer");
$win.off("scroll.invScreenViewer");
});
$scope.$on(
"loadingSequenceCompleted",
function() {
InvScreenViewer.store.triggerInitialSyncScreen(true);
}
);
$scope.$watch("deviceTemplate", handleDataChange, true);
$scope.$watch("screen", handleDataChange, true);
$scope.$watch("screens", handleDataChange, true);
$scope.$watch("hotspots", handleDataChange, true);
$scope.$watch("allHotspots", handleDataChange, true);
$scope.$watch("templates", handleDataChange, true);
$scope.$watch("share", handleDataChange, true);
$scope.$watch("tourPoints", handleDataChange, true);
if ( $scope.project.isMobile ) {
$win.on("resize.invScreenViewer", positionOtherViewports);
$win.on("scroll.invScreenViewer", positionOtherViewports);
}
$scope.$on(
"screenAlignment:update",
function(event, alignment ) {
syncScreenAlignment( alignment );
}
);
$scope.$on(
"screenViewer:screenChanged",
function() {
$scope.hasChangedScreens = true;
if ( InvScreenViewer.store.isOverlayOpen ) {
InvScreenViewer.store.closeOverlay();
}
}
);
InvScreenViewer.store.listenTo(
InvScreenViewer.actions.angularLocationChange,
function(targetScreenID) {
if ( _.isUndefined(targetScreenID) ) {
return;
}
$timeout(function() {
$scope.navigateToTargetScreen(targetScreenID);
});
}
);
InvScreenViewer.store.listenTo(
InvScreenViewer.actions.angularDoTransition,
function(hotspot, transitionData) {
$timeout(function() {
$scope.$emit("doTransition", hotspot, transitionData);
});
}
);
InvScreenViewer.store.listenTo(
InvScreenViewer.actions.setMobileScreenViewport,
function( ns ) {
niceScrollInstance = ns;
}
);
$scope.$watch(
"selectedTourPoint",
function(newValue, oldValue) {
if ( newValue !== oldValue ) {
InvScreenViewer.tourPointsStore.onSetSelectedTourPoint(newValue);
}
}
);
InvScreenViewer.store.listenTo(
InvScreenViewer.actions.handleTourPointClick,
function(tourPoint) {
$scope.selectTourPoint(tourPoint);
}
);
InvScreenViewer.store.listenTo(
InvScreenViewer.actions.handleTourPointMouseEnter,
function(tourPoint) {
$scope.selectTooltipTourPoint(tourPoint);
}
);
InvScreenViewer.store.listenTo(
InvScreenViewer.actions.handleTourPointMouseLeave,
function() {
$scope.clearTooltipTourPoint();
}
);
init();
};
return ({
restrict: "E",
link: linkFunction
});
}
})( angular, InVision );
;
;
/*! share-sketch-builder.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invShareSketchBuilder",
/** @ngInject */
function( $, $document, modelEvents, _ ) {
return {
restrict: 'A',
transclude: true,
replace: true,
templateUrl: "/assets/apps/share/views/directives/share-sketch-builder.htm",
link: function( $scope, element, attrs ){
var sketchBuilder_window = $(element).find("#builderWindow");
var sketch_tool = $(element).find('.sketch_tool');
var sketchImageWrapper = $(element).find('.sketchImage_wrapper');
var sketch_image = $(element).find('.sketch_image');
var top_bar = $(element).find('#sketchToolbar');
var sketch_toolbar = $(element).find('.tools');
var $whiteboard = $(element).find("#whiteboard_overlay"),
$scrollWrap = $(element).find(".scroll-wrap"),
$body = $("body");
var init_sketch = function(){
sketch_image.on('dragstart', function(event) {
event.preventDefault(); 
});
sketch_tool.on('click', function (e) {
e.preventDefault();
sketch_tool.removeClass('active')
.filter($(this)).addClass('active');
});
sketchImageWrapper.onselectstart = function(){ return false; };
var UndoManager = function () {
var commandStack = [],
index = -1,
undoManagerContext = false,
callback;
function execute(command) {
if (!command) {
return;
}
undoManagerContext = true;
command.f.apply(command.o, command.p);
undoManagerContext = false;
}
function createCommand(undoObj, undoFunc, undoParamsList, undoMsg, redoObj, redoFunc, redoParamsList, redoMsg) {
return {
undo: {
o: undoObj,
f: undoFunc,
p: undoParamsList,
m: undoMsg
},
redo: {
o: redoObj,
f: redoFunc,
p: redoParamsList,
m: redoMsg
}
};
}
return {
/*
Registers an undo and redo command. Both commands are passed as parameters and turned into command objects.
param undoObj: caller of the undo function
param undoFunc: function to be called at myUndoManager.undo
param undoParamsList: (array) parameter list
param undoMsg: message to be used
*/
register: function (undoObj, undoFunc, undoParamsList, undoMsg, redoObj, redoFunc, redoParamsList, redoMsg) {
if (undoManagerContext) {
return;
}
commandStack.splice(index + 1, commandStack.length - index);
commandStack.push(createCommand(undoObj, undoFunc, undoParamsList, undoMsg, redoObj, redoFunc, redoParamsList, redoMsg));
index = commandStack.length - 1;
if (callback) {
callback();
}
},
/*
Pass a function to be called on undo and redo actions.
*/
setCallback: function (callbackFunc) {
callback = callbackFunc;
},
undo: function () {
var command = commandStack[index];
if (!command) {
return;
}
execute(command.undo);
index -= 1;
if (callback) {
callback();
}
},
redo: function () {
var command = commandStack[index + 1];
if (!command) {
return;
}
execute(command.redo);
index += 1;
if (callback) {
callback();
}
},
/*
Clears the memory, losing all stored states.
*/
clear: function () {
var prev_size = commandStack.length;
commandStack = [];
index = -1;
if (callback && (prev_size > 0)) {
callback();
}
},
hasUndo: function () {
return index !== -1;
},
hasRedo: function () {
return index < (commandStack.length - 1);
}
};
};
(function () {
var sketchIMG_width =  sketch_image.width(),
sketchIMG_height = sketch_image.height();
window.div_paper = sketchImageWrapper;
window.paper = new Raphael(div_paper[0], 0, 0);
window.stack = {};
window.glow_stack = {};
window.undo_manager = new UndoManager();
paper.setSize(sketchIMG_width, sketchIMG_height);
/*
div_paper.css({
width: sketchIMG_width
});
*/
$(element).find("a#undo")
.on('click', function (e) {
e.preventDefault();
if (undo_manager.hasUndo()) undo_manager.undo();
});
$(element).find("a#redo")
.on('click', function (e) {
e.preventDefault();
if (undo_manager.hasRedo()) undo_manager.redo();
});
undo_manager.setUndoKeydown = function(  ){
$document.on("keydown.sketchBuilderModal", function( e ) {
if (e.keyCode === 8 || e.keyCode === 46){
e.preventDefault();
if (undo_manager.hasUndo()) {
undo_manager.undo();
}
}
});
};
undo_manager.setCallback(function () {
if (undo_manager.hasUndo()) {
$(element).find("a#undo")
.removeClass('inactive');
} else $(element).find("a#undo")
.addClass('inactive');
if (undo_manager.hasRedo()) {
$(element).find("a#redo")
.removeClass('inactive');
} else $(element).find("a#redo")
.addClass('inactive');
});
var Sketch = function (o) {
if (typeof(o) != 'undefined') $.extend(true, this, o);
var $this = this;
this.startX = 0;
this.startY = 0;
this.offset = this.findPos(div_paper);
$(window)
.resize(function () {
$this.offset = $this.findPos(div_paper);
});
this.el = $(element).find('.sketch_tool');
};
Sketch.prototype.findPos = function (obj) {
obj = obj[0];
var curleft = 0,
curtop = 0;
if (obj.offsetParent) {
do {
curleft += obj.offsetLeft;
curtop += obj.offsetTop;
} while (obj = obj.offsetParent);
return [curleft, curtop];
} else {
return false;
}
};
Sketch.prototype.normalizeContent = function (html, invert) {
if (!invert) {
html = html.replace(/<div>/gi, '\r\n');
html = html.replace(/<\/div>/gi, '');
html = html.replace(/(<br\s*\/?>)/gi, "\r\n");
} else {
html = html.replace(/\r\n/gi, "<br>");
}
return html;
};
Sketch.prototype.getCoords = function (event) {
event = event || window.event;
return {
x: event.clientX  + $scrollWrap.scrollLeft(),  //- $(sketch_image).css("left").replace("px","")
y: event.clientY + $scrollWrap.scrollTop()
};
};
Sketch.prototype.add_glow = function (el) {
/*
glow_stack[el.id] = el.glow({
color: "#000",
width: 2,
opacity: 0.3,
fill: true,
offsety: 2
});
*/
};
var SketchRectangular = function () {
this.figure = null;
return new Sketch(this);
};
SketchRectangular.prototype.redraw = function (event) {
var mousePos = rectangular.getCoords(event);
var currentX = mousePos.x - rectangular.offset[0];
var currentY = mousePos.y - rectangular.offset[1];
var width = currentX - rectangular.startX;
var height = currentY - rectangular.startY;
if (width < 0) {
rectangular.figure.attr({
'x': currentX,
'width': width * -1
});
} else {
rectangular.figure.attr({
'x': rectangular.startX,
'width': width
});
}
if (height < 0) {
rectangular.figure.attr({
'y': currentY,
'height': height * -1
});
} else {
rectangular.figure.attr({
'y': rectangular.startY,
'height': height
});
}
rectangular.figure.attr({
'fill': '#fff',
'fill-opacity': 0
});
};
SketchRectangular.prototype.draw = function () {
var that = this;
this.el.filter('.square')
.on('click', function () {
div_paper.off();
deselectHandObject();
undo_manager.setUndoKeydown();
hand.wrapper.css({
"cursor": "url('/assets/apps/share/img/cursor-square.png') 23 23,crosshair"
});
div_paper.on({
mousedown: function (event) {
event.preventDefault();
var mouseCoords = that.getCoords(event);
that.startX = mouseCoords.x - that.offset[0];
that.startY = mouseCoords.y - that.offset[1];
that.figure = paper.rect(that.startX, that.startY, 0, 0, 10)
.attr({
'stroke': '#f74272',
'stroke-width': 4,
'stroke-opacity': 1
});
div_paper.on('mousemove', that.redraw);
$document.on( "mouseup.sketchDraw" , function () {
if (that.figure.attr("width") === 0) {
that.figure.remove();
return;
}
if (that.figure) {
that.figure.toFront();
stack[that.figure.id] = that.figure;
undo_manager.register(
that.figure, that.figure.hide, [], 'Hide Rect',
that.figure, that.figure.show, [], 'Show Rect');
}
div_paper.off('mousemove');
$document.off("mouseup.sketchDraw");
}
);
}
});
});
};
var SketchCircle = function () {
this.figure = null;
return new Sketch(this);
};
SketchCircle.prototype.redraw = function (event) {
var mousePos = circle.getCoords(event);
var currentX = mousePos.x - circle.offset[0];
var currentY = mousePos.y - circle.offset[1];
var width = currentX - circle.startX;
var height = currentY - circle.startY;
var size = width > height ? width : height;
size = size / 2;
hand.wrapper.css({
"cursor": "url('/assets/apps/share/img/cursor-circle.png') 23 23,crosshair"
});
if (size < 0) {
circle.figure.attr({
'cx': circle.startX + size,
'rx': size * -1
});
} else {
circle.figure.attr({
'cx': circle.startX + size,
'rx': size
});
}
if (size < 0) {
circle.figure.attr({
'cy': circle.startY + size,
'ry': size * -1
});
} else {
circle.figure.attr({
'cy': circle.startY + size,
'ry': size
});
}
};
SketchCircle.prototype.draw = function () {
var that = this;
this.el.filter('.circle')
.on('click', function () {
div_paper.off();
deselectHandObject();
undo_manager.setUndoKeydown();
hand.wrapper.css({
"cursor": "url('/assets/apps/share/img/cursor-circle.png') 23 23,crosshair"
});
div_paper.on({
mousedown: function (event) {
event.preventDefault();
var mouseCoords = that.getCoords(event);
that.startX = mouseCoords.x - that.offset[0];
that.startY = mouseCoords.y - that.offset[1];
that.figure = paper.ellipse(that.startX, that.startY, 0, 0)
.attr({
'fill': '#fff',
'fill-opacity': 0,
'stroke': '#f74272',
'stroke-width': 4,
'stroke-opacity': 1
});
div_paper.on("mousemove", that.redraw);
$document.on( "mouseup.sketchDraw", function () {
if (that.figure.attr("rx") === 0) {
that.figure.remove();
return;
}
if (that.figure) {
stack[that.figure.id] = that.figure;
undo_manager.register(
that.figure, that.figure.hide, [], 'Hide Cirle',
that.figure, that.figure.show, [], 'Show Cirle');
that.figure.toFront();
}
div_paper.off("mousemove");
$document.off("mouseup.sketchDraw");
});
}
});
});
};
var SketchLine = function () {
this.figure = null;
return new Sketch(this);
};
SketchLine.prototype.redraw = function (event) {
var mousePos = line.getCoords(event);
var currentX = mousePos.x - line.offset[0];
var currentY = mousePos.y - line.offset[1];
line.figure.attr("path", "M" + line.startX + " " + line.startY + "L" + (currentX > 0 ? currentX : 0) + " " + (currentY > 0 ? currentY : 0));
};
SketchLine.prototype.draw = function () {
var that = this;
this.el.filter('.line')
.on('click', function () {
div_paper.off();
deselectHandObject();
undo_manager.setUndoKeydown();
hand.wrapper.css({
"cursor": "url('/assets/apps/share/img/cursor-line.png') 23 23,crosshair"
});
div_paper.on({
mousedown: function (event) {
event.preventDefault();
var mouseCoords = that.getCoords(event);
that.startX = mouseCoords.x - that.offset[0];
that.startY = mouseCoords.y - that.offset[1];
that.figure = paper.path(["M", that.startX, that.startY, "L"])
.attr({
'stroke': '#f74272',
'stroke-width': 4,
'stroke-opacity': 1
});
div_paper.on('mousemove', that.redraw);
$document.on("mouseup.sketchDraw", function () {
if (that.figure.getTotalLength() === 0) {
that.figure.remove();
return;
}
if (that.figure) {
stack[that.figure.id] = that.figure;
undo_manager.register(
that.figure, that.figure.hide, [], 'Hide Line',
that.figure, that.figure.show, [], 'Show Line');
that.figure.toFront();
}
div_paper.off('mousemove');
$document.off("mouseup.sketchDraw");
});
}
});
});
};
var SketchArrow = function () {
this.figure = null;
this.has_arrow = false;
return new Sketch(this);
};
SketchArrow.prototype.redraw = function (event) {
var mousePos = arrow.getCoords(event);
var currentX = mousePos.x - arrow.offset[0];
var currentY = mousePos.y - arrow.offset[1];
arrow.figure.attr("path", "M" + arrow.startX + " " + arrow.startY + "L" + (currentX > 0 ? currentX : 0) + " " + (currentY > 0 ? currentY : 0));
if (arrow.figure.getTotalLength() > 10 && !arrow.has_arrow) {
arrow.figure.attr({
"arrow-end": "classic-wide-long",
"stroke-width": 4,
'stroke': '#f74272',
'stroke-opacity': 1
});
arrow.has_arrow = true;
}
};
SketchArrow.prototype.draw = function () {
var that = this;
this.el.filter('.arrow')
.on('click', function () {
div_paper.off();
deselectHandObject();
undo_manager.setUndoKeydown();
hand.wrapper.css({
"cursor": "crosshair"
});
div_paper.on({
mousedown: function (event) {
event.preventDefault();
that.has_arrow = false;
var mouseCoords = that.getCoords(event);
that.startX = mouseCoords.x - that.offset[0];
that.startY = mouseCoords.y - that.offset[1];
that.figure = paper.path(["M", that.startX, that.startY, "L"]);
div_paper.on('mousemove', that.redraw);
},
mouseup: function () {
if (that.figure.getTotalLength() === 0) {
that.figure.remove();
return;
}
stack[that.figure.id] = that.figure;
if (that.figure) {
that.figure.toFront();
that.figure.add_glow = true;
that.figure.hide_arrow = arrow.hide_arrow;
that.figure.show_arrow = arrow.show_arrow;
that.figure.move_arrow = arrow.move_arrow;
that.add_glow(that.figure);
undo_manager.register(
that.figure, that.figure.hide_arrow, [], 'Hide Arrow',
that.figure, that.figure.show_arrow, [], 'Show Arrow');
}
div_paper.off('mousemove');
}
});
});
};
SketchArrow.prototype.hide_arrow = function () {
var glows = glow_stack[this.id];
if (typeof(glows) != 'undefined' && glows.length > 0) glows.hide();
this.hide();
};
SketchArrow.prototype.show_arrow = function () {
var glows = glow_stack[this.id];
if (typeof(glows) != 'undefined' && glows.length > 0) glows.show();
this.show();
};
SketchArrow.prototype.move_arrow = function (position) {
var glows = glow_stack[this.id];
if (typeof(glows) != 'undefined' && glows.length > 0) glows.remove();
this.transform(position);
arrow.add_glow(this);
};
var SketchText = function () {
this.figure = null;
this.toggle = false;
this.editing = false;
this.wrapper = $('.sketchImage_wrapper');
return new Sketch(this);
};
SketchText.prototype.write = function (text, startX, startY, height) {
text = text.replace( /&nbsp;/gi , " ");
text = this.normalizeContent( text );
text = _.unescape( text );
window.text.figure = paper.text(startX, startY + height, text)
.attr({
'font-family': 'Arial',
'font-size': '18px',
'font-weight': 'normal',
'fill': '#f74272',
'fill-opacity': 1,
"text-anchor": "start"
});
undo_manager.register(
window.text.figure, window.text.figure.hide, [], 'Hide Text',
window.text.figure, window.text.figure.show, [], 'Show Text');
};
SketchText.prototype.alignTop = function (t) {
var b = t.getBBox();
var h = Math.abs(b.y2) - Math.abs(b.y) + 1;
t.attr({
'y': b.y + h
});
};
SketchText.prototype.draw = function () {
var that = this;
this.el.filter('.text')
.on('click', function () {
div_paper.off();
that.wrapper.off();
deselectHandObject();
$document.off("keydown.sketchBuilderModal");
hand.wrapper.css({
"cursor": "text"
});
that.wrapper.on('click', function (event) {
event.preventDefault();
event.stopPropagation();
if (that.editing) return;
if (that.toggle) {
that.toggle = false;
return;
} else that.toggle = true;
var mouseCoords = that.getCoords(event);
var startX = mouseCoords.x - that.offset[0] - 2;
var startY = mouseCoords.y - that.offset[1] - 12;
$('<div contenteditable="true" class="type_tool"></div>')
.appendTo($(this))
.css({
top: startY,
left: startX
})
.focus()
.on('blur', function (e) {
e.preventDefault();
e.stopPropagation();
var $this = $(this),
text = that.normalizeContent($this.html(), false);
if (!text.trim()) {
$this.remove();
return;
}
that.write(text, startX, startY, 9);
stack[that.figure.id] = that.figure;
$this.remove();
that.figure.click(function () {
if (hand.move_tool) return;
that.editing = true;
var el = this;
var html = that.normalizeContent(this.attr('text'), true);
var obj = this.getBBox();
var x = obj.x;
var y = obj.y;
this.hide();
html = _.escape( html );
$('<div contenteditable="true" class="type_tool">' + html + '</div>')
.appendTo(that.wrapper)
.css({
top: y,
left: x
})
.focus()
.on('blur', function (e) {
e.preventDefault();
e.stopPropagation();
var $this = $(this),
text = $this.html();
that.editing = false;
that.toggle = true;
if (!text.trim()) {
text = html;
}
text = text.replace( /&nbsp;/gi , " ");
text = _.unescape( text );
undo_manager.register(
el, el.attr, ['text', el.attr('text')], 'Undo Text',
el, el.attr, ['text', text], 'Redo Text');
el.attr('text', that.normalizeContent(text, false));
el.show();
$this.remove();
});
});
});
});
});
};
var SketchHand = function () {
this.figure = null;
this.selected = false;
this.set = paper.set();
this.wrapper = sketchImageWrapper;
return new Sketch(this);
};
SketchHand.prototype.draw = function () {
var that = this;
this.el.filter('.move')
.on({
click: function () {
that.move_tool = true;
that.wrapper.off();
deselectHandObject();
$document
.off("keydown.sketchBuilderModal")
.on("keydown.sketchBuilderModal", that.deleteKey);
hand.wrapper.css({
"cursor": "default"
});
$(element).off('keydown');
$(element).find("a#delete").off();
that.set = paper.set();
for (var k in stack) {
that.set.push(stack[k]);
}
that.set.drag(that.move, that.start, that.up);
that.set.hover(that.hoverIn, that.hoverOut);
that.set.click(that.clickIn);
that.wrapper.on('click', that.clickOut);
$("a#delete")
.on('click', that.deleteKey);
}
});
this.el.on({
click: function () {
if (!$(this).hasClass('move')) {
$document.off("keydown.sketchBuilderModal")
that.move_tool = false;
that.set.undrag();
$(element).off("keydown.sketchBuilderModal");
that.set.unhover(that.hoverIn, that.hoverOut);
}
}
});
};
SketchHand.prototype.clickIn = function () {
deselectHandObject();
this.dx = this.attr("dx");
this.dy = this.attr("dy");
hand.selected = this;
$(element).find("a#delete")
.removeClass('inactive');
this.attr({
'stroke': '#00aeef',
'stroke-opacity': 1
});
};
SketchHand.prototype.deleteKey = function (e) {
if (e.keyCode == 8 || e.keyCode == 46 || e.type == "click") {
e.preventDefault();
undo_manager.register(
hand.selected, (hand.selected.show_arrow) ? hand.selected.show_arrow : hand.selected.show, [], 'Show Object',
hand.selected, (hand.selected.hide_arrow) ? hand.selected.hide_arrow : hand.selected.hide, [], 'Hide Object');
if (hand.selected.hide_arrow) hand.selected.hide_arrow();
else hand.selected.hide();
$(element).find("a#delete").addClass('inactive');
}
};
SketchHand.prototype.clickOut = function (e) {
if (e.target.nodeName === 'svg' && hand.selected) {
if (hand.selected.node.nodeName === "text"){
hand.selected.attr({
'fill': '#f74272',
'fill-opacity': 1,
'stroke': 'none',
'stroke-opacity': 0
});
}else{
hand.selected.attr({
'fill': '#fff',
'fill-opacity': 0,
'stroke': '#f74272',
'stroke-opacity': 1
});
}
$(element).find("a#delete")
.addClass('inactive');
}else if (e.target.nodeName === "tspan"){
hand.selected.attr({
'fill': '#00aeef',
'fill-opacity': 1,
'stroke': '#00aeef',
'stroke-opacity': 1
});
}
};
SketchHand.prototype.start = function () {
deselectHandObject();
this.attr({
'stroke': '#00aeef'
});
this.dx = this.attr("dx");
this.dy = this.attr("dy");
this.previous_pos = this.transform()
.toString();
hand.wrapper.css({
"cursor": "move"
});
this.unhover(hand.hoverIn, hand.hoverOut);
var glows = glow_stack[this.id];
if (typeof(glows) != 'undefined' && glows.length > 0) glows.remove();
};
SketchHand.prototype.move = function (dx, dy) {
this.translate(dx - this.dx, dy - this.dy);
this.dx = dx;
this.dy = dy;
};
SketchHand.prototype.up = function () {
this.attr({
'fill': '#fff',
'fill-opacity': 0,
'stroke': '#f74272',
'stroke-opacity': 1
});
hand.wrapper.css({
"cursor": "default"
});
this.hover(hand.hoverIn, hand.hoverOut);
if (this.add_glow) hand.add_glow(this);
if (this.previous_pos !== this.transform()
.toString()) undo_manager.register(
this, (this.move_arrow) ? this.move_arrow : this.transform, [this.previous_pos], 'Previous Position',
this, (this.move_arrow) ? this.move_arrow : this.transform, [this.transform()
.toString()], 'Current Position');
};
SketchHand.prototype.hoverIn = function () {
hand.wrapper.css({
cursor: 'move'
});
};
SketchHand.prototype.hoverOut = function () {
hand.wrapper.css({
cursor: "default"
});
};
var SketchPencil = function () {
this.figure = null;
this.wrapper = sketchImageWrapper;
this.pathString = null;
this.startX = 0;
this.startY = 0;
return new Sketch(this);
};
SketchPencil.prototype.redraw = function (event) {
var mousePos = pencil.getCoords(event);
var currentX = mousePos.x - pencil.offset[0];
var currentY = mousePos.y - pencil.offset[1];
pencil.pathString += 'l' + (currentX - pencil.startX) + ' ' + (currentY - pencil.startY);
pencil.figure.attr('path', pencil.pathString);
pencil.startX = currentX;
pencil.startY = currentY;
};
SketchPencil.prototype.draw = function () {
var that = this;
this.el.filter('.pencil')
.on('click', function () {
that.set = paper.set();
div_paper.off();
that.wrapper.off();
deselectHandObject();
undo_manager.setUndoKeydown();
hand.wrapper.css({
"cursor": "url('/assets/apps/share/img/cursor-pen.png') 23 23,crosshair"
});
that.wrapper.on('mousedown', function (event) {
event.preventDefault();
var mouseCoords = that.getCoords(event);
that.startX = mouseCoords.x - that.offset[0];
that.startY = mouseCoords.y - that.offset[1];
that.pathString = 'M' + that.startX + ' ' + that.startY + 'l0 0';
that.figure = paper.path(that.pathString);
stack[that.figure.id] = that.figure;
that.figure.attr({
'stroke': '#f74272',
'stroke-linecap': 'round',
'stroke-linejoin': 'round',
'stroke-width': 4,
'stroke-opacity': 1,
'fill-opacity': 0
});
that.wrapper.on('mousemove', that.redraw);
$document.on('mouseup.sketchDraw', function () {
if (that.figure) {
that.figure.toFront();
undo_manager.register(
that.figure, that.figure.hide, [], 'Hide Pencil',
that.figure, that.figure.show, [], 'Show Pencil');
}
div_paper.off('mousemove');
$document.off('mouseup.sketchDraw');
});
});
});
};
window.rectangular = new SketchRectangular();
rectangular.draw();
window.circle = new SketchCircle();
circle.draw();
window.line = new SketchLine();
line.draw();
window.arrow = new SketchArrow();
arrow.draw();
window.text = new SketchText();
text.draw();
window.hand = new SketchHand();
hand.draw();
window.pencil = new SketchPencil();
pencil.draw();
})();
$(element).find("#pencil").click();
sizeSketchBuilder();
sketchImageWrapper.find("svg").css({
left : $(sketch_image).css("left")
});
}; // end init_sketch()
var deselectHandObject = function(){
if( hand && hand.selected){
if (hand.selected.node.nodeName === "text"){
hand.selected.attr({
'fill': '#f74272',
'fill-opacity': 1,
'stroke': 'none',
'stroke-opacity': 0
});
}else{
hand.selected.attr({
'stroke': '#f74272',
'fill': '#f74272',
'fill-opacity': 0,
'stroke-opacity': 1
});
}
}
};
var sizeSketchBuilder = function(){
var $builderWindow = sketchBuilder_window,
$wrapper = sketchImageWrapper,
_window = {
height: $(window).height(),
width: $(window).width()
},
_sketch = {
height: sketch_image.height(),
width: sketch_image.width()
},
scrollSize = 15,
windowPadding = 60,
toolbarHeight = 49,
builderCSS = {},
wrapperCSS = {},
scrollCSS = {},
builderClasses = "",
wrapperClasses = "";
var minWidth = ( _sketch.width < 800 ) ? 800 : _sketch.width;
builderCSS = {
height: ( _sketch.height > _window.height ) ? ( _window.height - windowPadding ) : _sketch.height + 81,
width: ( _sketch.width > _window.width ) ? ( _window.width - windowPadding ) : minWidth,
left: "50%",
top: "50%",
marginLeft: "-" + ( minWidth / 2 ) + "px"
};
builderCSS.marginTop = "-" + ( builderCSS.height / 2 ) + "px";
wrapperCSS = {
height: _sketch.height,
width: _sketch.width
};
scrollCSS = {
height: builderCSS.height - toolbarHeight,
width: builderCSS.width
};
if ( _sketch.width > _window.width ) {
builderCSS.height += scrollSize;
builderCSS.left = 0;
builderCSS.marginLeft = windowPadding / 2;
scrollCSS.height += scrollSize;
}
if ( ( _sketch.height + toolbarHeight + windowPadding ) > _window.height ) {
builderCSS.top = 0;
builderCSS.marginTop = windowPadding / 2;
}
$builderWindow.css(builderCSS).addClass(builderClasses);
$wrapper.css(wrapperCSS).addClass(wrapperClasses);
$scrollWrap.css(scrollCSS);
$whiteboard.css({
height: _sketch.height,
width: _sketch.width
});
$whiteboard.appendTo( sketchImageWrapper );
};
var scrollToMatchCurrentScroll = function(){
var topOffset;
if( $scope.project.isMobile ){
topOffset = -75; // Mobile has extra space up top.
}else{
topOffset = 20;
}
var sTop = $(window).scrollTop() + topOffset;
var sLeft = $(window).scrollLeft();
$scrollWrap.scrollTop( sTop ).scrollLeft( sLeft );
}
$scope.whiteboardOpacity = 0;
$scope.whiteboardSelected = 'none';
$scope.setWhiteboardOpacity = function( opacity, name ) {
$scope.whiteboardOpacity = opacity;
$scope.whiteboardSelected = name;
};
$scope.saveSketch = function(){
deselectHandObject();
var svg_string = window.paper.toSVG();
var scale = $scope.getReverseDisplayScale($scope.screen);
var $svg = $.parseXML( svg_string );
var numOfSketchElements = $( $svg ).find("svg").children().size();
var opacity = $scope.whiteboardOpacity;
if ( numOfSketchElements === 0){
$scope.openModalWindow( "error", "Your sketch is empty.  There's nothing to save." );
return;
}
var sketch = {
tempID : $scope.tempSketches.length + 1,
screenID : $scope.screenID,
svg : svg_string,
svgScale : scale,
opacity: opacity
};
$scope.tempSketches.push( sketch );
$scope.hideSketchBuilder();
};
setTimeout( init_sketch, 250 );
$(sketch_image).on("load", function(){
sizeSketchBuilder();
scrollToMatchCurrentScroll();
});
$(window).on("resize.sketchBuilderModal", sizeSketchBuilder );
$scope.$on( "$destroy", function() {
$(window).off("resize.sketchBuilderModal", sizeSketchBuilder);
$document.off("keydown.sketchBuilderModal");
$body.removeClass("share-lite-sketching");
});
}
};
}
);
})( angular, InVision );
;
;
/*! share-sketch-viewer.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invShareSketchViewer",
/** @ngInject */
function( $, $window, modelEvents, $timeout ) {
return {
restrict: 'A',
transclude: true,
replace: true,
templateUrl: "/assets/apps/share/views/directives/share-sketch-viewer.htm",
link: function( $scope, element, attrs ){
var $win = $($window);
var resizeSketchViewer = function(){
var overlay = $( element ).find('.modalOverlay');
overlay.css("height", $win.height() );
overlay.css("width", $win.width() );
var sketchViewerWindow = $( element ).find(".sketchViewer");
var sketchImageContainer = $( sketchViewerWindow ).find(".imageContainer");
var sketchImage = $( sketchImageContainer ).find("img");
var tempSketchOverlay = $( sketchViewerWindow ).find(".tempSketchOverlay");
var tempSketchSVG  = $( tempSketchOverlay ).find("svg");
var sketchHeight = $scope.screen.height * $scope.screen.displayScale;
var sketchWidth = $scope.screen.width * $scope.screen.displayScale;
var viewerMaxHeight = $win.height() * .75;
var viewerMaxWidth = $win.width() * .85;
if ( sketchHeight < viewerMaxHeight){
viewerMaxHeight = sketchHeight;
}
if ( sketchWidth < viewerMaxWidth){
viewerMaxWidth = sketchWidth;
}else{
sketchImage.css( "width", viewerMaxWidth + "px");
}
sketchViewerWindow.css("height", viewerMaxHeight + "px");
sketchViewerWindow.css("width", viewerMaxWidth );
element.find(".isProcessing>p").css({"margin-top": (viewerMaxHeight/2 - 50) + "px"});
var marginTop = ( $win.height() - viewerMaxHeight ) / 2;
var marginLeft = ( $win.width() - viewerMaxWidth ) / 2;
sketchViewerWindow.css("margin-top", marginTop );
sketchViewerWindow.css("margin-left", marginLeft );
sketchViewerWindow.removeClass("taller");
sketchViewerWindow.removeClass("wider");
if ( $win.height() < sketchHeight + viewerMaxHeight ) {
sketchViewerWindow.addClass("taller");
}
if ( $win.width() < sketchWidth + viewerMaxHeight ) {
sketchViewerWindow.addClass("wider");
}
}
var autoScrollSketchViewer = function(){
var sTop = $scope.sketchViewerMarker.y * $scope.screen.displayScale - ( $(element).find(".sketchViewer").height() / 2 );
var sLeft = $scope.sketchViewerMarker.x * $scope.screen.displayScale - ( $(element).find(".sketchViewer").width() / 2 );
sTop = sTop > 0 ? sTop : 0;
sLeft = sLeft > 0 ? sLeft : 0;
$(element).find('.imageContainer').scrollTop( sTop ).scrollLeft( sLeft );
}
$timeout(function(){
resizeSketchViewer();
autoScrollSketchViewer();
});
$(window).on("resize.sketchViewerModal", function(){
resizeSketchViewer();
autoScrollSketchViewer();
});
$scope.$on( "$destroy", function() {
$(window).off("resize.sketchViewerModal");
});
}
};
}
);
})( angular, InVision );
;
;
/*! share-sketch-viewer-image.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invShareSketchViewerImage", Directive );
/** @ngInject */
function Directive( $, $window, modelEvents ) {
return {
restrict: 'A',
link: function( $scope, element, attrs ){
var retry = 1;
var timer;
var baseURL = "/api/comments/" + $scope.sketchViewerSketch.commentID + "/sketch/" + $scope.sketchViewerSketch.id;
element.bind("error", function(e){
$scope.setSketchImageIsProcessing( true );
$scope.$apply();
if( retry <= 5 ){
timer = setTimeout(function(){
element.attr("src", baseURL + "?retry=" + retry );
retry++
}, 5000);
}
});
element.bind("load", function(e){
$scope.setSketchImageIsProcessing( false );
$scope.$apply();
})
$scope.$on( "$destroy", function() {
$(window).off("resize.sketchViewerModal");
clearTimeout( timer );
});
}
};
}
})( angular, InVision );
;
;
/*! slice-helper.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invSliceHelper",
function( $document, $timeout, _, screenService ) {
var linkFunction = function( $scope, element, attributes, keyCombosController ) {
var $window = $(window),
$element = $(element),
$screen = $element.find("img");
$window.on("scroll.invSliceHelper", function() {
if ( $screen.width < $window.width || $scope.project.isMobile ) {
return;
}
if( $scope.screen.zoomScrollBehavior == screenService.zoomScrollBehaviors.DISABLE_HORIZONTAL_SCROLLING ){
return;
}else{
$element.css("margin-left", "-" + $(document).scrollLeft() + "px");
}
});
$scope.$on( 
"$destroy",
function() {
$window.off("scroll.invSliceHelper");
}
);
};
return({
link: linkFunction,
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! success-button.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invSuccessButton", Directive );
/** @ngInject */
function Directive( $timeout ) {
var linkFunction = function( $scope, element, attributes ) {
var $button = $(element),
markup = "<span class=\"success-wrap\">" +
"<span class=\"content\">" + $button.text() + "</span>" +
"<span class=\"success\"></span>" +
"</span>",
delay = attributes.delay || 1500;
$button
.text("")
.addClass("success-button")
.append($(markup));
$scope.$on("invSuccessButton:reload", function() {
$button.removeClass("success");
$button
.text("")
.addClass("success-button")
.append($(markup));
});
$scope.$on("invSuccessButton:success", function() {
$button.addClass("success");
$timeout(function() {
$scope.$apply( attributes.afterSuccess );
}, delay);
});
$scope.$on(
"$destroy",
function() {
$button.off("click.invSuccessButton");
}
);
};
return({
link: linkFunction,
restrict: "A"
});
}
})( angular, InVision );
;
;
/*! tinyscrollbar.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invTinyscrollbar",
/** @ngInject */
function( $timeout, _ ) {
var linkFunction = function( $scope, element, attributes ) {
function applyConditionalClasses() {
if ( isScrollbarDisabled() ) {
if ( enabledClass ) {
target.removeClass( enabledClass );
}
if ( disabledClass ) {
target.addClass( disabledClass );
}
} else {
if ( enabledClass ) {
target.addClass( enabledClass );
}
if ( disabledClass ) {
target.removeClass( disabledClass );
}
}
}
function isScrollbarDisabled() {
return( scrollbar.is( ".disable" ) );
}
var target = $( element );
target
.wrapInner( "<div class='overview'>" )
.wrapInner( "<div class='viewport'>" )
.prepend( "<div unselectable='on' class='scrollbar unselectable'><div unselectable='on' class='track unselectable'><div unselectable='on' class='thumb unselectable'><div unselectable='on' class='end unselectable'></div></div></div></div>" )
.tinyscrollbar({
axis: "y"
});
;
var viewport = target.children( "div.viewport" );
var overview = viewport.children( "div.overview" );
var scrollbar = target.children( "div.scrollbar" );
var disabledClass = ( attributes.tinyscrollbarDisabledClass || "" );
var enabledClass = ( attributes.tinyscrollbarEnabledClass || "" );
scrollbar.on(
"mousedown.invTinyscrollbar selectstart.invTinyscrollbar",
function( event ) {
event.preventDefault();
}
);
$scope.$watch(
function() {
return( overview.height() );
},
function( newValue ) {
target.tinyscrollbar_update();
applyConditionalClasses();
}
);
$( window ).on(
"resize.invTinyscrollbar",
function( event ) {
target.tinyscrollbar_update();
applyConditionalClasses();
}
);
$scope.$on(
"$destroy",
function() {
target.remove();
scrollbar.off( "mousedown.invTinyscrollbar" );
scrollbar.off( "selectstart.invTinyscrollbar" );
$( window ).off( "resize.invTinyscrollbar" );
}
);
};
return({
link: linkFunction,
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! toggle.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invToggle",
function() {
var linkFunction = function( $scope, element, attributes, modelController ) {
function applyModelValue( value ) {
if ( value ) {
element
.addClass( "on" )
.removeClass( "off" )
;
} else {
element
.addClass( "off" )
.removeClass( "on" )
;
}
}
function toggle() {
var newValue = ! modelController.$modelValue;
applyModelValue( newValue );
modelController.$setViewValue( newValue );
}
var thumb = element.siblings('.clickable'); //element.find( "a.toggle-thumb" );
thumb.on(
"click.invToggle", 
function( event ) {
event.preventDefault();
$scope.$apply( toggle );
}
);
modelController.$render = function() {
applyModelValue( modelController.$modelValue );
};
$scope.$on(
"$destroy",
function() {
thumb.off( "click.invToggle" );
}
);
};
return({
link: linkFunction,
replace: true,
require: "^ngModel",
restrict: "A",
templateUrl: "/assets/apps/share/views/directives/toggle.htm"
});
}
);
})( angular, InVision );
;
;
/*! toolbar.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invToolbar",
/** @ngInject */
function( _ ) {
var linkFunction = function( $scope, element, attributes ) {
element.on(
"mouseenter.invToolbar",
function( event ) {
$scope.$apply(
function() {
$scope.isUserOverToolbar = true;
$scope.updateActiveStatus();
}
);
}
);
element.on(
"mouseleave.invToolbar",
function( event ) {
$scope.$apply(
function() {
$scope.isUserOverToolbar = false;
$scope.updateActiveStatus();
}
);
}
);
$scope.$on(
"$destroy",
function() {
element.off( "mouseenter.invToolbar" );
element.off( "mouseleave.invToolbar" );
}
);
};
return({
link: linkFunction,
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! toolbar-introduction.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invToolbarIntroduction",
/** @ngInject */
function( $, $document, keyComboHelper, _ ) {
/** @ngInject */
var linkFunction = function( $scope, element, attributes, keyCombosController ) {
function closeIntroduction() {
$scope.$apply(
function() {
$scope.closeIntroduction();
}
);
}
var listenerConfig = {};
listenerConfig[ "keydown.invToolbarIntroduction" ] = function( event ) {
if ( event.metaKey ) {
return;
}
if ( keyComboHelper.isEscapeKeyEvent( event ) ) {
closeIntroduction();
}
};
element.on(
"click.invToolbarIntroduction",
function( event ) {
var isInDialog = $( event.target ).closest( "div.dialog" ).length;
if ( ! isInDialog ) {
closeIntroduction();
}
}
);
$scope.$watch(
"isShowingIntroduction",
function( newValue ) {
if ( newValue === true ) {
keyCombosController.addListener( listenerConfig );
} else if ( newValue === false ) {
keyCombosController.removeListener( listenerConfig );
}
}
);
$scope.$on(
"$destroy",
function() {
element.off( "click.invToolbarIntroduction" );
}
);
};
return({
link: linkFunction,
require: "^invKeyCombos",
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! tour-comments-form.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invTourCommentsForm",
/** @ngInject */
function( $window, $rootScope, $document, $timeout, _, modelEvents, config ) {
var linkFunction = function( $scope, element, attributes, markersController ) {
function getMarkerElement( conversation ) {
var tourPointMarker = $("[data-tour-point-id='" + conversation.id + "']:visible");
var headerMarker;
var finalMarker;
var headerRect;
var footerRect;
var curPos;
if( tourPointMarker.length > 1 ) {
if( $(".headerSlice").length > 0 ) {
headerMarker = $(".headerSlice [data-tour-point-id='" + conversation.id + "']:visible");
curPos = headerMarker[0].getBoundingClientRect();
headerRect = $(".headerSlice")[0].getBoundingClientRect();
if( curPos.top < headerRect.bottom ) {
return headerMarker[0];
}
}
if( $(".header-slice").length > 0 ) {
headerMarker = $(".header-slice [data-tour-point-id='" + conversation.id + "']:visible");
curPos = headerMarker[0].getBoundingClientRect();
headerRect = $(".header-slice")[0].getBoundingClientRect();
if( curPos.top < headerRect.bottom ) {
return headerMarker[0];
}
}
if( $(".footer-slice").length > 0 ) {
var footerMarker = $(".footer-slice [data-tour-point-id='" + conversation.id + "']:visible");
curPos = footerMarker[0].getBoundingClientRect();
footerRect = $(".footer-slice")[0].getBoundingClientRect();
if( curPos.top > footerRect.top ) {
return footerMarker[0];
}
}
return $(".primary-preview [data-tour-point-id='" + conversation.id + "']")[0];
} else {
finalMarker = tourPointMarker[0];
}
return finalMarker;
}
function updatePosition( conversation, isScrolling ) {
isScrolling = !! isScrolling;
var marker;
marker = getMarkerElement(conversation);
if( ! marker ) {
element.hide();
return;
}
var markerRect = marker.getBoundingClientRect();
var destPosition = {
left: ( Math.floor(markerRect.left) + Math.floor(markerRect.width / 2) ),
top: ( Math.floor(markerRect.top) + Math.floor(markerRect.height / 2) - 5 )
};
if(
isScrolling ||
( ! element[0].style.left || ! element[0].style.top ) ||
Math.abs(parseInt(element[0].style.left.replace("px", ""), 10) - destPosition.left) > 3 ||
Math.abs(parseInt(element[0].style.top.replace("px", ""), 10) - destPosition.top) > 3
) {
element.css({
left: destPosition.left + "px",
top: destPosition.top + "px"
});
}
if( config.project.isMobile ) {
markerRect = $(marker).offset();
element.hide();
}
if ( $(window).width() - markerRect.right <= 387 && markerRect.left >= 450 ) {
element.addClass( "left" );
element.removeClass( "right" );
element.removeClass( "bottom" );
} else if(
(! config.project.isMobile || config.project.mobileDeviceWidth > 500) &&
markerRect.left >= 135 &&
$(window).width() - markerRect.right > 387
) {
element.removeClass( "left" );
element.removeClass( "right" );
element.addClass( "bottom" );
} else {
element.removeClass( "left" );
element.addClass( "right" );
element.removeClass( "bottom" );
}
var formRect = element.find(".comment-thread")[0].getBoundingClientRect();
var markerPosition = {
top: marker.offsetTop,
left:  marker.offsetLeft
};
var containerElem = config.project.isMobile ? ".scroll-wrap" : window;
var formVisible = (formRect.left + formRect.width) < $(containerElem).width() &&
(formRect.top + formRect.height) < $(containerElem).height() &&
formRect.top > ( !! $scope.screen.fixedHeaderHeight ? ($scope.screen.fixedHeaderHeight * $scope.screen.displayScale) + 75 : 0 ) &&
formRect.left > 0;
var markerVisible = markerPosition.top >= $(containerElem).scrollTop() &&
markerPosition.top < $(containerElem).scrollTop() + $(containerElem).height() &&
markerPosition.left >= 0 &&
(
! config.project.isMobile ||
$(".mobile-status-bar").length > 0 && $(".mobile-status-bar").height() < markerPosition.top - $(containerElem).scrollTop()
) &&
(
! $scope.screen.fixedHeaderHeight ||
( $scope.screen.fixedHeaderHeight * $scope.screen.displayScale ) < markerPosition.top - $(containerElem).scrollTop()
) &&
(
! $scope.screen.fixedFooterHeight ||
( $scope.screen.fixedFooterHeight * $scope.screen.displayScale ) > markerPosition.top - $(containerElem).scrollTop()
);
var avoidScroll = $(marker).parents(".fixed-element").length > 0;
if( ((! formVisible || !markerVisible) && ! config.project.isMobile) || (! markerVisible && config.project.isMobile) ) {
$( "html, body" ).css( "padding-bottom", formRect.height + "px" );
if( ! isScrolling && ! avoidScroll ) {
var scrollElem = config.project.isMobile ? ".scroll-wrap" : "html, body";
var scrollRect = config.project.isMobile ? {
top: marker.parentNode.offsetTop + Math.floor( marker.parentNode.offsetHeight / 2 ),
left: marker.parentNode.offsetLeft + Math.floor( marker.parentNode.offsetWidth / 2 )
} : formRect;
var left, top;
if( ! config.project.isMobile ) {
left = scrollRect.left + $(window).scrollLeft();
top = scrollRect.top + $(window).scrollTop();
} else {
left = marker.offsetLeft;
top = marker.offsetTop;
}
isViewportScrolling = true;
var animateTime = ( config.project.isMobile &&
Math.max(0, Math.floor(
( top - 100 ) -
($scope.screen.fixedHeaderHeight * $scope.screen.displayScale)
)) !== $(".scroll-wrap").scrollTop()
) ? 250 : 0;
$( scrollElem ).stop( true ).animate(
{
scrollLeft: ( left - 100 ),
scrollTop: Math.max(0, Math.floor(( top - 100 ) - ($scope.screen.fixedHeaderHeight * $scope.screen.displayScale)))
},
animateTime, function() {
isViewportScrolling = false;
if( config.project.isMobile ) {
markerRect = marker.getBoundingClientRect();
destPosition = {
left: ( Math.floor(markerRect.left) + Math.floor(markerRect.width / 2) ),
top: ( Math.floor(markerRect.top) + Math.floor(markerRect.height / 2) - 5 )
};
if(
( ! element[0].style.left || ! element[0].style.top ) ||
Math.abs(parseInt(element[0].style.left.replace("px", ""), 10) - destPosition.left) > 3 ||
Math.abs(parseInt(element[0].style.top.replace("px", ""), 10) - destPosition.top) > 3
) {
element.css({
left: destPosition.left + "px",
top: destPosition.top + "px"
});
}
element.show();
} else {
element.show();
}
}
);
} else {
element.show();
}
} else {
element.show();
}
}
function setTextClass() {
if( ! $scope.conversation.isTourPoint ) {
return;
}
if( element.find(".primary-comment .post-comment").height() <= 40 ) {
element.find(".primary-comment .post-comment").addClass("single-line");
} else {
element.find(".primary-comment .post-comment").removeClass("single-line");
}
}
var documentWidth = $document.width();
var viewport = $( "div.viewport" );
var containerOffset = viewport.offset();
updatePosition( $scope.conversation );
$timeout(function() {
updatePosition( $scope.conversation, false );
setTextClass();
});
$timeout(function() {
updatePosition( $scope.conversation, false );
}, 250);
$scope.showCommentInput = function() {
$scope.isCommentInputVisible = true;
$timeout( function(){
element.find( "textarea" ).focus();
});
};
if ( $scope.conversation.id === 0 ) {
$scope.showCommentInput();
$scope.isShowingUserList = true;
}
$scope.toggleCommentsExpanded = function() {
$scope.commentsExpanded = ! $scope.commentsExpanded;
if( $scope.commentsExpanded ) {
$timeout(function() {
updatePosition( $scope.conversation, true );
element.find("textarea").focus();
});
}
};
$scope.onReplyFinished = function() {
$scope.$broadcast("invSuccessButton:reload");
$scope.toggleCommentsExpanded();
$timeout( $scope.clearCommentSketches, 1400);
};
$scope.commentsExpanded = false;
var isViewportScrolling = false;
$( window ).on(
"resize.invCommentsForm",
function( event ) {
updatePosition( $scope.conversation );
}
);
$( window ).on(
"scroll.invCommentsForm",
_.throttle(function( event ) {
updatePosition( $scope.conversation, true );
}, 10)
);
$(".scroll-wrap").on(
"scroll.invCommentsForm",
function(event) {
if( ! isViewportScrolling ) {
updatePosition( $scope.conversation, true );
}
}
);
$document.on("keydown.invCommentsForm", function(e) {
if ( e.keyCode === 13 && ( e.metaKey || e.ctrlKey ) ) {
$scope.$apply(
function invokeNgSubmitBinding() {
$scope.$eval( attributes.ngSubmit );
}
);
}
});
$(document).on("mousedown.invCommentsForm", function(e) {
if( $("#shareSketchBuilder").length > 0 || $(".sketchViewer").length > 0 ) {
return;
}
if(
! $(e.target).is(".tour-point-form") &&
! $(e.target).is(".tour-point-form footer") &&
$(e.target).closest(".tour-point-form").length === 0 &&
$(e.target).closest(".tour-point-form footer").length === 0
) {
$scope.selectTourPoint(null);
}
});
$(".scroll-wrap").on("click.invCommentsForm", function(e) {
if(
$("#shareSketchBuilder").length <= 0 &&
$(".sketchViewer").length <= 0 &&
$(".tour-point-form").length > 0
) {
$scope.selectTourPoint(null);
}
});
modelEvents.on("commentCreated.invTourCommentsForm", function() {
$timeout(function() {
$scope.$emit("reloadComments");
});
});
$scope.$on(
"commentChanged",
function() {
$timeout(function() {
setTextClass();
});
}
);
$scope.$on(
"conversationSelected",
function(event, conversation, mouseEvent) {
$("html, body").css("padding-bottom", 0);
}
);
$scope.$on(
"refreshConversationPosition",
function() {
updatePosition( $scope.conversation, false );
}
);
$scope.$on(
"$destroy",
function() {
markersController.clearCallback();
modelEvents.off("commentCreated.invTourCommentsForm");
$document.off( "resize.invCommentsForm" );
$document.off( "keydown.invCommentsForm" );
$( window ).off( "resize.invCommentsForm" );
$(window).off( "scroll.invCommentsForm" );
$(document).off("mousedown.invCommentsForm");
$(".skinWrapper").off("scroll.invCommentsForm");
$(".scroll-wrap").off("click.invCommentsForm");
$(".scroll-wrap").removeClass("tour-points");
$(".scroll-wrap").off("scroll.invCommentsForm");
}
);
};
return({
link: linkFunction,
require: "^invCommentsMarkers",
restrict: "A"
});
}
);
})( angular, InVision );
;
;
/*! tour-point-tooltip.js */ 
;
;
(function (ng, app) {
"use strict";
app.directive(
"invTourPointTooltip",
/** @ngInject */
function(_, $timeout, config, commentService, emojiService) {
var linkFunction = function($scope, element, attributes) {
var tooltipStyle = function() {
if (!$scope.tooltipTourPoint) {
return {};
}
var tourPointMarker = $("[data-tour-point-id='" + $scope.tooltipTourPoint.id + "']:visible");
var finalMarker;
var headerRect;
var curPos;
if (tourPointMarker.length > 1) {
if ($(".headerSlice").length > 0) {
var headerMarker = $(".headerSlice [data-tour-point-id='" + $scope.tooltipTourPoint.id + "']:visible");
curPos = headerMarker[0].getBoundingClientRect();
headerRect = $(".headerSlice")[0].getBoundingClientRect();
if (curPos.top < headerRect.bottom) {
finalMarker = $(headerMarker[0]);
}
}
if ($(".header-slice").length > 0) {
var headerMarker = $(".header-slice [data-tour-point-id='" + $scope.tooltipTourPoint.id + "']:visible");
curPos = headerMarker[0].getBoundingClientRect();
headerRect = $(".header-slice")[0].getBoundingClientRect();
if (curPos.top < headerRect.bottom) {
finalMarker = $(headerMarker[0]);
}
}
if ($(".footer-slice").length > 0) {
var footerMarker = $(".footer-slice [data-tour-point-id='" + $scope.tooltipTourPoint.id + "']:visible");
curPos = footerMarker[0].getBoundingClientRect();
var footerRect = $(".footer-slice")[0].getBoundingClientRect();
if (curPos.top > footerRect.top) {
finalMarker = $(footerMarker[0]);
}
}
if (!finalMarker) {
finalMarker = $(".primary-preview [data-tour-point-id='" + $scope.tooltipTourPoint.id + "']:visible");
}
} else {
finalMarker = tourPointMarker;
}
if (finalMarker.length > 0) {
var markerRect = finalMarker[0].getBoundingClientRect();
return {
top: markerRect.top + "px",
left: markerRect.left - 1 + "px"
};
}
return {};
};
$scope.tooltipExcerpt = function() {
if (!$scope.tooltipTourPoint) {
return "";
}
var comment = $scope.tooltipTourPoint.comment;
var sanitizedComment = commentService.escapeHtml(comment.comment);
return comment.emojiparsedcomment || emojiService.parseEmoji(sanitizedComment);
};
$scope.tooltipClass = function() {
if (!$scope.tooltipTourPoint) {
return [];
}
var tourPointMarker = $("[data-tour-point-id='" + $scope.tooltipTourPoint.id + "']");
var finalMarker;
if (tourPointMarker.length > 1) {
for (var i = 0; i < tourPointMarker.length; i++) {
var curPos = $(tourPointMarker[i]).offset();
if (curPos.top < $(window).height() + $(window).scrollTop() && curPos.top >= 0) {
finalMarker = $(tourPointMarker[i]);
}
}
} else {
finalMarker = tourPointMarker;
}
if (!!finalMarker) {
var tourClasses = [];
var markerRect = finalMarker[0].getBoundingClientRect();
if ($(window).width() - markerRect.right > 300) {
tourClasses.push("left");
} else {
tourClasses.push("right");
}
if (
$(".tour-point-form").length <= 0 || !$(".tour-point-form").is(":visible") ||
parseInt($(".tour-point-form").css("opacity"), 10) === 0
) {
tourClasses.push("visible");
}
return tourClasses;
}
return [];
};
element.css(tooltipStyle());
$(window).on(
"scroll.invTourPointTooltip",
_.throttle(function(event) {
element.css(tooltipStyle());
}, 10)
);
$(".mobile-viewport").on(
"scroll.invTourPointTooltip",
_.throttle(function(event) {
element.css(tooltipStyle());
}, 10)
);
$scope.$watch(
"tooltipTourPoint",
function(newValue, oldValue) {
element.css(tooltipStyle());
}
);
$scope.$on(
"refreshTooltipStyle",
function() {
element.css(tooltipStyle());
}
);
$scope.$on(
"$destroy",
function() {
$(window).off("scroll.invTourPointTooltip");
$(".m-preview").css("padding-bottom", "0");
$(".mobile-viewport").off("scroll.invTourPointTooltip");
$(element[0].parentNode.querySelector(".marker")).off("mouseenter.invTourPointTooltip");
$(element[0].parentNode.querySelector(".marker")).off("mouseleave.invTourPointTooltip");
}
);
};
return ({
link: linkFunction,
restrict: "A"
});
}
);
})(angular, InVision);
;
;
/*! uniform.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive(
"invUniform",
function() {
var linkFunction = function( $scope, element, attributes ) {
$( element ).uniform();
$scope.$watch(
attributes.ngModel,
function( newValue, oldValue ) {
$.uniform.update( element );
}
);
$scope.$on(
"$destroy",
function() {
}
);
};
return({
link: linkFunction,
restrict: "A",
scope: false
});
}
);
})( angular, InVision );
;
;
/*! video-overlay.js */ 
;
;
(function( ng, app ) {
"use strict";
app.directive( "invVideoOverlay", Directive );
/** @ngInject */
function Directive( $timeout ) {
var linkFunction = function( $scope, element, attributes ) {
var $element = $(element),
playerId = ( attributes.playerId || "unknown"),
videoId = ( attributes.videoId || "unknown" ),
videoWidth = ( attributes.videoWidth || 788 ),
videoHeight = ( attributes.videoHeight || 444 ),
$embed = $('<iframe id="' + videoId + '" src="//fast.wistia.net/embed/iframe/' + videoId + '" allowtransparency="true" frameborder="0" scrolling="no" class="wistia_embed" name="wistia_embed" allowfullscreen mozallowfullscreen webkitallowfullscreen oallowfullscreen msallowfullscreen width="' + videoWidth + '" height="' + videoHeight + '"></iframe>');
/* Wistia Video */
/********************************************************/
attributes.$observe("playerId", function(newValue) {
playerId = newValue;
$embed.attr("id", newValue);
});
attributes.$observe("videoWidth", function(newValue) {
$embed.attr("width", newValue);
});
attributes.$observe("videoHeight", function(newValue) {
$embed.attr("height", newValue);
});
attributes.$observe("videoId", function(newValue) {
$embed = $('<iframe id="' + playerId + '" src="//fast.wistia.net/embed/iframe/' + newValue + '" allowtransparency="true" frameborder="0" scrolling="no" class="wistia_embed" name="wistia_embed" allowfullscreen mozallowfullscreen webkitallowfullscreen oallowfullscreen msallowfullscreen width="100%" height="100%"></iframe>');
$element.append($embed);
});
$scope.$on('$destroy', function() {
$embed.remove();
});
};
return({
link: linkFunction,
restrict: "A",
scope: true
});
}
})( angular, InVision );
;
;
/*! account-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "accountService", Service );
/** @ngInject */
function Service(
$http,
$q,
$resource,
analyticsService,
serviceHelper,
config,
modelEvents
) {
function createAccount( criteria ) {
var submissionForm = "Signup from anonymous comment";
var name = criteria.name;
var email = criteria.email;
var password = criteria.password;
var marketingOptOut = criteria.marketingOptOut;
var postData = {
name: name,
email: email,
password: password,
marketingOptOut: marketingOptOut,
submissionForm: submissionForm
};
var postOptions = {
headers: { "Content-Type": "application/x-www-form-urlencoded" }
};
var analyticsData = {
name: name,
email: email,
submissionForm: submissionForm
};
return $http.post("/api/account/signup", $.param(postData), postOptions)
.then(function ( response ) {
analyticsService.track("SignupSelfServe", analyticsData);
analyticsService.track("Comment.AccountCreated", analyticsData);
},
function ( error ) {
analyticsService.track("Comment.AccountCreationFailure", analyticsData)
return( $q.reject( error ) );
});
}
function markLiveShareIntroClosed( hasClosedLiveshareIntro ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "markLiveShareIntroClosed",
parameters: {
option: hasClosedLiveshareIntro
},
successCallback: function( response ) {
modelEvents.trigger( "accountUpdated", response );
}
});
return( promise );
}
function markShareIntroClosed( hasClosedShareIntro ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "markShareIntroClosed",
parameters: {
option: hasClosedShareIntro
},
successCallback: function( response ) {
modelEvents.trigger( "accountUpdated", response );
}
});
return( promise );
}
function markHasSeenCommentTooltip( hasSeenCommentTooltip ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "markHasSeenCommentTooltip",
parameters: {
hasSeenCommentTooltip: hasSeenCommentTooltip
},
successCallback: function( response ) {
}
});
return( promise );
}
var resource = $resource(
"/api/account/:command",
{
command: "@command"
},
{
markHasSeenCommentTooltip:{
method: "POST",
params: {
command : "mark-has-seen-comment-tooltip"
}
},
markLiveShareIntroClosed: {
method: "POST",
params: {
command: "mark-liveshare-intro-closed"
}
},
markShareIntroClosed: {
method: "POST",
params: {
command: "mark-share-intro-closed"
}
}
}
);
return({
createAccount: createAccount,
markHasSeenCommentTooltip: markHasSeenCommentTooltip,
markLiveShareIntroClosed: markLiveShareIntroClosed,
markShareIntroClosed: markShareIntroClosed
});
}
})( angular, InVision );
;
;
/*! before-unload-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "beforeUnloadService", BeforeUnloadService );
/** @ngInject */
function BeforeUnloadService( $window, _ ) {
this.functionQueue = [];
$window.onbeforeunload = ng.bind( this, this.run );
return( this );
}
BeforeUnloadService.prototype = {
run: function( ) {
ng.forEach( this.functionQueue, function( bundle ){
bundle.funcRef.apply( bundle.context, bundle.args );
});
},
push: function( context, funcRef, args ) {
if( _.isUndefined( funcRef ) || !_.isFunction( funcRef ) ) {
funcRef = ng.noop;
}
this.functionQueue.push( {	
context: context,
funcRef: funcRef,
args: args
} );
}
};
})( angular, InVision );
;
;
/*! comment-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "commentService", CommentService );
/** @ngInject */
function CommentService(
_,
$resource,
serviceHelper,
modelEvents,
config,
MAX_COMMENT_LIKES_DISPLAYED,
mentionStorage
) {
function getCurrentShareKey() {
if (config && config.share && config.share.key) {
return config.share.key;
}
return "";
}
function addComment( conversationID, comment, mentions, notify, sketches, dataUrl, isUnsupported ) {
if ( typeof( isUnsupported ) == "undefined" ) {
isUnsupported = false;
}
var shareKey = getCurrentShareKey();
if ( isUnsupported ) {
dataUrl = "";
}
var promise = serviceHelper.executeRequest({
resource: resource,
name: "addComment",
parameters: {
conversationID: conversationID,
comment: comment,
notify: notify,
sketches : sketches,
dataUrl: "",
isUnsupported: isUnsupported,
mentions: mentions,
shareKey: shareKey
},
successCallback: function( response ) {
modelEvents.trigger( "commentCreated", response );
modelEvents.trigger( "conversationSubscribersUpdated", conversationID, notify );
}
});
return( promise );
}
function deleteComment( commentID ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "deleteComment",
parameters: {
id: commentID
},
successCallback: function( response ) {
modelEvents.trigger( "commentDeleted", commentID );
}
});
return( promise );
}
function formatCommentLikers( comment ) {
var likedByList = _.pluck( comment.likedBy, "name" ).join("<br >");
if( comment.numberOfLikes > MAX_COMMENT_LIKES_DISPLAYED ) {
likedByList += "<br >+" + (comment.numberOfLikes - MAX_COMMENT_LIKES_DISPLAYED ) + " more";
}
return likedByList;
}
function getCommentsByConversationID( conversationID ) {
var comments = _.withProperty( config.comments, "conversationID", conversationID );
for (var c = 0, length = comments.length; c < length; c++){
comments[c].sketches = getSketchesByCommentID( comments[c].id );
comments[c].likedByList = formatCommentLikers( comments[c] );
}
return(
ng.copy( comments )
);
}
function getSketchesByCommentID( commentID ){
var commentSketches = _.withProperty( config.commentSketches, "commentID", commentID );
return(
ng.copy( commentSketches )
);
}
function escapeHtml( string ) {
if ( !string ) {
return;
}
var text = string;
text = replaceLinks( text );
text = text.replace( /(\r\n?|\n)/g, "<br />" );
return text;
}
function getHtmlForComment( comment ) {
comment = comment.replace(
/(<)|(>)|(&)|(")/g,
function( $0, lt, gt, amp, quot ) {
if ( lt ) {
return( "&lt;" );
} else if ( gt ) {
return( "&gt;" );
} else if ( amp ) {
return( "&amp;" );
} else if ( quot ) {
return( "&quot;" );
}
}
);
comment = replaceLinks( comment );
comment = comment.replace( /(\r\n?|\n)/g, "<br />" );
return( comment );
}
function replaceLinks( comment ) {
comment = comment.replace(
/((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,
function( $0 ){
if ( ( /^javascript:/i ).test( $0 ) ) {
return( "" );
}
var hasProtocol = ( /^\w+:\/\//i ).test( $0 );
var href = ( hasProtocol ? $0 : ( "http://" + $0 ) );
var text = $0;
return(
"<a href=\"" + href + "\" target=\"_blank\">" + text + "</a>"
);
}
);
return( comment );
}
function updateComment( commentID, conversationID, comment ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "updateComment",
parameters: {
id: commentID,
conversationID: conversationID,
comment: comment,
mentions: mentionStorage.get()
},
successCallback: function( response ) {
modelEvents.trigger( "commentUpdated", response );
}
});
return( promise );
}
function unsubscribe( projectID, hash ){
var promise = serviceHelper.executeRequest({
resource: resource,
name: "unsubscribe",
parameters: {
id: projectID,
hash: hash
}
});
return( promise );
}
function resubscribe( projectID, hash ){
var promise = serviceHelper.executeRequest({
resource: resource,
name: "resubscribe",
parameters: {
id: projectID,
hash: hash
}
});
return( promise );
}
var resource = $resource(
"/api/comments/:id/:command",
{
id: "@id",
command: "@command"
},
{
addComment: {
method: "POST"
},
deleteComment: {
method: "DELETE"
},
updateComment: {
method: "POST"
},
unsubscribe: {
method: "GET",
params: {
command: "unsubscribe"
}
},
resubscribe: {
method: "GET",
params: {
command: "resubscribe"
}
}
}
);
modelEvents.on(
"commentCreated",
function( event, comment ) {
comment.userAvatarID = comment.avatarID;
for( var cs = 0; cs < comment.sketches.length; cs++ ){
var sketchID = comment.sketches[cs].sketchID || null;
if(_.find(config.commentSketches, _.matchesProperty('sketchID', sketchID))){
config.commentSketches.push( comment.sketches[cs] );
}
}
if( ! _.findWithProperty( config.comments, "id", comment.id ) ){
config.comments = _.rejectWithProperty( config.comments, "id", undefined );
config.comments.push( comment );
}
}
);
modelEvents.on(
"commentDeleted",
function( event, commentID ) {
config.comments = _.withoutProperty( config.comments, "id", commentID );
}
);
modelEvents.on(
"commentUpdated",
function( event, comment ) {
var cachedComment = _.findWithProperty( config.comments, "id", comment.id );
if ( cachedComment ) {
_.extendExistingProperties( cachedComment, comment );
}
}
);
modelEvents.on(
"conversationDeleted",
function( event, conversationID ) {
config.comments = _.withoutProperty( config.comments, "conversationID", conversationID );
}
);
modelEvents.on(
"conversationMarkedRead",
function( event, conversationID ) {
var comments = _.withProperty( config.comments, "conversationID", conversationID );
_.setProperty( comments, "isUnread", false );
}
);
return({
addComment: addComment,
deleteComment: deleteComment,
formatCommentLikers: formatCommentLikers,
getCommentsByConversationID: getCommentsByConversationID,
getHtmlForComment: getHtmlForComment,
escapeHtml: escapeHtml,
updateComment: updateComment,
unsubscribe: unsubscribe,
resubscribe: resubscribe
});
}
})( angular, InVision );
;
;
/*! company-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "companyService", Service );
/** @ngInject */
function Service( $resource, serviceHelper ) {
function assertEmailsAreCompanyMembers( emailArray ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "assertEmailsAreCompanyMembers",
parameters: { emails: emailArray }
});
return( promise );
}
var resource = $resource(
"/api/company/:command",
{
command: "@command"
},
{
assertEmailsAreCompanyMembers: {
method: "POST",
params: {
command: "assert-company-email"
}
}
}
);
return({
assertEmailsAreCompanyMembers: assertEmailsAreCompanyMembers
});
}
})( angular, InVision );
;
;
/*! conversation-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "conversationService", ConversationService );
/** @ngInject */
function ConversationService( $resource, serviceHelper, modelEvents, config, _ ) {
function getCurrentShareKey() {
if (config && config.share && config.share.key) {
return config.share.key;
}
return "";
}
function addSubscribers( conversationID, userIDs ) {
var conversation = _.findWithProperty( config.conversations, "id", conversationID );
if ( conversation ) {
conversation.subscribers = conversation.subscribers.concat( userIDs );
modelEvents.trigger( "conversationUpdated", conversation );
}
}
function getConversationParticipants( conversationID ) {
return serviceHelper.executeRequest({
resource: resource,
name: "participants",
parameters: {
id: conversationID
}
});
}
function changePosition( conversationID, x, y, dataUrl ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "changePosition",
parameters: {
id: conversationID,
x: x,
y: y,
dataUrl: ""
},
successCallback: function( response ) {
modelEvents.trigger( "conversationUpdated", response );
}
});
return( promise );
}
function changePrivacy( conversationID, isForDevelopment, isPrivate ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "changePrivacy",
parameters: {
id: conversationID,
isForDevelopment: isForDevelopment,
isPrivate: isPrivate
},
successCallback: function( response ) {
modelEvents.trigger( "conversationUpdated", response );
}
});
return( promise );
}
function deleteConversation( conversationID ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "deleteConversation",
parameters: {
id: conversationID
},
successCallback: function( response ) {
modelEvents.trigger( "conversationDeleted", conversationID );
}
});
return( promise );
}
function getConversationByID( conversationID ) {
var conversation = _.findWithProperty( config.conversations, "id", conversationID );
return(
ng.copy( conversation )
);
}
function getConversationsByScreenID( screenID ) {
var conversations = _.withProperty( config.conversations, "screenID", screenID );
return(
ng.copy( conversations )
);
}
function getMarkerType( marker ) {
if ( marker.isTourPoint) {
return "tour-point";
}
if ( marker.isForDevelopment ) {
return "dev-note";
}
if ( marker.isPrivate ) {
return "private-comment";
}
return "comment";
}
function markComplete( conversationID ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "markComplete",
parameters: {
id: conversationID
},
successCallback: function( response ) {
modelEvents.trigger( "conversationUpdated", response );
}
});
return( promise );
}
function markIncomplete( conversationID ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "markIncomplete",
parameters: {
id: conversationID
},
successCallback: function( response ) {
modelEvents.trigger( "conversationUpdated", response );
}
});
return( promise );
}
function markRead( conversationID ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "markRead",
parameters: {
id: conversationID
},
successCallback: function( response ) {
modelEvents.trigger( "conversationMarkedRead", conversationID );
}
});
return( promise );
}
function startConversation( screenID, label, x, y, isForDevelopment, isPrivate, isTourPoint, dataUrl, isUnsupported ) {
var shareKey = getCurrentShareKey();
var promise = serviceHelper.executeRequest({
resource: resource,
name: "startConversation",
parameters: {
screenID: screenID,
label: label,
x: x,
y: y,
isPrivate: isPrivate,
isForDevelopment: isForDevelopment,
isTourPoint: isTourPoint,
isComplete: false,
dataUrl: "",
isUnsupported: isUnsupported,
shareKey: shareKey
},
successCallback: function( response ) {
modelEvents.trigger( "conversationCreated", response );
}
});
return( promise );
}
function toggleCommentLike( commentID, conversationID ) {
var promise = serviceHelper.executeRequest({
resource: commentResource,
name: "toggleLike",
parameters: {
commentID: commentID
},
successCallback: function( response ) {
modelEvents.trigger(
"commentUpdated",
commentID,
conversationID
);
}
});
return promise;
}
function deleteSketch( sketchID ){
var promise = serviceHelper.executeRequest({
resource: sketchResource,
name: "deleteSketch",
parameters: {sketchID : sketchID},
successCallback: function( response ){
}
});
return promise;
}
function saveConversation( conversation ){
var parameters = _.pick( conversation, "id", "screenID", "label", "x", "y", "isPrivate", "isForDevelopment", "isComplete", "isTourPoint", "dataUrl" );
if ( ! parameters.id ) {
delete parameters.id;
}
var promise = serviceHelper.executeRequest({
resource: ConversationResource,
name: "save",
parameters: parameters,
successCallback: function( response ){
}
});
return promise;
}
var ConversationResource = $resource( "/api/conversations/:id",	{
id: "@id"
});
var resource = $resource(
"/api/conversations/:id/:command",
{
id: "@id",
command: "@command"
},
{
participants: {
method: "POST",
params: {
command: "participants"
}
},
changePosition: {
method: "POST",
params: {
command: "change-position"
}
},
changePrivacy: {
method: "POST",
params: {
command: "change-privacy"
}
},
deleteConversation: {
method: "DELETE"
},
markComplete: {
method: "POST",
params: {
command: "mark-complete"
}
},
markIncomplete: {
method: "POST",
params: {
command: "mark-incomplete"
}
},
markRead: {
method: "POST",
params: {
command: "mark-read"
}
},
startConversation: {
method: "POST"
}
}
);
var commentResource = $resource(
"/api/comments/:command",
{
command: "@command"
},
{
toggleLike: {
method: "POST",
params: {
command: "toggle-like"
}
}
}
);
var sketchResource = $resource(
"/api/comments/:command/:sketchID",
{
sketchID: "@sketchID",
command: "deleteSketch"
},
{
deleteSketch:{
method: "DELETE",
params: {
command: "deleteSketch"
}
}
}
);
modelEvents.on(
"conversationCreated",
function( event, conversation ) {
config.conversations.push( ng.copy( conversation ) );
}
);
modelEvents.on(
"conversationDeleted",
function( event, conversationID ) {
config.conversations = _.withoutProperty( config.conversations, "id", conversationID );
}
);
modelEvents.on(
"conversationSubscribersUpdated",
function( event, conversationID, notify ) {
var cachedConversation = _.findWithProperty( config.conversations, "id", conversationID );
if ( cachedConversation ) {
cachedConversation.subscribers = [].concat( notify.members ).concat( notify.stakeholders );
modelEvents.trigger( "conversationUpdated", cachedConversation );
}
}
);
modelEvents.on(
"conversationUpdated",
function( event, conversation ) {
var cachedConversation = _.findWithProperty( config.conversations, "id", conversation.id );
if ( cachedConversation ) {
_.extendExistingProperties( cachedConversation, conversation );
}
}
);
return({
addSubscribers: addSubscribers,
changePosition: changePosition,
changePrivacy: changePrivacy,
deleteConversation: deleteConversation,
deleteSketch: deleteSketch,
getConversationByID: getConversationByID,
getConversationsByScreenID: getConversationsByScreenID,
getConversationParticipants: getConversationParticipants,
getMarkerType: getMarkerType,
markComplete: markComplete,
markIncomplete: markIncomplete,
markRead: markRead,
startConversation: startConversation,
toggleCommentLike: toggleCommentLike,
saveConversation: saveConversation
});
}
})( angular, InVision );
;
;
/*! hotspot-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "hotspotService", HotspotService );
/** @ngInject */
function HotspotService( config, _ ) {
function getHotspotsByScreenID( screenID ) {
var hotspots = _.withProperty( config.hotspots, "screenID", screenID );
return(
ng.copy( hotspots )
);
}
function getAllHotSpots(){
return(
ng.copy( config.hotspots )
);
}
var eventTypes = {
click: 1,
doubleTap: 2,
pressHold: 3,
swipeRight: 4,
swipeLeft: 5,
swipeUp: 6,
swipeDown: 7,
hover: 8,
autoRedirect: 9
};
var targetTypes = {
screen: 1,
lastScreenVisited: 2,
previousScreenInSort: 3,
nextScreenInSort: 4,
externalUrl: 5,
positionOnScreen: 6,
screenOverlay: 7
};
var transitionTypes = {
none: 1,
pushRight: 2,
pushLeft: 3,
slideUp: 4,
slideDown: 5,
flipRight: 6,
flipLeft: 7,
dissolve: 8
};
return({
eventTypes: eventTypes,
getHotspotsByScreenID: getHotspotsByScreenID,
targetTypes: targetTypes,
transitionTypes: transitionTypes,
getAllHotSpots: getAllHotSpots
});
}
})( angular, InVision );
;
;
/*! ipinfo-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "ipInfoService", Service );
/** @ngInject */
function Service( config ) {
function getGeolocationData( parameter ) {
return ( config.ipGeoLocation );
}
return({
getGeolocationData: getGeolocationData
});
}
})( angular, InVision );
;
;
/*! key-combo-helper.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "keyComboHelper", KeyComboHelper );
/** @ngInject */
function KeyComboHelper( _ ) {
function isAltKeyEvent( event ) {
validateEventType( "altKey", event );
return( event.which === altKey );
}
function isCharKeyEvent( event, char, maintainCase ) {
var calculatedChar = String.fromCharCode( event.which );
if ( maintainCase ) {
return( char === calculatedChar );
}
return( char.toLowerCase() === calculatedChar.toLowerCase() );
}
function isControlKeyEvent( event ) {
validateEventType( "controlKey", event );
return( event.which === controlKey );
}
function isDownArrowKeyEvent( event ) {
validateEventType( "downArrowKey", event );
return( event.which === downArrowKey );
}
function isEnterKeyEvent( event ) {
validateEventType( "enterKey", event );
return( 
! event.metaKey &&
( event.which === enterKey )
);
}
function isEscapeKeyEvent( event ) {
validateEventType( "escapeKey", event );
return( event.which === escapeKey );
}
function isLeftArrowKeyEvent( event ) {
validateEventType( "leftArrowKey", event );
return( 
! event.metaKey &&
( event.which === leftArrowKey )
);
}
function isRightArrowKeyEvent( event ) {
validateEventType( "rightArrowKey", event );
return( 
! event.metaKey &&
( event.which === rightArrowKey )
);
}
function isShiftKeyEvent( event ) {
validateEventType( "shiftKey", event );
return( event.which === shiftKey );
}
function isSuperKeyEvent( event ) {
validateEventType( "superKey", event );
return( event.which === superKey );
}
function isTabKeyEvent( event ) {
validateEventType( "tabKey", event );
return( event.which === tabKey );
}
function isUpArrowKeyEvent( event ) {
validateEventType( "upArrowKey", event );
return( 
! event.metaKey &&
( event.which === upArrowKey )
);
}
function validateEventType( key, event ) {
if ( 
keyRequirements.hasOwnProperty( key ) &&
( _.indexOf( keyRequirements[ key ], event.type ) === -1 )
) {
throw( new Error( key + " requires " + keyRequirements[ key ].join( " / " ) + " event." ) );
}
}
var altKey = 18;
var controlKey = 17;
var downArrowKey = 40;
var enterKey = 13;
var escapeKey = 27;
var leftArrowKey = 37;
var rightArrowKey = 39;
var shiftKey = 16;
var superKey = 224;
var tabKey = 9;
var upArrowKey = 38;
var keyRequirements = {
altKey: [ "keydown", "keyup" ],
controlKey: [ "keydown", "keyup" ],
downArrowKey: [ "keydown", "keyup" ],
escapeKey: [ "keydown", "keyup" ],
leftArrowKey: [ "keydown", "keyup" ],
rightArrowKey: [ "keydown", "keyup" ],
shiftKey: [ "keydown", "keyup" ],
superKey: [ "keydown", "keyup" ],
tabKey: [ "keydown", "keyup" ],
upArrowKey: [ "keydown", "keyup" ]
};
return({
isAltKeyEvent: isAltKeyEvent,
isCharKeyEvent: isCharKeyEvent,
isControlKeyEvent: isControlKeyEvent,
isDownArrowKeyEvent: isDownArrowKeyEvent,
isEnterKeyEvent: isEnterKeyEvent,
isEscapeKeyEvent: isEscapeKeyEvent,
isLeftArrowKeyEvent: isLeftArrowKeyEvent,
isRightArrowKeyEvent: isRightArrowKeyEvent,
isShiftKeyEvent: isShiftKeyEvent,
isSuperKeyEvent: isSuperKeyEvent,
isTabKeyEvent: isTabKeyEvent,
isUpArrowKeyEvent: isUpArrowKeyEvent
});
}
})( angular, InVision );
;
;
/*! project-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "projectService", ProjectService );
/** @ngInject */
function ProjectService( config, _, modelEvents, $resource, sessionService, serviceHelper ) {
function getProject() {
return( 
ng.copy( config.project )
);
}
function reloadStakeholders( projectID ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "reloadStakeholders",
parameters: {
id: projectID
},
successCallback: function( response ){
config.affiliates = response;
}
});
return( promise );
}
function removeStakeholderFromProject( userID ) {
resource.removeStakeholder({ id: config.project.id, userID: userID }, function() {
modelEvents.trigger( "projectStakeholderRemoved", config.project.id, userID );
config.affiliates = _.rejectWithProperty( config.affiliates, "id", userID );
});
}
var resource = $resource(
"/api/project/:id/:command",
{
id: "@id",
command: "@command"
},
{
reloadStakeholders: {
method: "GET",
isArray: true,
params: {
command: "stakeholders"
}
},
removeStakeholder: {
method: "POST",
params: {
command: "remove-stakeholder"
}
}
}
);
return({
getProject: getProject,
reloadStakeholders: reloadStakeholders,
removeStakeholderFromProject: removeStakeholderFromProject
});
}
})( angular, InVision );
;
;
/*! project-viewing-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "projectViewingService", ProjectViewingService );
/** @ngInject */
function ProjectViewingService( $resource, serviceHelper, _ ) {
function incrementCommentCount( shareID ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "incrementCommentCount",
parameters: {
shareID: shareID
}
});
return( promise );
}
function setEndedAt( shareID ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "setEndedAt",
parameters: {
shareID: shareID
}
});
return( promise );
}
function incrementScreenCount( shareID ) {
if ( cachedScreenCountFailure !== null ) {
return( cachedScreenCountFailure );
}
var promise = serviceHelper.executeRequest({
resource: resource,
name: "incrementScreenCount",
parameters: {
shareID: shareID
}
});
promise.then(
null,
function() {
cachedScreenCountFailure = promise;
}
);
return( promise );
}
var resource = $resource(
"/api/project-viewing/:shareID/:command",
{
shareID: "@shareID",
command: "@command"
},
{
incrementCommentCount: {
method: "POST",
params: {
command: "increment-comment-count"
}
},
incrementScreenCount: {
method: "POST",
params: {
command: "increment-screen-count"
}
},
setEndedAt: {
method: "POST",
params: {
command: "set-ended-at"
}
}
}
);
var cachedScreenCountFailure = null;
return({
setEndedAt: setEndedAt,
incrementCommentCount: incrementCommentCount,
incrementScreenCount: incrementScreenCount
});
}
})( angular, InVision );
;
;
/*! screen-service.js */ 
;
;
(function(ng, app) {
app.service('screenService', ScreenService);
/** @ngInject */
function ScreenService(config, _, sortScreens) {
var zoomScrollBehaviors = {
NORMAL:                       1,
DISABLE_HORIZONTAL_SCROLLING: 2,
ZOOM_OUT_TO_BROWSER_WIDTH:    3
};
var _screen          = {};
var _screenClickedOn = {};
var service = {
alterCommentCount:        alterCommentCount,
alterUnreadCommentCount:  alterUnreadCommentCount,
getNextScreen:            getNextScreen,
getPreviousScreen:        getPreviousScreen,
getScreenByID:            getScreenByID,
getScreens:               getScreens,
getDividers:              getDividers,
getAppIcon:               getAppIcon,
getLoadingScreen:         getLoadingScreen,
setScreenFixedAreaColors: setScreenFixedAreaColors,
zoomScrollBehaviors:      zoomScrollBehaviors,
getCurrentScreen:         getCurrentScreen,
setCurrentScreen:         setCurrentScreen,
getCurrentScreenIndex:    getCurrentScreenIndex,
getScreenClickedOn:       getScreenClickedOn,
setScreenClickedOn:       setScreenClickedOn,
getTotalScreenCount:      getTotalScreenCount
};
return service;
function setScreenClickedOn(newScreen) {
_screenClickedOn = ng.copy(newScreen);
}
function getScreenClickedOn() {
return _screenClickedOn;
}
function getCurrentScreen() {
return ng.copy(_screen);
}
function getCurrentScreenIndex() {
var _screens = getScreens();
for ( var i = 0; i < _screens.length; i++ ) {
if ( _screen !== undefined && _screens[ i ].id === _screen.id ) {
return ( i + 1 );
}
}
return 0;
}
function getTotalScreenCount() {
return config.screens.length;
}
function setCurrentScreen(newScreen) {
_screen = newScreen;
}
function alterCommentCount(screenID, count) {
var cachedScreen = _.findWithProperty(config.screens, 'id', screenID);
if (cachedScreen) {
cachedScreen.commentCount += count;
}
}
function alterUnreadCommentCount(screenID, count) {
var cachedScreen = _.findWithProperty(config.screens, 'id', screenID);
if (cachedScreen) {
cachedScreen.unreadCommentCount += count;
}
}
function getNextScreen(screenID) {
var _screens = getScreens();
var index     = _.indexOfWithProperty(_screens, 'id', screenID);
var nextIndex = (index + 1);
if (nextIndex >= _screens.length) {
nextIndex = 0;
}
_screen = _screens[nextIndex];
return _screen;
}
function getPreviousScreen(screenID) {
var _screens = getScreens();
var index         = _.indexOfWithProperty(_screens, 'id', screenID);
var previousIndex = (index - 1);
if (previousIndex < 0) {
previousIndex = (_screens.length - 1);
}
_screen = _screens[previousIndex];
return _screen;
}
function getScreenByID(screenID) {
_screen = _.findWithProperty(config.screens, 'id', screenID);
return ng.copy(_screen);
}
function setScreenFixedAreaColors(screenID, fixedHeaderBgColor, fixedFooterBgColor) {
_screen = _.findWithProperty(config.screens, 'id', screenID);
_screen.fixedHeaderBgColor = fixedHeaderBgColor;
_screen.fixedFooterBgColor = fixedFooterBgColor;
}
function getScreens() {
var _screens = ng.copy(config.screens);
return sortScreens(_screens, config.dividers, config.project.sortTypeID);
}
function getDividers() {
return ng.copy(config.dividers);
}
function getAppIcon() {
return ng.copy(config.metaScreens.icon);
}
function getLoadingScreen() {
return ng.copy(config.metaScreens.splash);
}
}
})(angular, InVision);
;
;
/*! session-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "sessionService", SessionService );
/** @ngInject */
function SessionService( $q, $resource, serviceHelper, config, modelEvents, userService, _ ) {
function authenticate() {
var deferred = $q.defer();
resource.get(
{
},
function( response ) {
ng.extend( user, response.account );
ng.extend( subscription, response.subscription );
user.projectsUrl = response.projectsUrl;
user.initials = userService.getInitials( user.name );
user.hasSystemAvatar = userService.isSystemAvatar( user.avatarID );
if (response && response.sync) {
user.isSyncEnabled = response.sync.enabled;
user.syncClients = response.sync.clients;
}
user.companyInfo = response.companyInfo;
deferred.resolve( response );
},
function() {
deferred.reject();
}
);
return( deferred.promise );
}
function get( key, defaultValue ) {
var localKey = getDataKey( key );
if ( data.hasOwnProperty( localKey ) ) {
return( data[ localKey ] );
} else if ( ! ng.isUndefined( defaultValue ) ) {
data[ localKey ] = defaultValue;
return( defaultValue );
}
}
function getDataKey( key ) {
return( "session__" + key );
}
function set( key, value ) {
var localKey = getDataKey( key );
data[ localKey ] = value;
}
var user = ng.copy( config.user );
user.hasSystemAvatar = userService.isSystemAvatar( user.avatarID );
user.initials = userService.getInitials( user.name );
user.hasCompanyMembership = user.hasCompanyMembership;
user.isLoaded = true;
var data = {};
modelEvents.on(
"shareIdentityChanged.sessionService",
function( event, identifiedUser ) {
user = ng.copy( identifiedUser );
user.hasSystemAvatar = userService.isSystemAvatar( user.avatarID );
user.initials = userService.getInitials( user.name );
user.hasCompanyMembership = user.hasCompanyMembership;
}
);
var resource = $resource(
"/api/account",
{
},
{
getUser: {
method: "GET"
}
}
);
var subscription = {};
return({
authenticate: authenticate,
get: get,
set: set,
subscription: subscription,
user: user
});
}
})( angular, InVision );
;
;
/*! share-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "shareService", ShareService );
/** @ngInject */
function ShareService( $resource, serviceHelper, config, modelEvents, _ ) {
function getShare() {
var share = config.share;
if ( _.isArray( share )) share = share[ 0 ];
return( 
ng.copy( share )
);
}
function identify( name, email ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "identify",
parameters: {
id: config.share.id,
name: name,
email: email
},
successCallback: function( response ) {
modelEvents.trigger( "shareIdentityChanged", response );
}
});
return( promise );
}
function sendSMS( shareID, phoneNumber ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "sendSMS",
parameters: {
id: shareID,
phoneNumber: phoneNumber
}
});
return( promise );
}
function getExistingUser( userEmail ) {
return serviceHelper.executeRequest({
resource: resource,
name: "getExistingUser",
parameters: {
userEmail: userEmail
}
});
}
function validateUser( userEmail, password, projectID, anonUserID, workflow ) {
return serviceHelper.executeRequest({
resource: resource,
name: "validateUser",
parameters: {
userEmail: userEmail,
password: password,
projectID: projectID,
anonUserID: anonUserID,
workflow: workflow
},
successCallback: function( response ) {
if ( _.isEmpty( response.user ) ) {
return;
}
modelEvents.trigger( "shareIdentityChanged", response.user );
}
});
}
function getShareConfig( shareID, noCdnUrls, trigger ){
if ( cachedShareConfigFailure !== null ) {
return( cachedShareConfigFailure );
}
if ( !noCdnUrls ) {
noCdnUrls = false;
}
var promise = serviceHelper.executeRequest({
resource: resource,
name: "getShareConfig",
parameters: {
id: shareID,
noCdnUrls: noCdnUrls,
trigger: trigger
}
});
promise.then(
null,
function() {
cachedShareConfigFailure = promise;
}
);
return( promise );
}
var resource = $resource(
"/api/share/:id/:command",
{
id: "@id",
command: "@command",
workflow: "@workflow",
trigger: "@trigger"
},
{
identify: {
method: "POST",
params: {
command: "change-identity"
}
},
sendSMS: {
method: "POST",
params: {
command: "send-sms"
}
},
getShareConfig: {
method: "GET",
params: {
command: "get-share-config"
}
},
getExistingUser: {
method: "POST",
params: {
command: "get-existing-user"
}
},
validateUser: {
method: "POST",
params: {
command: "validate-user"
}
}
}
);
var cachedShareConfigFailure = null;
return({
getShare: getShare,
identify: identify,
getExistingUser: getExistingUser,
sendSMS: sendSMS,
getShareConfig: getShareConfig,
validateUser: validateUser
});
}
})( angular, InVision );
;
;
/*! user-preference-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "userPreferenceService", Service );
/** @ngInject */
function Service( _, serviceHelper, $resource, modelEvents, $q, config ) {
function cacheType( name, response ) {
cachedTypes[ name.toLowerCase() ] = response;
}
function cacheValue( id, response ) {
cachedValues[ id ] = response;
}
function getCachedType( name ) {
return( cachedTypes[ name.toLowerCase() ] );
}
function getCachedTypeResolution( name ) {
var deferred = $q.defer();
var promise = deferred.promise;
deferred.resolve( getCachedType( name.toLowerCase() ) );
return( promise );
}
function getCachedValue( id ) {
return( cachedValues[ id ] );
}
function getCachedValueResolution( id ) {
var deferred = $q.defer();
var promise = deferred.promise;
deferred.resolve( getCachedValue( id ) );
return( promise );
}
/**
* I get all the details about a specific user preference by it's name
* @param  {string} preferenceName  - name of the preference to lookup
* @param  {boolean} doCreate       - create the preference if it doesn't exist?
* @param  {string} dataType 		- type of data the new preferenceType is
* @param  {string} defaultValue 	- default value of the preference
* @return {object}
*/
function getPreferenceTypeByName( preferenceName, doCreate, dataType, defaultValue ) {
if ( isTypeCached( preferenceName ) ) {
return( getCachedTypeResolution( preferenceName ) );
}
var promise = serviceHelper.executeRequest({
resource: resource,
name: "getPreferenceTypeByName",
parameters: {
preferenceName: preferenceName,
doCreate: doCreate,
dataType: dataType,
defaultValue: defaultValue
},
successCallback: function( response ) {
cacheType( preferenceName, response );
}
});
return( promise );
}
/**
* I get a user's preference based by preference id
* @param  {int} preferenceId   - ID of the preference to lookup
* @return {object}
*/
function getUserPreferenceById( preferenceId ) {
if ( isValueCached( preferenceId ) ) {
return( getCachedValueResolution( preferenceId ) );
}
var promise = serviceHelper.executeRequest({
resource: resource,
name: "getUserPreferenceById",
parameters: {
userPreferenceTypeId: preferenceId
},
successCallback: function( response ) {
if ( ! response.data ) {
response.data = {
name: "",
value: null
};
}
cacheValue( preferenceId, response );
}
});
return( promise );	
}
function isTypeCached( name ) {
return( name.toLowerCase() in cachedTypes );
}
function isValueCached( id ) {
return( cachedValues.hasOwnProperty( id ) );
}
/**
* I set a user's preference
* @param {int} preferenceId   - the id of the preferenceType to set
* @param {any} value          - the value of that preferenceType
*/
function setUserPreferenceById( preferenceId, value ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "setUserPreferenceById",
parameters: {
userPreferenceTypeId: preferenceId,
userPreferenceTypeValue : value
},
successCallback: function( response ) {
updateCachedValue( preferenceId, value );
}
});
return( promise );	
}
function updateCachedValue( id, value ) {
if ( isValueCached( id ) ) {
var cachedValue = getCachedValue( id );
cachedValue.exists = "true";
cachedValue.data.value = value;
}
}
function updateTellAFriendTooltipLastViewedAt( dateTimeInMillisecs ) {
var promise = serviceHelper.executeRequest({
resource: resource,
name: "updateTellAFriendTooltipLastViewedAt",
parameters: {
tellAFriendTooltipLastViewedAt: dateTimeInMillisecs
},
successCallback: function( response ) {
modelEvents.trigger( "accountUpdated", response );
}
});
return( promise );
}
function preloadCaches ( userPreferences ){
_.each( userPreferences, function( pref ){
cacheType( pref.preferencetype, {
exists: "true",
data: {
id: pref.preferencetypeid,
preferencedatatype: pref.datatype,
preferencename: pref.preferencetype,
createdAt: pref.createdAt
}
});
cacheValue( pref.preferencetypeid, {
exists: "true",
data: { 
name: pref.preferencetype,
value: pref.preferencevalue,
createdAt: pref.createdAt
} 
});
});
}
var resource = $resource(
"/api/userPreference/:command",
{
command: "@command"
},
{
updateTellAFriendTooltipLastViewedAt: {
method: "POST",
params: {
command: "updateTellAFriendTooltipViewed"
}
},
getPreferenceTypeByName: {
method: "POST",
params: {
command: "getPreferenceTypeByName"
}
},
getUserPreferenceById: {
method: "POST",
params: {
command: "getUserPreferenceById"
}
},
setUserPreferenceById: {
method: "POST",
params: {
command: "setUserPreferenceById"
}
}
}
);
var cachedTypes = {};
var cachedValues = {};
preloadCaches( config.userPreferences );
return({
updateTellAFriendTooltipLastViewedAt: _.memoize( updateTellAFriendTooltipLastViewedAt ),
getPreferenceTypeByName : getPreferenceTypeByName,
getUserPreferenceById : getUserPreferenceById,
setUserPreferenceById : setUserPreferenceById
});
}
})( angular, InVision );
;
;
/*! user-service.js */ 
;
;
(function( ng, app ) {
"use strict";
app.service( "userService", UserService );
/** @ngInject */
function UserService( config, modelEvents, _ ) {
function getAffiliates() {
return(
ng.copy( config.affiliates )
);
}
function getInitials( name ) {
if ( ! name ) {
return( "" );
}
var nameParts = name.replace( /^\s+|\s+$/i, "" ).split( /\s+/i );
var namePartsCount = nameParts.length;
if ( namePartsCount > 1 ) {
return(
nameParts[ 0 ].slice( 0, 1 ) +
nameParts[ namePartsCount - 1 ].slice( 0, 1 )
);
}
return( nameParts[ 0 ].slice( 0, 1 ) );
}
function getFirstName( name ) {
if ( ! name ) {
return( "" );
}
var nameParts = name.replace( /^\s+|\s+$/i, "" ).split( /\s+/i );
return( nameParts[ 0 ] );
}
function getOnlineStatus( lastRequestAt ) {
var now = ( new Date() ).getTime();
var onlineCutoff = ( 10 * 60 * 1000 ); 	// 10 minutes.
var awayCutoff = ( 30 * 60 * 1000 );	// 30 minutes.
if ( lastRequestAt > ( now - onlineCutoff ) ) {
return( "Online" );
} else if ( lastRequestAt > ( now - awayCutoff ) ) {
return( "Away" );
}
return( "Offline" );
}
function getMembers() {
return(
ng.copy( config.members )
);
}
function isAffiliate( userID ) {
for ( var i = 0, length = config.affiliates.length ; i < length ; i++ ) {
if ( config.affiliates[ i ].id === userID ) {
return( true );
}
}
return( false );
}
function isSystemAvatar( avatarID ) {
return( avatarID.indexOf( "00000000" ) === 0 );
}
modelEvents.on(
"shareIdentityChanged.userService",
function( event, user ) {
config.user = ng.copy( user );
var cachedMember = _.findWithProperty( config.members, "id", user.id );
var cachedAffiliate = _.findWithProperty( config.affiliates, "id", user.id );
if ( cachedMember || cachedAffiliate ) {
return;
}
config.affiliates.push( user );
config.affiliates.sort(
function( a, b ) {
return( a.name.toLowerCase() < b.name.toLowerCase() ? -1 : 1 );
}
);
}
);
var ROLES = {
ADMIN : 1,
MANAGER : 2,
CONTRIBUTOR: 3,
REVIEWER: 4
};
return({
getAffiliates: getAffiliates,
getInitials: getInitials,
getFirstName: getFirstName,
getOnlineStatus: getOnlineStatus,
getMembers: getMembers,
isAffiliate: isAffiliate,
isSystemAvatar: isSystemAvatar,
ROLES: ROLES
});
}
})( angular, InVision );
;
;
/*! react-compiled.js */ 
;
;
!function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){!function(){"use strict";function e(){for(var t="",n=0;n<arguments.length;n++){var r=arguments[n];if(r){var i=typeof r;if("string"===i||"number"===i)t+=" "+r;else if(Array.isArray(r))t+=" "+e.apply(null,r);else if("object"===i)for(var o in r)r.hasOwnProperty(o)&&r[o]&&(t+=" "+o)}}return t.substr(1)}"undefined"!=typeof t&&t.exports?t.exports=e:"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return e}):window.classNames=e}()},{}],2:[function(e,t,n){"use strict";function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(){}i.prototype._events=void 0,i.prototype.listeners=function(e){if(!this._events||!this._events[e])return[];if(this._events[e].fn)return[this._events[e].fn];for(var t=0,n=this._events[e].length,r=new Array(n);n>t;t++)r[t]=this._events[e][t].fn;return r},i.prototype.emit=function(e,t,n,r,i,o){if(!this._events||!this._events[e])return!1;var s,a,l=this._events[e],c=arguments.length;if("function"==typeof l.fn){switch(l.once&&this.removeListener(e,l.fn,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,i),!0;case 6:return l.fn.call(l.context,t,n,r,i,o),!0}for(a=1,s=new Array(c-1);c>a;a++)s[a-1]=arguments[a];l.fn.apply(l.context,s)}else{var u,p=l.length;for(a=0;p>a;a++)switch(l[a].once&&this.removeListener(e,l[a].fn,!0),c){case 1:l[a].fn.call(l[a].context);break;case 2:l[a].fn.call(l[a].context,t);break;case 3:l[a].fn.call(l[a].context,t,n);break;default:if(!s)for(u=1,s=new Array(c-1);c>u;u++)s[u-1]=arguments[u];l[a].fn.apply(l[a].context,s)}}return!0},i.prototype.on=function(e,t,n){var i=new r(t,n||this);return this._events||(this._events={}),this._events[e]?this._events[e].fn?this._events[e]=[this._events[e],i]:this._events[e].push(i):this._events[e]=i,this},i.prototype.once=function(e,t,n){var i=new r(t,n||this,!0);return this._events||(this._events={}),this._events[e]?this._events[e].fn?this._events[e]=[this._events[e],i]:this._events[e].push(i):this._events[e]=i,this},i.prototype.removeListener=function(e,t,n){if(!this._events||!this._events[e])return this;var r=this._events[e],i=[];if(t&&(r.fn&&(r.fn!==t||n&&!r.once)&&i.push(r),!r.fn))for(var o=0,s=r.length;s>o;o++)(r[o].fn!==t||n&&!r[o].once)&&i.push(r[o]);return i.length?this._events[e]=1===i.length?i[0]:i:delete this._events[e],this},i.prototype.removeAllListeners=function(e){return this._events?(e?delete this._events[e]:this._events={},this):this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prototype.setMaxListeners=function(){return this},i.EventEmitter=i,i.EventEmitter2=i,i.EventEmitter3=i,t.exports=i},{}],3:[function(e,t,n){(function(e){(function(){function r(e,t){if(e!==t){var n=e===e,r=t===t;if(e>t||!n||"undefined"==typeof e&&r)return 1;if(t>e||!r||"undefined"==typeof t&&n)return-1}return 0}function i(e,t,n){for(var r=e.length,i=n?r:-1;n?i--:++i<r;)if(t(e[i],i,e))return i;return-1}function o(e,t,n){if(t!==t)return m(e,n);for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}function s(e){return"function"==typeof e||!1}function a(e){return"string"==typeof e?e:null==e?"":e+""}function l(e){return e.charCodeAt(0)}function c(e,t){for(var n=-1,r=e.length;++n<r&&t.indexOf(e.charAt(n))>-1;);return n}function u(e,t){for(var n=e.length;n--&&t.indexOf(e.charAt(n))>-1;);return n}function p(e,t){return r(e.criteria,t.criteria)||e.index-t.index}function f(e,t,n){for(var i=-1,o=e.criteria,s=t.criteria,a=o.length,l=n.length;++i<a;){var c=r(o[i],s[i]);if(c)return i>=l?c:c*(n[i]?1:-1)}return e.index-t.index}function h(e){return qe[e]}function d(e){return Ue[e]}function v(e){return"\\"+Ye[e]}function m(e,t,n){for(var r=e.length,i=t+(n?0:-1);n?i--:++i<r;){var o=e[i];if(o!==o)return i}return-1}function y(e){return!!e&&"object"==typeof e}function g(e){return 160>=e&&e>=9&&13>=e||32==e||160==e||5760==e||6158==e||e>=8192&&(8202>=e||8232==e||8233==e||8239==e||8287==e||12288==e||65279==e)}function b(e,t){for(var n=-1,r=e.length,i=-1,o=[];++n<r;)e[n]===t&&(e[n]=B,o[++i]=n);return o}function _(e,t){for(var n,r=-1,i=e.length,o=-1,s=[];++r<i;){var a=e[r],l=t?t(a,r,e):a;r&&n===l||(n=l,s[++o]=a)}return s}function S(e){for(var t=-1,n=e.length;++t<n&&g(e.charCodeAt(t)););return t}function x(e){for(var t=e.length;t--&&g(e.charCodeAt(t)););return t}function w(e){return Ve[e]}function T(e){function t(e){if(y(e)&&!sa(e)&&!(e instanceof J)){if(e instanceof g)return e;if(Mo.call(e,"__chain__")&&Mo.call(e,"__wrapped__"))return Gn(e)}return new g(e)}function n(){}function g(e,t,n){this.__wrapped__=e,this.__actions__=n||[],this.__chain__=!!t}function J(e){this.__wrapped__=e,this.__actions__=null,this.__dir__=1,this.__dropCount__=0,this.__filtered__=!1,this.__iteratees__=null,this.__takeCount__=as,this.__views__=null}function te(){var e=this.__actions__,t=this.__iteratees__,n=this.__views__,r=new J(this.__wrapped__);return r.__actions__=e?Xe(e):null,r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=t?Xe(t):null,r.__takeCount__=this.__takeCount__,r.__views__=n?Xe(n):null,r}function re(){if(this.__filtered__){var e=new J(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function qe(){var e=this.__wrapped__.value();if(!sa(e))return $t(e,this.__actions__);var t=this.__dir__,n=0>t,r=Mn(0,e.length,this.__views__),i=r.start,o=r.end,s=o-i,a=n?o:i-1,l=ts(s,this.__takeCount__),c=this.__iteratees__,u=c?c.length:0,p=0,f=[];e:for(;s--&&l>p;){a+=t;for(var h=-1,d=e[a];++h<u;){var v=c[h],m=v.iteratee,y=v.type;if(y==W){if(v.done&&(n?a>v.index:a<v.index)&&(v.count=0,v.done=!1),v.index=a,!v.done){var g=v.limit;if(!(v.done=g>-1?v.count++>=g:!m(d)))continue e}}else{var b=m(d);if(y==U)d=b;else if(!b){if(y==q)continue e;break e}}}f[p++]=d}return f}function Ue(){this.__data__={}}function Ve(e){return this.has(e)&&delete this.__data__[e]}function Be(e){return"__proto__"==e?E:this.__data__[e]}function Ye(e){return"__proto__"!=e&&Mo.call(this.__data__,e)}function ze(e,t){return"__proto__"!=e&&(this.__data__[e]=t),this}function $e(e){var t=e?e.length:0;for(this.data={hash:Jo(null),set:new Bo};t--;)this.push(e[t])}function Ge(e,t){var n=e.data,r="string"==typeof t||fi(t)?n.set.has(t):n.hash[t];return r?0:-1}function Ke(e){var t=this.data;"string"==typeof e||fi(e)?t.set.add(e):t.hash[e]=!0}function Xe(e,t){var n=-1,r=e.length;for(t||(t=vo(r));++n<r;)t[n]=e[n];return t}function Je(e,t){for(var n=-1,r=e.length;++n<r&&t(e[n],n,e)!==!1;);return e}function et(e,t){for(var n=e.length;n--&&t(e[n],n,e)!==!1;);return e}function tt(e,t){for(var n=-1,r=e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function nt(e,t){for(var n=-1,r=e.length,i=-1,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[++i]=s)}return o}function rt(e,t){for(var n=-1,r=e.length,i=vo(r);++n<r;)i[n]=t(e[n],n,e);return i}function it(e){for(var t=-1,n=e.length,r=ss;++t<n;){var i=e[t];i>r&&(r=i)}return r}function ot(e){for(var t=-1,n=e.length,r=as;++t<n;){var i=e[t];r>i&&(r=i)}return r}function st(e,t,n,r){var i=-1,o=e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function at(e,t,n,r){var i=e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function lt(e,t){for(var n=-1,r=e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function ct(e){for(var t=e.length,n=0;t--;)n+=+e[t]||0;return n}function ut(e,t){return"undefined"==typeof e?t:e}function pt(e,t,n,r){return"undefined"!=typeof e&&Mo.call(r,n)?e:t}function ft(e,t,n){var r=ga(t);if(!n)return dt(t,e,r);for(var i=-1,o=r.length;++i<o;){var s=r[i],a=e[s],l=n(a,t[s],s,e,t);(l===l?l===a:a!==a)&&("undefined"!=typeof a||s in e)||(e[s]=l)}return e}function ht(e,t){for(var n=-1,r=e.length,i=An(r),o=t.length,s=vo(o);++n<o;){var a=t[n];i?(a=parseFloat(a),s[n]=Fn(a,r)?e[a]:E):s[n]=e[a]}return s}function dt(e,t,n){n||(n=t,t={});for(var r=-1,i=n.length;++r<i;){var o=n[r];t[o]=e[o]}return t}function vt(e,t,n){var r=typeof e;return"function"==r?"undefined"==typeof t?e:Xt(e,t,n):null==e?to:"object"==r?Dt(e):"undefined"==typeof t?Ht(e+""):kt(e+"",t)}function mt(e,t,n,r,i,o,s){var a;if(n&&(a=i?n(e,r,i):n(e)),"undefined"!=typeof a)return a;if(!fi(e))return e;var l=sa(e);if(l){if(a=Dn(e),!t)return Xe(e,a)}else{var c=ko.call(e),u=c==X;if(c!=Q&&c!=Y&&(!u||i))return Ne[c]?Cn(e,c,t):i?e:{};if(a=kn(u?{}:e),!t)return dt(e,a,ga(e))}o||(o=[]),s||(s=[]);for(var p=o.length;p--;)if(o[p]==e)return s[p];return o.push(e),s.push(a),(l?Je:Et)(e,function(r,i){a[i]=mt(r,t,n,i,e,o,s)}),a}function yt(e,t,n){if("function"!=typeof e)throw new To(V);return Yo(function(){e.apply(E,n)},t)}function gt(e,t){var n=e?e.length:0,r=[];if(!n)return r;var i=-1,s=In(),a=s==o,l=a&&t.length>=200?xs(t):null,c=t.length;l&&(s=Ge,a=!1,t=l);e:for(;++i<n;){var u=e[i];if(a&&u===u){for(var p=c;p--;)if(t[p]===u)continue e;r.push(u)}else s(t,u,0)<0&&r.push(u)}return r}function bt(e,t){var n=!0;return ys(e,function(e,r,i){return n=!!t(e,r,i)}),n}function _t(e,t,n,r){var i=e.length;for(n=null==n?0:+n||0,0>n&&(n=-n>i?0:i+n),r="undefined"==typeof r||r>i?i:+r||0,0>r&&(r+=i),i=n>r?0:r>>>0,n>>>=0;i>n;)e[n++]=t;return e}function St(e,t){var n=[];return ys(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function xt(e,t,n,r){var i;return n(e,function(e,n,o){return t(e,n,o)?(i=r?n:e,!1):void 0}),i}function wt(e,t,n){for(var r=-1,i=e.length,o=-1,s=[];++r<i;){var a=e[r];if(y(a)&&An(a.length)&&(sa(a)||oi(a))){t&&(a=wt(a,t,n));var l=-1,c=a.length;for(s.length+=c;++l<c;)s[++o]=a[l]}else n||(s[++o]=a)}return s}function Tt(e,t){return bs(e,t,Pi)}function Et(e,t){return bs(e,t,ga)}function Ot(e,t){return _s(e,t,ga)}function Rt(e,t){for(var n=-1,r=t.length,i=-1,o=[];++n<r;){var s=t[n];la(e[s])&&(o[++i]=s)}return o}function Pt(e,t,n,r,i,o){if(e===t)return 0!==e||1/e==1/t;var s=typeof e,a=typeof t;return"function"!=s&&"object"!=s&&"function"!=a&&"object"!=a||null==e||null==t?e!==e&&t!==t:jt(e,t,Pt,n,r,i,o)}function jt(e,t,n,r,i,o,s){var a=sa(e),l=sa(t),c=z,u=z;a||(c=ko.call(e),c==Y?c=Q:c!=Q&&(a=_i(e))),l||(u=ko.call(t),u==Y?u=Q:u!=Q&&(l=_i(t)));var p=c==Q||i&&c==X,f=u==Q||i&&u==X,h=c==u;if(h&&!a&&!p)return On(e,t,c);if(i){if(!(h||p&&f))return!1}else{var d=p&&Mo.call(e,"__wrapped__"),v=f&&Mo.call(t,"__wrapped__");if(d||v)return n(d?e.value():e,v?t.value():t,r,i,o,s);if(!h)return!1}o||(o=[]),s||(s=[]);for(var m=o.length;m--;)if(o[m]==e)return s[m]==t;o.push(e),s.push(t);var y=(a?En:Rn)(e,t,n,r,i,o,s);return o.pop(),s.pop(),y}function It(e,t,n,r,i){for(var o=-1,s=t.length,a=!i;++o<s;)if(a&&r[o]?n[o]!==e[t[o]]:!(t[o]in e))return!1;for(o=-1;++o<s;){var l=t[o],c=e[l],u=n[o];if(a&&r[o])var p="undefined"!=typeof c||l in e;else p=i?i(c,u,l):E,"undefined"==typeof p&&(p=Pt(u,c,i,!0));if(!p)return!1}return!0}function Mt(e,t){var n=[];return ys(e,function(e,r,i){n.push(t(e,r,i))}),n}function Dt(e){var t=ga(e),n=t.length;if(!n)return eo(!0);if(1==n){var r=t[0],i=e[r];if(Nn(i))return function(e){return null!=e&&e[r]===i&&("undefined"!=typeof i||r in $n(e))}}for(var o=vo(n),s=vo(n);n--;)i=e[t[n]],o[n]=i,s[n]=Nn(i);return function(e){return null!=e&&It($n(e),t,o,s)}}function kt(e,t){return Nn(t)?function(n){return null!=n&&n[e]===t&&("undefined"!=typeof t||e in $n(n))}:function(n){return null!=n&&Pt(t,n[e],null,!0)}}function Ct(e,t,n,r,i){if(!fi(e))return e;var o=An(t.length)&&(sa(t)||_i(t));return(o?Je:Et)(t,function(t,s,a){if(y(t))return r||(r=[]),i||(i=[]),Ft(e,a,s,Ct,n,r,i);var l=e[s],c=n?n(l,t,s,e,a):E,u="undefined"==typeof c;u&&(c=t),!o&&"undefined"==typeof c||!u&&(c===c?c===l:l!==l)||(e[s]=c)}),e}function Ft(e,t,n,r,i,o,s){for(var a=o.length,l=t[n];a--;)if(o[a]==l)return void(e[n]=s[a]);var c=e[n],u=i?i(c,l,n,e,t):E,p="undefined"==typeof u;p&&(u=l,An(l.length)&&(sa(l)||_i(l))?u=sa(c)?c:c&&c.length?Xe(c):[]:ca(l)||oi(l)?u=oi(c)?wi(c):ca(c)?c:{}:p=!1),o.push(l),s.push(u),p?e[n]=r(u,l,i,o,s):(u===u?u!==c:c===c)&&(e[n]=u)}function Ht(e){return function(t){return null==t?E:t[e]}}function Lt(e,t){return e+Wo(os()*(t-e+1))}function At(e,t,n,r,i){return i(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function Nt(e,t,n){var r=-1,i=e.length;t=null==t?0:+t||0,0>t&&(t=-t>i?0:i+t),n="undefined"==typeof n||n>i?i:+n||0,0>n&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=vo(i);++r<i;)o[r]=e[r+t];return o}function Wt(e,t){var n;return ys(e,function(e,r,i){return n=t(e,r,i),!n}),!!n}function qt(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function Ut(e,t,n){var r=-1,i=e.length,o=An(i)?vo(i):[];return ys(e,function(e){for(var n=t.length,i=vo(n);n--;)i[n]=null==e?E:e[t[n]];o[++r]={criteria:i,index:r,value:e}}),qt(o,function(e,t){return f(e,t,n)})}function Vt(e,t){var n=0;return ys(e,function(e,r,i){n+=+t(e,r,i)||0}),n}function Bt(e,t){var n=-1,r=In(),i=e.length,s=r==o,a=s&&i>=200,l=a?xs():null,c=[];l?(r=Ge,s=!1):(a=!1,l=t?[]:c);e:for(;++n<i;){var u=e[n],p=t?t(u,n,e):u;if(s&&u===u){for(var f=l.length;f--;)if(l[f]===p)continue e;t&&l.push(p),c.push(u)}else r(l,p,0)<0&&((t||a)&&l.push(p),c.push(u))}return c}function Yt(e,t){for(var n=-1,r=t.length,i=vo(r);++n<r;)i[n]=e[t[n]];return i}function zt(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Nt(e,r?0:o,r?o+1:i):Nt(e,r?o+1:0,r?i:o)}function $t(e,t){var n=e;n instanceof J&&(n=n.value());for(var r=-1,i=t.length;++r<i;){var o=[n],s=t[r];Uo.apply(o,s.args),n=s.func.apply(s.thisArg,o)}return n}function Gt(e,t,n){var r=0,i=e?e.length:r;if("number"==typeof t&&t===t&&us>=i){for(;i>r;){var o=r+i>>>1,s=e[o];(n?t>=s:t>s)?r=o+1:i=o}return i}return Kt(e,t,to,n)}function Kt(e,t,n,r){t=n(t);for(var i=0,o=e?e.length:0,s=t!==t,a="undefined"==typeof t;o>i;){var l=Wo((i+o)/2),c=n(e[l]),u=c===c;if(s)var p=u||r;else p=a?u&&(r||"undefined"!=typeof c):r?t>=c:t>c;p?i=l+1:o=l}return ts(o,cs)}function Xt(e,t,n){if("function"!=typeof e)return to;if("undefined"==typeof t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,o){return e.call(t,n,r,i,o)};case 5:return function(n,r,i,o,s){return e.call(t,n,r,i,o,s)}}return function(){return e.apply(t,arguments)}}function Jt(e){return Lo.call(e,0)}function Zt(e,t,n){for(var r=n.length,i=-1,o=es(e.length-r,0),s=-1,a=t.length,l=vo(o+a);++s<a;)l[s]=t[s];for(;++i<r;)l[n[i]]=e[i];for(;o--;)l[s++]=e[i++];return l}function Qt(e,t,n){for(var r=-1,i=n.length,o=-1,s=es(e.length-i,0),a=-1,l=t.length,c=vo(s+l);++o<s;)c[o]=e[o];for(var u=o;++a<l;)c[u+a]=t[a];for(;++r<i;)c[u+n[r]]=e[o++];return c}function en(e,t){return function(n,r,i){var o=t?t():{};if(r=jn(r,i,3),sa(n))for(var s=-1,a=n.length;++s<a;){var l=n[s];e(o,l,r(l,s,n),n)}else ys(n,function(t,n,i){e(o,t,r(t,n,i),i)});return o}}function tn(e){return function(){var t=arguments,n=t.length,r=t[0];if(2>n||null==r)return r;var i=t[n-2],o=t[n-1],s=t[3];n>3&&"function"==typeof i?(i=Xt(i,o,5),n-=2):(i=n>2&&"function"==typeof o?o:null,n-=i?1:0),s&&Hn(t[1],t[2],s)&&(i=3==n?null:i,n=2);for(var a=0;++a<n;){var l=t[a];l&&e(r,l,i)}return r}}function nn(e,t){return function(n,r){var i=n?n.length:0;if(!An(i))return e(n,r);for(var o=t?i:-1,s=$n(n);(t?o--:++o<i)&&r(s[o],o,s)!==!1;);return n}}function rn(e){return function(t,n,r){for(var i=$n(t),o=r(t),s=o.length,a=e?s:-1;e?a--:++a<s;){var l=o[a];if(n(i[l],l,i)===!1)break}return t}}function on(e,t){function n(){var i=this&&this!==Ze&&this instanceof n?r:e;return i.apply(t,arguments)}var r=an(e);return n}function sn(e){return function(t){for(var n=-1,r=Zi(Ai(t)),i=r.length,o="";++n<i;)o=e(o,r[n],n);return o}}function an(e){return function(){var t=ms(e.prototype),n=e.apply(t,arguments);return fi(n)?n:t}}function ln(e){function t(n,r,i){i&&Hn(n,r,i)&&(r=null);var o=Tn(n,e,null,null,null,null,null,r);return o.placeholder=t.placeholder,o}return t}function cn(e,t){return function(n,r,i){i&&Hn(n,r,i)&&(r=null);var o=jn(),s=null==r;if(o===vt&&s||(s=!1,r=o(r,i,3)),s){var a=sa(n);if(a||!bi(n))return e(a?n:zn(n));r=l}return Pn(n,r,t)}}function un(e,t){return function(n,r,o){if(r=jn(r,o,3),sa(n)){var s=i(n,r,t);return s>-1?n[s]:E}return xt(n,r,e)}}function pn(e){return function(t,n,r){return t&&t.length?(n=jn(n,r,3),i(t,n,e)):-1}}function fn(e){return function(t,n,r){return n=jn(n,r,3),xt(t,n,e,!0)}}function hn(e){return function(){var t=arguments.length;if(!t)return function(){return arguments[0]};for(var n,r=e?t:-1,i=0,o=vo(t);e?r--:++r<t;){var s=o[i++]=arguments[r];if("function"!=typeof s)throw new To(V);var a=n?"":Ts(s);n="wrapper"==a?new g([]):n}for(r=n?-1:t;++r<t;){s=o[r],a=Ts(s);var l="wrapper"==a?ws(s):null;n=l&&Ln(l[0])?n[Ts(l[0])].apply(n,l[3]):1==s.length&&Ln(s)?n[a]():n.thru(s)}return function(){var e=arguments;if(n&&1==e.length&&sa(e[0]))return n.plant(e[0]).value();for(var r=0,i=o[r].apply(this,e);++r<t;)i=o[r].call(this,i);return i}}}function dn(e,t){return function(n,r,i){return"function"==typeof r&&"undefined"==typeof i&&sa(n)?e(n,r):t(n,Xt(r,i,3))}}function vn(e){return function(t,n,r){return("function"!=typeof n||"undefined"!=typeof r)&&(n=Xt(n,r,3)),e(t,n,Pi)}}function mn(e){return function(t,n,r){return("function"!=typeof n||"undefined"!=typeof r)&&(n=Xt(n,r,3)),e(t,n)}}function yn(e){return function(t,n,r){return t=a(t),t&&(e?t:"")+Sn(t,n,r)+(e?"":t)}}function gn(e){var t=Qr(function(n,r){var i=b(r,t.placeholder);return Tn(n,e,null,r,i)});return t}function bn(e,t){return function(n,r,i,o){var s=arguments.length<3;return"function"==typeof r&&"undefined"==typeof o&&sa(n)?e(n,r,i,s):At(n,jn(r,o,4),i,s,t)}}function _n(e,t,n,r,i,o,s,a,l,c){function u(){for(var _=arguments.length,S=_,x=vo(_);S--;)x[S]=arguments[S];if(r&&(x=Zt(x,r,i)),o&&(x=Qt(x,o,s)),d||m){var w=u.placeholder,T=b(x,w);if(_-=T.length,c>_){var O=a?Xe(a):null,j=es(c-_,0),I=d?T:null,M=d?null:T,C=d?x:null,F=d?null:x;t|=d?D:k,t&=~(d?k:D),v||(t&=~(R|P));var H=[e,t,n,C,I,F,M,O,l,j],L=_n.apply(E,H);return Ln(e)&&Es(L,H),L.placeholder=w,L}}var A=f?n:this;h&&(e=A[g]),a&&(x=Vn(x,a)),p&&l<x.length&&(x.length=l);var N=this&&this!==Ze&&this instanceof u?y||an(e):e;return N.apply(A,x)}var p=t&C,f=t&R,h=t&P,d=t&I,v=t&j,m=t&M,y=!h&&an(e),g=e;return u}function Sn(e,t,n){var r=e.length;if(t=+t,r>=t||!Zo(t))return"";var i=t-r;return n=null==n?" ":n+"",Bi(n,Ao(i/n.length)).slice(0,i)}function xn(e,t,n,r){function i(){for(var t=-1,a=arguments.length,l=-1,c=r.length,u=vo(a+c);++l<c;)u[l]=r[l];for(;a--;)u[l++]=arguments[++t];var p=this&&this!==Ze&&this instanceof i?s:e;return p.apply(o?n:this,u)}var o=t&R,s=an(e);return i}function wn(e){return function(t,n,r,i){var o=jn(r);return o===vt&&null==r?Gt(t,n,e):Kt(t,n,o(r,i,1),e)}}function Tn(e,t,n,r,i,o,s,a){var l=t&P;if(!l&&"function"!=typeof e)throw new To(V);var c=r?r.length:0;if(c||(t&=~(D|k),r=i=null),c-=i?i.length:0,t&k){var u=r,p=i;r=i=null}var f=l?null:ws(e),h=[e,t,n,r,i,u,p,o,s,a];if(f&&(Wn(h,f),t=h[1],a=h[9]),h[9]=null==a?l?0:e.length:es(a-c,0)||0,t==R)var d=on(h[0],h[2]);else d=t!=D&&t!=(R|D)||h[4].length?_n.apply(E,h):xn.apply(E,h);var v=f?Ss:Es;return v(d,h)}function En(e,t,n,r,i,o,s){var a=-1,l=e.length,c=t.length,u=!0;if(l!=c&&!(i&&c>l))return!1;for(;u&&++a<l;){var p=e[a],f=t[a];if(u=E,r&&(u=i?r(f,p,a):r(p,f,a)),"undefined"==typeof u)if(i)for(var h=c;h--&&(f=t[h],!(u=p&&p===f||n(p,f,r,i,o,s))););else u=p&&p===f||n(p,f,r,i,o,s)}return!!u}function On(e,t,n){switch(n){case $:case G:return+e==+t;case K:return e.name==t.name&&e.message==t.message;case Z:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case ee:case ne:return e==t+""}return!1}function Rn(e,t,n,r,i,o,s){var a=ga(e),l=a.length,c=ga(t),u=c.length;if(l!=u&&!i)return!1;for(var p=i,f=-1;++f<l;){var h=a[f],d=i?h in t:Mo.call(t,h);if(d){var v=e[h],m=t[h];d=E,r&&(d=i?r(m,v,h):r(v,m,h)),"undefined"==typeof d&&(d=v&&v===m||n(v,m,r,i,o,s))}if(!d)return!1;p||(p="constructor"==h)}if(!p){var y=e.constructor,g=t.constructor;if(y!=g&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof g&&g instanceof g))return!1}return!0}function Pn(e,t,n){var r=n?as:ss,i=r,o=i;return ys(e,function(e,s,a){var l=t(e,s,a);((n?i>l:l>i)||l===r&&l===o)&&(i=l,o=e)}),o}function jn(e,n,r){var i=t.callback||Qi;return i=i===Qi?vt:i,r?i(e,n,r):i}function In(e,n,r){var i=t.indexOf||or;return i=i===or?o:i,e?i(e,n,r):i}function Mn(e,t,n){for(var r=-1,i=n?n.length:0;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=ts(t,e+s);break;case"takeRight":e=es(e,t-s)}}return{start:e,end:t}}function Dn(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Mo.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function kn(e){var t=e.constructor;return"function"==typeof t&&t instanceof t||(t=So),new t}function Cn(e,t,n){var r=e.constructor;switch(t){case ie:return Jt(e);case $:case G:return new r(+e);case oe:case se:case ae:case le:case ce:case ue:case pe:case fe:case he:var i=e.buffer;return new r(n?Jt(i):i,e.byteOffset,e.length);case Z:case ne:return new r(e);case ee:var o=new r(e.source,Oe.exec(e));o.lastIndex=e.lastIndex}return o}function Fn(e,t){return e=+e,t=null==t?fs:t,e>-1&&e%1==0&&t>e}function Hn(e,t,n){if(!fi(n))return!1;var r=typeof t;if("number"==r)var i=n.length,o=An(i)&&Fn(t,i);else o="string"==r&&t in n;if(o){var s=n[t];return e===e?e===s:s!==s}return!1}function Ln(e){var n=Ts(e);return!!n&&e===t[n]&&n in J.prototype}function An(e){return"number"==typeof e&&e>-1&&e%1==0&&fs>=e}function Nn(e){return e===e&&(0===e?1/e>0:!fi(e))}function Wn(e,t){var n=e[1],r=t[1],i=n|r,o=C>i,s=r==C&&n==I||r==C&&n==F&&e[7].length<=t[8]||r==(C|F)&&n==I;if(!o&&!s)return e;r&R&&(e[2]=t[2],i|=n&R?0:j);var a=t[3];if(a){var l=e[3];e[3]=l?Zt(l,a,t[4]):Xe(a),e[4]=l?b(e[3],B):Xe(t[4])}return a=t[5],a&&(l=e[5],e[5]=l?Qt(l,a,t[6]):Xe(a),e[6]=l?b(e[5],B):Xe(t[6])),a=t[7],a&&(e[7]=Xe(a)),r&C&&(e[8]=null==e[8]?t[8]:ts(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e}function qn(e,t){e=$n(e);for(var n=-1,r=t.length,i={};++n<r;){var o=t[n];o in e&&(i[o]=e[o])}return i}function Un(e,t){var n={};return Tt(e,function(e,r,i){t(e,r,i)&&(n[r]=e)}),n}function Vn(e,t){for(var n=e.length,r=ts(t.length,n),i=Xe(e);r--;){var o=t[r];e[r]=Fn(o,n)?i[o]:E}return e}function Bn(e){{var n;t.support}if(!y(e)||ko.call(e)!=Q||!Mo.call(e,"constructor")&&(n=e.constructor,"function"==typeof n&&!(n instanceof n)))return!1;var r;return Tt(e,function(e,t){r=t}),"undefined"==typeof r||Mo.call(e,r)}function Yn(e){for(var n=Pi(e),r=n.length,i=r&&e.length,o=t.support,s=i&&An(i)&&(sa(e)||o.nonEnumArgs&&oi(e)),a=-1,l=[];++a<r;){var c=n[a];(s&&Fn(c,i)||Mo.call(e,c))&&l.push(c)}return l}function zn(e){return null==e?[]:An(e.length)?fi(e)?e:So(e):ki(e)}function $n(e){return fi(e)?e:So(e)}function Gn(e){return e instanceof J?e.clone():new g(e.__wrapped__,e.__chain__,Xe(e.__actions__))}function Kn(e,t,n){t=(n?Hn(e,t,n):null==t)?1:es(+t||1,1);for(var r=0,i=e?e.length:0,o=-1,s=vo(Ao(i/t));i>r;)s[++o]=Nt(e,r,r+=t);return s}function Xn(e){for(var t=-1,n=e?e.length:0,r=-1,i=[];++t<n;){var o=e[t];o&&(i[++r]=o)}return i}function Jn(e,t,n){var r=e?e.length:0;return r?((n?Hn(e,t,n):null==t)&&(t=1),Nt(e,0>t?0:t)):[]}function Zn(e,t,n){var r=e?e.length:0;return r?((n?Hn(e,t,n):null==t)&&(t=1),t=r-(+t||0),Nt(e,0,0>t?0:t)):[]}function Qn(e,t,n){return e&&e.length?zt(e,jn(t,n,3),!0,!0):[]}function er(e,t,n){return e&&e.length?zt(e,jn(t,n,3),!0):[]}function tr(e,t,n,r){var i=e?e.length:0;return i?(n&&"number"!=typeof n&&Hn(e,t,n)&&(n=0,r=i),_t(e,t,n,r)):[]}function nr(e){return e?e[0]:E}function rr(e,t,n){var r=e?e.length:0;return n&&Hn(e,t,n)&&(t=!1),r?wt(e,t):[]}function ir(e){var t=e?e.length:0;return t?wt(e,!0):[]}function or(e,t,n){var r=e?e.length:0;if(!r)return-1;if("number"==typeof n)n=0>n?es(r+n,0):n;else if(n){var i=Gt(e,t),s=e[i];return(t===t?t===s:s!==s)?i:-1}return o(e,t,n||0)}function sr(e){return Zn(e,1)}function ar(){for(var e=[],t=-1,n=arguments.length,r=[],i=In(),s=i==o;++t<n;){var a=arguments[t];(sa(a)||oi(a))&&(e.push(a),r.push(s&&a.length>=120?xs(t&&a):null))}n=e.length;var l=e[0],c=-1,u=l?l.length:0,p=[],f=r[0];e:for(;++c<u;)if(a=l[c],(f?Ge(f,a):i(p,a,0))<0){for(t=n;--t;){var h=r[t];if((h?Ge(h,a):i(e[t],a,0))<0)continue e}f&&f.push(a),p.push(a)}return p}function lr(e){var t=e?e.length:0;return t?e[t-1]:E}function cr(e,t,n){var r=e?e.length:0;if(!r)return-1;var i=r;if("number"==typeof n)i=(0>n?es(r+n,0):ts(n||0,r-1))+1;else if(n){i=Gt(e,t,!0)-1;var o=e[i];return(t===t?t===o:o!==o)?i:-1}if(t!==t)return m(e,i,!0);for(;i--;)if(e[i]===t)return i;return-1}function ur(){var e=arguments,t=e[0];if(!t||!t.length)return t;for(var n=0,r=In(),i=e.length;++n<i;)for(var o=0,s=e[n];(o=r(t,s,o))>-1;)zo.call(t,o,1);return t}function pr(e,t,n){var r=-1,i=e?e.length:0,o=[];for(t=jn(t,n,3);++r<i;){var s=e[r];t(s,r,e)&&(o.push(s),zo.call(e,r--,1),i--)}return o}function fr(e){return Jn(e,1)}function hr(e,t,n){var r=e?e.length:0;return r?(n&&"number"!=typeof n&&Hn(e,t,n)&&(t=0,n=r),Nt(e,t,n)):[]}function dr(e,t,n){var r=e?e.length:0;return r?((n?Hn(e,t,n):null==t)&&(t=1),Nt(e,0,0>t?0:t)):[]}function vr(e,t,n){var r=e?e.length:0;return r?((n?Hn(e,t,n):null==t)&&(t=1),t=r-(+t||0),Nt(e,0>t?0:t)):[]}function mr(e,t,n){return e&&e.length?zt(e,jn(t,n,3),!1,!0):[]}function yr(e,t,n){return e&&e.length?zt(e,jn(t,n,3)):[]}function gr(e,t,n,r){var i=e?e.length:0;if(!i)return[];null!=t&&"boolean"!=typeof t&&(r=n,n=Hn(e,t,r)?null:t,t=!1);var s=jn();return(s!==vt||null!=n)&&(n=s(n,r,3)),t&&In()==o?_(e,n):Bt(e,n)}function br(e){for(var t=-1,n=(e&&e.length&&it(rt(e,Io)))>>>0,r=vo(n);++t<n;)r[t]=rt(e,Ht(t));return r}function _r(){for(var e=-1,t=arguments.length;++e<t;){var n=arguments[e];if(sa(n)||oi(n))var r=r?gt(r,n).concat(gt(n,r)):n}return r?Bt(r):[]}function Sr(e,t){var n=-1,r=e?e.length:0,i={};for(!r||t||sa(e[0])||(t=[]);++n<r;){var o=e[n];t?i[o]=t[n]:o&&(i[o[0]]=o[1])}return i}function xr(e){var n=t(e);return n.__chain__=!0,n}function wr(e,t,n){return t.call(n,e),e}function Tr(e,t,n){return t.call(n,e)}function Er(){return xr(this)}function Or(){return new g(this.value(),this.__chain__)}function Rr(e){for(var t,r=this;r instanceof n;){var i=Gn(r);t?o.__wrapped__=i:t=i;var o=i;r=r.__wrapped__}return o.__wrapped__=e,t}function Pr(){var e=this.__wrapped__;return e instanceof J?(this.__actions__.length&&(e=new J(this)),new g(e.reverse(),this.__chain__)):this.thru(function(e){return e.reverse()})}function jr(){return this.value()+""}function Ir(){return $t(this.__wrapped__,this.__actions__)}function Mr(e,t,n){var r=sa(e)?tt:bt;return n&&Hn(e,t,n)&&(t=null),("function"!=typeof t||"undefined"!=typeof n)&&(t=jn(t,n,3)),r(e,t)}function Dr(e,t,n){var r=sa(e)?nt:St;return t=jn(t,n,3),r(e,t)}function kr(e,t){return Ls(e,Dt(t))}function Cr(e,t,n,r){var i=e?e.length:0;return An(i)||(e=ki(e),i=e.length),i?(n="number"!=typeof n||r&&Hn(t,n,r)?0:0>n?es(i+n,0):n||0,"string"==typeof e||!sa(e)&&bi(e)?i>n&&e.indexOf(t,n)>-1:In(e,t,n)>-1):!1}function Fr(e,t,n){var r=sa(e)?rt:Mt;return t=jn(t,n,3),r(e,t)}function Hr(e,t){return Fr(e,Ht(t))}function Lr(e,t,n){var r=sa(e)?nt:St;return t=jn(t,n,3),r(e,function(e,n,r){return!t(e,n,r)})}function Ar(e,t,n){if(n?Hn(e,t,n):null==t){e=zn(e);var r=e.length;return r>0?e[Lt(0,r-1)]:E}var i=Nr(e);return i.length=ts(0>t?0:+t||0,i.length),i}function Nr(e){e=zn(e);for(var t=-1,n=e.length,r=vo(n);++t<n;){var i=Lt(0,t);t!=i&&(r[t]=r[i]),r[i]=e[t]}return r}function Wr(e){var t=e?e.length:0;return An(t)?t:ga(e).length}function qr(e,t,n){var r=sa(e)?lt:Wt;return n&&Hn(e,t,n)&&(t=null),("function"!=typeof t||"undefined"!=typeof n)&&(t=jn(t,n,3)),r(e,t)}function Ur(e,t,n){if(null==e)return[];var r=-1,i=e.length,o=An(i)?vo(i):[];return n&&Hn(e,t,n)&&(t=null),t=jn(t,n,3),ys(e,function(e,n,i){o[++r]={criteria:t(e,n,i),index:r,value:e}}),qt(o,p)}function Vr(){var e=arguments,t=e[0],n=e[3],r=0,i=e.length-1;if(null==t)return[];for(var o=vo(i);i>r;)o[r]=e[++r];return n&&Hn(e[1],e[2],n)&&(o=e[1]),Ut(t,wt(o),[])}function Br(e,t,n,r){return null==e?[]:(r&&Hn(t,n,r)&&(n=null),sa(t)||(t=null==t?[]:[t]),sa(n)||(n=null==n?[]:[n]),Ut(e,t,n))}function Yr(e,t){return Dr(e,Dt(t))}function zr(e,t){if("function"!=typeof t){if("function"!=typeof e)throw new To(V);var n=e;e=t,t=n}return e=Zo(e=+e)?e:0,function(){return--e<1?t.apply(this,arguments):void 0}}function $r(e,t,n){return n&&Hn(e,t,n)&&(t=null),t=e&&null==t?e.length:es(+t||0,0),Tn(e,C,null,null,null,null,t)}function Gr(e,t){var n;if("function"!=typeof t){if("function"!=typeof e)throw new To(V);var r=e;e=t,t=r}return function(){return--e>0?n=t.apply(this,arguments):t=null,n}}function Kr(e,t,n){function r(){f&&No(f),l&&No(l),l=f=h=E}function i(){var n=t-($s()-u);if(0>=n||n>t){l&&No(l);var r=h;l=f=h=E,r&&(d=$s(),c=e.apply(p,a),f||l||(a=p=null))}else f=Yo(i,n)}function o(){f&&No(f),l=f=h=E,(m||v!==t)&&(d=$s(),c=e.apply(p,a),f||l||(a=p=null))}function s(){if(a=arguments,u=$s(),p=this,h=m&&(f||!y),v===!1)var n=y&&!f;else{l||y||(d=u);var r=v-(u-d),s=0>=r||r>v;s?(l&&(l=No(l)),d=u,c=e.apply(p,a)):l||(l=Yo(o,r))}return s&&f?f=No(f):f||t===v||(f=Yo(i,t)),n&&(s=!0,c=e.apply(p,a)),!s||f||l||(a=p=null),c}var a,l,c,u,p,f,h,d=0,v=!1,m=!0;if("function"!=typeof e)throw new To(V);if(t=0>t?0:+t||0,n===!0){var y=!0;m=!1}else fi(n)&&(y=n.leading,v="maxWait"in n&&es(+n.maxWait||0,t),m="trailing"in n?n.trailing:m);return s.cancel=r,s}function Xr(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new To(V);var n=function(){var r=arguments,i=n.cache,o=t?t.apply(this,r):r[0];if(i.has(o))return i.get(o);var s=e.apply(this,r);return i.set(o,s),s};return n.cache=new Xr.Cache,n}function Jr(e){if("function"!=typeof e)throw new To(V);return function(){return!e.apply(this,arguments)}}function Zr(e){return Gr(e,2)}function Qr(e,t){if("function"!=typeof e)throw new To(V);return t=es("undefined"==typeof t?e.length-1:+t||0,0),function(){for(var n=arguments,r=-1,i=es(n.length-t,0),o=vo(i);++r<i;)o[r]=n[t+r];switch(t){case 0:return e.call(this,o);case 1:return e.call(this,n[0],o);case 2:return e.call(this,n[0],n[1],o)}var s=vo(t+1);for(r=-1;++r<t;)s[r]=n[r];return s[t]=o,e.apply(this,s)}}function ei(e){if("function"!=typeof e)throw new To(V);return function(t){return e.apply(this,t)}}function ti(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new To(V);return n===!1?r=!1:fi(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),We.leading=r,We.maxWait=+t,We.trailing=i,Kr(e,t,We)}function ni(e,t){return t=null==t?to:t,Tn(t,D,null,[e],[])}function ri(e,t,n,r){return t&&"boolean"!=typeof t&&Hn(e,t,n)?t=!1:"function"==typeof t&&(r=n,n=t,t=!1),n="function"==typeof n&&Xt(n,r,1),mt(e,t,n)}function ii(e,t,n){return t="function"==typeof t&&Xt(t,n,1),mt(e,!0,t)}function oi(e){var t=y(e)?e.length:E;return An(t)&&ko.call(e)==Y}function si(e){return e===!0||e===!1||y(e)&&ko.call(e)==$}function ai(e){return y(e)&&ko.call(e)==G}function li(e){return!!e&&1===e.nodeType&&y(e)&&ko.call(e).indexOf("Element")>-1}function ci(e){if(null==e)return!0;var t=e.length;return An(t)&&(sa(e)||bi(e)||oi(e)||y(e)&&la(e.splice))?!t:!ga(e).length}function ui(e,t,n,r){if(n="function"==typeof n&&Xt(n,r,3),!n&&Nn(e)&&Nn(t))return e===t;var i=n?n(e,t):E;return"undefined"==typeof i?Pt(e,t,n):!!i}function pi(e){return y(e)&&"string"==typeof e.message&&ko.call(e)==K}function fi(e){var t=typeof e;return"function"==t||!!e&&"object"==t}function hi(e,t,n,r){var i=ga(t),o=i.length;if(!o)return!0;if(null==e)return!1;if(n="function"==typeof n&&Xt(n,r,3),!n&&1==o){var s=i[0],a=t[s];if(Nn(a))return a===e[s]&&("undefined"!=typeof a||s in $n(e))}for(var l=vo(o),c=vo(o);o--;)a=l[o]=t[i[o]],c[o]=Nn(a);return It($n(e),i,l,c,n)}function di(e){return yi(e)&&e!=+e}function vi(e){return null==e?!1:ko.call(e)==X?Fo.test(jo.call(e)):y(e)&&Pe.test(e)}function mi(e){return null===e}function yi(e){
return"number"==typeof e||y(e)&&ko.call(e)==Z}function gi(e){return y(e)&&ko.call(e)==ee||!1}function bi(e){return"string"==typeof e||y(e)&&ko.call(e)==ne}function _i(e){return y(e)&&An(e.length)&&!!Ae[ko.call(e)]}function Si(e){return"undefined"==typeof e}function xi(e){var t=e?e.length:0;return An(t)?t?Xe(e):[]:ki(e)}function wi(e){return dt(e,Pi(e))}function Ti(e,t,n){var r=ms(e);return n&&Hn(e,t,n)&&(t=null),t?dt(t,r,ga(t)):r}function Ei(e){return Rt(e,Pi(e))}function Oi(e,t){return e?Mo.call(e,t):!1}function Ri(e,t,n){n&&Hn(e,t,n)&&(t=null);for(var r=-1,i=ga(e),o=i.length,s={};++r<o;){var a=i[r],l=e[a];t?Mo.call(s,l)?s[l].push(a):s[l]=[a]:s[l]=a}return s}function Pi(e){if(null==e)return[];fi(e)||(e=So(e));var t=e.length;t=t&&An(t)&&(sa(e)||vs.nonEnumArgs&&oi(e))&&t||0;for(var n=e.constructor,r=-1,i="function"==typeof n&&n.prototype===e,o=vo(t),s=t>0;++r<t;)o[r]=r+"";for(var a in e)s&&Fn(a,t)||"constructor"==a&&(i||!Mo.call(e,a))||o.push(a);return o}function ji(e,t,n){var r={};return t=jn(t,n,3),Et(e,function(e,n,i){r[n]=t(e,n,i)}),r}function Ii(e){for(var t=-1,n=ga(e),r=n.length,i=vo(r);++t<r;){var o=n[t];i[t]=[o,e[o]]}return i}function Mi(e,t,n){var r=null==e?E:e[t];return"undefined"==typeof r&&(r=n),la(r)?r.call(e):r}function Di(e,t,n,r){var i=sa(e)||_i(e);if(t=jn(t,r,4),null==n)if(i||fi(e)){var o=e.constructor;n=i?sa(e)?new o:[]:ms(la(o)&&o.prototype)}else n={};return(i?Je:Et)(e,function(e,r,i){return t(n,e,r,i)}),n}function ki(e){return Yt(e,ga(e))}function Ci(e){return Yt(e,Pi(e))}function Fi(e,t,n){return t=+t||0,"undefined"==typeof n?(n=t,t=0):n=+n||0,e>=t&&n>e}function Hi(e,t,n){n&&Hn(e,t,n)&&(t=n=null);var r=null==e,i=null==t;if(null==n&&(i&&"boolean"==typeof e?(n=e,e=1):"boolean"==typeof t&&(n=t,i=!0)),r&&i&&(t=1,i=!1),e=+e||0,i?(t=e,e=0):t=+t||0,n||e%1||t%1){var o=os();return ts(e+o*(t-e+parseFloat("1e-"+((o+"").length-1))),t)}return Lt(e,t)}function Li(e){return e=a(e),e&&e.charAt(0).toUpperCase()+e.slice(1)}function Ai(e){return e=a(e),e&&e.replace(je,h).replace(Te,"")}function Ni(e,t,n){e=a(e),t+="";var r=e.length;return n="undefined"==typeof n?r:ts(0>n?0:+n||0,r),n-=t.length,n>=0&&e.indexOf(t,n)==n}function Wi(e){return e=a(e),e&&_e.test(e)?e.replace(ge,d):e}function qi(e){return e=a(e),e&&De.test(e)?e.replace(Me,"\\$&"):e}function Ui(e,t,n){e=a(e),t=+t;var r=e.length;if(r>=t||!Zo(t))return e;var i=(t-r)/2,o=Wo(i),s=Ao(i);return n=Sn("",s,n),n.slice(0,o)+e+n}function Vi(e,t,n){return n&&Hn(e,t,n)&&(t=0),is(e,t)}function Bi(e,t){var n="";if(e=a(e),t=+t,1>t||!e||!Zo(t))return n;do t%2&&(n+=e),t=Wo(t/2),e+=e;while(t);return n}function Yi(e,t,n){return e=a(e),n=null==n?0:ts(0>n?0:+n||0,e.length),e.lastIndexOf(t,n)==n}function zi(e,n,r){var i=t.templateSettings;r&&Hn(e,n,r)&&(n=r=null),e=a(e),n=ft(ft({},r||n),i,pt);var o,s,l=ft(ft({},n.imports),i.imports,pt),c=ga(l),u=Yt(l,c),p=0,f=n.interpolate||Ie,h="__p += '",d=xo((n.escape||Ie).source+"|"+f.source+"|"+(f===we?Ee:Ie).source+"|"+(n.evaluate||Ie).source+"|$","g"),m="//# sourceURL="+("sourceURL"in n?n.sourceURL:"lodash.templateSources["+ ++Le+"]")+"\n";e.replace(d,function(t,n,r,i,a,l){return r||(r=i),h+=e.slice(p,l).replace(ke,v),n&&(o=!0,h+="' +\n__e("+n+") +\n'"),a&&(s=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),p=l+t.length,t}),h+="';\n";var y=n.variable;y||(h="with (obj) {\n"+h+"\n}\n"),h=(s?h.replace(de,""):h).replace(ve,"$1").replace(me,"$1;"),h="function("+(y||"obj")+") {\n"+(y?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var g=Pa(function(){return go(c,m+"return "+h).apply(E,u)});if(g.source=h,pi(g))throw g;return g}function $i(e,t,n){var r=e;return(e=a(e))?(n?Hn(r,t,n):null==t)?e.slice(S(e),x(e)+1):(t+="",e.slice(c(e,t),u(e,t)+1)):e}function Gi(e,t,n){var r=e;return e=a(e),e?e.slice((n?Hn(r,t,n):null==t)?S(e):c(e,t+"")):e}function Ki(e,t,n){var r=e;return e=a(e),e?(n?Hn(r,t,n):null==t)?e.slice(0,x(e)+1):e.slice(0,u(e,t+"")+1):e}function Xi(e,t,n){n&&Hn(e,t,n)&&(t=null);var r=H,i=L;if(null!=t)if(fi(t)){var o="separator"in t?t.separator:o;r="length"in t?+t.length||0:r,i="omission"in t?a(t.omission):i}else r=+t||0;if(e=a(e),r>=e.length)return e;var s=r-i.length;if(1>s)return i;var l=e.slice(0,s);if(null==o)return l+i;if(gi(o)){if(e.slice(s).search(o)){var c,u,p=e.slice(0,s);for(o.global||(o=xo(o.source,(Oe.exec(o)||"")+"g")),o.lastIndex=0;c=o.exec(p);)u=c.index;l=l.slice(0,null==u?s:u)}}else if(e.indexOf(o,s)!=s){var f=l.lastIndexOf(o);f>-1&&(l=l.slice(0,f))}return l+i}function Ji(e){return e=a(e),e&&be.test(e)?e.replace(ye,w):e}function Zi(e,t,n){return n&&Hn(e,t,n)&&(t=null),e=a(e),e.match(t||Ce)||[]}function Qi(e,t,n){return n&&Hn(e,t,n)&&(t=null),y(e)?no(e):vt(e,t)}function eo(e){return function(){return e}}function to(e){return e}function no(e){return Dt(mt(e,!0))}function ro(e,t){return kt(e+"",mt(t,!0))}function io(e,t,n){if(null==n){var r=fi(t),i=r&&ga(t),o=i&&i.length&&Rt(t,i);(o?o.length:r)||(o=!1,n=t,t=e,e=this)}o||(o=Rt(t,ga(t)));var s=!0,a=-1,l=la(e),c=o.length;n===!1?s=!1:fi(n)&&"chain"in n&&(s=n.chain);for(;++a<c;){var u=o[a],p=t[u];e[u]=p,l&&(e.prototype[u]=function(t){return function(){var n=this.__chain__;if(s||n){var r=e(this.__wrapped__),i=r.__actions__=Xe(this.__actions__);return i.push({func:t,args:arguments,thisArg:e}),r.__chain__=n,r}var o=[this.value()];return Uo.apply(o,arguments),t.apply(e,o)}}(p))}return e}function oo(){return e._=Co,this}function so(){}function ao(e){return Ht(e+"")}function lo(e){return function(t){return null==e?E:e[t]}}function co(e,t,n){n&&Hn(e,t,n)&&(t=n=null),e=+e||0,n=null==n?1:+n||0,null==t?(t=e,e=0):t=+t||0;for(var r=-1,i=es(Ao((t-e)/(n||1)),0),o=vo(i);++r<i;)o[r]=e,e+=n;return o}function uo(e,t,n){if(e=+e,1>e||!Zo(e))return[];var r=-1,i=vo(ts(e,ls));for(t=Xt(t,n,1);++r<e;)ls>r?i[r]=t(r):t(r);return i}function po(e){var t=++Do;return a(e)+t}function fo(e,t){return e+t}function ho(e,t,n){n&&Hn(e,t,n)&&(t=null);var r=jn(),i=null==t;return r===vt&&i||(i=!1,t=r(t,n,3)),i?ct(sa(e)?e:zn(e)):Vt(e,t)}e=e?Qe.defaults(Ze.Object(),e,Qe.pick(Ze,He)):Ze;var vo=e.Array,mo=e.Date,yo=e.Error,go=e.Function,bo=e.Math,_o=e.Number,So=e.Object,xo=e.RegExp,wo=e.String,To=e.TypeError,Eo=vo.prototype,Oo=So.prototype,Ro=wo.prototype,Po=(Po=e.window)&&Po.document,jo=go.prototype.toString,Io=Ht("length"),Mo=Oo.hasOwnProperty,Do=0,ko=Oo.toString,Co=e._,Fo=xo("^"+qi(ko).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ho=vi(Ho=e.ArrayBuffer)&&Ho,Lo=vi(Lo=Ho&&new Ho(0).slice)&&Lo,Ao=bo.ceil,No=e.clearTimeout,Wo=bo.floor,qo=vi(qo=So.getPrototypeOf)&&qo,Uo=Eo.push,Vo=Oo.propertyIsEnumerable,Bo=vi(Bo=e.Set)&&Bo,Yo=e.setTimeout,zo=Eo.splice,$o=vi($o=e.Uint8Array)&&$o,Go=vi(Go=e.WeakMap)&&Go,Ko=function(){try{var t=vi(t=e.Float64Array)&&t,n=new t(new Ho(10),0,1)&&t}catch(r){}return n}(),Xo=vi(Xo=vo.isArray)&&Xo,Jo=vi(Jo=So.create)&&Jo,Zo=e.isFinite,Qo=vi(Qo=So.keys)&&Qo,es=bo.max,ts=bo.min,ns=vi(ns=mo.now)&&ns,rs=vi(rs=_o.isFinite)&&rs,is=e.parseInt,os=bo.random,ss=_o.NEGATIVE_INFINITY,as=_o.POSITIVE_INFINITY,ls=bo.pow(2,32)-1,cs=ls-1,us=ls>>>1,ps=Ko?Ko.BYTES_PER_ELEMENT:0,fs=bo.pow(2,53)-1,hs=Go&&new Go,ds={},vs=t.support={};!function(e){vs.funcDecomp=/\bthis\b/.test(function(){return this}),vs.funcNames="string"==typeof go.name;try{vs.dom=11===Po.createDocumentFragment().nodeType}catch(t){vs.dom=!1}try{vs.nonEnumArgs=!Vo.call(arguments,1)}catch(t){vs.nonEnumArgs=!0}}(0,0),t.templateSettings={escape:Se,evaluate:xe,interpolate:we,variable:"",imports:{_:t}};var ms=function(){function t(){}return function(n){if(fi(n)){t.prototype=n;var r=new t;t.prototype=null}return r||e.Object()}}(),ys=nn(Et),gs=nn(Ot,!0),bs=rn(),_s=rn(!0),Ss=hs?function(e,t){return hs.set(e,t),e}:to;Lo||(Jt=Ho&&$o?function(e){var t=e.byteLength,n=Ko?Wo(t/ps):0,r=n*ps,i=new Ho(t);if(n){var o=new Ko(i,0,n);o.set(new Ko(e,0,n))}return t!=r&&(o=new $o(i,r),o.set(new $o(e,r))),i}:eo(null));var xs=Jo&&Bo?function(e){return new $e(e)}:eo(null),ws=hs?function(e){return hs.get(e)}:so,Ts=function(){return vs.funcNames?"constant"==eo.name?Ht("name"):function(e){for(var t=e.name,n=ds[t],r=n?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}:eo("")}(),Es=function(){var e=0,t=0;return function(n,r){var i=$s(),o=N-(i-t);if(t=i,o>0){if(++e>=A)return n}else e=0;return Ss(n,r)}}(),Os=Qr(function(e,t){return sa(e)||oi(e)?gt(e,wt(t,!1,!0)):[]}),Rs=pn(),Ps=pn(!0),js=Qr(function(e,t){e||(e=[]),t=wt(t);var n=t.length,i=ht(e,t);for(t.sort(r);n--;){var o=parseFloat(t[n]);if(o!=s&&Fn(o)){var s=o;zo.call(e,o,1)}}return i}),Is=wn(),Ms=wn(!0),Ds=Qr(function(e){return Bt(wt(e,!1,!0))}),ks=Qr(function(e,t){return sa(e)||oi(e)?gt(e,t):[]}),Cs=Qr(br),Fs=Qr(function(e,t){var n=e?e.length:0;return An(n)&&(e=zn(e)),ht(e,wt(t))}),Hs=en(function(e,t,n){Mo.call(e,n)?++e[n]:e[n]=1}),Ls=un(ys),As=un(gs,!0),Ns=dn(Je,ys),Ws=dn(et,gs),qs=en(function(e,t,n){Mo.call(e,n)?e[n].push(t):e[n]=[t]}),Us=en(function(e,t,n){e[n]=t}),Vs=Qr(function(e,t,n){var r=-1,i="function"==typeof t,o=e?e.length:0,s=An(o)?vo(o):[];return ys(e,function(e){var o=i?t:null!=e&&e[t];s[++r]=o?o.apply(e,n):E}),s}),Bs=en(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),Ys=bn(st,ys),zs=bn(at,gs),$s=ns||function(){return(new mo).getTime()},Gs=Qr(function(e,t,n){var r=R;if(n.length){var i=b(n,Gs.placeholder);r|=D}return Tn(e,r,t,n,i)}),Ks=Qr(function(e,t){t=t.length?wt(t):Ei(e);for(var n=-1,r=t.length;++n<r;){var i=t[n];e[i]=Tn(e[i],R,e)}return e}),Xs=Qr(function(e,t,n){var r=R|P;if(n.length){var i=b(n,Xs.placeholder);r|=D}return Tn(t,r,e,n,i)}),Js=ln(I),Zs=ln(M),Qs=Qr(function(e,t){return yt(e,1,t)}),ea=Qr(function(e,t,n){return yt(e,t,n)}),ta=hn(),na=hn(!0),ra=gn(D),ia=gn(k),oa=Qr(function(e,t){return Tn(e,F,null,null,null,wt(t))}),sa=Xo||function(e){return y(e)&&An(e.length)&&ko.call(e)==z};vs.dom||(li=function(e){return!!e&&1===e.nodeType&&y(e)&&!ca(e)});var aa=rs||function(e){return"number"==typeof e&&Zo(e)},la=s(/x/)||$o&&!s($o)?function(e){return ko.call(e)==X}:s,ca=qo?function(e){if(!e||ko.call(e)!=Q)return!1;var t=e.valueOf,n=vi(t)&&(n=qo(t))&&qo(n);return n?e==n||qo(e)==n:Bn(e)}:Bn,ua=tn(ft),pa=Qr(function(e){var t=e[0];return null==t?t:(e.push(ut),ua.apply(E,e))}),fa=fn(Et),ha=fn(Ot),da=vn(bs),va=vn(_s),ma=mn(Et),ya=mn(Ot),ga=Qo?function(e){if(e)var t=e.constructor,n=e.length;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&n&&An(n)?Yn(e):fi(e)?Qo(e):[]}:Yn,ba=tn(Ct),_a=Qr(function(e,t){if(null==e)return{};if("function"!=typeof t[0]){var t=rt(wt(t),wo);return qn(e,gt(Pi(e),t))}var n=Xt(t[0],t[1],3);return Un(e,function(e,t,r){return!n(e,t,r)})}),Sa=Qr(function(e,t){return null==e?{}:"function"==typeof t[0]?Un(e,Xt(t[0],t[1],3)):qn(e,wt(t))}),xa=sn(function(e,t,n){return t=t.toLowerCase(),e+(n?t.charAt(0).toUpperCase()+t.slice(1):t)}),wa=sn(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),Ta=yn(),Ea=yn(!0);8!=is(Fe+"08")&&(Vi=function(e,t,n){return(n?Hn(e,t,n):null==t)?t=0:t&&(t=+t),e=$i(e),is(e,t||(Re.test(e)?16:10))});var Oa=sn(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),Ra=sn(function(e,t,n){return e+(n?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))}),Pa=Qr(function(e,t){try{return e.apply(E,t)}catch(n){return pi(n)?n:new yo(n)}}),ja=cn(it),Ia=cn(ot,!0);return t.prototype=n.prototype,g.prototype=ms(n.prototype),g.prototype.constructor=g,J.prototype=ms(n.prototype),J.prototype.constructor=J,Ue.prototype["delete"]=Ve,Ue.prototype.get=Be,Ue.prototype.has=Ye,Ue.prototype.set=ze,$e.prototype.push=Ke,Xr.Cache=Ue,t.after=zr,t.ary=$r,t.assign=ua,t.at=Fs,t.before=Gr,t.bind=Gs,t.bindAll=Ks,t.bindKey=Xs,t.callback=Qi,t.chain=xr,t.chunk=Kn,t.compact=Xn,t.constant=eo,t.countBy=Hs,t.create=Ti,t.curry=Js,t.curryRight=Zs,t.debounce=Kr,t.defaults=pa,t.defer=Qs,t.delay=ea,t.difference=Os,t.drop=Jn,t.dropRight=Zn,t.dropRightWhile=Qn,t.dropWhile=er,t.fill=tr,t.filter=Dr,t.flatten=rr,t.flattenDeep=ir,t.flow=ta,t.flowRight=na,t.forEach=Ns,t.forEachRight=Ws,t.forIn=da,t.forInRight=va,t.forOwn=ma,t.forOwnRight=ya,t.functions=Ei,t.groupBy=qs,t.indexBy=Us,t.initial=sr,t.intersection=ar,t.invert=Ri,t.invoke=Vs,t.keys=ga,t.keysIn=Pi,t.map=Fr,t.mapValues=ji,t.matches=no,t.matchesProperty=ro,t.memoize=Xr,t.merge=ba,t.mixin=io,t.negate=Jr,t.omit=_a,t.once=Zr,t.pairs=Ii,t.partial=ra,t.partialRight=ia,t.partition=Bs,t.pick=Sa,t.pluck=Hr,t.property=ao,t.propertyOf=lo,t.pull=ur,t.pullAt=js,t.range=co,t.rearg=oa,t.reject=Lr,t.remove=pr,t.rest=fr,t.restParam=Qr,t.shuffle=Nr,t.slice=hr,t.sortBy=Ur,t.sortByAll=Vr,t.sortByOrder=Br,t.spread=ei,t.take=dr,t.takeRight=vr,t.takeRightWhile=mr,t.takeWhile=yr,t.tap=wr,t.throttle=ti,t.thru=Tr,t.times=uo,t.toArray=xi,t.toPlainObject=wi,t.transform=Di,t.union=Ds,t.uniq=gr,t.unzip=br,t.values=ki,t.valuesIn=Ci,t.where=Yr,t.without=ks,t.wrap=ni,t.xor=_r,t.zip=Cs,t.zipObject=Sr,t.backflow=na,t.collect=Fr,t.compose=na,t.each=Ns,t.eachRight=Ws,t.extend=ua,t.iteratee=Qi,t.methods=Ei,t.object=Sr,t.select=Dr,t.tail=fr,t.unique=gr,io(t,t),t.add=fo,t.attempt=Pa,t.camelCase=xa,t.capitalize=Li,t.clone=ri,t.cloneDeep=ii,t.deburr=Ai,t.endsWith=Ni,t.escape=Wi,t.escapeRegExp=qi,t.every=Mr,t.find=Ls,t.findIndex=Rs,t.findKey=fa,t.findLast=As,t.findLastIndex=Ps,t.findLastKey=ha,t.findWhere=kr,t.first=nr,t.has=Oi,t.identity=to,t.includes=Cr,t.indexOf=or,t.inRange=Fi,t.isArguments=oi,t.isArray=sa,t.isBoolean=si,t.isDate=ai,t.isElement=li,t.isEmpty=ci,t.isEqual=ui,t.isError=pi,t.isFinite=aa,t.isFunction=la,t.isMatch=hi,t.isNaN=di,t.isNative=vi,t.isNull=mi,t.isNumber=yi,t.isObject=fi,t.isPlainObject=ca,t.isRegExp=gi,t.isString=bi,t.isTypedArray=_i,t.isUndefined=Si,t.kebabCase=wa,t.last=lr,t.lastIndexOf=cr,t.max=ja,t.min=Ia,t.noConflict=oo,t.noop=so,t.now=$s,t.pad=Ui,t.padLeft=Ta,t.padRight=Ea,t.parseInt=Vi,t.random=Hi,t.reduce=Ys,t.reduceRight=zs,t.repeat=Bi,t.result=Mi,t.runInContext=T,t.size=Wr,t.snakeCase=Oa,t.some=qr,t.sortedIndex=Is,t.sortedLastIndex=Ms,t.startCase=Ra,t.startsWith=Yi,t.sum=ho,t.template=zi,t.trim=$i,t.trimLeft=Gi,t.trimRight=Ki,t.trunc=Xi,t.unescape=Ji,t.uniqueId=po,t.words=Zi,t.all=Mr,t.any=qr,t.contains=Cr,t.detect=Ls,t.foldl=Ys,t.foldr=zs,t.head=nr,t.include=Cr,t.inject=Ys,io(t,function(){var e={};return Et(t,function(n,r){t.prototype[r]||(e[r]=n)}),e}(),!1),t.sample=Ar,t.prototype.sample=function(e){return this.__chain__||null!=e?this.thru(function(t){return Ar(t,e)}):Ar(this.value())},t.VERSION=O,Je(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){t[e].placeholder=t}),Je(["dropWhile","filter","map","takeWhile"],function(e,t){var n=t!=U,r=t==W;J.prototype[e]=function(e,i){var o=this.__filtered__,s=o&&r?new J(this):this.clone(),a=s.__iteratees__||(s.__iteratees__=[]);return a.push({done:!1,count:0,index:0,iteratee:jn(e,i,1),limit:-1,type:t}),s.__filtered__=o||n,s}}),Je(["drop","take"],function(e,t){var n=e+"While";J.prototype[e]=function(n){var r=this.__filtered__,i=r&&!t?this.dropWhile():this.clone();if(n=null==n?1:es(Wo(n)||0,0),r)t?i.__takeCount__=ts(i.__takeCount__,n):lr(i.__iteratees__).limit=n;else{var o=i.__views__||(i.__views__=[]);o.push({size:n,type:e+(i.__dir__<0?"Right":"")})}return i},J.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()},J.prototype[e+"RightWhile"]=function(e,t){return this.reverse()[n](e,t).reverse()}}),Je(["first","last"],function(e,t){var n="take"+(t?"Right":"");J.prototype[e]=function(){return this[n](1).value()[0]}}),Je(["initial","rest"],function(e,t){var n="drop"+(t?"":"Right");J.prototype[e]=function(){return this[n](1)}}),Je(["pluck","where"],function(e,t){var n=t?"filter":"map",r=t?Dt:Ht;J.prototype[e]=function(e){return this[n](r(e))}}),J.prototype.compact=function(){return this.filter(to)},J.prototype.reject=function(e,t){return e=jn(e,t,1),this.filter(function(t){return!e(t)})},J.prototype.slice=function(e,t){e=null==e?0:+e||0;var n=0>e?this.takeRight(-e):this.drop(e);return"undefined"!=typeof t&&(t=+t||0,n=0>t?n.dropRight(-t):n.take(t-e)),n},J.prototype.toArray=function(){return this.drop(0)},Et(J.prototype,function(e,n){var r=t[n];if(r){var i=/^(?:filter|map|reject)|While$/.test(n),o=/^(?:first|last)$/.test(n);t.prototype[n]=function(){var n=arguments,s=(n.length,this.__chain__),a=this.__wrapped__,l=!!this.__actions__.length,c=a instanceof J,u=n[0],p=c||sa(a);p&&i&&"function"==typeof u&&1!=u.length&&(c=p=!1);var f=c&&!l;if(o&&!s)return f?e.call(a):r.call(t,this.value());var h=function(e){var i=[e];return Uo.apply(i,n),r.apply(t,i)};if(p){var d=f?a:new J(this),v=e.apply(d,n);if(!o&&(l||v.__actions__)){var m=v.__actions__||(v.__actions__=[]);m.push({func:Tr,args:[h],thisArg:t})}return new g(v,s)}return this.thru(h)}}}),Je(["concat","join","pop","push","replace","shift","sort","splice","split","unshift"],function(e){var n=(/^(?:replace|split)$/.test(e)?Ro:Eo)[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:join|pop|replace|shift)$/.test(e);t.prototype[e]=function(){var e=arguments;return i&&!this.__chain__?n.apply(this.value(),e):this[r](function(t){return n.apply(t,e)})}}),Et(J.prototype,function(e,n){var r=t[n];if(r){var i=r.name,o=ds[i]||(ds[i]=[]);o.push({name:n,func:r})}}),ds[_n(null,P).name]=[{name:"wrapper",func:null}],J.prototype.clone=te,J.prototype.reverse=re,J.prototype.value=qe,t.prototype.chain=Er,t.prototype.commit=Or,t.prototype.plant=Rr,t.prototype.reverse=Pr,t.prototype.toString=jr,t.prototype.run=t.prototype.toJSON=t.prototype.valueOf=t.prototype.value=Ir,t.prototype.collect=t.prototype.map,t.prototype.head=t.prototype.first,t.prototype.select=t.prototype.filter,t.prototype.tail=t.prototype.rest,t}var E,O="3.6.0",R=1,P=2,j=4,I=8,M=16,D=32,k=64,C=128,F=256,H=30,L="...",A=150,N=16,W=0,q=1,U=2,V="Expected a function",B="__lodash_placeholder__",Y="[object Arguments]",z="[object Array]",$="[object Boolean]",G="[object Date]",K="[object Error]",X="[object Function]",J="[object Map]",Z="[object Number]",Q="[object Object]",ee="[object RegExp]",te="[object Set]",ne="[object String]",re="[object WeakMap]",ie="[object ArrayBuffer]",oe="[object Float32Array]",se="[object Float64Array]",ae="[object Int8Array]",le="[object Int16Array]",ce="[object Int32Array]",ue="[object Uint8Array]",pe="[object Uint8ClampedArray]",fe="[object Uint16Array]",he="[object Uint32Array]",de=/\b__p \+= '';/g,ve=/\b(__p \+=) '' \+/g,me=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ye=/&(?:amp|lt|gt|quot|#39|#96);/g,ge=/[&<>"'`]/g,be=RegExp(ye.source),_e=RegExp(ge.source),Se=/<%-([\s\S]+?)%>/g,xe=/<%([\s\S]+?)%>/g,we=/<%=([\s\S]+?)%>/g,Te=/[\u0300-\u036f\ufe20-\ufe23]/g,Ee=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Oe=/\w*$/,Re=/^0[xX]/,Pe=/^\[object .+?Constructor\]$/,je=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Ie=/($^)/,Me=/[.*+?^${}()|[\]\/\\]/g,De=RegExp(Me.source),ke=/['\n\r\u2028\u2029\\]/g,Ce=function(){var e="[A-Z\\xc0-\\xd6\\xd8-\\xde]",t="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(e+"+(?="+e+t+")|"+e+"?"+t+"|"+e+"+|[0-9]+","g")}(),Fe=" 	\f \ufeff\n\r\u2028\u2029 ᠎             　",He=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","document","isFinite","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","window"],Le=-1,Ae={};Ae[oe]=Ae[se]=Ae[ae]=Ae[le]=Ae[ce]=Ae[ue]=Ae[pe]=Ae[fe]=Ae[he]=!0,Ae[Y]=Ae[z]=Ae[ie]=Ae[$]=Ae[G]=Ae[K]=Ae[X]=Ae[J]=Ae[Z]=Ae[Q]=Ae[ee]=Ae[te]=Ae[ne]=Ae[re]=!1;var Ne={};Ne[Y]=Ne[z]=Ne[ie]=Ne[$]=Ne[G]=Ne[oe]=Ne[se]=Ne[ae]=Ne[le]=Ne[ce]=Ne[Z]=Ne[Q]=Ne[ee]=Ne[ne]=Ne[ue]=Ne[pe]=Ne[fe]=Ne[he]=!0,Ne[K]=Ne[X]=Ne[J]=Ne[te]=Ne[re]=!1;var We={leading:!1,maxWait:0,trailing:!1},qe={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},Ue={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Ve={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Be={"function":!0,object:!0},Ye={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ze=Be[typeof n]&&n&&!n.nodeType&&n,$e=Be[typeof t]&&t&&!t.nodeType&&t,Ge=ze&&$e&&"object"==typeof e&&e,Ke=Be[typeof self]&&self&&self.Object&&self,Xe=Be[typeof window]&&window&&window.Object&&window,Je=$e&&$e.exports===ze&&ze,Ze=Ge||Xe!==(this&&this.window)&&Xe||Ke||this,Qe=T();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Ze._=Qe,define(function(){return Qe})):ze&&$e?Je?($e.exports=Qe)._=Qe:ze._=Qe:Ze._=Qe}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,n){(function(e){!function(e,n,r){n[e]=n[e]||r(),"undefined"!=typeof t&&t.exports?t.exports=n[e]:"function"==typeof define&&define.amd&&define(function(){return n[e]})}("Promise","undefined"!=typeof e?e:this,function(){"use strict";function e(e,t){f.add(e,t),p||(p=d(f.drain))}function t(e){var t,n=typeof e;return null==e||"object"!=n&&"function"!=n||(t=e.then),"function"==typeof t?t:!1}function n(){for(var e=0;e<this.chain.length;e++)r(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function r(e,n,r){var i,o;try{n===!1?r.reject(e.msg):(i=n===!0?e.msg:n.call(void 0,e.msg),i===r.promise?r.reject(TypeError("Promise-chain cycle")):(o=t(i))?o.call(i,r.resolve,r.reject):r.resolve(i))}catch(s){r.reject(s)}}function i(r){var s,l,c=this;if(!c.triggered){c.triggered=!0,c.def&&(c=c.def);try{(s=t(r))?(l=new a(c),s.call(r,function(){i.apply(l,arguments)},function(){o.apply(l,arguments)})):(c.msg=r,c.state=1,c.chain.length>0&&e(n,c))}catch(u){o.call(l||new a(c),u)}}}function o(t){var r=this;r.triggered||(r.triggered=!0,r.def&&(r=r.def),r.msg=t,r.state=2,r.chain.length>0&&e(n,r))}function s(e,t,n,r){for(var i=0;i<t.length;i++)!function(i){e.resolve(t[i]).then(function(e){n(i,e)},r)}(i)}function a(e){this.def=e,this.triggered=!1}function l(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function c(t){if("function"!=typeof t)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var r=new l(this);this.then=function(t,i){var o={success:"function"==typeof t?t:!0,failure:"function"==typeof i?i:!1};return o.promise=new this.constructor(function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");o.resolve=e,o.reject=t}),r.chain.push(o),0!==r.state&&e(n,r),o.promise},this["catch"]=function(e){return this.then(void 0,e)};try{t.call(void 0,function(e){i.call(r,e)},function(e){o.call(r,e)})}catch(s){o.call(r,s)}}var u,p,f,h=Object.prototype.toString,d="undefined"!=typeof setImmediate?function(e){return setImmediate(e)}:setTimeout;try{Object.defineProperty({},"x",{}),u=function(e,t,n,r){return Object.defineProperty(e,t,{value:n,writable:!0,configurable:r!==!1})}}catch(v){u=function(e,t,n){return e[t]=n,e}}f=function(){function e(e,t){this.fn=e,this.self=t,this.next=void 0}var t,n,r;return{add:function(i,o){r=new e(i,o),n?n.next=r:t=r,n=r,r=void 0},drain:function(){var e=t;for(t=n=p=void 0;e;)e.fn.call(e.self),e=e.next}}}();var m=u({},"constructor",c,!1);return u(c,"prototype",m,!1),u(m,"__NPO__",0,!1),u(c,"resolve",function(e){var t=this;return e&&"object"==typeof e&&1===e.__NPO__?e:new t(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");t(e)})}),u(c,"reject",function(e){return new this(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");n(e)})}),u(c,"all",function(e){var t=this;return"[object Array]"!=h.call(e)?t.reject(TypeError("Not an array")):0===e.length?t.resolve([]):new t(function(n,r){if("function"!=typeof n||"function"!=typeof r)throw TypeError("Not a function");var i=e.length,o=Array(i),a=0;s(t,e,function(e,t){o[e]=t,++a===i&&n(o)},r)})}),u(c,"race",function(e){var t=this;return"[object Array]"!=h.call(e)?t.reject(TypeError("Not an array")):new t(function(n,r){if("function"!=typeof n||"function"!=typeof r)throw TypeError("Not a function");s(t,e,function(e,t){n(t)},r)})}),c})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,n){t.exports=e("./src")},{"./src":17}],6:[function(e,t,n){t.exports={}},{}],7:[function(e,t,n){n.createdStores=[],n.createdActions=[],n.reset=function(){for(;n.createdStores.length;)n.createdStores.pop();for(;n.createdActions.length;)n.createdActions.pop()}},{}],8:[function(e,t,n){var r=e("./utils"),i=e("./joins").instanceJoinCreator,o=function(e){for(var t,n=0,r={};n<(e.children||[]).length;++n)t=e.children[n],e[t]&&(r[t]=e[t]);return r},s=function(e){var t={};for(var n in e){var i=e[n],a=o(i),l=s(a);t[n]=i;for(var c in l){var u=l[c];t[n+r.capitalize(c)]=u}}return t};t.exports={hasListener:function(e){for(var t,n,r,i=0;i<(this.subscriptions||[]).length;++i)for(r=[].concat(this.subscriptions[i].listenable),t=0;t<r.length;t++)if(n=r[t],n===e||n.hasListener&&n.hasListener(e))return!0;return!1},listenToMany:function(e){var t=s(e);for(var n in t){var i=r.callbackName(n),o=this[i]?i:this[n]?n:void 0;o&&this.listenTo(t[n],o,this[i+"Default"]||this[o+"Default"]||o)}},validateListening:function(e){return e===this?"Listener is not able to listen to itself":r.isFunction(e.listen)?e.hasListener&&e.hasListener(this)?"Listener cannot listen to this listenable because of circular loop":void 0:e+" is missing a listen method"},listenTo:function(e,t,n){var i,o,s,a=this.subscriptions=this.subscriptions||[];return r.throwIf(this.validateListening(e)),this.fetchInitialState(e,n),i=e.listen(this[t]||t,this),o=function(){var e=a.indexOf(s);r.throwIf(-1===e,"Tried to remove listen already gone from subscriptions list!"),a.splice(e,1),i()},s={stop:o,listenable:e},a.push(s),s},stopListeningTo:function(e){for(var t,n=0,i=this.subscriptions||[];n<i.length;n++)if(t=i[n],t.listenable===e)return t.stop(),r.throwIf(-1!==i.indexOf(t),"Failed to remove listen from subscriptions list!"),!0;return!1},stopListeningToAll:function(){for(var e,t=this.subscriptions||[];e=t.length;)t[0].stop(),r.throwIf(t.length!==e-1,"Failed to remove listen from subscriptions list!")},fetchInitialState:function(e,t){t=t&&this[t]||t;var n=this;if(r.isFunction(t)&&r.isFunction(e.getInitialState)){var i=e.getInitialState();i&&r.isFunction(i.then)?i.then(function(){t.apply(n,arguments)}):t.call(this,i)}},joinTrailing:i("last"),joinLeading:i("first"),joinConcat:i("all"),joinStrict:i("strict")}},{"./joins":18,"./utils":22}],9:[function(e,t,n){var r=e("./utils"),i=e("./ListenerMethods");t.exports=r.extend({componentWillUnmount:i.stopListeningToAll},i)},{"./ListenerMethods":8,"./utils":22}],10:[function(e,t,n){var r=e("./utils");t.exports={preEmit:function(){},shouldEmit:function(){return!0},listen:function(e,t){t=t||this;var n=function(n){i||e.apply(t,n)},r=this,i=!1;return this.emitter.addListener(this.eventLabel,n),function(){i=!0,r.emitter.removeListener(r.eventLabel,n)}},promise:function(e){var t=this,n=this.children.indexOf("completed")>=0&&this.children.indexOf("failed")>=0;if(!n)throw new Error('Publisher must have "completed" and "failed" child publishers');e.then(function(e){return t.completed(e)},function(e){return t.failed(e)})},listenAndPromise:function(e,t){var n=this;t=t||this,this.willCallPromise=(this.willCallPromise||0)+1;var r=this.listen(function(){if(!e)throw new Error("Expected a function returning a promise but got "+e);var r=arguments,i=e.apply(t,r);return n.promise.call(n,i)},t);return function(){n.willCallPromise--,r.call(n)}},trigger:function(){var e=arguments,t=this.preEmit.apply(this,e);e=void 0===t?e:r.isArguments(t)?t:[].concat(t),this.shouldEmit.apply(this,e)&&this.emitter.emit(this.eventLabel,e)},triggerAsync:function(){var e=arguments,t=this;r.nextTick(function(){t.trigger.apply(t,e)})},triggerPromise:function(){var e=this,t=arguments,n=this.children.indexOf("completed")>=0&&this.children.indexOf("failed")>=0,i=r.createPromise(function(i,o){if(e.willCallPromise)return void r.nextTick(function(){var n=e.promise;e.promise=function(t){return t.then(i,o),e.promise=n,e.promise.apply(e,arguments)},e.trigger.apply(e,t)});if(n)var s=e.completed.listen(function(e){s(),a(),i(e)}),a=e.failed.listen(function(e){s(),a(),o(e)});e.triggerAsync.apply(e,t),n||i()});return i}}},{"./utils":22}],11:[function(e,t,n){t.exports={}},{}],12:[function(e,t,n){t.exports=function(e,t){for(var n in t)if(Object.getOwnPropertyDescriptor&&Object.defineProperty){var r=Object.getOwnPropertyDescriptor(t,n);if(!r.value||"function"!=typeof r.value||!t.hasOwnProperty(n))continue;e[n]=t[n].bind(e)}else{var i=t[n];if("function"!=typeof i||!t.hasOwnProperty(n))continue;e[n]=i.bind(e)}return e}},{}],13:[function(e,t,n){var r=e("./index"),i=e("./utils");t.exports=function(e,t){return{getInitialState:function(){return i.isFunction(e.getInitialState)?void 0===t?e.getInitialState():i.object([t],[e.getInitialState()]):{}},componentDidMount:function(){i.extend(this,r.ListenerMethods);var n=this,o=void 0===t?this.setState:function(e){n.setState(i.object([t],[e]))};this.listenTo(e,o)},componentWillUnmount:r.ListenerMixin.componentWillUnmount}}},{"./index":17,"./utils":22}],14:[function(e,t,n){var r=e("./index"),i=e("./utils");t.exports=function(e,t,n){return n=i.isFunction(t)?t:n,{getInitialState:function(){if(i.isFunction(e.getInitialState)){if(i.isFunction(t))return n.call(this,e.getInitialState());var r=n.call(this,e.getInitialState());return r?i.object([t],[r]):{}}return{}},componentDidMount:function(){i.extend(this,r.ListenerMethods);var o=this,s=function(e){if(i.isFunction(t))o.setState(n.call(o,e));else{var r=n.call(o,e);o.setState(i.object([t],[r]))}};this.listenTo(e,s)},componentWillUnmount:r.ListenerMixin.componentWillUnmount}}},{"./index":17,"./utils":22}],15:[function(e,t,n){var r=e("./utils"),i=e("./index"),o=e("./Keep"),s={preEmit:1,shouldEmit:1},a=function(e){e=e||{},r.isObject(e)||(e={actionName:e});for(var t in i.ActionMethods)if(!s[t]&&i.PublisherMethods[t])throw new Error("Cannot override API method "+t+" in Reflux.ActionMethods. Use another method name or override it on Reflux.PublisherMethods instead.");for(var n in e)if(!s[n]&&i.PublisherMethods[n])throw new Error("Cannot override API method "+n+" in action creation. Use another method name or override it on Reflux.PublisherMethods instead.");e.children=e.children||[],e.asyncResult&&(e.children=e.children.concat(["completed","failed"]));for(var l=0,c={};l<e.children.length;l++){var u=e.children[l];c[u]=a(u)}var p=r.extend({eventLabel:"action",emitter:new r.EventEmitter,_isAction:!0},i.PublisherMethods,i.ActionMethods,e),f=function(){return f[f.sync?"trigger":"triggerPromise"].apply(f,arguments)};return r.extend(f,c,p),o.createdActions.push(f),f};t.exports=a},{"./Keep":7,"./index":17,"./utils":22}],16:[function(e,t,n){var r=e("./utils"),i=e("./index"),o=e("./Keep"),s=e("./mixer"),a={preEmit:1,shouldEmit:1},l=e("./bindMethods");t.exports=function(e){function t(){var t,n=0;if(this.subscriptions=[],this.emitter=new r.EventEmitter,this.eventLabel="change",l(this,e),this.init&&r.isFunction(this.init)&&this.init(),this.listenables)for(t=[].concat(this.listenables);n<t.length;n++)this.listenToMany(t[n])}e=e||{};for(var n in i.StoreMethods)if(!a[n]&&(i.PublisherMethods[n]||i.ListenerMethods[n]))throw new Error("Cannot override API method "+n+" in Reflux.StoreMethods. Use another method name or override it on Reflux.PublisherMethods / Reflux.ListenerMethods instead.");for(var c in e)if(!a[c]&&(i.PublisherMethods[c]||i.ListenerMethods[c]))throw new Error("Cannot override API method "+c+" in store creation. Use another method name or override it on Reflux.PublisherMethods / Reflux.ListenerMethods instead.");
e=s(e),r.extend(t.prototype,i.ListenerMethods,i.PublisherMethods,i.StoreMethods,e);var u=new t;return o.createdStores.push(u),u}},{"./Keep":7,"./bindMethods":12,"./index":17,"./mixer":21,"./utils":22}],17:[function(e,t,n){n.ActionMethods=e("./ActionMethods"),n.ListenerMethods=e("./ListenerMethods"),n.PublisherMethods=e("./PublisherMethods"),n.StoreMethods=e("./StoreMethods"),n.createAction=e("./createAction"),n.createStore=e("./createStore"),n.connect=e("./connect"),n.connectFilter=e("./connectFilter"),n.ListenerMixin=e("./ListenerMixin"),n.listenTo=e("./listenTo"),n.listenToMany=e("./listenToMany");var r=e("./joins").staticJoinCreator;n.joinTrailing=n.all=r("last"),n.joinLeading=r("first"),n.joinStrict=r("strict"),n.joinConcat=r("all");var i=e("./utils");n.EventEmitter=i.EventEmitter,n.Promise=i.Promise,n.createActions=function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var o=e[r],s=i.isObject(o)?r:o;t[s]=n.createAction(o)}return t},n.setEventEmitter=function(t){var r=e("./utils");n.EventEmitter=r.EventEmitter=t},n.setPromise=function(t){var r=e("./utils");n.Promise=r.Promise=t},n.setPromiseFactory=function(t){var n=e("./utils");n.createPromise=t},n.nextTick=function(t){var n=e("./utils");n.nextTick=t},n.__keep=e("./Keep"),Function.prototype.bind||console.error("Function.prototype.bind not available. ES5 shim required. https://github.com/spoike/refluxjs#es5")},{"./ActionMethods":6,"./Keep":7,"./ListenerMethods":8,"./ListenerMixin":9,"./PublisherMethods":10,"./StoreMethods":11,"./connect":13,"./connectFilter":14,"./createAction":15,"./createStore":16,"./joins":18,"./listenTo":19,"./listenToMany":20,"./utils":22}],18:[function(e,t,n){function r(e,t,n){return function(){var r,i=n.subscriptions,o=i?i.indexOf(e):-1;for(l.throwIf(-1===o,"Tried to remove join already gone from subscriptions list!"),r=0;r<t.length;r++)t[r]();i.splice(o,1)}}function i(e){e.listenablesEmitted=new Array(e.numberOfListenables),e.args=new Array(e.numberOfListenables)}function o(e,t){return function(){var n=a.call(arguments);if(t.listenablesEmitted[e])switch(t.strategy){case"strict":throw new Error("Strict join failed because listener triggered twice.");case"last":t.args[e]=n;break;case"all":t.args[e].push(n)}else t.listenablesEmitted[e]=!0,t.args[e]="all"===t.strategy?[n]:n;s(t)}}function s(e){for(var t=0;t<e.numberOfListenables;t++)if(!e.listenablesEmitted[t])return;e.callback.apply(e.listener,e.args),i(e)}var a=Array.prototype.slice,l=e("./utils"),c=e("./createStore"),u={strict:"joinStrict",first:"joinLeading",last:"joinTrailing",all:"joinConcat"};n.staticJoinCreator=function(e){return function(){var t=a.call(arguments);return c({init:function(){this[u[e]].apply(this,t.concat("triggerAsync"))}})}},n.instanceJoinCreator=function(e){return function(){l.throwIf(arguments.length<3,"Cannot create a join with less than 2 listenables!");var t,n,s=a.call(arguments),c=s.pop(),u=s.length,p={numberOfListenables:u,callback:this[c]||c,listener:this,strategy:e},f=[];for(t=0;u>t;t++)l.throwIf(this.validateListening(s[t]));for(t=0;u>t;t++)f.push(s[t].listen(o(t,p),this));return i(p),n={listenable:s},n.stop=r(n,f,this),this.subscriptions=(this.subscriptions||[]).concat(n),n}}},{"./createStore":16,"./utils":22}],19:[function(e,t,n){var r=e("./index");t.exports=function(e,t,n){return{componentDidMount:function(){for(var i in r.ListenerMethods)if(this[i]!==r.ListenerMethods[i]){if(this[i])throw"Can't have other property '"+i+"' when using Reflux.listenTo!";this[i]=r.ListenerMethods[i]}this.listenTo(e,t,n)},componentWillUnmount:r.ListenerMethods.stopListeningToAll}}},{"./index":17}],20:[function(e,t,n){var r=e("./index");t.exports=function(e){return{componentDidMount:function(){for(var t in r.ListenerMethods)if(this[t]!==r.ListenerMethods[t]){if(this[t])throw"Can't have other property '"+t+"' when using Reflux.listenToMany!";this[t]=r.ListenerMethods[t]}this.listenToMany(e)},componentWillUnmount:r.ListenerMethods.stopListeningToAll}}},{"./index":17}],21:[function(e,t,n){var r=e("./utils");t.exports=function(e){var t={init:[],preEmit:[],shouldEmit:[]},n=function i(e){var n={};return e.mixins&&e.mixins.forEach(function(e){r.extend(n,i(e))}),r.extend(n,e),Object.keys(t).forEach(function(n){e.hasOwnProperty(n)&&t[n].push(e[n])}),n}(e);return t.init.length>1&&(n.init=function(){var e=arguments;t.init.forEach(function(t){t.apply(this,e)},this)}),t.preEmit.length>1&&(n.preEmit=function(){return t.preEmit.reduce(function(e,t){var n=t.apply(this,e);return void 0===n?e:[n]}.bind(this),arguments)}),t.shouldEmit.length>1&&(n.shouldEmit=function(){var e=arguments;return!t.shouldEmit.some(function(t){return!t.apply(this,e)},this)}),Object.keys(t).forEach(function(e){1===t[e].length&&(n[e]=t[e][0])}),n}},{"./utils":22}],22:[function(e,t,n){var r=n.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e};n.extend=function(e){if(!r(e))return e;for(var t,n,i=1,o=arguments.length;o>i;i++){t=arguments[i];for(n in t)if(Object.getOwnPropertyDescriptor&&Object.defineProperty){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,s)}else e[n]=t[n]}return e},n.isFunction=function(e){return"function"==typeof e},n.EventEmitter=e("eventemitter3"),n.nextTick=function(e){setTimeout(e,0)},n.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},n.callbackName=function(e){return"on"+n.capitalize(e)},n.object=function(e,t){for(var n={},r=0;r<e.length;r++)n[e[r]]=t[r];return n},n.Promise=e("native-promise-only"),n.createPromise=function(e){return new n.Promise(e)},n.isArguments=function(e){return"object"==typeof e&&"callee"in e&&"number"==typeof e.length},n.throwIf=function(e,t){if(e)throw Error(t||e)}},{eventemitter3:2,"native-promise-only":4}],23:[function(e,t,n){var r=e("reflux"),i=r.createActions(["handleHotspotClick","handleHotspotMouseEnter","handleHotspotMouseLeave","activateHotspot","handleCloseOverlay","maintainScrollPosition","setMobileScreenViewport","setCurrentScroll","triggerComplexOverlay","updateSimpleOverlay","setScreenViewerPosition","handleTourPointClick","handleTourPointMouseEnter","handleTourPointMouseLeave","angularLocationChange","angularToggleConfigMenu","angularDoTransition","angularNavigateFromScreensViewerNav"]);t.exports=i},{reflux:5}],24:[function(e,t,n){var r=e("reflux"),i=r.createActions(["setSelectedTourPoint","disableTourPoints"]);t.exports=i},{reflux:5}],25:[function(e,t,n){var r=e("classnames"),i=e("../mixins/mobile-mixin.js"),o=e("./Hotspots.jsx"),s=e("./TourPoints.jsx"),a=React.createClass({displayName:"FixedElement",propTypes:{displayScale:React.PropTypes.number.isRequired,isOverlayOpen:React.PropTypes.bool.isRequired,screen:React.PropTypes.object.isRequired,isOverlayScreen:React.PropTypes.bool,overlayMeta:React.PropTypes.object,disableHotspotFlash:React.PropTypes.bool,isMobile:React.PropTypes.bool,tourPoints:React.PropTypes.object,type:React.PropTypes.string},mixins:[i],getInitialState:function(){return{isBrowserTooSmall:!1}},componentDidMount:function(){window.addEventListener("resize",this.handleResize),window.addEventListener("scroll",this.handleScroll),this.init()},componentWillUnmount:function(){window.removeEventListener("resize",this.handleResize),window.removeEventListener("scroll",this.handleScroll)},componentDidUpdate:function(e,t){this.syncAlignment()},render:function(){var e=this.props.isMobile,t=this.props.screen,n=this.props.displayScale,i=this.props.isOverlayOpen,a=this.props.type,l=this.props.isOverlayScreen,c=this.props.overlayMeta,u="header"===a?t.fixedHeaderHeight:t.fixedFooterHeight,p=u;u=this.formatWithDisplayScale(u);var f=this.formatWithDisplayScale(t.width),h=this.formatWithDisplayScale(t.height),d=r("fixed-element",a),v={height:u,width:f,backgroundImage:'url("'+t.imageUrl+'")',backgroundSize:"cover",backgroundRepeat:"no-repeat"},m={height:h,width:f};return React.createElement("div",{className:d,style:v},React.createElement("div",{className:"fixed-element-inner",ref:"fixedElementInner",style:m},React.createElement(o,{isMobile:e,hotspots:t.hotspots,displayScale:n,isOverlayOpen:i,disableHotspotFlash:this.props.disableHotspotFlash,height:p,width:t.width,isOverlayScreen:l,overlayMeta:c,style:{},isInFixedElement:!0}),React.createElement(s,{tourPoints:this.props.tourPoints,screen:t,displayScale:n,isInFixedHeader:"header"===a,isInFixedFooter:"footer"===a})))},_isBrowserTooSmall:function(){return window.innerWidth<this.formatWithDisplayScale(this.props.screen.width)},handleResize:function(){!this.state.isBrowserTooSmall&&this._isBrowserTooSmall()&&this.setState({isBrowserTooSmall:!0}),this.state.isBrowserTooSmall&&!this._isBrowserTooSmall()&&this.setState({isBrowserTooSmall:!1}),this.syncAlignment()},handleScroll:function(){this.syncAlignment()},syncAlignment:function(){if(this.props.isMobile!==!0){var e=ReactDOM.findDOMNode(this),t=e.parentNode,n=t.getBoundingClientRect();e.style.left=n.left+"px"}},init:function(){this.handleResize(),this.handleScroll()}});t.exports=a},{"../mixins/mobile-mixin.js":43,"./Hotspots.jsx":27,"./TourPoints.jsx":39,classnames:1}],26:[function(e,t,n){var r=e("lodash"),i=e("classnames"),o=React.addons.PureRenderMixin,s=e("../constants/hotspot.js"),a=e("../helpers/hotspot-helper.js"),l=e("../mixins/mobile-mixin.js"),c=e("../actions/screen-viewer-actions.js"),u=React.createClass({displayName:"Hotspot",mixins:[l,o],propTypes:{displayScale:React.PropTypes.number.isRequired,hotspot:React.PropTypes.object.isRequired,fixedOffset:React.PropTypes.number,isInFixedElement:React.PropTypes.bool,isOverlayOpen:React.PropTypes.bool,overlayType:React.PropTypes.string,overlayOffsets:React.PropTypes.object,style:React.PropTypes.object},getDefaultProps:function(){return{overlayOffsets:null}},_shouldIgnoreHoverEvent:function(e){var t=e.relatedTarget||e.fromElement,n=e.relatedTarget||e.toElement;return $(t).hasClass("hotspot")&&$(n).hasClass("hotspot")?!0:"simple"===this.props.overlayType?!1:!1},_setupHoverEvents:function(){var e=ReactDOM.findDOMNode(this);e.addEventListener("mouseenter",this.handleMouseEnter),e.addEventListener("mouseleave",this.handleMouseLeave)},_removeHoverEvents:function(){var e=ReactDOM.findDOMNode(this);e.removeEventListener("mouseenter",this.handleMouseEnter),e.removeEventListener("mouseleave",this.handleMouseLeave)},handleClick:function(){return"simple"===this.props.overlayType&&this.props.hotspot.targetTypeID!==s.TARGET_TYPES.externalUrl&&this.props.hotspot.targetTypeID!==s.TARGET_TYPES.positionOnScreen&&this.props.hotspot.eventTypeID===s.EVENT_TYPES.hover?void c.updateSimpleOverlay({hotspot:this.props.hotspot}):void(this.props.hotspot.eventTypeID!==s.EVENT_TYPES.hover&&c.handleHotspotClick({hotspot:this.props.hotspot,tracking:{hotspotClicked:!0}}))},handleMouseEnter:function(e){this.props.isOverlayOpen===!0&&"simple"===this.props.overlayType||this._shouldIgnoreHoverEvent(e)||(this.props.hotspot.metaData.stayOnScreen?c.handleHotspotClick({hotspot:this.props.hotspot,fromHover:!0,isInFixedElement:this.props.isInFixedElement,tracking:{hotspotClicked:!1}}):c.handleHotspotMouseEnter({hotspot:this.props.hotspot,isInFixedElement:this.props.isInFixedElement}))},handleMouseLeave:function(e){this._shouldIgnoreHoverEvent(e)||c.handleHotspotMouseLeave({hotspot:this.props.hotspot})},componentDidMount:function(){var e=ReactDOM.findDOMNode(this);this.props.hotspot.eventTypeID===s.EVENT_TYPES.hover&&this._setupHoverEvents(),"simple"===this.props.overlayType&&e.addEventListener("mouseleave",this.handleMouseLeave)},componentWillUnmount:function(){this._removeHoverEvents()},componentDidUpdate:function(e,t){this.props.hotspot.eventTypeID===s.EVENT_TYPES.hover&&e.hotspot.eventTypeID!==s.EVENT_TYPES.hover&&(this._removeHoverEvents(),this._setupHoverEvents()),this.props.hotspot.eventTypeID!==s.EVENT_TYPES.hover&&e.hotspot.eventTypeID===s.EVENT_TYPES.hover&&this._removeHoverEvents()},render:function(){var e=this.props.hotspot,t=this.props.isInFixedElement&&this.props.fixedOffset,n={top:this.formatWithDisplayScale(e.y),left:this.formatWithDisplayScale(e.x+this.props.fixedOffset),width:this.formatWithDisplayScale(e.width),height:this.formatWithDisplayScale(e.height),position:t?"fixed":!1};if(e.forceCloseOnMouseLeave&&this.props.overlayOffsets){var o=a.getFixedElementOffsets(e,this.props);r.merge(n,o)}r.merge(n,this.props.style);var l=i("hotspot",{template:e.includeHotspotInTemplate,hover:e.eventTypeID===s.EVENT_TYPES.hover,parent:e.isParent===!0,"is-force-close":e.forceCloseOnMouseLeave===!0});return React.createElement("a",{className:l,style:n,onClick:this.handleClick},e.id)}});t.exports=u},{"../actions/screen-viewer-actions.js":23,"../constants/hotspot.js":41,"../helpers/hotspot-helper.js":42,"../mixins/mobile-mixin.js":43,classnames:1,lodash:3}],27:[function(e,t,n){var r=e("lodash"),i=e("classnames"),o=e("../mixins/mobile-mixin.js"),s=e("./Hotspot.jsx"),a=React.createClass({displayName:"Hotspots",mixins:[o],propTypes:{disableHotspotFlash:React.PropTypes.bool.isRequired,height:React.PropTypes.number.isRequired,isOverlayOpen:React.PropTypes.bool.isRequired,width:React.PropTypes.number.isRequired,hotspots:React.PropTypes.array,forceCloseOnMouseLeave:React.PropTypes.bool,isInFixedElement:React.PropTypes.bool,overlayType:React.PropTypes.string,overlayMeta:React.PropTypes.object,isMobile:React.PropTypes.bool,screen:React.PropTypes.object,overlayOffsets:React.PropTypes.object,style:React.PropTypes.object},areHotspotsFlashed:!1,getInitialState:function(){return{fixedOffset:0}},_shouldHotspotDisplay:function(e){var t=!0;if(r.isUndefined(this.props.screen))return t;var n=this.props.screen;return this.props.isInFixedElement!==!0&&e.y<n.fixedHeaderHeight&&(t=!1),this.props.isMobile&&this.props.isOverlayOpen&&!this.props.isOverlayScreen&&this.props.overlayMeta&&!this.props.overlayMeta.closeOnOutsideClick&&(t=!1),t},_getHotspotsToFlash:function(){return this.props.isOverlayOpen?"#screen_viewer_overlay .hotspot":".hotspot"},_showHotspots:function(){var e=this._getHotspotsToFlash();$(e).stop(!0).fadeTo(100,1),this.areHotspotsFlashed=!0},_hideHotspots:function(){var e=this._getHotspotsToFlash();$(e).stop(!0).fadeTo(200,0),this.areHotspotsFlashed=!1},flashHotspots:function(e){if(!this.props.disableHotspotFlash&&!$(e.target).hasClass("hotspot")){var t=this;this._showHotspots();var n=setTimeout(function(){t._hideHotspots(),clearTimeout(n)},300)}},handleKeyDown:function(e){this.props.disableHotspotFlash||e.shiftKey===!1||this._showHotspots()},handleKeyUp:function(e){this.areHotspotsFlashed===!0&&this._hideHotspots()},componentDidMount:function(){this.props.forceCloseOnMouseLeave&&this.props.isInFixedElement&&this.props.isOverlayOpen&&this.setState({fixedOffset:$(this.refs.hotspots).offset().left}),window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp)},componentWillUnmount:function(){window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp)},render:function(){var e=this,t=this.props.hotspots,n=r.map(t,function(t){var n=e._shouldHotspotDisplay(t);return n?React.createElement(s,{hotspot:t,key:t.id,displayScale:e.props.displayScale,style:e.props.style,overlayType:e.props.overlayType,isInFixedElement:e.props.isInFixedElement,fixedOffset:e.state.fixedOffset,overlayOffsets:e.props.overlayOffsets,isOverlayOpen:e.props.isOverlayOpen}):null}),o=i("hotspots",{"is-force-close":this.props.forceCloseOnMouseLeave});return React.createElement("div",{className:o,onClick:this.flashHotspots,ref:"hotspots"},n)}});t.exports=a},{"../mixins/mobile-mixin.js":43,"./Hotspot.jsx":26,classnames:1,lodash:3}],28:[function(e,t,n){(function(n){function r(e){return/\.gif\?/i.test(e)}function i(){var e="object"==typeof navigator&&navigator.userAgent;return!/msie (9|10)/i.test(e)}var o=n.React.addons.PureRenderMixin,s=e("../mixins/mobile-mixin.js"),a=e("../../../utilities/auto-image-preloader.js"),l=React.createClass({displayName:"Image",mixins:[o,s],propTypes:{alt:React.PropTypes.string.isRequired,displayScale:React.PropTypes.number.isRequired,height:React.PropTypes.number.isRequired,src:React.PropTypes.string.isRequired,width:React.PropTypes.number.isRequired,style:React.PropTypes.object},resetSrc:function(){var e=this;setTimeout(function(){e.refs.image&&(e.refs.image.src=e._src)},0)},updateSrc:function(e){if(r(e)){var t=i();e=t?a.next(e):[e,+new Date].join("&")}this._src=e},componentWillMount:function(){this.updateSrc(this.props.src)},componentDidMount:function(){if(this.refs.image){var e=ReactDOM.findDOMNode(this.refs.image);e.setAttribute("decoding","async")}this.resetSrc()},componentWillUpdate:function(e){this.updateSrc(e.src)},render:function(){var e=this.formatWithDisplayScale(this.props.height),t=this.formatWithDisplayScale(this.props.width);return React.createElement("img",{ref:"image",alt:this.props.alt,src:this._src,height:e,width:t,style:this.props.style})}});t.exports=l}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../../utilities/auto-image-preloader.js":46,"../mixins/mobile-mixin.js":43}],29:[function(e,t,n){var r=e("classnames"),i=e("../mixins/mobile-mixin.js"),o=e("./Image.jsx"),s=React.createClass({displayName:"MobileLoadingScreen",mixins:[i],propTypes:{displayScale:React.PropTypes.number.isRequired,screen:React.PropTypes.object.isRequired},getInitialState:function(){return{isLoaded:!1,isComplete:!1}},componentDidMount:function(){var e=this,t=2e3,n=450;this.fadeTimer=setTimeout(function(){e.setState({isLoaded:!0})},t),this.removeTimer=setTimeout(function(){e.setState({isComplete:!0}),InvScreenViewer.store.hasShownLoadingScreen=!0},t+n)},componentWillUnmount:function(){clearTimeout(this.fadeTimer),clearTimeout(this.removeTimer)},render:function(){if(this.state.isComplete===!0||InvScreenViewer.store.hasShownLoadingScreen===!0)return null;var e=this.props.screen,t=r("mobile-loading-screen",{loaded:this.state.isLoaded});return React.createElement("div",{className:t},React.createElement(o,{src:e.imageUrl,alt:e.name,height:this.formatWithDisplayScale(e.height),width:this.formatWithDisplayScale(e.width),displayScale:this.props.displayScale}))}});t.exports=s},{"../mixins/mobile-mixin.js":43,"./Image.jsx":28,classnames:1}],30:[function(e,t,n){var r=e("classnames"),i=e("../mixins/mobile-mixin.js"),o=e("../actions/screen-viewer-actions.js"),s=e("../stores/screen-viewer-store.js"),a=e("./FixedElement.jsx"),l=e("./Hotspots.jsx"),c=e("./Image.jsx"),u=e("./MobileTransparencyHelper.jsx"),p=e("./TourPoints.jsx"),f=!1,h=React.createClass({displayName:"MobileScreen",mixins:[i],propTypes:{disableHotspotFlash:React.PropTypes.bool.isRequired,displayScale:React.PropTypes.number.isRequired,hotspots:React.PropTypes.array.isRequired,isOverlayOpen:React.PropTypes.bool.isRequired,project:React.PropTypes.object.isRequired,screen:React.PropTypes.object.isRequired,tourPoints:React.PropTypes.object},_getFixedElementRailPadding:function(e){return e?this.formatWithDisplayScale(e)+5:0},_setupScrollbars:function(){var e=this.props.screen,t=this.props.project.mobileTemplate;if(!(this.formatWithDisplayScale(e.height)-3<=parseInt(t.viewportHeight))){var n=$(this.refs.scrollWrap),r=$(this.refs.mobileScreen),i=s.getDefaultMobileScrollPosition();n.niceScroll({cursordragontouch:!0,touchbehavior:!0,enablekeyboard:!1,hide:"leave",cursoropacitymax:".5",cursorborder:0,railpadding:{top:this._getFixedElementRailPadding(e.fixedHeaderHeight),bottom:this._getFixedElementRailPadding(e.fixedFooterHeight),right:3}}),f=n.getNiceScroll(0),f.scrollTop(i),f.scrollend(function(e){o.setCurrentScroll(e.end.x,e.end.y),s.setScrollEnd({x:e.end.x,y:e.end.y})});var a=$(f.rail);this.isChrome46()?r.addClass("drag"):a.addClass("mobile-scroll"),a.css("cursor",""),n.css("cursor",""),o.setMobileScreenViewport(f)}},componentDidMount:function(){var e=s.transitionScroll||{x:0,y:0};o.setCurrentScroll(e.x,e.y),this._setupScrollbars()},componentDidUpdate:function(){f||this._setupScrollbars()},componentWillUnmount:function(){f&&(f.remove(),f=null,o.setMobileScreenViewport(f))},render:function(){var e=this.props.project,t=this.props.screen,n=this.props.hotspots,i=this.props.displayScale,o=this.props.isOverlayOpen,s=(this.props.isOverlayScreen,this.props.overlayType),f=this.props.overlayMeta,h=this.props.disableHotspotFlash,d=this.props.tourPoints,v=this.formatWithDisplayScale(t.height-t.fixedFooterHeight),m={height:v,overflowY:t.fixedFooterHeight>0?"hidden":null},y=r({"mobile-hover-chrome":this.isChrome46()}),g={background:"#"+t.backgroundColor},b={width:e.mobileTemplate.viewportWidth,overflow:"hidden"};return React.createElement("div",{id:"mobile_screen",style:g,className:y,ref:"mobileScreen"},t.fixedHeaderHeight>0?React.createElement(a,{type:"header",screen:t,hotspots:n,displayScale:i,disableHotspotFlash:h,isOverlayOpen:o,isOverlayScreen:!1,overlayMeta:f,tourPoints:d,isMobile:!0}):null,t.fixedFooterHeight>0?React.createElement(a,{type:"footer",screen:t,hotspots:n,displayScale:i,disableHotspotFlash:h,isOverlayOpen:o,isOverlayScreen:!1,overlayMeta:f,tourPoints:d,isMobile:!0}):null,React.createElement("div",{className:"scroll-wrap",ref:"scrollWrap",style:b},React.createElement(u,{type:"header",height:t.fixedHeaderHeight,backgroundColor:t.extended.fixedHeaderBackground,displayScale:i}),React.createElement(u,{type:"footer",height:t.fixedFooterHeight,backgroundColor:t.extended.fixedFooterBackground,parentScreenHeight:t.height,displayScale:i}),React.createElement(l,{isMobile:!0,hotspots:n,displayScale:i,isOverlayOpen:o,isOverlayScreen:!1,overlayMeta:f,overlayType:s,disableHotspotFlash:h,screen:t,height:t.height,width:t.width}),React.createElement(p,{tourPoints:d,screen:t,displayScale:i}),React.createElement("div",{style:m},React.createElement(c,{src:t.imageUrl,alt:t.name,height:t.height,width:t.width,displayScale:i}))))},isChrome46:function(){var e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./),t=navigator.platform;return"MacIntel"===t&&!!e&&46===parseInt(e[2],10)}});t.exports=h},{"../actions/screen-viewer-actions.js":23,"../mixins/mobile-mixin.js":43,"../stores/screen-viewer-store.js":44,"./FixedElement.jsx":25,"./Hotspots.jsx":27,"./Image.jsx":28,"./MobileTransparencyHelper.jsx":33,"./TourPoints.jsx":39,classnames:1}],31:[function(e,t,n){var r=e("classnames"),i=React.createClass({displayName:"MobileSkin",propTypes:{config:React.PropTypes.object.isRequired,template:React.PropTypes.object.isRequired,isStatusBarOpaque:React.PropTypes.bool,isStatusBarVisible:React.PropTypes.bool},_getSkinMargin:function(){if(!this.props.config.isMobile||!this.props.config.isEmbed){var e=this.props.template.deviceHeight,t=window.innerHeight,n=(t-e)/2,r=this.props.config.isShare?0:42,i=n>=0?n-r:100;return i}},_getSkinSize:function(){var e=this.props.template.deviceWidth,t=this.props.template.deviceHeight;return{width:e,height:t}},render:function(){var e=this.props.template,t=r("mobile-skin",e.className,e.mobileSkinColor,e.orientation,{"opaque-status-bar":this.props.isStatusBarOpaque&&this.props.isStatusBarVisible}),n=this._getSkinSize(),i=this._getSkinMargin(),o={width:n.width+"px",height:n.height+"px",marginTop:i+"px",marginBottom:i+"px"};return React.createElement("div",{className:t,style:o},this.props.children)}});t.exports=i},{classnames:1}],32:[function(e,t,n){var r=e("classnames"),i=e("../actions/screen-viewer-actions.js"),o=React.createClass({displayName:"MobileStatusBar",propTypes:{backgroundColor:React.PropTypes.string.isRequired,fontColor:React.PropTypes.string.isRequired,isTransparent:React.PropTypes.bool.isRequired},handleClick:function(){i.angularToggleConfigMenu()},render:function(){var e=r("mobile-status-bar",this.props.fontColor),t={backgroundColor:this.props.isTransparent?null:this.props.backgroundColor};return React.createElement("div",{className:e,style:t,onClick:this.handleClick})}});t.exports=o},{"../actions/screen-viewer-actions.js":23,classnames:1}],33:[function(e,t,n){var r=e("classnames"),i=e("../mixins/mobile-mixin.js"),o=React.createClass({displayName:"MobileTransparencyHelper",mixins:[i],propTypes:{backgroundColor:React.PropTypes.string.isRequired,displayScale:React.PropTypes.number.isRequired,height:React.PropTypes.number.isRequired,type:React.PropTypes.string.isRequired,parentScreenHeight:React.PropTypes.number},render:function(){var e=r("mobile-transparency-helper",this.props.type),t={height:this.formatWithDisplayScale(this.props.height),backgroundColor:this.props.backgroundColor,top:this.props.parentScreenHeight?this.formatWithDisplayScale(this.props.parentScreenHeight-this.props.height):null};return this.props.height>0?React.createElement("div",{className:e,style:t}):null}});t.exports=o},{"../mixins/mobile-mixin.js":43,classnames:1}],34:[function(e,t,n){var r,i,o,s=e("classnames"),a=e("../constants/hotspot.js"),l=e("../mixins/mobile-mixin.js"),c=e("../actions/screen-viewer-actions.js"),u=e("../stores/screen-viewer-store.js"),p=e("./Hotspots.jsx"),f=e("./Screen.jsx"),h=0,d=React.createClass({displayName:"Overlay",propTypes:{config:React.PropTypes.object.isRequired,disableHotspotFlash:React.PropTypes.bool.isRequired,displayScale:React.PropTypes.number.isRequired,hotspots:React.PropTypes.array.isRequired,isOverlayOpen:React.PropTypes.bool.isRequired,parentScreen:React.PropTypes.object.isRequired,project:React.PropTypes.object.isRequired,screen:React.PropTypes.object.isRequired,type:React.PropTypes.string.isRequired,metaData:React.PropTypes.object,forceCloseOnMouseLeave:React.PropTypes.bool,isBrowserTooSmall:React.PropTypes.bool,isInFixedElement:React.PropTypes.bool,template:React.PropTypes.object},mixins:[l],componentWillMount:function(){this.props.project.isMobile&&this._setupMobileScrollWatch()},componentDidMount:function(){this._setupStickyUpOffset()},componentDidUpdate:function(e,t){this._destroyStickyUpOffset(),this.props.isBrowserTooSmall===!0&&this._setupStickyUpOffset(),e.config.isPresenter!==this.props.config.isPresenter&&this.props.isOverlayOpen&&this.props.forceCloseOnMouseLeave&&!this.props.isInFixedElement&&c.handleCloseOverlay()},componentWillUnmount:function(){r&&r.off("scroll.Overlay"),this._destroyStickyUpOffset()},render:function(){var e=null,t=this.props.disableHotspotFlash,n=this.props.displayScale,r=this.props.hotspots,o=this.props.isOverlayOpen,l=_.isUndefined(this.props.metaData)?{}:this.props.metaData.overlay,c=this.props.parentScreen,d=this.props.project,v=_.cloneDeep(this.props.screen),m=this.props.template,y=this.props.type,g=this.props.isInFixedElement,b=this.props.forceCloseOnMouseLeave&&!g,S=s("backdrop"),x=this.formatWithDisplayScale(v.height),w=this.formatWithDisplayScale(v.width),T=this.formatWithDisplayScale(c.height),E=this.formatWithDisplayScale(c.width),O={height:x,width:w,overflow:g?"visible":"hidden"},R={background:"#"+v.backgroundColor,opacity:100};v.config={},v.fixedHeaderHeight=0,v.fixedFooterHeight=0;var P=s(y,a.OVERLAY_TRANSITION_TYPES[l.transitionID],{"no-reverse":l.reverseTransitionOnClose===!1,"is-in-fixed-element":g===!0,"should-scroll":d.isMobile&&!l.closeOnOutsideClick}),j={};switch(y){case"simple":j={textAlign:"left",pointerEvents:"none",zIndex:g?null:3},O.pointerEvents="auto",g&&_.merge(j,{position:"fixed",marginLeft:"-"+window.scrollX+"px",width:c.width});break;case"complex":var I=s("overlay-screen",a.OVERLAY_POSITION_TYPES[l.positionID],a.OVERLAY_TRANSITION_TYPES[l.transitionID],{fixed:l.isFixedPosition&&!d.isMobile,"is-mobile":d.isMobile});S=s("backdrop",{"can-close":l.closeOnOutsideClick});var M=l.positionOffset.y,D=l.positionOffset.x;if(d.isMobile&&1===l.positionID){var k=u.getScrollEnd();M=l.positionOffset.y-k.y}else 3===parseInt(this.props.config.zoomScrollBehavior)&&(M=this.formatWithDisplayScale(l.positionOffset.y),D=this.formatWithDisplayScale(l.positionOffset.x));R={background:"#"+v.backgroundColor,opacity:l.bgOpacity/100};var C={height:T,width:E},F=s("overlay-screen-wrap",{"has-hover-hotspot":b});if(m&&(C={height:m.viewportHeight,width:m.viewportWidth}),e=React.createElement("div",{className:S,style:R,onClick:this.handleBackdropClick}),"centered"===a.OVERLAY_POSITION_TYPES[l.positionID])O.margin="-"+x/2+"px 0 0 -"+w/2+"px";else{switch(l.positionID){case 1:O.margin=M+"px 0 0 "+D+"px";break;case 3:case 4:case 5:O.marginTop=M+"px";break;case 6:case 7:case 8:O.marginBottom=M+"px"}switch(l.positionID){case 2:case 3:case 6:var H=w/2*-1;O.marginLeft=H+D+"px";break;case 4:case 7:O.marginRight=D+"px";break;case 5:case 8:O.marginLeft=D+"px"}}if(!l.isFixedPosition&&d.isMobile&&i){var L,A=i.scrollTop();switch(h=A,l.positionID){case 2:L=T/2-x/2-A,O.top=0,O.marginTop=L+"px";break;case 6:case 7:case 8:L=T-x-A-M,O.marginTop=L+"px",O.bottom="auto"}}}return React.createElement("div",{id:"screen_viewer_overlay",className:P,style:j},React.createElement("div",{className:F,style:C},React.createElement("div",{className:I,style:O,ref:"overlayScreen"},React.createElement(f,{screen:v,hotspots:r,key:v.id,displayScale:n,isOverlayScreen:!0,isOverlayOpen:o,disableHotspotFlash:t,forceCloseOnMouseLeave:b,overlayType:y,overlayOffsets:l.positionOffset})),b?React.createElement(p,{hotspots:r,displayScale:n,isOverlayOpen:o,isOverlayScreen:!0,disableHotspotFlash:t,height:T,width:E,forceCloseOnMouseLeave:b,isInFixedElement:this.props.isInFixedElement}):null,e))},handleBackdropClick:function(){this.props.metaData.overlay.closeOnOutsideClick===!0&&c.handleCloseOverlay()},_setupMobileScrollWatch:function(){if(!this.props.metaData.overlay.isFixedPosition){var e=this;r=$(".scroll-wrap"),i=r.getNiceScroll()[0],r.on("scroll.Overlay",function(){var t=h-i.scrollTop(),n="translateY("+t+"px)";$(e.refs.overlayScreen).css({WebkitTransform:n,MozTransform:n,msTransform:n,transform:n})})}},_setupStickyUpOffset:function(){_.isEmpty(this.props.metaData)||_.isUndefined(this.props.metaData)||this.props.isBrowserTooSmall===!0&&7===this.props.metaData.overlay.transitionID&&1===this.props.metaData.overlay.positionID&&(o=$(window),o.on("scroll.Overlay",this._moveStickyUp),o.on("resize.Overlay",this._moveStickyUp),this._moveStickyUp())},_destroyStickyUpOffset:function(){o&&(o.off("scroll.Overlay",this._moveStickyUp),o.off("resize.Overlay",this._moveStickyUp))},_moveStickyUp:function(){var e=-1*o.scrollLeft(),t="translateX("+e+"px)";$(this.refs.overlayScreen).css({WebkitTransform:t,MozTransform:t,msTransform:t,transform:t})}});t.exports=d},{"../actions/screen-viewer-actions.js":23,"../constants/hotspot.js":41,"../mixins/mobile-mixin.js":43,"../stores/screen-viewer-store.js":44,"./Hotspots.jsx":27,"./Screen.jsx":35,classnames:1}],35:[function(e,t,n){var r=e("lodash"),i=e("../mixins/mobile-mixin.js"),o=e("../actions/screen-viewer-actions.js"),s=e("./FixedElement.jsx"),a=e("./Hotspots.jsx"),l=e("./Image.jsx"),c=e("./TourPoints.jsx"),u=React.createClass({displayName:"Screen",mixins:[i],propTypes:{disableHotspotFlash:React.PropTypes.bool.isRequired,displayScale:React.PropTypes.number.isRequired,hotspots:React.PropTypes.array.isRequired,isOverlayOpen:React.PropTypes.bool.isRequired,screen:React.PropTypes.object.isRequired,forceCloseOnMouseLeave:React.PropTypes.bool,overlayType:React.PropTypes.string,overlayOffsets:React.PropTypes.object,tourPoints:React.PropTypes.object},handleMouseLeave:function(){o.handleCloseOverlay()},componentDidMount:function(){o.maintainScrollPosition(),this.props.forceCloseOnMouseLeave&&ReactDOM.findDOMNode(this).addEventListener("mouseleave",this.handleMouseLeave)},componentWillUnmount:function(){ReactDOM.findDOMNode(this).removeEventListener("mouseleave",this.handleMouseLeave)},render:function(){var e,t=this.props.screen,n=this.props.hotspots,i=this.props.displayScale,o=this.props.isOverlayOpen,u=this.props.disableHotspotFlash,p=this.props.tourPoints,f="screen_"+t.id,h=t.fixedHeaderHeight+t.fixedFooterHeight,d=$("#bottom_bar:not(.hidden)").size()>0?$("#bottom_bar").height():0,v=window.innerHeight,m={height:this.formatWithDisplayScale(t.height-h-(t.fixedFooterHeight&&t.height>=v?d:0)),width:this.formatWithDisplayScale(t.width)};if(t.fixedHeaderHeight>0){var y=this.formatWithDisplayScale(t.fixedHeaderHeight);
r.merge(m,{marginTop:y,overflow:"hidden"}),e={marginTop:"-"+y+"px"}}else if(t.fixedFooterHeight>0){var y=this.formatWithDisplayScale(t.fixedFooterHeight);r.merge(m,{marginBottom:"-"+y+"px",overflow:"hidden"})}return React.createElement("div",{className:"screen",id:f,style:m},t.fixedHeaderHeight>0?React.createElement(s,{type:"header",screen:t,hotspots:n,displayScale:i,isOverlayOpen:o,disableHotspotFlash:u,tourPoints:p}):null,t.fixedFooterHeight>0?React.createElement(s,{type:"footer",screen:t,hotspots:n,displayScale:i,isOverlayOpen:o,disableHotspotFlash:u,tourPoints:p}):null,React.createElement(a,{isMobile:!1,hotspots:n,displayScale:i,isOverlayOpen:o,disableHotspotFlash:u,height:t.height,width:t.width,style:e,overlayType:this.props.overlayType,overlayOffsets:this.props.overlayOffsets,screen:t}),React.createElement(c,{tourPoints:p,screen:t,displayScale:i,hasFixedOffset:!0}),React.createElement(l,{src:t.imageUrl,alt:t.name,height:t.height,width:t.width,displayScale:i,style:e}))}});t.exports=u},{"../actions/screen-viewer-actions.js":23,"../mixins/mobile-mixin.js":43,"./FixedElement.jsx":25,"./Hotspots.jsx":27,"./Image.jsx":28,"./TourPoints.jsx":39,lodash:3}],36:[function(e,t,n){var r=e("classnames"),i=e("reflux"),o=e("../actions/screen-viewer-actions.js"),s=e("../stores/screen-viewer-store.js"),a=e("../mixins/mobile-mixin.js"),l=e("./ScreenViewerNav.jsx"),c=e("./MobileSkin.jsx"),u=e("./MobileStatusBar.jsx"),p=e("./Viewport.jsx"),f=React.createClass({displayName:"ScreenViewer",mixins:[i.connect(s),a],getInitialState:function(){return{currentOverlay:{},isBrowserTooSmall:!1}},componentDidMount:function(){window.addEventListener("resize",this.handleResize),window.addEventListener("scroll",this.setViewportPosition),this.handleResize()},componentDidUpdate:function(e,t){if(this.state.alignment){var n=this.state.alignment,r=t.alignment?t.alignment.offset:0,i=n.offset||0;(r!==i||this.state.alignment.usingScroll!==n.usingScroll)&&this.handleSyncScreenAlignment(n),t.screen.id!==this.state.screen.id&&this.setViewportPosition()}},componentWillUnmount:function(){window.removeEventListener("resize",this.handleResize),window.removeEventListener("scroll",this.setViewportPosition)},render:function(){{var e=this.state.screen,t=this.state.project,n=this.state.config,i=this.state.screenCount,o=this.state.isOverlayOpen,a=this.state.disableHotspotFlash,f=this.state.isBrowserTooSmall,h=this.state.tourPoints,d=!!this.state.isNavigationDisabled,v=e.displayScale,m=this.applyDisplayScale(e.fixedHeaderHeight,v),y=this.applyDisplayScale(e.fixedFooterHeight,v),g=this.applyDisplayScale(e.width,v),b=this.applyDisplayScale(e.height,v),_=i>=1;this.state.currentOverlay}(d||n.isShare===!0&&!n.isLoadAllScreens)&&(_=!1);var S=s.hasShownLoadingScreen,x={textAlign:n.alignment},w={height:m,width:$(window).width()},T={height:y,width:$(window).width()},E=g/v,O={borderImageSource:'url("'+e.imageUrl+'")',borderImageSlice:"0 0 0 "+(E-1)+" fill",height:b},R={borderImageSource:'url("'+e.imageUrl+'")',borderImageSlice:"0 0 0 "+(E-1)+" fill",height:b},P=r({mobile:t.isMobile,"browser-is-too-small":f});return React.createElement("div",{id:"screen_viewer",style:x,className:P},!t.isMobile&&e.fixedHeaderHeight>0&&e.backgroundAutostretch?React.createElement("div",{className:"autostretch-container",style:w},React.createElement("div",{className:"autostretch-header",style:O})):null,!t.isMobile&&e.fixedFooterHeight>0&&e.backgroundAutostretch?React.createElement("div",{className:"autostretch-container-footer",style:T},React.createElement("div",{className:"autostretch-footer",style:R})):null,t.isMobile?React.createElement(c,{template:t.mobileTemplate,config:n,isStatusBarOpaque:n.mobileStatusbarIsOpaque,isStatusBarVisible:n.mobileStatusbarIsVisible},n.mobileStatusbarIsVisible?React.createElement(u,{backgroundColor:n.mobileStatusbarBackgroundColor,fontColor:n.mobileStatusbarFontColor,isTransparent:n.mobileStatusbarBackgroundIsTransparent}):null,"iPhoneX"===t.mobileTemplate.mobileSkin?React.createElement("div",{className:"iphoneX-notch"}):null,React.createElement(p,{config:n,project:t,screen:e,hotspots:e.hotspots,currentOverlay:this.state.currentOverlay,template:t.mobileTemplate,displayScale:e.displayScale,isOverlayOpen:o,isStatusBarOpaque:n.mobileStatusbarIsOpaque,disableHotspotFlash:a,tourPoints:h,hasShownLoadingScreen:S}),React.createElement(l,{project:t,shouldShowNav:_})):null,t.isMobile?null:React.createElement(p,{ref:"desktopViewport",project:t,screen:e,config:n,hotspots:e.hotspots,currentOverlay:this.state.currentOverlay,displayScale:e.displayScale,isOverlayOpen:o,disableHotspotFlash:a,isBrowserTooSmall:f,isStatusBarOpaque:!1,tourPoints:h}),t.isMobile?null:React.createElement(l,{project:t,shouldShowNav:_}))},setViewportPosition:function(){if(!this.state.project.isMobile){var e=$(ReactDOM.findDOMNode(this.refs.desktopViewport)),t=e.offset();o.setScreenViewerPosition({x:t.left-window.scrollX,y:window.scrollY,width:this.state.isBrowserTooSmall?window.innerWidth:e.innerWidth()})}},handleResize:function(){var e=this._isBrowserTooSmall();e!==this.state.isBrowserTooSmall&&this.setState({isBrowserTooSmall:e}),this.setViewportPosition(),this.state.alignment&&this.handleSyncScreenAlignment(this.state.alignment)},handleSyncScreenAlignment:function(e){var t=ReactDOM.findDOMNode(this);e.usingScroll?(t.style.marginLeft=null,$("html, body").animate({scrollLeft:e.offset},300)):t.style.marginLeft=Math.min(-Math.abs(e.offset),0)+"px"},_isBrowserTooSmall:function(){return this.state.project.isMobile?!1:window.innerWidth<this.state.screen.width}});t.exports=f},{"../actions/screen-viewer-actions.js":23,"../mixins/mobile-mixin.js":43,"../stores/screen-viewer-store.js":44,"./MobileSkin.jsx":31,"./MobileStatusBar.jsx":32,"./ScreenViewerNav.jsx":37,"./Viewport.jsx":40,classnames:1,reflux:5}],37:[function(e,t,n){var r=e("classnames"),i=e("../constants/hotspot.js"),o=e("../actions/screen-viewer-actions.js"),s=(e("../stores/screen-viewer-store.js"),React.createClass({displayName:"ScreenViewerNav",propTypes:{project:React.PropTypes.object.isRequired,shouldShowNav:React.PropTypes.bool.isRequired},render:function(){if(this.props.shouldShowNav===!1)return null;var e=r(this.props.project.isMobile?"preview-nav":"slideshow-nav");return React.createElement("div",{id:"screens_viewer_nav"},React.createElement("div",{className:e},React.createElement("a",{className:"prev nav-left",onClick:this.handlePreviousScreenClick},React.createElement("span",{className:"hide-text"},"Previous")),React.createElement("a",{className:"next nav-right",onClick:this.handleNextScreenClick},React.createElement("span",{className:"hide-text"},"Next"))))},handlePreviousScreenClick:function(){var e={targetTypeID:i.TARGET_TYPES.previousScreenInSort};o.handleHotspotClick({hotspot:e,tracking:{hotspotClicked:!1,pagingArrowClicked:"previous"}}),o.angularNavigateFromScreensViewerNav()},handleNextScreenClick:function(){var e={targetTypeID:i.TARGET_TYPES.nextScreenInSort};o.handleHotspotClick({hotspot:e,tracking:{hotspotClicked:!1,pagingArrowClicked:"next"}}),o.angularNavigateFromScreensViewerNav()}}));t.exports=s},{"../actions/screen-viewer-actions.js":23,"../constants/hotspot.js":41,"../stores/screen-viewer-store.js":44,classnames:1}],38:[function(e,t,n){var r=e("classnames"),i=e("../mixins/mobile-mixin.js"),o=e("../actions/screen-viewer-actions.js"),s=React.createClass({displayName:"TourPoint",mixins:[i],propTypes:{displayScale:React.PropTypes.number.isRequired,tourPoint:React.PropTypes.object.isRequired,screen:React.PropTypes.object.isRequired,selectedTourPoint:React.PropTypes.object.isRequired,isInFixedFooter:React.PropTypes.bool,isInFixedHeader:React.PropTypes.bool},handleClick:function(){o.handleTourPointClick(this.props.tourPoint)},handleMouseEnter:function(){o.handleTourPointMouseEnter(this.props.tourPoint)},handleMouseLeave:function(){o.handleTourPointMouseLeave()},render:function(){var e=this.props.tourPoint,t=this.props.screen,n=this.formatWithDisplayScale(e.y),i=120,o=t.fixedHeaderHeight>0&&n+i<t.fixedHeaderHeight,s=t.fixedFooterHeight>0&&n+i>this.formatWithDisplayScale(t.height)-t.fixedFooterHeight;if(e.screenID!==t.id)return null;if(this.props.isInFixedHeader&&!o)return null;if(this.props.isInFixedFooter&&!s)return null;if(!this.props.isInFixedHeader&&!this.props.isInFixedFooter&&(o||s))return null;var a=r("marker","preview-tour-point",{complete:e.isComplete,development:e.isForDevelopment,active:e.id===this.props.selectedTourPoint.id,"active-private":e.isPrivate,read:!e.isUnread}),l={left:this.formatWithDisplayScale(e.x),top:n};return React.createElement("div",{className:a,style:l,id:"tour-point-"+e.id,"data-tour-point-id":e.id,unselectable:"on",onClick:this.handleClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},React.createElement("div",{className:"point"}))}});t.exports=s},{"../actions/screen-viewer-actions.js":23,"../mixins/mobile-mixin.js":43,classnames:1}],39:[function(e,t,n){var r=e("reflux"),i=e("lodash"),o=e("../mixins/mobile-mixin.js"),s=e("../stores/tour-points-store.js"),a=e("./TourPoint.jsx"),l=React.createClass({displayName:"TourPoints",mixins:[o,r.connect(s)],propTypes:{displayScale:React.PropTypes.number.isRequired,screen:React.PropTypes.object.isRequired,hasFixedOffset:React.PropTypes.bool,isInFixedFooter:React.PropTypes.bool,isInFixedHeader:React.PropTypes.bool,tourPoints:React.PropTypes.object},render:function(){if(i.isEmpty(this.props.tourPoints)||this.state.areTourPointsEnabled===!1)return null;var e=this,t=this.props.screen,n=i.map(this.props.tourPoints,function(n){return React.createElement(a,{tourPoint:n,displayScale:e.props.displayScale,screen:t,selectedTourPoint:e.state.selectedTourPoint,isInFixedHeader:e.props.isInFixedHeader||!1,isInFixedFooter:e.props.isInFixedFooter||!1,key:n.id})}),r=this.formatWithDisplayScale(t.fixedHeaderHeight),o={height:this.formatWithDisplayScale(t.height),width:this.formatWithDisplayScale(t.width),marginTop:this.props.hasFixedOffset?"-"+r+"px":null};return React.createElement("div",{className:"tour-points",style:o},n)}});t.exports=l},{"../mixins/mobile-mixin.js":43,"../stores/tour-points-store.js":45,"./TourPoint.jsx":38,lodash:3,reflux:5}],40:[function(e,t,n){var r=e("lodash"),i=e("classnames"),o=React.addons.CSSTransitionGroup,s=e("../mixins/mobile-mixin.js"),a=e("./MobileLoadingScreen.jsx"),l=e("./MobileScreen.jsx"),c=e("./Overlay.jsx"),u=e("./Screen.jsx"),p=React.createClass({displayName:"Viewport",mixins:[s],propTypes:{config:React.PropTypes.object.isRequired,disableHotspotFlash:React.PropTypes.bool.isRequired,displayScale:React.PropTypes.number.isRequired,isOverlayOpen:React.PropTypes.bool.isRequired,isStatusBarOpaque:React.PropTypes.bool.isRequired,project:React.PropTypes.object.isRequired,screen:React.PropTypes.object.isRequired,currentOverlay:React.PropTypes.object,isBrowserTooSmall:React.PropTypes.bool,tourPoints:React.PropTypes.object},render:function(){var e=this.props.screen,t=this.props.project,n=this.props.currentOverlay,o=this.props.displayScale||1,s=this.props.template||{},c=this.props.isOverlayOpen,p=this.props.disableHotspotFlash,f=this.props.tourPoints,h=!0;r.isEmpty(n)||"simple"!==n.type||(h=!1);var d=i({"mobile-viewport":t.isMobile}),v={height:this.formatWithDisplayScale(e.height),width:this.formatWithDisplayScale(e.width)},m=React.createElement(u,{screen:e,hotspots:e.hotspots,displayScale:o,key:e.id,isOverlayOpen:c,disableHotspotFlash:p,tourPoints:f});return t.isMobile&&(v={width:s.viewportWidth},"iPhoneX"===s.mobileSkin&&(v.borderRadius=!this.props.config.mobileStatusbarIsVisible||this.props.config.mobileStatusbarBackgroundIsTransparent||this.props.isStatusBarOpaque?this.props.isStatusBarOpaque&&this.props.config.mobileStatusbarIsVisible?"0 0 40px 40px":"40px":"42px 42px 40px 40px"),m=React.createElement(l,{project:t,screen:e,hotspots:e.hotspots,displayScale:o,key:e.id,isOverlayOpen:c,isOverlayScreen:!1,overlayMeta:n.metaData?n.metaData.overlay:{},overlayType:n.type,disableHotspotFlash:p,tourPoints:f})),React.createElement("div",{id:"viewport",className:d,style:v},this.renderOverlay(h),t.loadingScreen?React.createElement(a,{screen:t.loadingScreen,displayScale:o}):null,m)},renderOverlay:function(e){var t=this.props.currentOverlay,n=this.props.screen,i=this.props.template||{},s=r.isEmpty(t)?null:React.createElement(c,{type:t.type,parentScreen:n,screen:t.screen,config:this.props.config,hotspots:t.hotspots,metaData:t.metaData,displayScale:n.displayScale,template:i,project:this.props.project,isOverlayOpen:this.props.isOverlayOpen,disableHotspotFlash:this.props.disableHotspotFlash,forceCloseOnMouseLeave:t.forceCloseOnMouseLeave,isBrowserTooSmall:this.props.isBrowserTooSmall,isInFixedElement:t.isInFixedElement});return e?React.createElement(o,{transitionName:"overlay",component:"div",transitionEnter:!0,transitionLeave:!0,transitionEnterTimeout:300,transitionLeaveTimeout:300},s):s}});t.exports=p},{"../mixins/mobile-mixin.js":43,"./MobileLoadingScreen.jsx":29,"./MobileScreen.jsx":30,"./Overlay.jsx":34,"./Screen.jsx":35,classnames:1,lodash:3}],41:[function(e,t,n){t.exports={EVENT_TYPES:{click:1,doubleTap:2,pressHold:3,swipeRight:4,swipeLeft:5,swipeUp:6,swipeDown:7,hover:8},TARGET_TYPES:{screen:1,lastScreenVisited:2,previousScreenInSort:3,nextScreenInSort:4,externalUrl:5,positionOnScreen:6,overlay:7},TRANSITION_TYPES:{none:1,pushRight:2,pushLeft:3,slideUp:4,slideDown:5,flipRight:6,flipLeft:7,dissolve:8},OVERLAY_TRANSITION_TYPES:{1:"fade-in-scale",2:"slide-in-right",3:"slide-in-bottom",4:"fade-in",5:"fall",6:"side-fall",7:"sticky-up",8:"flip-horizontal",9:"flip-vertical",10:"sign",11:"super-scaled",12:"instant",13:"rotate-in-bottom",14:"rotate-in-left",15:"rotate-in-top",16:"rotate-in-right",17:"slide-in-top",18:"slide-in-left"},OVERLAY_POSITION_TYPES:{1:"custom",2:"centered",3:"top center",4:"top right",5:"top left",6:"bottom center",7:"bottom right",8:"bottom left"}}},{}],42:[function(e,t,n){var r=e("lodash"),i=e("../stores/screen-viewer-store.js"),o=e("../mixins/mobile-mixin.js");t.exports={getFixedElementOffsets:function(e,t){var n=i.getScreenViewerPosition(),s={},a=e.metaData.overlay,l=a.isFixedPosition===!0,c=e.metaData.overlayScreen,u=e.metaData.parentScreen,p=l?n.document.width-c.width:n.width-c.width,f=l?n.document.width/2-c.width/2-n.x:n.width/2-c.width/2,h=l?n.document.height/2-c.height/2:u.height/2-c.height/2,d=l?n.document.height-c.height:u.height-c.height,v=p-n.x;switch(s.marginTop=t.overlayOffsets.y,s.marginLeft=-t.overlayOffsets.x,a.positionID){case 1:s.marginTop=-t.overlayOffsets.y;break;case 2:s.marginLeft-=f,s.marginTop-=h;break;case 6:s.marginLeft-=f,s.marginTop-=d;break;case 3:s.marginLeft-=f,s.marginTop=-t.overlayOffsets.y;break;case 4:s.marginTop=-t.overlayOffsets.y,s.marginLeft=a.isFixedPosition===!0?-v+t.overlayOffsets.x:-p+t.overlayOffsets.x;break;case 7:s.marginTop-=d,s.marginLeft=a.isFixedPosition===!0?-v+t.overlayOffsets.x:-p+t.overlayOffsets.x;break;case 5:s.marginTop=-t.overlayOffsets.y,a.isFixedPosition===!0&&(s.marginLeft+=n.x);break;case 8:s.marginTop-=d,a.isFixedPosition===!0&&(s.marginLeft+=n.x)}return r.forEach(s,function(e,n,r){s[n]=o.applyDisplayScale(e,t.displayScale)}),s}}},{"../mixins/mobile-mixin.js":43,"../stores/screen-viewer-store.js":44,lodash:3}],43:[function(e,t,n){t.exports={formatWithDisplayScale:function(e){if(!this.props.displayScale)throw new Error("formatWithDisplayScale: No props.displayScale");return this.applyDisplayScale(e,this.props.displayScale)},applyDisplayScale:function(e,t){return Math.round(parseInt(e,10)*t)}}},{}],44:[function(e,t,n){var r=e("lodash"),i=e("reflux"),o=e("../constants/hotspot.js"),s=e("../mixins/mobile-mixin.js"),a=e("../actions/screen-viewer-actions.js"),l=i.createStore({listenables:[a],currentScroll:{x:0,y:0},transitionScroll:{x:0,y:0},config:null,currentScreenID:null,disableHotspotFlash:!1,history:[],shouldMaintainScroll:!0,shouldTriggerInitialAlignment:!1,isOverlayOpen:!1,maintainScrollPosition:!1,mobileScreenViewport:void 0,hasShownLoadingScreen:!1,project:null,screen:null,screenCount:0,scrollEnd:{x:0,y:0},screens:null,tourPoints:{},isNavigationDisabled:!1,getInitialState:function(){return{config:this.config,currentScreenID:this.currentScreenID,disableHotspotFlash:this.disableHotspotFlash,isOverlayOpen:this.isOverlayOpen,project:this.project,screen:this.screen,screenCount:0,tourPoints:this.tourPoints,isNavigationDisabled:!1}},getDefaultData:function(e){this.config=e.config,this.currentScreenID=e.screen.id,this.project=e.project,this.screen=e.screen,this.screenCount=e.screenCount,this.screens=e.screens,this.tourPoints=e.tourPoints,this.isNavigationDisabled=e.isNavigationDisabled,this.setCurrentScreen({screenID:this.currentScreenID})},pushNewData:function(e){this.allHotspots=e.allHotspots||this.allHotspots,this.currentScreenID=e.currentScreenID||this.currentScreenID,this.disableHotspotFlash=e.disableHotspotFlash||this.disableHotspotFlash,this.screenCount=e.screenCount||this.screenCount,this.screen=e.screen||this.screen,this.screens=e.screens||this.screens,this.tourPoints=e.tourPoints||this.tourPoints,this.isNavigationDisabled=e.isNavigationDisabled||this.isNavigationDisabled,this.trigger(e)},_getTargetScreen:function(e){var t=e.targetScreenID;switch(e.targetTypeID){case o.TARGET_TYPES.lastScreenVisited:t=this.getLastScreenVisited();break;case o.TARGET_TYPES.previousScreenInSort:t=this.getPreviousScreenInSort();break;case o.TARGET_TYPES.nextScreenInSort:t=this.getNextScreenInSort()}return t},addToHistory:function(e,t){e!==r.last(this.history)&&e!==t&&this.history.push(e)},getNextScreenInSort:function(){var e=parseInt(r.findKey(this.screens,{id:this.currentScreenID}),10)+1;return e=e>=r.size(this.screens)?0:e,this.screens[e].id},getPreviousScreenInSort:function(){var e=parseInt(r.findKey(this.screens,{id:this.currentScreenID}),10)-1;return e=0>e?r.size(this.screens)-1:e,this.screens[e].id},getLastScreenVisited:function(){var e=r.last(this.history);return this.history.length-1>=1&&(this.history=r.dropRight(this.history)),e},setAlignment:function(e){this.trigger({alignment:e})},setCurrentScreen:function(e){r.defaults(e,{hotspot:!1,skipHistory:!1});var t=e.hotspot,n=e.screenID;if(e.skipHistory||this.addToHistory(this.currentScreenID,n),n!==this.currentScreenID){this.closeOverlay();var i=this.currentScreenID,o=r.findWhere(this.screens,{id:n});this.currentScreenID=n,this.screen=o,this.project.isMobile&&t&&1!==t.transitionTypeID?a.angularDoTransition(t,{hotspot:t,transitionTypeID:t.transitionTypeID,currentScreen:r.findWhere(this.screens,{id:i}),targetScreen:o,currentScreenPosition:t.currentScreenPosition,scrollPosition:this.currentScroll.y}):a.angularLocationChange(n),this.maintainScrollPosition=t.isScrollTo,i=null}},getScrollEnd:function(){return this.scrollEnd},setScrollEnd:function(e){this.scrollEnd=e},scrollToPosition:function(e){var t=e.isSmoothScroll?450:0,n="scrollScale"in this.screen?this.screen.scrollScale:this.screen.displayScale,r=s.applyDisplayScale(e.scrollOffset-this.screen.fixedHeaderHeight,n);this.project.isMobile?this.mobileScreenViewport.doScrollTop(r,t):$("html, body").animate({scrollTop:r},t)},triggerInitialSyncScreen:function(e){this.trigger({shouldTriggerInitialAlignment:e})},openExternalUrl:function(e){var t="file:"===window.location.protocol?e.url:"/redirect?url="+encodeURIComponent(e.url),n=e.isOpenInNewWindow,i=this.config.isShare&&!n?"_self":"_blank",o=window.navigator.userAgent,s=/(msie|trident)/i.test(o);if(s){var a=document.createElement("a");r.assign(a,{target:i,href:t}),n&&window.setTimeout(function(){document.body.removeChild(a)}),document.body.appendChild(a),a.click()}else window.open(t,i)},openSimpleOverlay:function(e){r.defaults(e,{isFromLegacyClick:!1,isInFixedElement:!1});var t=r.cloneDeep(e.hotspot);t.isParent=!0;var n=this._getTargetScreen(t),i=r.where(this.allHotspots,{screenID:n});i.push(t),this.isOverlayOpen=!0,this.trigger({isOverlayOpen:!0,currentOverlay:{type:"simple",screen:e.screen,hotspots:i,isInFixedElement:e.isInFixedElement,metaData:{overlay:{}}}})},onUpdateSimpleOverlay:function(e){var t=e.hotspot,n=r.find(this.screens,{id:t.targetScreenID}),i=r.where(this.allHotspots,{screenID:t.targetScreenID});this.openSimpleOverlay({hotspot:t,hotspots:i,screen:n,isFromLegacyClick:!0})},openComplexOverlay:function(e){r.defaults(e,{isInFixedElement:!1});var t=e.hotspot,n=this._getTargetScreen(t),i=r.find(this.screens,{id:t.screenID}),s=r.find(this.screens,{id:n}),l=r.where(this.allHotspots,{screenID:n});if(!s)return void console.error("No screen set for overlay");t.metaData.stayOnScreen!==!1&&!r.isUndefined(t.metaData.stayOnScreen)||t.eventTypeID!==o.EVENT_TYPES.hover||this.isOverlayOpen!==!1||(t.forceCloseOnMouseLeave=!0,l=[],l.push(t));var c=t.metaData;c.overlayScreen={id:s.id,width:s.width,height:s.height},c.parentScreen={id:i?i.id:0,width:i?i.width:0,height:i?i.height:0};var u=t.forceCloseOnMouseLeave,p=e.isInFixedElement,f=this.isOverlayOpen&&12!==c.overlay.transitionID,h=f?500:0;f&&this.closeOverlay(),this.isOverlayOpen=!0,setTimeout(function(){a.triggerComplexOverlay({screen:s,hotspots:l,metaData:c,forceClose:u,isInFixed:p})},h)},closeOverlay:function(){this.isOverlayOpen===!0&&(this.isOverlayOpen=!1,this.trigger({isOverlayOpen:!1,currentOverlay:{}}))},clearHistory:function(){this.history=[]},getDefaultMobileScrollPosition:function(){return this.maintainScrollPosition===!0?this.currentScroll.y:0},onActivateHotspot:function(e){a.handleHotspotClick({hotspot:e})},onHandleHotspotClick:function(e){r.defaults(e,{fromHover:!1,isInFixedElement:!1});var t=e.hotspot;switch(e.fromHover&&(t.isScrollTo=!0),t.isOverlayOpen=this.isOverlayOpen,t.targetTypeID){case o.TARGET_TYPES.screen:this.isOverlayOpen&&this.currentScreenID===t.targetScreenID?this.closeOverlay():this.setCurrentScreen({screenID:t.targetScreenID,hotspot:t});break;case o.TARGET_TYPES.lastScreenVisited:if(this.isOverlayOpen)this.closeOverlay();else{var n=this.getLastScreenVisited();this.setCurrentScreen({screenID:n,hotspot:t,skipHistory:!0})}break;case o.TARGET_TYPES.previousScreenInSort:var n=this.getPreviousScreenInSort();this.setCurrentScreen({screenID:n,hotspot:t});break;case o.TARGET_TYPES.nextScreenInSort:var n=this.getNextScreenInSort();this.setCurrentScreen({screenID:n,hotspot:t});break;case o.TARGET_TYPES.externalUrl:this.openExternalUrl(t.metaData);break;case o.TARGET_TYPES.positionOnScreen:this.scrollToPosition(t.metaData);break;case o.TARGET_TYPES.overlay:this.maintainScrollPosition=!0,this.openComplexOverlay({hotspot:t,isInFixedElement:e.isInFixedElement})}this.transitionScroll=r.assign(t.isScrollTo?this.currentScroll:{x:0,y:0}),this.currentScroll=r.clone(this.transitionScroll)},onHandleHotspotMouseEnter:function(e){r.defaults(e,{isInFixedElement:!1});var t=e.hotspot;if(this.maintainScrollPosition=!0,t.targetTypeID===o.TARGET_TYPES.overlay&&t.eventTypeID===o.EVENT_TYPES.hover)this.openComplexOverlay({hotspot:t,isInFixedElement:e.isInFixedElement});else{var n=t.targetScreenID;switch(t.targetTypeID){case o.TARGET_TYPES.lastScreenVisited:n=this.getLastScreenVisited();break;case o.TARGET_TYPES.previousScreenInSort:n=this.getPreviousScreenInSort();break;case o.TARGET_TYPES.nextScreenInSort:n=this.getNextScreenInSort();break;case o.TARGET_TYPES.externalUrl:this.openExternalUrl(t.metaData);break;case o.TARGET_TYPES.positionOnScreen:this.scrollToPosition(t.metaData)}var i=r.find(this.screens,{id:n});this.openSimpleOverlay({hotspot:t,screen:i,isInFixedElement:e.isInFixedElement})}},onHandleHotspotMouseLeave:function(e){var t=e.hotspot;t.targetTypeID===o.TARGET_TYPES.overlay&&t.eventTypeID===o.EVENT_TYPES.hover&&t.forceCloseOnMouseLeave!==!0||this.closeOverlay()},onHandleCloseOverlay:function(){this.closeOverlay()},onMaintainScrollPosition:function(){this.shouldMaintainScroll!==!1&&this.maintainScrollPosition===!1&&($("body,html").scrollTop(0),this.currentScroll.x=0,this.currentScroll.y=0)},onSetMobileScreenViewport:function(e){this.mobileScreenViewport=e},onSetCurrentScroll:function(e,t){this.currentScroll.x=e,this.currentScroll.y=t},onTriggerComplexOverlay:function(e){this.trigger({isOverlayOpen:!0,currentOverlay:{type:"complex",screen:e.screen,hotspots:e.hotspots,metaData:e.metaData,forceCloseOnMouseLeave:e.forceClose||!1,isInFixedElement:e.isInFixed}})},onSetScreenViewerPosition:function(e){this.screenViewerPosition={x:e.x,y:e.y,width:e.width,document:{width:document.documentElement.clientWidth,height:window.innerHeight}}},getScreenViewerPosition:function(){return this.screenViewerPosition}});t.exports=l},{"../actions/screen-viewer-actions.js":23,"../constants/hotspot.js":41,"../mixins/mobile-mixin.js":43,lodash:3,reflux:5}],45:[function(e,t,n){var r=(e("lodash"),e("reflux")),i=e("../actions/tour-points-actions.js"),o=r.createStore({listenables:[i],areTourPointsEnabled:!0,emptyTourPoint:{id:0},getInitialState:function(){return{selectedTourPoint:this.emptyTourPoint,areTourPointsEnabled:this.areTourPointsEnabled}},onSetSelectedTourPoint:function(e){e=e||this.emptyTourPoint,this.trigger({selectedTourPoint:e})},onDisableTourPoints:function(){this.areTourPointsEnabled=!1,this.trigger({areTourPointsEnabled:!1})}});t.exports=o},{"../actions/tour-points-actions.js":24,lodash:3,reflux:5}],46:[function(e,t,n){function r(e){var t=s.peek(e);i[e]=t;var n=document.createElement("img");return n.src=[e,+new Date].join("&"),n}var i={},o={},s=t.exports={images:o,clear:function(){i={},o={},this.images=o},peek:function(e){var t=o[e];return t?t.src:null},previous:function(e){return i[e]||null},next:function(e){var t=o[e];return o[e]=r(e),t?t.src:e}};angular.module("InVision").factory("autoImagePreloader",function(){return s})},{}],47:[function(e,t,n){(function(n){var r={component:e("../common/react-components/screen-viewer/components/ScreenViewer.jsx"),actions:e("../common/react-components/screen-viewer/actions/screen-viewer-actions.js"),store:e("../common/react-components/screen-viewer/stores/screen-viewer-store.js"),tourPointsStore:e("../common/react-components/screen-viewer/stores/tour-points-store.js")};n.InvScreenViewer=t.exports=r}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../common/react-components/screen-viewer/actions/screen-viewer-actions.js":23,"../common/react-components/screen-viewer/components/ScreenViewer.jsx":36,"../common/react-components/screen-viewer/stores/screen-viewer-store.js":44,"../common/react-components/screen-viewer/stores/tour-points-store.js":45}]},{},[47]);